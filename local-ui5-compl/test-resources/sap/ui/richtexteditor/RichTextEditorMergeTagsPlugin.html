<!DOCTYPE HTML>
<html>

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>RichTextEditorTinyMCE6 - mergetags plugin</title>

    <script src="../../../../resources/sap-ui-core.js" type="text/javascript" charset="UTF-8" id="sap-ui-bootstrap"
        data-sap-ui-libs="sap.ui.richtexteditor, sap.m" data-sap-ui-theme="sap_fiori_3" data-sap-ui-preload="async">
        </script>

    <script>
        sap.ui.getCore().attachInit(function () {
            sap.ui.require([
                "sap/ui/richtexteditor/RichTextEditor",
                "sap/ui/richtexteditor/RTESplitButton",
                "sap/m/App",
                "sap/m/Page",
                "sap/m/Button",
                "sap/ui/core/InvisibleText"
            ], function (RTE, RTESplitButton, App, Page, Button, InvisibleText) {

                var oApp = new App("myApp", {
                    initialPage: "myPage"
                });

                var oRichTextEditor = new RTE("myRTE", {
                    editorType: "TinyMCE6",
                    plugins: [{
                        name: "mergetags"
                    }],
                    width: "100%",
                    height: "300px",
                    showGroupFont: true,
                    showGroupUndo: true,
                    showGroupLink: true,
                    showGroupInsert: true,
                    customToolbar: true,
                    beforeEditorInit: function (oEvent) {
                        var oConfig = oEvent.getParameter('configuration');

                        Object.assign(oConfig, {

                            mergetags_prefix: '{*',
                            mergetags_suffix: '*}',
                            mergetags_list: [
                                {
                                    title: 'Client',
                                    menu: [
                                        {
                                            value: 'Client.LastCallDate',
                                            title: 'Call date'
                                        },
                                        {
                                            value: 'Client.Name',
                                            title: 'Client name'
                                        }
                                    ]
                                },
                                {
                                    title: 'Proposal',
                                    menu: [
                                        {
                                            value: 'Proposal.SubmissionDate',
                                            title: 'Submission date'
                                        }
                                    ]
                                },
                                {
                                    value: 'Consultant',
                                    title: 'Consultant'
                                },
                                {
                                    value: 'Salutation',
                                    title: 'Salutation'
                                }
                            ]
                        });
                    }
                });

                var oInvisibleText = new InvisibleText({
                    id: "textForRTE",
                    text: "RichTextEditor with a custom toolbar",
                });
                oRichTextEditor.addAriaLabelledBy(oInvisibleText);
                let value = '<h1 style="font-family: arial black,avant garde; font-size: xx-large; color: rgb(51, 51, 51);">Proposal for Services â€” {*Client.Name*}</h1>';
                value += '<h2 style="font-family: arial, sans-serif; font-size: large; color: rgb(51, 51, 51);">Prepared on {*Proposal.SubmissionDate*}</h2>';
                value += '<p style="font-family: arial, sans-serif; font-size: medium; color: rgb(51, 51, 51);">{*Client.Name*},</p>';
                value += '<p style="font-family: arial, sans-serif; font-size: medium; color: rgb(51, 51, 51);">As per our discussions on {*Client.LastCallDate*}, please find attached our formal Services Proposal.</p>';
                value += '<p style="font-family: arial, sans-serif; font-size: medium; color: rgb(51, 51, 51);">{*Salutation*},</p>';
                value += '<p style="font-family: arial, sans-serif; font-size: medium; color: rgb(51, 51, 51);">{*Consultant*}.</p>';

                oRichTextEditor.setValue(value);

                // This timeout is needed because the custom toolbar must be rendered before adding new groups in it.
                setTimeout(function () {
                    oRichTextEditor.addButtonGroup("styles");
                    oRichTextEditor.addButtonGroup("table");
                }, 1000);

                var oPage = new Page("myPage", {
                    title: "RichTextEditorTinyMCE6 with mergetags plugin",
                    contentOnlyBusy: true,
                    content: [
                        oInvisibleText,
                        oRichTextEditor
                    ]
                });

                oApp.addPage(oPage).placeAt("content");
            });
        });
    </script>
</head>

<body class="sapUiBody">
    <div id="content"></div>
</body>

</html>
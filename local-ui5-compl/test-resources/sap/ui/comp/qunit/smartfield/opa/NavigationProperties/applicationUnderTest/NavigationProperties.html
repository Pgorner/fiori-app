<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>SmartField bound to navigation properties</title>

	<script id="sap-ui-bootstrap"
			data-sap-ui-async="true"
			data-sap-ui-compat-version="edge"
			data-sap-ui-libs="sap.m, sap.ui.comp"
			src="../../../../../../../../../resources/sap-ui-core.js">
	</script>

	<script id="mainView" type="text/xml">
		<mvc:View
				viewName="myView"
				xmlns:mvc="sap.ui.core.mvc"
				controllerName="mainView.controller"
				xmlns="sap.m"
				xmlns:smartForm="sap.ui.comp.smartform"
				xmlns:smartField="sap.ui.comp.smartfield"
				height="100%">

			<App>
				<Page id="page" title="SmartField navigation properties">
					<smartForm:SmartForm id="smartForm" editable="true" title="Smart Form">
						<smartForm:Group binding="{/Products('001')}" title="/Products('001')">
							<smartForm:GroupElement>

								<smartField:SmartField id="ProductExpanded" value="{to_ProductCategories/Description}"/>

							</smartForm:GroupElement>
						</smartForm:Group>
						<smartForm:Group binding="{/Products('002')}" title="/Products('002')">
							<smartForm:GroupElement>

								<smartField:SmartField id="ProductNotExpanded" value="{to_ProductCategories/Description}"/>

							</smartForm:GroupElement>
						</smartForm:Group>
						<smartForm:Group id="createGroup">
							<smartForm:GroupElement>

								<smartField:SmartField id="CreateField" value="{to_ProductCategories/Description}"/>

							</smartForm:GroupElement>
						</smartForm:Group>
					</smartForm:SmartForm>

					<smartForm:SmartForm editable="true" title="Preview">
						<smartForm:Group binding="{/Categories('LT')}" title="/Categories('LT')">
							<smartForm:GroupElement>
								<smartField:SmartField id="CategoriesLT" value="{Description}"/>
							</smartForm:GroupElement>
						</smartForm:Group>
						<smartForm:Group binding="{/Categories('SS')}" title="/Categories('SS')">
							<smartForm:GroupElement>
								<smartField:SmartField id="CategoriesSS" value="{Description}"/>
							</smartForm:GroupElement>
						</smartForm:Group>
						<smartForm:Group binding="{/Categories('SP')}" title="/Categories('SP')">
							<smartForm:GroupElement>
								<smartField:SmartField id="CategoriesSP" value="{Description}"/>
							</smartForm:GroupElement>
						</smartForm:Group>
					</smartForm:SmartForm>

					<Button id="ExpandPersisted" text="Expand Persisted" press=".simulateExpand"/>
					<Button id="ExpandCreated" text="Expand Created" press=".simulateExpandOnCreated"/>
					<Button id="ResetModel" text="Reset Model" press=".resetModel"/>

				</Page>
			</App>
		</mvc:View>
	</script>

	<script id="metadata" type="text/xml"><?xml version="1.0" encoding="utf-8"?>
		<edmx:Edmx Version="1.0"
				   xmlns:edmx="http://schemas.microsoft.com/ado/2007/06/edmx"
				   xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata"
				   xmlns:sap="http://www.sap.com/Protocols/SAPData">
			<edmx:DataServices m:DataServiceVersion="2.0">
				<Schema Namespace="smartfield.TextInEditModeSource" sap:schema-version="1"
						xmlns="http://schemas.microsoft.com/ado/2008/09/edm">

					<EntityType Name="Product" sap:content-version="1">
						<Key>
							<PropertyRef Name="ID"/>
						</Key>
						<Property Name="ID" Type="Edm.String" Nullable="false" MaxLength="20" sap:label="Product ID" sap:creatable="false" sap:updatable="true" sap:sortable="false"/>
						<Property Name="CategoryID" Type="Edm.String" Nullable="true" MaxLength="3" sap:label="Category" sap:creatable="false" sap:updatable="true" sap:sortable="false"/>
						<Property Name="Description"
								  sap:field-control="Description_fc"
								  Type="Edm.String"
								  MaxLength="30"
								  sap:label="Local property"
								  sap:creatable="false"
								  sap:quickinfo="Property annotation DataFieldWithUrl"
								  sap:sortable="false"
						/>
						<Property Name="Description_fc"
								  Type="Edm.Byte"
								  Nullable="false"
								  MaxLength="30"
								  sap:label="Name"
								  sap:creatable="false"
								  sap:updatable="true"
								  sap:sortable="false"/>

						<Property Name="Data_mc"
								  Type="Edm.Boolean"/>

						<NavigationProperty Name="to_ProductCategories"
											Relationship="smartfield.TextInEditModeSource.ProductCategory"
											FromRole="FromRole_ProductCategory"
											ToRole="ToRole_ProductCategory"/>
					</EntityType>

					<EntityType Name="Category" sap:content-version="1" >
						<Key>
							<PropertyRef Name="ID"/>
						</Key>
						<Property Name="ID" Type="Edm.String" Nullable="true" MaxLength="3" sap:label="Category" sap:creatable="true" sap:updatable="true" sap:sortable="false"/>
						<Property Name="Description"
								  Type="Edm.String"
								  MaxLength="30"
								  sap:label="Foreign property"
								  sap:creatable="true"
								  sap:updatable="true"
								  sap:sortable="false"/>
						<Property Name="Update_mc" Type="Edm.Boolean" sap:label="Dyn. Method Control" sap:creatable="true" sap:updatable="true" sap:sortable="false" sap:filterable="false"/>
					</EntityType>

					<EntityType Name="VL_Category" sap:content-version="1">
						<Key>
							<PropertyRef Name="CATC"/>
						</Key>
						<Property Name="CATC" Type="Edm.String" Nullable="false" MaxLength="4" sap:display-format="UpperCase" sap:label="Category"/>
						<Property Name="LTXT" Type="Edm.String" Nullable="false" sap:label="Category Description"/>
					</EntityType>

					<Association Name="ProductCategory" sap:content-version="1">
						<End Type="smartfield.TextInEditModeSource.Product" Multiplicity="*" Role="FromRole_ProductCategory"/>
						<End Type="smartfield.TextInEditModeSource.Category" Multiplicity="0..1" Role="ToRole_ProductCategory"/>
						<ReferentialConstraint>
							<Principal Role="ToRole_ProductCategory">
								<PropertyRef Name="ID"/>
							</Principal>
							<Dependent Role="FromRole_ProductCategory">
								<PropertyRef Name="CategoryID"/>
							</Dependent>
						</ReferentialConstraint>
					</Association>

					<EntityContainer Name="smartfield.TextInEditModeSource_Entities" m:IsDefaultEntityContainer="true" sap:supported-formats="atom json xlsx">
						<EntitySet Name="Products"
								   EntityType="smartfield.TextInEditModeSource.Product"
								   sap:creatable="true"
								   sap:updatable="true"
								   sap:updatable-path="Data_mc"
								   sap:deletable="false"
								   sap:pageable="false"
								   sap:content-version="1"
						/>
						<EntitySet Name="Categories"
								   EntityType="smartfield.TextInEditModeSource.Category"
								   sap:creatable="true"
								   sap:deletable="true"
								   sap:pageable="false"
								   sap:content-version="1"
						/>
						<EntitySet Name="VL_Category" EntityType="smartfield.TextInEditModeSource.VL_Category" sap:creatable="false" sap:updatable="false" sap:deletable="false" sap:content-version="1" sap:countable="false"/>
						<AssociationSet Name="ProductCategoriesSet" Association="smartfield.TextInEditModeSource.ProductCategory" sap:creatable="false" sap:updatable="false" sap:deletable="false" sap:content-version="1">
							<End EntitySet="Products" Role="FromRole_ProductCategory"/>
							<End EntitySet="Categories" Role="ToRole_ProductCategory"/>
						</AssociationSet>
					</EntityContainer>

					<Annotations Target="smartfield.TextInEditModeSource.VL_Category/CATC" xmlns="http://docs.oasis-open.org/odata/ns/edm">
						<Annotation Term="com.sap.vocabularies.Common.v1.Text" Path="LTXT">
							<Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement" EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast"/>
						</Annotation>
					</Annotations>

					<Annotations Target="smartfield.TextInEditModeSource.Product/CategoryID" xmlns="http://docs.oasis-open.org/odata/ns/edm">
						<Annotation Term="com.sap.vocabularies.Common.v1.Text" Path="to_ProductCategories/Description">
							<Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement" EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast"/>
						</Annotation>
						<Annotation Term="com.sap.vocabularies.Common.v1.ValueList">
							<Record>
								<PropertyValue Property="Label" String="Categories"/>
								<PropertyValue Property="CollectionPath" String="VL_Category"/>
								<PropertyValue Property="SearchSupported" Bool="true"/>
								<PropertyValue Property="FetchValues" Int="1" />
								<PropertyValue Property="Parameters">
									<Collection>
										<Record Type="com.sap.vocabularies.Common.v1.ValueListParameterInOut">
											<PropertyValue Property="LocalDataProperty" PropertyPath="CategoryID"/>
											<PropertyValue Property="ValueListProperty" String="CATC"/>
										</Record>
										<Record Type="com.sap.vocabularies.Common.v1.ValueListParameterDisplayOnly">
											<PropertyValue Property="ValueListProperty" String="LTXT"/>
										</Record>
									</Collection>
								</PropertyValue>
							</Record>
						</Annotation>
					</Annotations>
				</Schema>
			</edmx:DataServices>
		</edmx:Edmx>
	</script>

	<script id="products" type="application/json">
		{"d": {
			"__count": "5",
			"results":
			[
				{
					"__metadata": {
						"id": "Products('001')",
						"uri": "Products('001')",
						"type": "smartfield.TextInEditModeSource.Products"
					},
					"ID": "001",
					"CategoryID": "PR",
					"Description": "Power Projector 4713",
					"Description_fc": 1,
					"SupplierID": "DL",
					"Data_mc": false,
					"SupplierIDNoValidation": "DL",
					"ProductRating": 1,
					"to_ProductCategories": {
						"__metadata": {
							"id": "Categories('LT')",
							"uri": "Categories('LT')",
							"type": "smartfield.TextInEditModeSource.Categories"
						},
						"ID": "LT",
						"Update_mc": true,
						"Description": "Laptop"
					}
				},
				{
					"__metadata": {
						"id": "Products('002')",
						"uri": "Products('002')",
						"type": "smartfield.TextInEditModeSource.Products"
					},
					"ID": "002",
					"CategoryID": "SS",
					"Description": "Soundstation",
					"Description_fc": 1,
					"Data_mc": false,
					"SupplierID": "PL",
					"SupplierIDNoValidation": "PL",
					"ProductRating": 1
				},
				{
					"__metadata": {
						"id": "Products('003')",
						"uri": "Products('003')",
						"type": "smartfield.TextInEditModeSource.Products"
					},
					"ID": "003",
					"CategoryID": "LT",
					"Description": "Laptop",
					"Description_fc": 1,
					"Data_mc": false,
					"SupplierID": "LN",
					"SupplierIDNoValidation": "LN",
					"ProductRating": 2
				},
				{
					"__metadata": {
						"id": "Products('004')",
						"uri": "Products('004')",
						"type": "smartfield.TextInEditModeSource.Products"
					},
					"ID": "004",
					"CategoryID": "SP",
					"Description": "Smartphone",
					"Description_fc": 1,
					"Data_mc": false,
					"SupplierID": "AP",
					"SupplierIDNoValidation": "AP",
					"ProductRating": 3
				},
				{
					"__metadata": {
						"id": "Products('005')",
						"uri": "Products('005')",
						"type": "smartfield.TextInEditModeSource.Products"
					},
					"ID": "005",
					"CategoryID": "GC",
					"Description": "1080 GTX",
					"Description_fc": 1,
					"Data_mc": false,
					"SupplierID": "NV",
					"SupplierIDNoValidation": "NV",
					"ProductRating": 2
				}
			]
		}}
	</script>

	<script id="categories" type="application/json">
	{"d": {
		"__count": "5",
		"results": [
	{
		"__metadata": {
			"id": "Categories('PR')",
			"uri": "Categories('PR')",
			"type": "smartfield.TextInEditModeSource.Categories"
		},
		"ID": "PR",
		"Update_mc": true,
		"Description": "Projector"
	},
	{
		"__metadata": {
			"id": "Categories('SS')",
			"uri": "Categories('SS')",
			"type": "smartfield.TextInEditModeSource.Categories"
		},
		"ID": "SS",
		"Update_mc": true,
		"Description": "Soundstation"
	},
	{
		"__metadata": {
			"id": "Categories('LT')",
			"uri": "Categories('LT')",
			"type": "smartfield.TextInEditModeSource.Categories"
		},
		"ID": "LT",
		"Update_mc": true,
		"Description": "Laptop"
	},
	{
		"__metadata": {
			"id": "Categories('SP')",
			"uri": "Categories('SP')",
			"type": "smartfield.TextInEditModeSource.Categories"
		},
		"ID": "SP",
		"Update_mc": false,
		"Description": "Smartphone"
	},
	{
		"__metadata": {
			"id": "Categories('GC')",
			"uri": "Categories('GC')",
			"type": "smartfield.TextInEditModeSource.Categories"
		},
		"ID": "GC",
		"Update_mc": false,
		"Description": "Graphics Card"
	}
]
	}}
</script>

</head>

<script src="./NavigationProperties.js"></script>

<body class='sapUiBody'>
	<div id='content'></div>
</body>
</html>

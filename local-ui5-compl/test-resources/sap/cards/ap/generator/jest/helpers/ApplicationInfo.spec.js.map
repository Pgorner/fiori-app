{"version":3,"file":"ApplicationInfo.spec.js","names":["sap","ui","define","sap_cards_ap_generator_helpers_ApplicationInfo","UIComponent","ODataModel","ApplicationInfo","ODataModelVersion","describe","windowSpy","sId","oManifest","id","type","Component","extend","metadata","manifest","createContent","rootComponent","setModel","beforeEach","jest","spyOn","window","mockImplementation","hasher","getHash","afterEach","getInstance","_resetInstance","mockRestore","it","instance","createInstance","expect","toBeInstanceOf","firstInstance","secondInstance","toBe","getRootComponent","_oDataModelVersion","V2","details","fetchDetails","floorPlan","odataModel","entitySet","serviceUrl","entitySetWithObjectContext","componentName","semanticObject","action","_expect","Promise","resolve","validateCardGeneration","then","_instance$validateCar","e","reject","_expect2","_instance$validateCar2","_expect3","_instance$validateCar3","_expect4","_instance$validateCar4"],"sources":["ApplicationInfo.spec.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\nimport { ApplicationInfo, ODataModelVersion } from \"sap/cards/ap/generator/helpers/ApplicationInfo\";\nimport UIComponent from \"sap/ui/core/UIComponent\";\nimport ODataModel from \"sap/ui/model/odata/v2/ODataModel\";\n\ndescribe(\"ApplicationInfo\", () => {\n\tlet windowSpy: jest.SpyInstance;\n\n\tconst sId = \"testComponent\";\n\tconst oManifest = {\n\t\t\"sap.app\": {\n\t\t\tid: sId,\n\t\t\ttype: \"application\"\n\t\t}\n\t};\n\tconst Component = UIComponent.extend(\"component\", {\n\t\tmetadata: {\n\t\t\tmanifest: oManifest\n\t\t},\n\t\tcreateContent() {\n\t\t\treturn null;\n\t\t}\n\t});\n\n\tconst rootComponent = new Component(sId);\n\trootComponent.setModel(new ODataModel(\"sap/opu/odata\"));\n\n\tbeforeEach(() => {\n\t\twindowSpy = jest.spyOn(window, \"window\", \"get\");\n\t\twindowSpy.mockImplementation(() => ({\n\t\t\thasher: {\n\t\t\t\tgetHash: () => \"test-intent?salesOrder='1234'&/testEntity(12345)\"\n\t\t\t}\n\t\t}));\n\t});\n\n\tafterEach(() => {\n\t\tApplicationInfo.getInstance()._resetInstance();\n\t\twindowSpy.mockRestore();\n\t});\n\n\tit(\"should create a new instance if one does not exist\", () => {\n\t\tconst instance = ApplicationInfo.createInstance(rootComponent);\n\t\texpect(instance).toBeInstanceOf(ApplicationInfo);\n\t});\n\n\tit(\"should return the same instance if one already exists\", () => {\n\t\tconst firstInstance = ApplicationInfo.createInstance(rootComponent);\n\t\tconst secondInstance = ApplicationInfo.createInstance(rootComponent);\n\t\texpect(firstInstance).toBe(secondInstance);\n\t});\n\n\tit(\"should return the root component\", () => {\n\t\tconst instance = ApplicationInfo.createInstance(rootComponent);\n\t\texpect(instance.getRootComponent()).toBe(rootComponent);\n\t});\n\n\tit(\"should set the correct ODataModelVersion\", () => {\n\t\tconst instance = ApplicationInfo.createInstance(rootComponent);\n\t\texpect(instance._oDataModelVersion).toBe(ODataModelVersion.V2);\n\t});\n\n\tit(\"should fetch the correct details\", () => {\n\t\tconst instance = ApplicationInfo.createInstance(rootComponent);\n\t\tconst details = instance.fetchDetails();\n\t\texpect(details.rootComponent).toBe(rootComponent);\n\t\texpect(details.floorPlan).toBe(\"ObjectPage\");\n\t\texpect(details.odataModel).toBe(ODataModelVersion.V2);\n\t\texpect(details.entitySet).toBe(\"testEntity\");\n\t\texpect(details.serviceUrl).toBe(\"sap/opu/odata\");\n\t\texpect(details.entitySetWithObjectContext).toBe(\"testEntity(12345)\");\n\t\texpect(details.componentName).toBe(sId);\n\t\texpect(details.semanticObject).toBe(\"test\");\n\t\texpect(details.action).toBe(\"intent\");\n\t});\n\n\tit(\"should validate card generation\", async () => {\n\t\tconst instance = ApplicationInfo.createInstance(rootComponent);\n\t\texpect(await instance.validateCardGeneration()).toBe(true);\n\t});\n});\n\ndescribe(\"Invalidate Card Generation\", () => {\n\tlet windowSpy: jest.SpyInstance;\n\tconst sId = \"testComponent1\";\n\tconst oManifest = {\n\t\t\"sap.app\": {\n\t\t\tid: sId,\n\t\t\ttype: \"application\"\n\t\t}\n\t};\n\tconst Component = UIComponent.extend(\"component\", {\n\t\tmetadata: {\n\t\t\tmanifest: oManifest\n\t\t},\n\t\tcreateContent() {\n\t\t\treturn null;\n\t\t}\n\t});\n\n\tconst rootComponent = new Component(sId);\n\trootComponent.setModel(new ODataModel(\"sap/opu/odata\"));\n\n\tafterEach(() => {\n\t\tApplicationInfo.getInstance()._resetInstance();\n\t\twindowSpy.mockRestore();\n\t});\n\n\tit(\"should invalidate the card generation for non-object page\", async () => {\n\t\twindowSpy = jest.spyOn(window, \"window\", \"get\");\n\t\twindowSpy.mockImplementation(() => ({\n\t\t\thasher: {\n\t\t\t\tgetHash: () => \"test-intent&/testEntity\"\n\t\t\t}\n\t\t}));\n\n\t\tconst instance = ApplicationInfo.createInstance(rootComponent);\n\t\texpect(await instance.validateCardGeneration()).toBe(false);\n\t});\n\n\tit(\"should invalidate the card generation for unavailable object context\", async () => {\n\t\twindowSpy = jest.spyOn(window, \"window\", \"get\");\n\t\twindowSpy.mockImplementation(() => ({\n\t\t\thasher: {\n\t\t\t\tgetHash: () => \"test-intent&/testEntity()\"\n\t\t\t}\n\t\t}));\n\n\t\tconst instance = ApplicationInfo.createInstance(rootComponent);\n\t\texpect(await instance.validateCardGeneration()).toBe(false);\n\t});\n\n\tit(\"should invalidate the card generation when no entitySet is provided\", async () => {\n\t\twindowSpy = jest.spyOn(window, \"window\", \"get\");\n\t\twindowSpy.mockImplementation(() => ({\n\t\t\thasher: {\n\t\t\t\tgetHash: () => \"test-intent\"\n\t\t\t}\n\t\t}));\n\n\t\tconst instance = ApplicationInfo.createInstance(rootComponent);\n\t\texpect(await instance.validateCardGeneration()).toBe(false);\n\t});\n});\n"],"mappings":"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","ignoreList":[]}
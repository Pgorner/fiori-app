{"version":3,"file":"ApplicationInfo.spec.js","names":["sap","ui","define","ResourceBundle","sap_cards_ap_common_helpers_ApplicationInfo","UIComponent","fetchApplicationInfo","i18nMap","appTitle","appDescription","CardGeneratorHeaderTitle","CardGeneratorHeaderSubTitle","CardGeneratorGroupPropertyLabel_Groups_0_Items_0","CardGeneratorGroupPropertyLabel_Groups_0_Items_1","CardGeneratorGroupPropertyLabel_Groups_0_Items_2","CardGeneratorGroupHeader_Groups_0","CardGeneratorGroupPropertyLabel_Groups_1_Items_0","CardGeneratorGroupPropertyLabel_Groups_1_Items_1","CardGeneratorGroupPropertyLabel_Groups_1_Items_2","CardGeneratorGroupHeader_Groups_1","describe","windowSpy","getModelSpy","resourceBundleCreateSpy","sapAppId","Component","extend","metadata","manifest","id","type","uri","createContent","rootComponent","beforeEach","jest","spyOn","afterEach","mockRestore","beforeAll","window","mockImplementation","isA","getResourceBundle","fn","oUrlInfo","url","afterAll","test","hasher","getHash","getText","key","Promise","resolve","then","applicationInfo","expect","toMatchObject","componentName","entitySet","context","e","reject","isDesignMode","toHaveBeenCalled","not"],"sources":["ApplicationInfo.spec.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\nimport ResourceBundle from \"sap/base/i18n/ResourceBundle\";\nimport { fetchApplicationInfo } from \"sap/cards/ap/common/helpers/ApplicationInfo\";\nimport UIComponent from \"sap/ui/core/UIComponent\";\n\nconst i18nMap: {\n\t[key: string]: string;\n} = {\n\tappTitle: \"Sales Order\",\n\tappDescription: \"A Fiori application.\",\n\tCardGeneratorHeaderTitle: \"Sales Order\",\n\tCardGeneratorHeaderSubTitle: \"A Fiori application.\",\n\tCardGeneratorGroupPropertyLabel_Groups_0_Items_0: \"Net Amount\",\n\tCardGeneratorGroupPropertyLabel_Groups_0_Items_1: \"Gross Amount\",\n\tCardGeneratorGroupPropertyLabel_Groups_0_Items_2: \"Tax Amount\",\n\tCardGeneratorGroupHeader_Groups_0: \"Amount\",\n\tCardGeneratorGroupPropertyLabel_Groups_1_Items_0: \"Business Partner ID\",\n\tCardGeneratorGroupPropertyLabel_Groups_1_Items_1: \"Created At\",\n\tCardGeneratorGroupPropertyLabel_Groups_1_Items_2: \"Sales Order ID\",\n\tCardGeneratorGroupHeader_Groups_1: \"Additional Info\"\n};\n\ndescribe(\"fetchApplicationInfo\", () => {\n\tlet windowSpy: jest.SpyInstance;\n\tlet getModelSpy: jest.SpyInstance;\n\tlet resourceBundleCreateSpy: jest.SpyInstance;\n\tconst sapAppId = \"testComponent\";\n\tconst Component = UIComponent.extend(\"rootComponent\", {\n\t\tmetadata: {\n\t\t\tmanifest: {\n\t\t\t\t\"sap.app\": {\n\t\t\t\t\tid: sapAppId,\n\t\t\t\t\ttype: \"application\"\n\t\t\t\t},\n\t\t\t\t\"sap.ui5\": {},\n\t\t\t\t\"sap.platform.abap\": {\n\t\t\t\t\turi: \"\"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcreateContent() {\n\t\t\treturn null;\n\t\t}\n\t});\n\tconst rootComponent = new Component(sapAppId);\n\n\tbeforeEach(() => {\n\t\tresourceBundleCreateSpy = jest.spyOn(ResourceBundle, \"create\");\n\t});\n\n\tafterEach(() => {\n\t\tresourceBundleCreateSpy.mockRestore();\n\t});\n\n\tbeforeAll(() => {\n\t\twindowSpy = jest.spyOn(window, \"window\", \"get\");\n\t\tgetModelSpy = jest.spyOn(rootComponent, \"getModel\").mockImplementation(() => {\n\t\t\treturn {\n\t\t\t\tisA: () => true,\n\t\t\t\tgetResourceBundle: jest.fn().mockImplementation(() => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\toUrlInfo: {\n\t\t\t\t\t\t\turl: \"i18n.properties\"\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t})\n\t\t\t};\n\t\t});\n\t});\n\n\tafterAll(() => {\n\t\twindowSpy.mockRestore();\n\t\tgetModelSpy.mockRestore();\n\t});\n\n\ttest(\"returns the application info, object page\", async () => {\n\t\twindowSpy.mockImplementation(() => ({\n\t\t\thasher: {\n\t\t\t\tgetHash: () => \"test-intent&/testEntity('12345')\"\n\t\t\t}\n\t\t}));\n\t\tresourceBundleCreateSpy.mockImplementation(() => {\n\t\t\treturn {\n\t\t\t\tgetText: (key: string) => {\n\t\t\t\t\treturn i18nMap[key] || key;\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\n\t\tconst applicationInfo = await fetchApplicationInfo(rootComponent);\n\t\texpect(applicationInfo).toMatchObject({\n\t\t\tcomponentName: sapAppId,\n\t\t\tentitySet: \"testEntity\",\n\t\t\tcontext: \"'12345'\"\n\t\t});\n\t});\n\n\ttest(\"returns the application info, other than object page\", async () => {\n\t\twindowSpy.mockImplementation(() => ({\n\t\t\thasher: {\n\t\t\t\tgetHash: () => \"test-intent\"\n\t\t\t}\n\t\t}));\n\n\t\tresourceBundleCreateSpy.mockImplementation(() => {\n\t\t\treturn {\n\t\t\t\tgetText: (key: string) => {\n\t\t\t\t\treturn i18nMap[key] || key;\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\n\t\tconst applicationInfo = await fetchApplicationInfo(rootComponent);\n\t\texpect(applicationInfo).toMatchObject({\n\t\t\tcomponentName: sapAppId,\n\t\t\tentitySet: \"\",\n\t\t\tcontext: \"\"\n\t\t});\n\t});\n\n\ttest(\"ResourceBundle create method should be called, when isDesignMode option is true\", async () => {\n\t\twindowSpy.mockImplementation(() => ({\n\t\t\thasher: {\n\t\t\t\tgetHash: () => \"test-intent&/testEntity('12345')\"\n\t\t\t}\n\t\t}));\n\n\t\tawait fetchApplicationInfo(rootComponent, { isDesignMode: true });\n\t\texpect(resourceBundleCreateSpy).toHaveBeenCalled();\n\t});\n\n\ttest(\"ResourceBundle create method should not be called, when isDesignMode option is false\", async () => {\n\t\twindowSpy.mockImplementation(() => ({\n\t\t\thasher: {\n\t\t\t\tgetHash: () => \"test-intent&/testEntity('12345')\"\n\t\t\t}\n\t\t}));\n\n\t\tawait fetchApplicationInfo(rootComponent, { isDesignMode: false });\n\t\texpect(resourceBundleCreateSpy).not.toHaveBeenCalled();\n\t});\n});\n"],"mappings":"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","ignoreList":[]}
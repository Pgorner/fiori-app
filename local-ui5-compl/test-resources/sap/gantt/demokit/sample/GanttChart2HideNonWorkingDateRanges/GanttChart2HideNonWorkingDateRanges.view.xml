<mvc:View height="100%"
	controllerName="sap.gantt.sample.GanttChart2HideNonWorkingDateRanges.GanttChart2HideNonWorkingDateRanges"
	xmlns="sap.ui.table"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns:core="sap.ui.core"
	xmlns:m="sap.m"
	xmlns:gnt="sap.gantt"
	xmlns:axistime="sap.gantt.axistime"
	xmlns:config="sap.gantt.config"
	xmlns:gnt2="sap.gantt.simple"
	xmlns:rm="sap.ui.table.rowmodes"
	xmlns:custom="sap.gantt.sample.GanttChart2HideNonWorkingDateRanges"
	xmlns:f="sap.ui.layout.form">

	<m:VBox>
		<f:SimpleForm content="{path:'/intervals', templateShareable:false}">
			<f:toolbar>
				<m:Toolbar>
					<m:Title text="Non Working Date Ranges:"/>
				</m:Toolbar>
			</f:toolbar>
			<f:content>
				<m:DateRangeSelection change="handleChange" fieldGroupIds="MyGroup"
					value= "{
						'type': 'sap.ui.model.type.DateInterval',
						'parts': [
							{
								'type': 'sap.ui.model.type.Date',
								'path': 'startDate'
							},
							{
								'type': 'sap.ui.model.type.Date',
								'path': 'endDate'
							}
						]}" minDate="{/tHorizonStart}" maxDate="{/tHorizonEnd}" valueState="{path:'valueState'}">
				</m:DateRangeSelection>
			</f:content>
		</f:SimpleForm>
	</m:VBox>

	<gnt2:GanttChartContainer id="container" enableStatusBar="true" height="80%" class="sapUiSmallMarginTop">
		<gnt2:toolbar>
			<gnt2:ContainerToolbar stepCountOfSlider="5" id="containerToolbar" showSearchButton="false">
				<m:Label text="Enable Custom Provider:" />
				<m:Switch state="{/enabled}"/>
			</gnt2:ContainerToolbar>
		</gnt2:toolbar>

		<gnt2:ganttCharts>
			<gnt2:GanttChartWithTable id="gantt" ghostAlignment="Start" enableSelectAndDrag="false"
				shapeResize="onShapeResize"
				shapeDrop="onShapeDrop"
				shapeConnect="onShapeConnect"
				shapeContextMenu="onShapeContextMenu"
				shapeOverRelationship="false"
				shapePress="onShapePress"
				shapeSelectionMode="MultiWithKeyboardAndLasso"
				isConnectorDetailsVisible="true"
				shapeConnectorList="onShapeConnectorList">
					<gnt2:table>
						<TreeTable
							selectionMode="Single"
							selectionBehavior="RowSelector"
							rows="{
								path: 'data>/ProjectElems',
								parameters: {
									operationMode: 'Server',
									numberOfExpandedLevels: 2,
									treeAnnotationProperties: {
										hierarchyNodeFor: 'ObjectID',
										hierarchyParentNodeFor: 'ParentObjectID',
										hierarchyLevelFor: 'HierarchyNodeLevel',
										hierarchyDrillStateFor: 'DrillDownState',
										hierarchyNodeDescendantCountFor: 'Magnitude'
									},
									expand: 'Relationships'
								}
							}">
							<rowSettingsTemplate>
								<gnt2:GanttRowSettings rowId="{data>ObjectID}" calendars="{path:'/patterns', templateShareable:true}"
										relationships="{path:'data>Relationships', templateShareable: 'true'}">
									<gnt2:calendars>
										<gnt2:BaseCalendar 
											time="{startDate}" endTime="{path: 'endDate', formatter: '.resetTime'}"
											fill="@sapUiChartPaletteSemanticNeutralLight3"
											tooltip ="Non working time" visible="{path: '/enabled', formatter: '.calendarVisible'}"
											/>
									</gnt2:calendars>
									<gnt2:shapes1>
										<gnt2:BaseRectangle title="{data>ObjectName}"
															shapeId="{data>ObjectID}"
															time="{data>StartDate}" endTime="{data>EndDate}"
															tooltip="{data>ObjectName}"
															fill="#0092D1"
															selectedFill="#0955d9"
															selectedTitleColor="#F7ADCD"
															resizable="true"
															draggable="false"
															horizontalTextAlignment="Dynamic"
															selectable="true"
															hoverable="true"
															connectable="true"
															height="19"
															verticalTextAlignment="Center"/>
									</gnt2:shapes1>
									<gnt2:relationships>
										<gnt2:Relationship shapeId="{data>RelationID}"
										predecessor="{data>PredecTaskID}" successor="{data>SuccTaskID}" type="{data>RelationType}" tooltip="{data>RelationType}"
										selectable="true" hoverable="true"/>
									</gnt2:relationships>
								</gnt2:GanttRowSettings>
							</rowSettingsTemplate>
							<rowMode>
								<rm:Auto minRowCount="12"/>
							</rowMode>
							<columns>
								<Column id="ObjectName" >
									<customData>
										<core:CustomData key="exportTableColumnConfig"
											value='{"columnKey": "ObjectName",
											"leadingProperty":"ObjectName",
											"dataType": "string",
											"hierarchyNodeLevel": "HierarchyNodeLevel",
											"wrap": true}' />
									</customData>
									<m:Text text="Object Name"/>
									<template>
										<m:Label text="{data>ObjectName}"/>
									</template>
								</Column>
							</columns>
						</TreeTable>
					</gnt2:table>
					<gnt2:simpleAdhocLines>
						<gnt2:AdhocLine markerType="Diamond" stroke="@sapUiLegend7" strokeDasharray="5, 2" timeStamp="20160904120000"/>
					</gnt2:simpleAdhocLines>
					<gnt2:deltaLines>
						<gnt2:DeltaLine resizable="true" deltalineResize="onDeltaResize" stroke="@sapUiLegend13" strokeDasharray="5, 2" timeStamp="20160912000000" endTimeStamp="20160918000000" visible="true"/>
					</gnt2:deltaLines>
					<gnt2:axisTimeStrategy>
						<axistime:StepwiseZoomStrategy id="zoomStrategy" zoomLevels="5">
							<axistime:skipTimePattern>
								<custom:RangePattern dateIntervals="{path:'/intervals', templateShareable:false}" enabled="{/enabled}">
									<custom:DateInterval startDate="{startDate}" endDate="{path: 'endDate', formatter: '.resetTime'}" />
								</custom:RangePattern>
							</axistime:skipTimePattern>
							<axistime:totalHorizon>
								<config:TimeHorizon
									startTime="{path: '/tHorizonStart', formatter: '.dateToAbapTimestamp'}"
									endTime="{path: '/tHorizonEnd', formatter: '.dateToAbapTimestamp'}" />
							</axistime:totalHorizon>
							<axistime:visibleHorizon>
								<config:TimeHorizon
									startTime="20160901000000"
									endTime="20170601000000"/>
							</axistime:visibleHorizon>
						</axistime:StepwiseZoomStrategy>
					</gnt2:axisTimeStrategy>
			</gnt2:GanttChartWithTable>
		</gnt2:ganttCharts>
	</gnt2:GanttChartContainer>
</mvc:View>
<!DOCTYPE HTML>
<html>
   <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
      <title>Example - sap.rules.ui.ExpressionBasic</title>
	   <script id="sap-ui-bootstrap" data-sap-ui-theme="sap_fiori_3"
			   src="../../../../resources/sap-ui-core.js"
			   data-sap-ui-libs="sap.m, sap.rules.ui">
	   </script>
      
      <script>
          sap.ui.define(
            [
                "sap/ui/thirdparty/jquery",
                "sap/rules/ui/services/ExpressionLanguage",
                "sap/rules/ui/ExpressionBasic",
                "sap/ui/model/odata/v2/ODataModel",
                "sap/ui/model/BindingMode",
                "sap/m/Input",
                "sap/m/FlexBox",
                "sap/m/Button",
                "sap/m/TextArea",
                "sap/m/ToolbarSpacer",
                "sap/m/App",
                "sap/m/Page",
                "sap/ui/core/HTML",
                "sap/rules/ui/ExpressionAdvanced",
            ],
            function (jQuery, ExpressionLanguage, ExpressionBasic, ODataModel, BindingMode,
            Input, FlexBox, Button, TextArea, ToolbarSpacer, App, Page, HTML, ExpressionAdvanced) {

                //Get vocabulary data
				var oVocaGaming = {};
				var getData = function () {
				jQuery.ajax({
					url: './qunit/data/parser/vocabulary/flightValueHelp.txt',
					dataType: "json",
					async: false,
					success: function (data) {
						oVocaGaming = data;
					}
					});
				}
				getData();
                var oExpressionLanguage = new ExpressionLanguage();
                oExpressionLanguage.setData(oVocaGaming);
                var  callback = function (valueHelpInfo){
					var i;
					var serviceInfo;
					for(i=0 ; i< valueHelpInfo.length ; i++){
						serviceInfo = valueHelpInfo[i].metadata;
						valueHelpInfo[i].model = new ODataModel({
							serviceUrl: serviceInfo.serviceURL,
            				defaultBindingMode: BindingMode.OneWay	,
                            editable: true
						});
						// Uncomment the next line to test valuehelp error handling - V2 oData model isn't returned;
						//valueHelpInfo[i].model = new Input();
					}
				}
				// Uncomment the next line to test valuehelp error handling - callback is not a function
				//callback = {"stam":false};
				oExpressionLanguage.setValueHelpCallback(callback);
                
                var oExpressionBasic = new ExpressionBasic({
                    expressionLanguage: oExpressionLanguage,
                    value: ""
                });

                //Create App
                var oApp = new App("myApp", { initialPage: "myPage1" });

                //Create Page
                var oPage = new Page("myPage1", { title: "Basic Editor" }).addStyleClass("sapUiSizeCozy");

                /*var addInstruction = new Button({
                text: "Add",
                press: function() {
                oModel.submitChanges();
                }
                });*/

                var toolBarSpacer1 = new ToolbarSpacer({ width: "1em" });
                var toolBarSpacer2 = new ToolbarSpacer({ width: "1em" });
                var toolBarSpacer3 = new ToolbarSpacer({ width: "1em" });

                var oFlexBox = new FlexBox({
                    height: "50px",
                    items: [toolBarSpacer1/*, addInstruction*/]
                });
                
                var oExpressionAdvances = new ExpressionAdvanced({
                    expressionLanguage: oExpressionLanguage,
                    placeholder: "Please enter a gaming relevant expression",
                    value: "",
                    editable: true,
                    validateOnLoad: true
                });
                
                var oAdvanceToBasicButton = new Button({
                    text: "Put advance in basic form",
                    press: function () {
                        var sExpressionAdvancedValue = oExpressionAdvances.getValue();
                        oExpressionBasic.setValue(sExpressionAdvancedValue);

                    }
                });
                
                 var oBasicToAdvanceButton = new Button({
                    text: "Put basic in advance form",
                    press: function () {
                        
                        var basicExpression = oExpressionBasic.getValue();

                        oExpressionAdvances.setValue(basicExpression);
                    }
                });
                
                oPage.addContent(oFlexBox)
                     .addContent(oExpressionAdvances)
                     .addContent (new HTML({content: "<br>"}))
                     .addContent(oAdvanceToBasicButton)
                     .addContent (new HTML({content: "<span class='expressionBasic'></span>"}))
                     .addContent(oBasicToAdvanceButton).addContent(oExpressionBasic);
                oApp.addPage(oPage);
                oApp.placeAt("content");
            });
      </script>
   </head>
   <body class="sapUiBody" role="application">
      <h1 id="header">Test Page for <code> sap.rules.ui.oExpressionBasic</code></h1>
       <div id="content1"></div>
      <div id="content"></div>
   </body>
</html>
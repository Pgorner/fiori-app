<html><head></head><body><div id="d4h5-main-container" class="dk-main"><section id="loio3cc020e232a2472c9f7fde2e99230633" class=" section topic"><div class="section-mdeditlink hidden">
				<a class="mdeditlink hidden" href="https://github.com/SAP-docs/sapui5/blob/main/docs/03_Get-Started/step-33-custom-controls-typescript-3cc020e.md">Edit on GitHub</a>
			</div><div class="collapsible-icon sap-icon innerTitle"><h2 class="title ">Step 33: Custom Controls (TypeScript)</h2></div><div class="fig"><div class="topictitle1 title"><h2 class="title ">Step 33: Custom Controls (TypeScript)</h2></div><div class="shortdesc">In this step, we are going to extend the functionality of SAPUI5 with a custom control.
		We want to rate the product shown on the detail page, so we create a composition of multiple
		standard controls using the SAPUI5 extension mechanism and
		add some glue code to make them work nicely together. This way, we can reuse the control
		across the app and keep all related functionality in one module.</div><section>
			<h2 class="title ">Preview</h2>
			<div><div class="fig"><img src="loio21dd14c37b67473b817c8865f168f668_LowRes.png" title="The graphic has an explanatory text" alt="The graphic has an explanatory text" usemap="#"></div><span class="collapsible-icon sap-icon figcap title"><h2 class="title ">A custom product rating control is added to the detail page</h2></span></div>
		</section><section id="section_ylk_pbn_tyb">
			<h2 class="title ">Coding</h2>
			<p>You can view all files at <a href="https://github.com/sap-samples/ui5-typescript-walkthrough/tree/main/steps/33" title="https://github.com/sap-samples/ui5-typescript-walkthrough/tree/main/steps/33" class="external-link" target="_blank" rel="noopener">OpenUI5 TypeScript Walkthrough - Step 33: Custom Controls</a> and <a href="https://sap-samples.github.io/ui5-typescript-walkthrough/ui5-typescript-walkthrough-step-33.zip" title="https://sap-samples.github.io/ui5-typescript-walkthrough/ui5-typescript-walkthrough-step-33.zip" class="external-link" target="_blank" rel="noopener">download the solution as a zip file</a>.</p>
		</section><section id="section_bzj_rbn_tyb">
			<h2 class="title ">webapp/i18n/i18n.properties </h2>
			<p>For our new product-rating custom control we will need some additional text resources: Firstly, we'll need some labels for the custom
				control, interacting with the user. Then we want to display a confirmation message on the detail page once a user has provided their
				rating.</p>
			<section class="lang-prefs"><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">â€¦
# Detail Page
detailPageTitle=Walkthrough - Details
<span class="emphasis">ratingConfirmation=You have rated this product with {0} stars

# Product Rating
productRatingLabelInitial=Please rate this product
productRatingLabelIndicator=Your rating: {0} out of {1}
productRatingLabelFinal=Thank you for your rating!
productRatingButton=Rate</span></pre></div></div></section>
		</section><section id="section_azj_rbn_tyb">
			<h2 class="title ">webapp/css/style.css</h2>
			<p>To layout our new custom control, we specify some additional css. We create a root class <code>myAppDemoWTProductRating</code> that sets the
				padding to <code>0.75rem</code>. We will use this class to specify some space around our inner controls. In a second rule we reset
				the vertical alignment of controls with the class <code>sapMRI</code>  assigned to inside controls with the class
					<code>myAppDemoWTProductRating</code> to the initial value. We will need this rule to align all the controls we use with our
				composition.</p>
			<section class="language-css"><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">html[dir="ltr"] .myAppDemoWT .myCustomButton.sapMBtn {
    margin-right: 0.125rem
}
html[dir="rtl"] .myAppDemoWT .myCustomButton.sapMBtn {
    margin-left: 0.125rem
}
.myAppDemoWT .myCustomText {
    display: inline-block;
    font-weight: bold;
}
<span class="emphasis">/*  ProductRating */
.myAppDemoWTProductRating {
    padding: 0.75rem;
}
.myAppDemoWTProductRating .sapMRI {
    vertical-align: initial;
}</span></pre></div></div></section>
			<p>We could also do this with more HTML in the renderer, but this is the simplest way and it will only be applied inside our custom control.
				However, please be aware that the custom control is in your app and might have to be adjusted when the inner controls change in future
				versions of SAPUI5.</p>
		</section><section id="section_zlk_pbn_tyb">
			<h2 class="title ">webapp/control/ProductRating.ts (New)</h2>
			<p>Custom controls are small reuse components that can be created within the app very easily. Due to their nature, they are sometimes also
				referred to as "notepad" or "on the fly" controls. A custom control is a script object that has two special sections
					(<code>metadata</code> and <code>renderer</code>) and a number of methods that implement the functionality of the
				control.</p>
			<p>We create a new folder <code>control</code> and a file <code>ProductRating.ts</code> that will hold our new control.</p>
			<p>We start with importing two classes, the <code>Control</code> and the <code>RenderManager</code> from the
					<code>sap/ui/core</code> module. These classes are part of the SAPUI5 framework and are used for creating controls and managing their
				rendering. We then declare the class . This
				property defines the data structure and thus the API of the control. With this metadata for the control's properties, events, and
				aggregations, <code>ProductRating</code> by extending the base class
				<code>sap.ui.core.Control</code>.</p>
			<p>To add functionality to the control, we can provide meta information via a static property named <code>metadata</code>SAPUI5. This can automatically create setter and getter methods
				along with other convenience functions that can be used within the application. We'ill leave the <code>metadata</code> property
				empty for now.</p>
			<p>The <code>init</code> function is a lifecycle function that is automatically called by the SAPUI5 framework when an instance of the control is created. We'll use
				this function to initialize the control and prepare its contents for display.</p>
			<p>The <code>renderer</code> property is an object that determines how the control is rendered. It is invoked initially by the SAPUI5 framework, and also each time any property of the control is
				changed. The <code>renderer</code> object has two  properties: <code>apiVersion</code> and <code>render</code>. The
					<code>apiVersion</code> property specifies the API version of the <code>RenderManager</code> that is used in this
				renderer. The <code>render</code> property is a method that takes two parameters: a <code>RenderManager</code> object and the
				control instance itself. We'll delve into the implementation of our control's rendering within this method at a later stage.</p><div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>
					</p><p>The <code>RenderManager</code> is an important component in SAPUI5 that is responsible for converting abstract
						representations of controls into actual HTML elements that can be displayed in the browser. Different versions of the
							<code>RenderManager</code> API exist, each representing an evolution of the <code>RenderManager</code> with
						specific sets of APIs and rendering techniques. These different API versions are important to ensure compatibility between
						different versions of SAPUI5.</p>
					<p>The latest version of the <code>RenderManager</code> API is Version 4, which introduces new features and improvements
						compared to previous versions. It also includes performance enhancements, making your applications run faster and more
						efficiently. For example, Version 4 avoids the re-rendering of child controls unless they are invalidated, which can save
						processing time.</p>
					<p>When developing a custom control, it's crucial to specify the appropriate <code>apiVersion</code> for the control's
						renderer. This ensures that your control can can leverage the latest rendering features and improvements available in the
							<code>RenderManager</code>.</p>
				<p></p></div></div><p></p>
			<section class="lang-js"><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock"><span class="emphasis">import Control from "sap/ui/core/Control";
import RenderManager from "sap/ui/core/RenderManager";

/**
 * @namespace ui5.walkthrough.control
 */
export default class ProductRating extends Control {

	static readonly metadata: MetadataOptions = {
	
	}
	init(): void {
	
	}
	
	renderer = {  
		apiVersion: 4,
		render: (rm: RenderManager, control: ProductRating) =&gt; {
		}
	}
};</span></pre></div></div></section>
			<p>For now, the metadata section plus <code>init</code> and <code>render</code> function are empty. We will take care of this in
				the next step.</p>
			<p>
				</p><div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>Controls always extend <code>sap.ui.core.Control</code> and render themselves. You could also extend
						<code>sap.ui.core.Element</code> or <code>sap.ui.base.ManagedObject</code> directly if you want to reuse life cycle
					features of SAPUI5 including data binding for objects that are not
					rendered. Please refer to the API reference to learn more about the inheritance hierarchy of controls. </p></div></div>
			<p></p>
		</section><section id="section_bvh_qbn_tyb">
			<h2 class="title ">webapp/control/ProductRating.ts</h2>
			<p>We now enhance our new custom control with the custom functionality that we need. In our case we want to create an interactive product
				rating, so we define a value and use three internal controls that are displayed updated by our control automatically. A
					<code>RatingIndicator</code> control is used to collect user input on the product, a label is displaying further information,
				and a button submits the rating to the app to store it.</p>
			<p>In the <code>metadata</code> section we therefore define several properties that we make use in the implementation (for details on
				individual metadata properties, see <a href="api/sap.ui.base.ManagedObject.MetadataOptions" title="api/sap.ui.base.ManagedObject.MetadataOptions" class="sap-doc" alt="api/sap.ui.base.ManagedObject.MetadataOptions">MetadataOptions</a>):</p><ul class="ul ">
					<li class="li">
						<p>Properties</p><ul class="ul ">
								<li class="li">
									<p>Value</p>
									<p>We define a control property <code>value</code> that will hold the value that the user selected in the
										rating. Getter and setter function for this property will automatically be created and we can also bind it to
										a field of the data model in the XML view if we like.</p>
								</li>
							</ul><p></p>
					</li>
					<li class="li">
						<p>Aggregations</p>
						<p>As described in the first paragraph, we need three internal controls to realize our rating functionality. We therefore
							create three "hidden aggregations" by setting the <code>visibility</code> attribute to <code>hidden</code>. This
							way, we can use the models that are set on the view also in the inner controls and SAPUI5 will take care of the lifecycle management and destroy
							the controls when they are not needed anymore. Aggregations can also be used to hold arrays of controls but we just want a
							single control in each of the aggregations so we need to adjust the cardinality by setting the attribute
								<code>multiple</code> to <code>false</code>.</p><ul class="ul ">
								<li class="li">
									<p>
										<code>_rating</code>: A <code>sap.m.RatingIndicator</code> control for user input</p>
								</li>
								<li class="li">
									<p>
										<code>_label</code>: A <code>sap.m.Label</code> to display additional information</p>
								</li>
								<li class="li">
									<p>
										<code>_button</code>: A <code>sap.m.Button</code> to submit the rating</p>
								</li>
							</ul><div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>
								</p><p>You can define <code>aggregations</code> and <code>associations</code></p><ul class="ul ">
										<li class="li">
											<p> An <span class="emphasis">aggregation</span> is a strong relation that also manages the lifecycle of the
												related control, for example, when the parent is destroyed, the related control is also destroyed.
												Also, a control can only be assigned to one single aggregation, if it is assigned to a second
												aggregation, it is removed from the previous aggregation automatically.</p>
										</li>
										<li class="li">
											<p>An <span class="emphasis">association</span> is a weak relation that does not manage the lifecycle and can be
												defined multiple times. To have a clear distinction, an association only stores the ID, whereas an
												aggregation stores the direct reference to the control. We do not specify associations in this
												example, as we want to have our internal controls managed by the parent.</p>
										</li>
									</ul><p></p>
							<p></p></div></div><p></p>
					</li>
					<li class="li">
						<p>Events</p><ul class="ul ">
								<li class="li">
									<p>Change</p>
									<p>We specify a <code>change</code> event that the control will fire when the rating is submitted. It contains
										the current value as an event parameter. Applications can register to this event and process the result
										similar to "regular" SAPUI5 controls, which are
										in fact built similar to custom controls.</p>
								</li>
							</ul><p></p>
					</li>
				</ul><p></p>
			<p>In the <code>init</code> function that is called by SAPUI5
				automatically whenever a new instance of the control is instantiated, we set up our internal controls. We instantiate the three
				controls and store them in the internal aggregation by calling the framework method <code>setAggregation</code> that has been
				inherited from <code>sap.ui.core.Control</code>. We pass on the name of the internal aggregations that we specified above and the
				new control instances. We specify some control properties to make our custom control look nicer and register a
					<code>liveChange</code> event to the rating and a press event to the button. The initial texts for the label and the button
				are referenced from our <code>i18n</code> model.</p>
			<p>Let's ignore the other internal helper functions and event handlers for now and define our renderer. By using the APIs of the
					<code>RenderManager</code> and the control instance that are passed as references, we can describe the necessary HTML for our
				control. To open a new HTML tag we use the <code>openStart</code> method and pass <code>"div"</code> as the HTML element to be
				created. We also pass our control instance (<code>ProductRating</code>) to be associated with the HTML tag. The RenderManager will
				automatically generate the properties for the control and assign it to the <code>div</code> tag. After calling
					<code>openStart</code>, we can chain additional methods to set attributes or styles for the element. To set
					<code>myAppDemoWTProductRating</code> as our custom CSS class for the <code>div</code> element, we use the
					<code>class</code> method. If a <code>tooltip</code> exists, we call the <code>attr</code> method to set the
					<code>title</code> attribute with the value of the tooltip for the <code>div</code> element. Finally, we close the
				surrounding <code>div</code> tag by calling <code>openEnd</code>.</p>
			<p>
				</p><div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>
					</p><p>Since our custom control extends the <code>sap.ui.core.Control</code> class, it also inherits its properties and
						aggregations. In this case, the <code>tooltip</code> property is defined in the <code>sap.ui.core.Element</code>
						class, which is inherited by the <code>sap.ui.core.Control</code> class. Therefore, your custom control also inherits this
						aggregation. However, controls must explicitly support tooltips as they have to render them.</p>
				<p></p></div></div>
			<p></p>
			<p>Next, we render the three child controls we defined in the aggregation of our <code>ProductRating</code> control. We retrieve the
				child controls using the <code>getAggregation</code> method with the aggregation name as parameter. The
					<code>renderControl</code> method is then called on each child control to render them. Finally, we close the element by
				calling the <code>close</code> method on the <code>RenderManager</code> and passing the <code>"div"</code> element name as
				argument. This completes the rendering of the custom control.</p>
			<p>The <code>setValue</code> is an overridden setter. SAPUI5 will
				generate a setter that updates the property value when called in a controller or defined in the XML view, but we also need to update
				the internal rating control in the hidden aggregation to reflect the state properly. Also, we can skip the rerendering of SAPUI5 that is usually triggered when a property is changed on a control
				by calling the <code>setProperty</code> method to update the control property with true as the third parameter.</p>
			<p>Now we define the event handler for the internal rating control. It is called every time the user changes the rating. The current value
				of the rating control can be read from the event parameter value of the <code>sap.m.RatingIndicator</code> control. With the value
				we call the <code>setProperty</code> method to update the control state, then we update the <code>label</code> next to the
				rating to show the user which value he has selected currently and also displays the maximum value. The string with the placeholder
				values is read from the <code>i18n</code> model that is assigned to the control automatically.</p>
			<p>Next, we have the <code>press</code> handler for the rating button that submits our rating. We assume that rating a product is a
				one-time action and first disable the rating and the button so that the user is not allowed to submit another rating. We also update
				the label to show a "Thank you for your rating!" message, then we fire the change event of the control and pass in the current value
				as a parameter so that applications that are listening to this event can react on the rating interaction.</p>
			<p>We define the <code>reset</code> method to be able to revert the state of the control on the UI to its initial state so that the
				user can again submit a rating.</p>
			<section class="lang-js"><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">import Control from "sap/ui/core/Control";
import RenderManager from "sap/ui/core/RenderManager";
<span class="emphasis">import { MetadataOptions } from "sap/ui/core/Element";
import Label from "sap/m/Label";
import Button, { Button$PressEvent } from "sap/m/Button";
import RatingIndicator, { RatingIndicator$LiveChangeEvent } from "sap/m/RatingIndicator";
import ResourceBundle from "sap/base/i18n/ResourceBundle";
import ResourceModel from "sap/ui/model/resource/ResourceModel";</span>

/**
 * @namespace ui5.walkthrough.control
 */
export default class ProductRating extends Control {

	static readonly metadata: MetadataOptions = {
		<span class="emphasis">properties: {
			value: {
				type: "float",
				defaultValue: 0
			}
		},
		aggregations: {
			_rating: {
				type: "sap.m.RatingIndicator", 
				multiple: false,
				visibility: "hidden"
			},
			_label: {
				type: "sap.m.Label", 
				multiple: false,
				visibility: "hidden"
			},
			_button: {
				type: "sap.m.Button",
				multiple: false,
				visibility: "hidden"
			} 
		},
		events: {
			change: {
				parameters: {
					"value": "int"
				}
			}
		}</span>
	}
	
	init(): void {
		<span class="emphasis">this.setAggregation("_rating", new RatingIndicator({
			value: this.getValue(),
			iconSize: "2rem",
			liveChange: this._onRate.bind(this)
		}));
		this.setAggregation("_label", new Label({
			text: "{i18n&gt;productRatingLabelInitial}"
		}).addStyleClass("sapUiSmallMargin"));
		this.setAggregation("_button", new Button({
			text: "{i18n&gt;productRatingButton}",
			press: this._onSubmit.bind(this)
		}).addStyleClass("sapUiTinyMarginTopBottom"));</span>
	}

	<span class="emphasis">setValue(value: "float" ): ProductRating {
		this.setProperty("value", value, true);
		(this.getAggregation("_rating") as RatingIndicator).setValue(value);
		return this;		
	}
	
	reset(): void {
		const resourceBundle = (this?.getModel("i18n") as ResourceModel)?.getResourceBundle() as ResourceBundle;
		
		this.setValue(0);
		(this.getAggregation("_label") as Label).setDesign("Standard");
		(this.getAggregation("_rating") as RatingIndicator).setEnabled(true);
		(this.getAggregation("_label") as Label).setText(resourceBundle.getText("productRatingLabelInitial"));
		(this.getAggregation("_button") as Button).setEnabled(true);
	}
	
	_onRate(event: RatingIndicator$LiveChangeEvent): void {
		const resourceBundle = (this?.getModel("i18n") as ResourceModel)?.getResourceBundle() as ResourceBundle;
		const value = event.getParameter("value");
		
		this.setProperty("value", value, true);
		
		(this.getAggregation("_label") as Label).setText(resourceBundle.getText("productRatingLabelIndicator", [value, (event.getSource() as RatingIndicator).getMaxValue()]));
		(this.getAggregation("_label") as Label).setDesign("Bold");
	}
	
	_onSubmit(event: Button$PressEvent): void {
		const resourceBundle = (this?.getModel("i18n") as ResourceModel)?.getResourceBundle() as ResourceBundle;
		
		(this.getAggregation("_rating") as RatingIndicator).setEnabled(false);
		(this.getAggregation("_label") as Label).setText(resourceBundle.getText("productRatingLabelFinal"));
		(this.getAggregation("_button") as Button).setEnabled(false);
		this.fireEvent("change", {
			value: this.getValue()
		})
	}</span>
	
	renderer = {  
		apiVersion: 4,
		render: (rm: RenderManager, control: ProductRating) =&gt; {<span class="emphasis">
			const tooltip = control.getTooltip_AsString();
			rm.openStart("div", control);
			rm.class("myAppDemoWTProductRating");
			if (tooltip) {
				rm.attr("title", tooltip);
			}
			rm.openEnd();
			rm.renderControl(control.getAggregation("_rating") as Control);
			rm.renderControl(control.getAggregation("_label") as Control);
			rm.renderControl(control.getAggregation("_button") as Control);
			rm.close("div");</span>
		}
	}
};</pre></div></div></section>
		</section><section id="section_s2z_hkw_4zb">
			<h2 class="title ">Generate Control Interfaces to Resolve the TypeScript Errors</h2>
			<p>While the application would run successfully, the editor still displays an error in the <code>ProductRating.ts</code> renderer.</p>
			<p>The solution is to use the <a href="https://www.npmjs.com/package/@ui5/ts-interface-generator" title="https://www.npmjs.com/package/@ui5/ts-interface-generator" class="external-link" target="_blank" rel="noopener">ts-interface-generator</a>, a small tool that scans the project for any controls (as well as other subclasses of
					<code>sap.ui.ManagedObject</code>) and generates TypeScript interface definitions declaring those generated methods:</p>
			<ul class="ul ">
				<li class="li">
					<p>Open a new terminal window in your app root folder and execute <code>npm install @ui5/ts-interface-generator --save-dev</code> to install
						this package as a new development dependency in your <code>package.json</code>.</p>
				</li>
				<li class="li">
					<p>Run <code>ui5 serve</code>. This starts the interface generator tool in "watch" mode and creates the required interface definition (after
						a short startup delay during which all existing types in the project and in UI5 are scanned).</p>
				</li>
			</ul>
			<p>You can inspect the generated file <code>webapp/control/ProductRating.gen.d.ts</code> next to the control implementation. It defines an
				interface with the same name as the control class and declares the same module name. This causes <a href="https://www.typescriptlang.org/docs/handbook/declaration-merging.html" title="https://www.typescriptlang.org/docs/handbook/declaration-merging.html" class="external-link" target="_blank" rel="noopener">TypeScript to merge the
					definitions</a> and to assume that the interface methods also exist in the class.</p>
			<p>As a result, the TypeScript error message related to the new <code>ProductRating</code> control is gone and code completion is also
				available for all control API methods.</p>
			<p>You can now stop the interface generator again, as no further control API changes will be done in this tutorial. For continuous control
				development with frequent API changes, you would likely add a "watch" script to <code>package.json</code> for starting this
				generator.</p>
		</section><section id="section_a4x_1kw_4zb">
			<h2 class="title ">webapp/controller/Detail.controller.ts</h2>
			<p>In the <code>Detail</code> controller we implement a new <code>onRatingChange</code> event that reads the value of our coustom change
				event that is fired when a rating has been submitted. This requires to import our new control, as well as the
					<code>ProductRating$ChangeEvent</code> type we just defined to the detail controller. To keep the sample simple we only
				display a message message instead of sending the rating to the back end. We therefore load the <code>MessageToast</code> module
				from the <code>sap.m</code> namespace to our script. In addition we need the <code>ResourceBundle</code> module from the
					<code>sap/base/i18n</code> namespace as well as the <code>ResourceModel</code> module from the
					<code>sap/ui/model/resource</code> namespace, as we want to display the confirmation message we specified in our resource
				bundle in the message toast.</p>
			<p>In the <code>onRatingChange</code> event handler we extract the value of our custom change event that is fired when the rating has
				been submitted. We then display the confirmation message we defined in our resource bundle with the rating value in a
					<code>MessageToast</code> control.</p>
			<p>In the <code>onObjectMatched</code> method, we call the <code>reset</code> method to make it possible to submit another rating
				as soon as the detail view is displayed for a different item.</p>
			<section class="lang-js"><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">import Controller from "sap/ui/core/mvc/Controller";
import UIComponent from "sap/ui/core/ UIComponent";
import { Route$PatternMatchedEvent } from "sap/ui/core/routing/Route";
import History from "sap/ui/core/routing/History";
<span class="emphasis">import MessageToast from "sap/m/MessageToast";
import ProductRating, { ProductRating$ChangeEvent } from "../control/ProductRating";
import ResourceBundle from "sap/base/i18n/ResourceBundle";
import ResourceModel from "sap/ui/model/resource/ResourceModel";</span>

/**
 * @namespace ui5.walkthrough.controller
 */
export default class Detail extends Controller {

    onInit(): void {
        const router = UIComponent.getRouterFor(this);
        router.getRoute("detail").attachPatternMatched(this.onObjectMatched, this);
    }
	
    onObjectMatched(event: Route$PatternMatchedEvent): void {
    
        <span class="emphasis">(&lt;ProductRating&gt; this.byId("rating")).reset();</span>
        this.getView().bindElement({
            path: "/" + window.decodeURIComponent((&lt;any&gt; event.getParameter("arguments")).invoicePath),
            model: "invoice"
        });
    }
	
    onNavBack(): void {
        const history = History.getInstance();
        const previousHash = history.getPreviousHash();
		
        if (previousHash !== undefined) {
            window.history.go(-1);
        } else {
            const router = UIComponent.getRouterFor(this);
            router.navTo("overview", {}, true);
        }
    }    
   
    <span class="emphasis">onRatingChange(event: ProductRating$ChangeEvent): void {
        const value = event.getParameter("value");
        const resourceBundle = &lt;ResourceBundle&gt; (&lt;ResourceModel&gt; this?.getView().getModel("i18n"))?.getResourceBundle();
		
        MessageToast.show(resourceBundle.getText("ratingConfirmation", [value]));
    }</span>
};</pre></div></div></section>
		</section><section>
			<h2 class="title ">webapp/view/Detail.view.xml</h2>
			<p>All we need now is to add our new control to the detail view. To do so we must add a new namespace <code>wt</code>on the view so that we can
				reference our custom controls easily in the view. We then add an instance of the <code>ProductRating</code> control to our detail
				page and register our event handler for the change event. As we want to reset the value when navigating away, we need to assign an ID
				to the control. To have a proper layout, we also add a margin style class.</p>
			<section class="lang-xml"><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">&lt;mvc:View
	controllerName="ui5.walkthrough.controller.Detail"
	xmlns="sap.m"
	xmlns:mvc="sap.ui.core.mvc"
	<span class="emphasis">xmlns:wt="ui5.walkthrough.control"</span>&gt;
	&lt;Page
		title="{i18n&gt;detailPageTitle}"
		showNavButton="true"
		navButtonPress=".onNavBack"&gt;
		&lt;ObjectHeader
			intro="{invoice&gt;ShipperName}"
			title="{invoice&gt;ProductName}"/&gt;
		<span class="emphasis">&lt;wt:ProductRating 
			id="rating"
			tooltip="{invoice&gt;ProductName}"
			class="sapUiSmallMarginBeginEnd" 
			change=".onRatingChange"/&gt;</span>
	&lt;/Page&gt;
&lt;/mvc:View&gt;
</pre></div></div></section>
			<p>We can now rate a product on the detail page with our brand new control.</p>
		</section><section id="section_zpb_2kw_4zb">
			<h2 class="title ">webapp/control/ProductRating.ts</h2>
			<p>When opening the detail page you'll see the following note in the console informing you that there is still something missing in our
					<code>ProductRating</code> script:</p>
			<p>
				</p><section class="language-ini"><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">NOTE:
Class ProductRating in file [..]/webapp/control/ProductRating.ts needs to contain the following constructors,
in order to make TypeScript aware of the possible constructor settings. 
Please copy&paste the block manually, as the ts-interface-generator will not touch your source files:
===== BEGIN =====
// The following three lines were generated and should remain as-is  
// to make TypeScript aware of the constructor signatures
constructor(idOrSettings?: string | $ProductRatingSettings);
constructor(id?: string, settings?: $ProductRatingSettings);
constructor(id?: string, settings?: $ProductRatingSettings) { super(id, settings); }
===== END =====</pre></div></div></section>
			<p></p>
			<p>To complete the setup of the generated interface, we follow the instructions and add the block between the BEGIN and END line into the
					<code>ProductRating</code> class body in the file <code>webapp/control/ProductRating.ts</code>.</p>
			<section class="lang-js"><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">import Control from "sap/ui/core/Control";
import RenderManager from "sap/ui/core/RenderManager";
import { MetadataOptions } from "sap/ui/core/Element";
import Label from "sap/m/Label";
import Button, { Button$PressEvent } from "sap/m/Button";
import RatingIndicator, { RatingIndicator$LiveChangeEvent } from "sap/m/RatingIndicator";
import ResourceBundle from "sap/base/i18n/ResourceBundle";
import ResourceModel from "sap/ui/model/resource/ResourceModel";

/**
 * @namespace ui5.walkthrough.control
 */
export default class ProductRating extends Control {

	<span class="emphasis">// The following three lines were generated and should remain as-is 
	// to make TypeScript aware of the constructor signatures
	constructor(idOrSettings?: string | $ProductRatingSettings);
	constructor(id?: string, settings?: $ProductRatingSettings);
	constructor(id?: string, settings?: $ProductRatingSettings) { super(id, settings); }</span>	
    ...</pre></div></div></section>
			<p>Adding the block at this position provides the constructors and the structure of the constructor settings object. As result, the
				constructor signatures with and without control ID are available. Furthermore, TypeScript checks the settings you give in the
				constructor and suggests the available ones, like the direction property.</p>
		</section><section>
			<h2 class="title "> Conventions</h2>
			<ul class="ul ">
				<li class="li">
					<p>Put custom controls in the <code>control</code> folder of your app.</p>
				</li>
			</ul>
		</section><section class="contentInSection hidden"><h2>In this section:</h2></section><section class="familyLinks"><div class="parentLink"><br><strong>Parent topic: </strong><a href="topic/dad1905a07f849ce9c509721317d38d8">Walkthrough Tutorial (TypeScript)</a></div><div class="previousLink"><br><strong>Previous: </strong><a href="topic/ae61211b1bb744f7ab42731a37b7738c">Step 32: Routing Back and History (TypeScript)</a></div><div class="nextLink"><br><strong>Next: </strong><a href="topic/e5577bbb63154a56a2f9797caf2e5e38">Step 34: Responsiveness (TypeScript)</a></div></section><section class="relatedLinks "><div class="collapsible-icon sap-icon title"><h2>Related information</h2></div><ul class="fig">
		<li><a href="topic/8dcab0011d274051808f959800cabf9f" title="You can create own content for SAPUI5. To develop controls in JavaScript, you can either extend existing controls or create new ones." class="sap-doc">Developing Controls</a></li>
		<li><a href="topic/7b52540d9d8c4e00b9723151622bbb64" title="Control metadata consists of properties, events, as well as aggregations and associations." class="sap-doc">Defining the Control Metadata</a></li>
		<li><a href="topic/6d6b5bda5727419eadcc9cbac1f6e6a1" title="The init() method can be used to set up, for example, internal variables or subcontrols of a composite control." class="sap-doc">init() Method</a></li>
		<li><a href="api/sap.ui.core.ControlRenderer" title="api/sap.ui.core.ControlRenderer" class="sap-doc" alt="api/sap.ui.core.ControlRenderer">API Reference: sap.ui.core.ControlRenderer</a></li>
		<li><a href="topic/c9ab34570cc14ea5ab72a6d1a4a03e3f" title="The renderer object is responsible for creating the HTML structure for the control." class="sap-doc">Renderer Object</a></li>
		<li><a href="api/sap.ui.core.RenderManager" title="api/sap.ui.core.RenderManager" class="sap-doc" alt="api/sap.ui.core.RenderManager">API Reference: sap.ui.core.RenderManager</a></li>
		<li><a href="https://blogs.sap.com/2023/04/05/the-next-innovation-of-ui5-rendering/" title="https://blogs.sap.com/2023/04/05/the-next-innovation-of-ui5-rendering/" class="sap-doc">Blog: UI5 Rendering: The Next Big Step Towards a Better Performance</a></li>
		<li><a href="api/sap.m.RatingIndicator" title="api/sap.m.RatingIndicator" class="sap-doc" alt="api/sap.m.RatingIndicator">API Reference: sap.m.RatingIndicator</a></li>
		<li><a href="entity/sap.m.RatingIndicator" title="entity/sap.m.RatingIndicator" class="sap-doc" alt="entity/sap.m.RatingIndicator">Samples: sap.m.RatingIndicator
			</a></li>
		<li><a href="api/sap.m.Label" title="api/sap.m.Label" class="sap-doc" alt="api/sap.m.Label">API Reference: sap.m.Label</a></li>
		<li><a href="entity/sap.m.Label" title="entity/sap.m.Label" class="sap-doc" alt="entity/sap.m.Label">Samples: sap.m.Label
			</a></li>
		<li><a href="api/sap.m.Button" title="api/sap.m.Button" class="sap-doc" alt="api/sap.m.Button">API Reference: sap.m.Button</a></li>
		<li><a href="entity/sap.m.Button" title="entity/sap.m.Button" class="sap-doc" alt="entity/sap.m.Button">Samples: sap.m.Button
			</a></li>
		<li><a href="api/sap.ui.core.Control" title="api/sap.ui.core.Control" class="sap-doc" alt="api/sap.ui.core.Control">API Reference: sap.ui.core.Control</a></li>
		<li><a href="api/sap.ui.core.Element" title="api/sap.ui.core.Element" class="sap-doc" alt="api/sap.ui.core.Element">API Reference: sap.ui.core.Element</a></li>
		<li><a href="topic/bdf3e9818cd84d37a18ee5680e97e1c1" title="Event handler methods are invoked when an event occurs. Method names starting with on are reserved for event handler methods." class="sap-doc">Event Handler Methods</a></li>
		<li><a href="api/sap.ui.base.ManagedObject" title="api/sap.ui.base.ManagedObject" class="sap-doc" alt="api/sap.ui.base.ManagedObject">API Reference: sap.ui.base.ManagedObject</a></li>
		<li><a href="https://www.npmjs.com/package/@ui5/ts-interface-generator" title="https://www.npmjs.com/package/@ui5/ts-interface-generator" class="sap-doc">NPM Package: ui5/ts-interface-generator</a></li>
		<li><a href="https://www.typescriptlang.org/docs/handbook/declaration-merging.html" title="https://www.typescriptlang.org/docs/handbook/declaration-merging.html" class="sap-doc">TypeScript: Declaration Merging</a></li>
	</ul></section></div></section></div></body></html>
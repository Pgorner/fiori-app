<html><head></head><body><div id="d4h5-main-container" class="dk-main"><section id="loioed9aa41c563a44b18701529c8327db4d" class=" section topic"><div class="section-mdeditlink hidden">
				<a class="mdeditlink hidden" href="https://github.com/SAP-docs/sapui5/blob/main/docs/06_SAP_Fiori_Elements/draft-handling-ed9aa41.md">Edit on GitHub</a>
			</div><div class="collapsible-icon sap-icon innerTitle"><h2 class="title ">Draft Handling</h2></div><div class="fig"><div class="topictitle1 title"><h2 class="title ">Draft Handling</h2></div><div class="shortdesc">A draft is an interim version of a business entity that has not yet been explicitly saved as an active version. SAP Fiori elements supports the creation of apps using draft handling.</div><p>Drafts are used as follows:</p><ul class="ul ">
			<li class="li">
				<p>To keep unsaved changes when an editing activity is interrupted. This lets users resume editing later.</p>
			</li>
			<li class="li">
				<p>To prevent data loss if an app terminates unexpectedly.</p>
			</li>
			<li class="li">
				<p>As a locking mechanism to prevent multiple users from editing the same object at the same time, and to inform users about unsaved
					changes by another user.</p>
			</li>
		</ul><p>When a user starts creating a new business entity or edits an existing one, a draft is created in the background. This enables field
			validation and dynamic field control (showing additional fields based on user interaction) and provides default values for fields based on
			recent data entry. A draft can be validated for consistency and completeness at any time. This returns a list of messages.</p><p>While the user is modifying a business entity, an indicator shows when a draft is saved implicitly. The user still needs to choose
				<span class="ph uicontrol">Save</span> to incorporate the changes into an active business document.</p><section id="section_mvv_ts2_pmb">
			<h2 class="title ">Using the <span class="ph uicontrol">Apply</span> Button</h2>
			<p>The footer bar of a subobject page contains an <span class="ph uicontrol">Apply</span> button in create mode and edit mode. When users choose this
				button they can conclude their current create or edit activity, apply the changes or entries to the draft, and navigate one step up in
				the object hierarchy.</p>
			<p>When a user edits an object, the system behavior of the <span class="ph uicontrol">Apply</span> button is as follows: <img src="loio36204dc3fff942668f0c38c93d6684d6_LowRes.png" usemap="#"></p>
			<ol>
				<li class="li">
					<p>On an object page, the user chooses <span class="ph uicontrol">Edit</span>. </p>
				</li>
				<li class="li">
					<p>The system creates a draft version of the object.</p>
				</li>
				<li class="li">
					<p>The user makes changes to the draft version of the object and navigates to a detail page. When the user chooses
							<span class="ph uicontrol">Apply</span>, the changes are applied to the draft.</p>
				</li>
				<li class="li">
					<p>When the user chooses <span class="ph uicontrol">Save</span>, the changes are saved to the active version of the object.</p>
				</li>
			</ol>
			<div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>
				</p><p>If the <code>DiscardAction</code> has been defined in the <code>DraftRoot</code> annotation, the
						<code>DiscardAction</code> is called if the user chooses to delete the draft. If the <code>DiscardAction</code> has
					not been defined, the <code>Delete</code> call is triggered instead.</p>
			<p></p></div></div>
		</section><section id="section_ysr_zrm_mtb">
			<h2 class="title ">Switching Between the Draft and Saved Version </h2>
			<p>Users can switch between the draft and saved version using a dropdown in applications that have the dynamic header.</p>
			<p> </p>
			<div><div class="fig"><img src="loio6c69105cdbae47a5967a7651e154700b_LowRes.png" usemap="#"></div><span class="collapsible-icon sap-icon figcap title"><h2 class="title ">Dynamic Header</h2></span></div>
			<section>
				<h3 class="title ">Preparing the Draft for Activation on Tablet and Mobile Devices
					</h3>
				<p>The object page displays the <span class="ph uicontrol">Validate</span> button to execute the <code>PreparationAction</code> call. The
					side effects, if configured, are also triggered along with the validate action. </p>
			</section>
		</section><section id="section_qvv_ts2_pmb">
			<h2 class="title ">Handling Inconsistent Input</h2>
			<p>Users might enter data that is so inconsistent that the system cannot store it in the draft. For example, characters are entered in a
				number field, or more characters than the field length allows are entered. If this is the case, the contents of the UI differ from the
				contents of the draft. Before the draft can be saved by the user, the system displays a message prompting the users to solve these
				errors. After all errors have been solved, the draft can be saved.</p>
			<p>This system behavior is also valid when using the <span class="ph uicontrol">Apply</span> button. When choosing <span class="ph uicontrol">Apply</span>, the
				system has to make sure that the contents on the UI and the stored contents of the draft are identical. If the errors described above
				occur, the system displays the same message prompting the user to solve them.</p>
			<div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>
				</p><p>This message lists only errors related to technical inconsistencies, not to logical inconsistencies. For example, if a user enters
					a business partner that does not exist, this error is not displayed. These types of errors are displayed in a state message when
					saving the object.</p>
			<p></p></div></div>
		</section><section id="section_eq2_h5q_j5b" class="collapsible expanded"><div class="collapsible-icon sap-icon"><h2 class="title collapsible expanded">Additional Features in SAP Fiori Elements for OData V2</h2></div><div class="fig"><p>Drafts are saved automatically in the background after an interval of 20 seconds whenever users add or change information within a
				business entity while it's in edit mode. However, if the user has modified a field on the UI that has a side effect annotation, then
				the draft is saved immediately after the user moves out of the virtual field group of the corresponding side effect. The draft is also
				saved immediately when the user executes an action. In this case, the pending changes in the draft are also saved immediately.</p><p>You can turn off the feature to delay draft merges in <code>manifest.json</code> in exceptional cases using the following sample
				code:</p><div class="note other samplecode "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Sample Code
				</strong></div></div><div class="fig"><p>Settings in <code>manifest.json</code></p><section><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">"sap.ui.generic.app": {
     "settings": {
          "draftSettings": {
               "dataSaveFrequency": "immediate"
          }
     }
}</pre></div></div></section><p></p></div></div><p>You can use keyboard shortcuts for common tasks.</p><p>When a user toggles away from the draft version, any pending changes are automatically saved and are visible in the active version.</p><section>
				<h3 class="title ">Switching Between the Draft and Saved Version </h3>
				<p>Users can switch between the draft and saved version using a toggle button in applications that have the static or classic
					header.</p>
				<div><div class="fig"><img src="loio17f784f03d8f472ea03064a8e1d88a37_LowRes.png" usemap="#"></div><span class="collapsible-icon sap-icon figcap title"><h2 class="title ">Static/Classic Header</h2></span></div>
			</section><section>
				<h3 class="title ">Preparing the Draft for Activation by Pressing <span class="keyWrap"><kbd class="key">Enter</kbd></span></h3>
				<p>On a draft version of a document, if you press <span class="keyWrap"><kbd class="key">Enter</kbd></span> on input fields, by default the draft validation
						(<code>PreparationAction</code> available on the <code>DraftRoot</code>) is triggered. The
						<code>PreparationAction</code> performs a validation in the back end for the draft values and sends back validation
					messages if they're available. The pending changes on the draft, if any, are also saved before validating the draft instance.</p>
				<p>The <code>PreparationAction</code> that is defined within the <code>DraftRoot</code> is called, even if you've pressed
						<span class="keyWrap"><kbd class="key">Enter</kbd></span> in the fields of the object page table, or in the subobject pages.</p>
				<p>The side effects, if configured, are also triggered upon pressing <span class="keyWrap"><kbd class="key">Enter</kbd></span>. The <code>PreparationAction</code> call is
					skipped if you've annotated <code>TriggerAction</code> in the global side effects under the corresponding entity. In this
					case, <code>TriggerAction</code> is called instead of <code>PreparationAction</code>. However, in case of side effects
					annotated with source properties and <code>TriggerAction</code>, <code>PreparationAction</code> call is not impacted. For
					more information, see <a href="topic/955ae316856a4dcdbe07a1dbf584fa98" title="Global side effects are those side effects that are defined without any source properties or source entities." class="sap-doc">Using Global Side Effects</a>.</p>
			</section></div></section><section id="section_oll_ghj_gvb" class="collapsible expanded"><div class="collapsible-icon sap-icon"><h2 class="title collapsible expanded">Additional Features in SAP Fiori Elements for OData V4</h2></div><div class="fig"><p>There are two kinds of drafts in SAP Fiori elements for OData
                            V4:</p><ul class="ul ">
				<li class="li">
					<p>Exclusive draft: only one user can create the draft for the business entity. Other users cannot see the changes before the user
						saves the draft.</p>
				</li>
				<li class="li">
					<p>Collaborative draft: all users who have access to a business object can access the draft and change the business entity.</p>
				</li>
			</ul><p>Drafts are saved automatically in the background whenever users add or change information within a business entity while it's in edit
				mode.</p><p>You can use a keyboard shortcut to execute a <code>PreparationAction</code> or global side effects in the draft mode.</p><section>
				<h3 class="title ">Preparing the Draft for Activation by Pressing <span class="keyWrap"><kbd class="key">Enter</kbd></span></h3>
				<p>On a draft version of a document, if you press <span class="keyWrap"><kbd class="key">Enter</kbd></span> on input fields, one of the following actions is triggered:</p>
				<ul class="ul ">
					<li class="li">
						<p>Global side effects (<code>SideEffects</code> without <code>SourceProperties</code> and
								<code>SourceEntities</code>) are executed if these side effects are defined in the entity related to the field,
							that is, the page entity in a form or the table entity in a cell.</p>
					</li>
					<li class="li">
						<p>If a <code>PreparationAction</code> is defined in the <code>DraftRoot</code> entity and the message is annotated,
							that <code>PreparationAction</code> is triggered and the messages are requested.</p>
					</li>
				</ul>
				<p>For more information, see <a href="topic/955ae316856a4dcdbe07a1dbf584fa98" title="Global side effects are those side effects that are defined without any source properties or source entities." class="sap-doc">Using Global Side Effects</a> and our live example in the flexible programming
					model explorer at <a href="test-resources/sap/fe/core/fpmExplorer/index.html#/advancedFeatures/guidance/draftValidation" title="https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/advancedFeatures/guidance/draftValidation" class="sap-doc">Guidance - Draft Validation</a>.</p>
			</section><section>
				<h3 class="title ">Filtering Draft-Related Data</h3>
				<p>Filtering draft-related data is enabled by default in SAP Fiori elements for OData
                            V4. The
					available filters are <span class="ph uicontrol">Draft Created By</span>, <span class="ph uicontrol">Draft Created On</span>, <span class="ph uicontrol">Draft Last
						Changed By</span>, and <span class="ph uicontrol">Draft Last Changed On</span>. Semantic operators are used by default for the
					time-related filters, displaying only past values.</p>
				<div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>
					</p><p>This feature is not available with a CAP service.</p>
				<p></p></div></div>
			</section><section>
				<h3 class="title ">Using the Collaborative Draft</h3>
				<p>If the service supports the collaborative draft using a <code>ShareAction</code> annotation, all drafts are automatically
					shared with all users who have access to the business object. Users can edit the entity as long as the draft exists.</p>
				<p>Avatars of all the users who are currently accessing this draft are displayed in the object page header.</p>
				<p>When a user starts typing in a field or sets the focus in a specific field, it is locked for all the other users. An indicator
					appears next to the field to show who is modifying it.</p>
				<p>When a user changes a field or performs an action, such as creating a new subitem, deleting a subitem or calling an action, the new
					changes are immediately visible to the other users. When a user saves or discards the draft, the other users are notified.</p>
				<p>Clicking the <span class="ph uicontrol">Invite</span> button next to the user avatars shows a list of users who are currently editing the
					draft or have previously edited it. Users can also add other users to the list, asking them to join the collaborative draft. Note
					that adding a user to this list does not change their authorization. Only users with access to the business object can be
					invited.</p>
				<p>When a user is added to the list, the draft will appear in their <span class="ph uicontrol">Own Draft</span> list.</p>
				
				<div class="note caution  "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Caution
				</strong></div></div><div class="fig"><p>
					</p><p>The collaborative draft uses WebSocket for the synchronization between the participants, which extends the browser session
						timeout until all users have either navigated away from the draft, closed the session, or closed the application.</p>
					<p>Please be aware of this behavior and also inform end users of the app accordingly.</p>
				<p></p></div></div>
				
				<div class="note restriction  "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Restriction
				</strong></div></div><div class="fig"><p>
					</p><ul class="ul ">
						<li class="li">
							<p>This feature is only supported when using the ABAP RESTful Application Programming Model (RAP).</p>
						</li>
						<li class="li">
							<p>The lock mechanism is only supported by app extensions built using the SAP Fiori elements for OData
                            V4 building blocks.</p>
						</li>
					</ul>
				<p></p></div></div>
			</section></div></section><section id="section_ivw_gkc_d2b">
			<h2 class="title ">Related Links</h2>
			<ul class="ul ">
				<li class="li">
					<p><a href="https://experience.sap.com/fiori-design-web/draft-handling/" title="https://experience.sap.com/fiori-design-web/draft-handling/" class="external-link" target="_blank" rel="noopener">Draft Handling in SAP
							Fiori Design Guidelines</a></p>
				</li>
				<li class="li">
					<p><a href="https://help.sap.com/viewer/cc0c305d2fab47bd808adcad3ca7ee9d/7.52.2/en-US/d36820f082c84085b6634be4576e351a.html" title="https://help.sap.com/viewer/cc0c305d2fab47bd808adcad3ca7ee9d/7.52.2/en-US/d36820f082c84085b6634be4576e351a.html" class="external-link" target="_blank" rel="noopener">Developing New Transactional Apps with Draft Capabilities</a>
					</p>
				</li>
				<li class="li">
					<p><a href="topic/9a536627a6a94de084b0605eb164d2c8" title="You can configure confirmation popups for various use cases in list reports and object pages." class="sap-doc">Confirmation Popups</a></p>
				</li>
				<li class="li">
					<p><a href="topic/955ae316856a4dcdbe07a1dbf584fa98" title="Global side effects are those side effects that are defined without any source properties or source entities." class="sap-doc">Using Global Side Effects</a></p>
				</li>
				<li class="li">
					<p><a href="topic/fd3950a0b251439ab8cd4153d64844b6" title="You can toggle between draft and saved values." class="sap-doc">Toggling Between Draft and Saved Values</a></p>
				</li>
			</ul>
		</section><section class="contentInSection hidden"><h2>In this section:</h2></section><section class="familyLinks"><div class="parentLink hidden"><br><strong>Parent topic: </strong></div><div class="previousLink hidden"><br><strong>Previous: </strong></div><div class="nextLink hidden"><br><strong>Next: </strong></div></section><section class="hidden relatedLinks "><div class="collapsible-icon sap-icon title"><h2>Related information</h2></div><ul class="fig"></ul></section></div></section></div></body></html>
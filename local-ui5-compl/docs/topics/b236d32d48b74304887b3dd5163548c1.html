<html><head></head><body><div id="d4h5-main-container" class="dk-main"><section id="loiob236d32d48b74304887b3dd5163548c1" class=" section topic"><div class="section-mdeditlink hidden">
				<a class="mdeditlink hidden" href="https://github.com/SAP-docs/sapui5/blob/main/docs/06_SAP_Fiori_Elements/enabling-stream-support-b236d32.md">Edit on GitHub</a>
			</div><div class="collapsible-icon sap-icon innerTitle"><h2 class="title ">Enabling Stream Support</h2></div><div class="fig"><div class="topictitle1 title"><h2 class="title ">Enabling Stream Support</h2></div><div class="shortdesc">End users of SAP Fiori elements can upload, download, and delete
		files.</div><div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>
			</p><p>Application developers must define <code>@Core.AcceptableMediaTypes</code>. This avoids security issues by enabling SAP Fiori elements to check for allowed file types.
				The
				back-end service framework must ensure a virus scan and other security measures, such as maximum file size limitations and MIME-type
				restrictions, are in place.</p>
		<p></p></div></div><section id="section_kqw_x3n_psb" class="collapsible expanded"><div class="collapsible-icon sap-icon"><h2 class="title collapsible expanded">Additional Features in SAP Fiori Elements for OData V2</h2></div><div class="fig"><p>You can upload or download different <code>MediaType</code> files from an object page using stream support.</p><section>
				<h3 class="title ">Prerequisites</h3>
				<p>The <code>Edm.Stream</code> type is not supported in SAP Fiori elements for OData
                            V2,
					so the service must have an entity that is stream enabled:</p>
				<div class="note other samplecode "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Sample Code
				</strong></div></div><div class="fig"><p>
					</p><section><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">&lt;EntityType Name="MyStreamType" m:HasStream="true" sap:label="Stream Test" sap:content-version="1"&gt;
  &lt;Key&gt;
    &lt;PropertyRef Name="Streamuuid" /&gt;
    &lt;PropertyRef Name="IsActiveEntity" /&gt;
  &lt;/Key&gt;
&lt;Property Name="Edit_ac" Type="Edm.Boolean" sap:label="Dyn. Action Control" sap:creatable="false" sap:updatable="false" sap:sortable="false" sap:filterable="false" /&gt;
</pre></div></div></section>
				<p></p></div></div>
			</section><section>
				<h3 class="title ">Enabling Stream Support</h3>
				<p>To make stream support available on the object page, annotate the following in the <code>UI.FieldGroup</code> or
						<code>UI.Identification</code> annotation:</p><div class="note other samplecode "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Sample Code
				</strong></div></div><div class="fig"><p>
						</p><section><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">&lt;Record Type="UI.DataField"&gt;
     &lt;PropertyValue Property="Value" Path="$value"/&gt;
&lt;/Record&gt;
</pre></div></div></section>
					<p></p></div></div><p></p>
				<div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>
					</p><p><code>$value</code> is a reserved text, and it is used only to support stream.</p>
				<p></p></div></div>
				<p>The following <code>MediaType</code> annotation represents the stream type that displays each record. This annotation is
					mandatory and exists on the entity level.</p><div class="note other samplecode "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Sample Code
				</strong></div></div><div class="fig"><p>
						</p><section><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">&lt;Annotation Term="Org.OData.Core.V1.MediaType" Path="ThisMimeType"&gt;&lt;/Annotation&gt;</pre></div></div></section>
					<p></p></div></div><p></p>
				<p>The following annotation must be set on the <code>entitylevel</code> if the stream is displayed as image.</p>
				<div class="note other samplecode "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Sample Code
				</strong></div></div><div class="fig"><p>
					</p><section><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">&lt;Annotation Term="UI.IsImage"/&gt;</pre></div></div></section>
				<p></p></div></div>
				<p>If the entity is annotated with <code>UI.IsImage</code>, then both the images and the media files are displayed on the UI as
					thumbnails.</p>
				<div><div class="fig"><img src="loio6239c9804bbd4bc19362a3715c123539_LowRes.png" usemap="#"></div></div>
				<p>If the entity is not annotated with <code>UI.IsImage</code>, then both the images and the media files are displayed on the UI
					with icon and hyperlink.</p>
				<div><div class="fig"><img src="loio24af17e5378f4579ba282bd93467168a_LowRes.png" usemap="#"></div></div>
				<div><div class="fig"><img src="loiofc27c6347001481da9ab3c6ac78f8b3c_LowRes.png" usemap="#"></div></div>
				<p>Label for the file uploader is picked from the
						<code>dataField</code>
					annotation.</p>
				<p>Based on the <code>MediaType</code>, the icon for the non-image media type is shown differently in the UI.</p>
				<p>The following annotation must exist on the <code>entitylevel</code> to set the text for the file name. If the annotations are
					not included, the hyperlink displays the text <span class="ph uicontrol">Open File</span>.</p><div class="note other samplecode "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Sample Code
				</strong></div></div><div class="fig"><p>
						</p><section><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">&lt;Annotation Term="SAP__core.ContentDisposition"&gt;
    &lt;Record&gt;
        &lt;PropertyValue Property="Filename" Path="ThisFileName" /&gt;
    &lt;/Record&gt;
&lt;/Annotation&gt;
</pre></div></div></section>
					<p></p></div></div><p></p>
				<p>You can restrict the <code>MediaType</code> from being uploaded by using the following annotation:</p><div class="note other samplecode "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Sample Code
				</strong></div></div><div class="fig"><p>
						</p><section><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">&lt;Annotation Term="Core.AcceptableMediaTypes"&gt;
    &lt;Collection&gt;
        &lt;String&gt;text/plain&lt;/String&gt;
    &lt;/Collection&gt;
&lt;/Annotation&gt;
</pre></div></div></section>
					<p></p></div></div><p></p>
				<p>In the draft apps, you can only upload or delete a stream when the UI is editable. However, in the non-draft apps, the upload and
					delete is supported only in display mode.</p>
				<p>If no file is present, a placeholder is displayed:</p>
				<div><div class="fig"><img src="loioadaa7a8b863c46b2917c13d751beb72d_LowRes.png" usemap="#"></div></div>
				<div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>
					</p><p>An uploaded file cannot be viewed in the list report or the object page table. But that cannot be edited from the table. To upload a
						file, you have to navigate to the
						corresponding object page. You cannot upload multiple files. </p>
					<div><div class="fig"><img src="loio08edaaf80b16446bad62d232a5e887a3_LowRes.png" usemap="#"></div></div>
				<p></p></div></div>
			</section></div></section><section id="section_dn4_zkn_psb" class="collapsible expanded"><div class="collapsible-icon sap-icon"><h2 class="title collapsible expanded">Additional Features in SAP Fiori Elements for OData V4</h2></div><div class="fig"><p>App developers can define fields based on <code>Edm.Stream</code> properties and add them to forms or tables, for example.</p><p>Fields based on <code>Edm.Stream</code> have the following features:</p><ul class="ul ">
				<li class="li">
					<p>In display mode, the stream content is represented
						either as a preview (image) or as a link to download the file.</p>
					<p>If the field is represented as a download link, it also contains a media-type icon, and the display text for the link is the file name (for example,
						<span class="ph uicontrol">1.gif</span>) if available.
						Otherwise, the display text is
							<span class="ph uicontrol">Open File</span>.</p>
				</li>
				<li class="li">
					<p>In edit mode, there are additional buttons to upload
						or delete the stream content.</p>
				</li>
			</ul><p>The following image shows an example of a list report from which end users can download a file:</p><div><div class="fig"><img src="loio5659cb3e656b4ddfaa9d0ddd1f1b99d2_LowRes.png" usemap="#"></div></div><p>The following image shows an example of an object page in display mode:</p><div><div class="fig"><img src="loio3d08541952d042a38ae7852c902dcfba_LowRes.png" usemap="#"></div></div><p>The following image shows the object page containing file upload fields in edit mode:</p><div><div class="fig"><img src="loio46c270634ecc49328bd882dda7ae0633_LowRes.png" usemap="#"></div></div><p>To get the file upload elements, proceed as follows:</p><section>
				<h3 class="title ">Step 1: Provide a property of type
					<code>Edm.Stream</code>.</h3>
				<div class="note other samplecode "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Sample Code
				</strong></div></div><div class="fig"><p>
					</p><section class="collapsible"><div class="collapsible-icon sap-icon title"><strong>
						Sample Code
					</strong></div><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">&lt;EntityType Name="MainEntities"&gt;
    ...
    &lt;Property Name="myStreamProperty" Type="Edm.Stream" /&gt;
    &lt;Property Name="myStreamPropertyType" Type="Edm.String" /&gt;
    &lt;Property Name="myRestrictedStreamProperty" Type="Edm.Stream" MaxLength="100000"/&gt;
    ...
&lt;/EntityType&gt;
&lt;Annotations Target="sap.fe.stream.StreamsService.MainEntities/myStreamProperty"&gt;
    &lt;Annotation Term="Core.MediaType" Path="myStreamPropertyType" /&gt;
&lt;/Annotations&gt;
&lt;Annotations Target="sap.fe.stream.StreamsService.MainEntities/myStreamPropertyType"&gt;
    &lt;Annotation Term="Core.IsMediaType" Bool="true" /&gt;
&lt;/Annotations&gt;
&lt;Annotations Target="sap.fe.stream.StreamsService.MainEntities/myRestrictedStreamProperty"&gt;
    &lt;Annotation Term="Core.MediaType" String="text/plain"/&gt;
    &lt;Annotation Term="Core.AcceptableMediaTypes"&gt;
        &lt;Collection&gt;
            &lt;String&gt;text/plain&lt;/String&gt;
        &lt;/Collection&gt;
    &lt;/Annotation&gt;
&lt;/Annotations&gt;</pre></div></div></section>
				<p></p></div></div>
				<p>To restrict the file size, add the attribute <code>MaxLength</code> to the <code>Property</code>.
						<code>MaxLength</code> is the maximum file size in bytes. To define the allowed media types, use the annotation
						<code>Core.AcceptableMediaTypes</code>. Without these annotations, there is no restriction regarding file size and media
					types that can be uploaded. App developers must define these restrictions.</p>
				<div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>
					</p><p>The <code>odata.mediaEditLink</code> annotation is
						not supported.</p>
				<p></p></div></div>
				<p>For more information, see <a href="https://cap.cloud.sap/docs/guides/providing-services#annotating-media-elements" title="https://cap.cloud.sap/docs/guides/providing-services#annotating-media-elements" class="external-link" target="_blank" rel="noopener">https://cap.cloud.sap/docs/guides/providing-services#annotating-media-elements</a>.</p>
			</section><section>
				<h3 class="title ">Step 2: Maintain and annotate the UI field as a
					<code>DataField</code>.</h3>
				<div class="note other samplecode "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Sample Code
				</strong></div></div><div class="fig"><p>
					</p><section class="collapsible"><div class="collapsible-icon sap-icon title"><strong>
						Sample Code
					</strong></div><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">&lt;Annotations Target="sap.fe.stream.StreamsService.MainEntities"&gt;
    &lt;Annotation Term="UI.FieldGroup" Qualifier="streams"&gt;
        &lt;Record Type="UI.FieldGroupType"&gt;
            &lt;PropertyValue Property="Label" String="Streams" /&gt;
            &lt;PropertyValue Property="Data"&gt;
                &lt;Collection&gt;
                    &lt;Record Type="UI.DataField"&gt;
                        &lt;PropertyValue Property="Label" String="Stream" /&gt;
                        &lt;PropertyValue Property="Value" Path="myStreamProperty" /&gt;
                    &lt;/Record&gt;
                &lt;/Collection&gt;
            &lt;/PropertyValue&gt;
        &lt;/Record&gt;
    &lt;/Annotation&gt;
&lt;/Annotations&gt;</pre></div></div></section>
				<p></p></div></div>
			</section><section>
				<h3 class="title ">UI Representation</h3>
				<p>The representation of the document icon and the link depend on the <code>odata.mediaContentType</code> and
						<code>Core.ContentDisposition/Filename</code> annotations.</p>
				<p>– Document Icon –</p>
				<p>If the back end returns an <code>odata.mediaContentType</code> annotation for the stream property, SAP Fiori elements renders a specific document icon based on the content
					type. If the back end doesn't
					 return an <code>odata.mediaContentType</code>
					annotation (or if the content type can be mapped to
					a specific document icon), SAP Fiori elements renders a generic document
					icon.</p>
				<p>– Document Link –</p>
				<p>You can click on the document link to open the content of the stream property. SAP Fiori elements distinguishes the following three cases for rendering
					the document link:</p>
				<ul class="ul ">
					<li class="li">
						<p>The link text shows the file name. Two conditions must be fulfilled:</p>
						<ul class="ul ">
							<li class="li">
								<p>For the stream property,
									there's
									a <code>Core.ContentDisposition/Filename</code> annotation pointing to a non-empty file name that is
									empty.</p>
							</li>
							<li class="li">
								<p>The stream property is not empty. This means the back end either returns an <code>odata.mediaContentType</code> annotation with a value
									that is not
										<code>null</code>,
									or does not return an <code>odata.mediaContentType</code> annotation.</p>
							</li>
						</ul>
					</li>
					<li class="li">
						<p>The link text is "Open File". Two conditions must be fulfilled:</p>
						<ul class="ul ">
							<li class="li">
								<p>For the stream property,
									there's
									either no <code>Core.ContentDisposition/Filename</code> annotation, or a
										<code>Core.ContentDisposition/Filename</code> annotation pointing to an empty file name.</p>
							</li>
							<li class="li">The stream property is not empty. This means the back end either returns an <code>odata.mediaContentType</code> annotation with a value
								that is not
									<code>null</code>,
								or does not return an <code>odata.mediaContentType</code> annotation.</li>
						</ul>
					</li>
					<li class="li">
						<p>There's
							an empty indicator instead of a link. The following condition must be fulfilled:</p>
						<ul class="ul ">
							<li class="li">
								<p>The stream property is empty. This means the back end returns an <code>odata.mediaContentType</code> annotation with the value
										<code>null</code>.</p>
							</li>
						</ul>
					</li>
				</ul>
				<div class="note other samplecode "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Sample Code
				</strong></div></div><div class="fig"><p>XML
					Annotation</p><section class="collapsible lang-xml"><div class="collapsible-icon sap-icon title"><strong>
						Sample Code
					</strong></div><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">&lt;Annotations Target="sap.fe.streams.StreamsService.MainEntities/streamWithFilename_content"&gt;
     &lt;Annotation Term="Core.MediaType" Path="streamWithFilename_type"/&gt;
          &lt;Annotation Term="Core.ContentDisposition"&gt;
               &lt;Record Type="Core.ContentDispositionType"&gt;
                    &lt;PropertyValue Property="Filename" Path="streamWithFilename_name"/&gt;
               &lt;/Record&gt;
          &lt;/Annotation&gt;
     &lt;Annotation Term="Common.Label" String="Stream, dynamic media type, with name"/&gt;
&lt;/Annotations&gt;
</pre></div></div></section><p></p></div></div>
				<div class="note other samplecode "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Sample Code
				</strong></div></div><div class="fig"><p>CAP CDS
					Annotation</p><section class="collapsible"><div class="collapsible-icon sap-icon title"><strong>
						Sample Code
					</strong></div><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">@title : 'Stream with file name'
@Core.MediaType : streamWithFilename_type
@Core.ContentDisposition.Filename : streamWithFilename_name
                                    streamWithFilename_content : Stream;
                                    streamWithFilename_type : MediaType;
                                    streamWithFilename_name : StreamName;</pre></div></div></section><p></p></div></div>
				<p>– Avatar –</p>
				<p>An avatar is rendered instead of the icon and link representation when one of the following two conditions is fulfilled:</p>
				<ul class="ul ">
					<li class="li">
						<p>The <code>Edm.Stream</code> property is annotated with <code>UI.IsImage</code>
							which
							is included in an <code>EntityType</code> that is annotated with
								<code>Common.IsNaturalPerson</code> or <code>UI.IsImageUrl</code>.</p>
					</li>
					<li class="li">
						<p>The <code>Core.MediaType</code> annotation starts with 'image/', as in 'image/gif'</p>
					</li>
				</ul>
				<p>– Edit Mode –</p>
				<p>In Edit mode, an upload button and a delete button are
					available so that users can upload a different file or delete the file. If the back-end response provides a new value for
						<code>odata.mediaContentType</code> after uploading a new file, the icon and link change their representation according to
					the new value.</p>
			</section></div></section><section class="contentInSection hidden"><h2>In this section:</h2></section><section class="familyLinks"><div class="parentLink hidden"><br><strong>Parent topic: </strong></div><div class="previousLink hidden"><br><strong>Previous: </strong></div><div class="nextLink hidden"><br><strong>Next: </strong></div></section><section class="hidden relatedLinks "><div class="collapsible-icon sap-icon title"><h2>Related information</h2></div><ul class="fig"></ul></section></div></section></div></body></html>
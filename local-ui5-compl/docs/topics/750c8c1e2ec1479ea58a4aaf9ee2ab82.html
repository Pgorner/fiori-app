<html><head></head><body><div id="d4h5-main-container" class="dk-main"><section id="loio750c8c1e2ec1479ea58a4aaf9ee2ab82" class=" section topic"><div class="section-mdeditlink hidden">
				<a class="mdeditlink hidden" href="https://github.com/SAP-docs/sapui5/blob/main/docs/03_Get-Started/step-27-unit-test-with-qunit-typescript-750c8c1.md">Edit on GitHub</a>
			</div><div class="collapsible-icon sap-icon innerTitle"><h2 class="title ">Step 27: Unit Test with QUnit (TypeScript)</h2></div><div class="fig"><div class="topictitle1 title"><h2 class="title ">Step 27: Unit Test with QUnit (TypeScript)</h2></div><div class="shortdesc">Now that we have a test folder in the app, we can start to increase our test
		coverage. </div><p>Actually, every feature that we added to the app so far, would require a separate test case. We have totally neglected this so far, so let's add
			a simple unit test for our custom formatter function from Step 22. We will test if the long text for our status is correct by comparing it
			with the texts from our resource bundle.</p><div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>In this tutorial, we focus on a simple use case for the test implementation. If you
			want to learn more about QUnit tests, have a look at our <a href="topic/291c9121e6044ab381e0b51716f97f52" title="In this tutorial we will test application functionality with the testing tools that are delivered with SAPUI5. At different steps of this tutorial you will write tests using QUnit, OPA5, and the OData V2 mock server. Additionally, you will learn about testing strategies, Test Driven Development (TDD), and much more." class="sap-doc">Testing Tutorial</a> tutorial, especially <a href="topic/b81736e0fcb246efb3b0cf0ca422f8fd" title="In this step we will analyze the unit testing infrastructure and write a first unit test." class="sap-doc">Step 2: A First Unit Test</a>.</p></div></div><section>
			<h2 class="title ">Preview</h2>
			<div><div class="fig"><img src="loio0d29491d96574cfe8d8158d60a0a32e2_LowRes.png" title="Preview of the unit test" alt="Preview of the unit test" usemap="#"></div><span class="collapsible-icon sap-icon figcap title"><h2 class="title ">A unit test for our formatters is now available</h2></span></div>
		</section><section>
			<h2 class="title ">Coding</h2>
			<p>You can view all files at <a href="https://github.com/sap-samples/ui5-typescript-walkthrough/tree/main/steps/27" title="https://github.com/sap-samples/ui5-typescript-walkthrough/tree/main/steps/27" class="external-link" target="_blank" rel="noopener">OpenUI5 TypeScript Walkthrough - Step 27: Unit Test with QUnit</a> and <a href="https://sap-samples.github.io/ui5-typescript-walkthrough/ui5-typescript-walkthrough-step-27.zip" title="https://sap-samples.github.io/ui5-typescript-walkthrough/ui5-typescript-walkthrough-step-27.zip" class="external-link" target="_blank" rel="noopener">download the solution as a zip file</a>.</p>
			<p>
				</p><div><div class="fig"><img src="loioeae0f42249494ae7aeda044e83f15097_LowRes.png" title="The graphic has an explanatory text" alt="The graphic has an explanatory text" usemap="#"></div><span class="collapsible-icon sap-icon figcap title"><h2 class="title ">Folder Structure for this Step</h2></span></div>
			<p></p>
			<p>We add a new folder <code>unit</code> under the <code>test</code> folder and a
					<code>model</code> subfolder where we will place our formatter unit test.
				The folder structure matches the app structure to easily find the corresponding unit
				tests.</p>
		</section><section>
			<h2 class="title ">webapp/test/unit/model/formatter.ts (New)</h2>
			<p>We create a new <code>formatter.ts</code> file under <code>webapp/test/unit/model</code> where the unit test for the custom
				formatter is implemented. The <code>formatter</code> function that we want to test is from the <code>formatter.ts</code> file
				located in the <code>webapp/model</code> folder.</p>
			<p>The new formatter file just contains one QUnit module for our formatter function and one unit test for the formatter function. In the
				implementation of the <code>statusText</code> function that we created in Step 22, we use the translated texts when calling the
				formatter. As we do not want to test the SAPUI5 binding functionality, we
				just use text in the test instead of a <code>ResourceBundle</code>.</p>
			<p>Finally, we perform our assertions. We check each branch of the formatter logic by invoking the isolated formatter function with the
				values that we expect in the data model (<code>A</code>, <code>B</code>, <code>C</code>, and everything else). We strictly
				compare the result of the formatter function with the hard-coded strings that we expect from the resource bundle and give a meaningful
				error message if the test should fail.</p>
			<div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>
				</p><p>The test code should import the modules under test (i.e. the productive code)
					using their full namespace (in our case <code>ui5/walkthrough/</code>).
					Avoid using relative paths because the test code uses a different namespace
						(<code>test-resources/ui5/walkthrough/</code>).</p>
			<p></p></div></div>
			<section class="lang-ts"><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock"><span class="emphasis">import ResourceModel from "sap/ui/model/resource/ResourceModel";
import Controller from "sap/ui/core/mvc/Controller";
import formatter from "ui5/walkthrough/model/formatter";

QUnit.module("Formatting function", {});

QUnit.test("Should return the translated texts", (assert) =&gt; {
    const resourceModel = new ResourceModel({
        bundleUrl: sap.ui.require.toUrl("ui5/walkthrough/i18n/i18n.properties"),
        supportedLocales: [
            ""
        ],
        fallbackLocale: ""
    });

    const controllerMock = {
        getOwnerComponent() {
            return {
                getModel() {
                    return resourceModel;
                }
            };
        }
    } as any as Controller;

    // System under test
    const fnIsolatedFormatter = formatter.statusText.bind(controllerMock);

    // Assert
    assert.strictEqual(fnIsolatedFormatter("A"), "New", "The long text for status A is correct");
    assert.strictEqual(fnIsolatedFormatter("B"), "In Progress", "The long text for status B is correct");
    assert.strictEqual(fnIsolatedFormatter("C"), "Done", "The long text for status C is correct");
    assert.strictEqual(fnIsolatedFormatter("Foo"), "Foo", "The long text for status Foo is correct");
});</span></pre></div></div></section>
		</section><section id="section_hnt_54c_yfb">
			<h2 class="title ">webapp/test/unit/unitTests.qunit.ts (New)</h2>
			<p>We create a new <code>unitTests.qunit.ts</code> file under
					<code>webapp/test/unit/</code>. This module will serve as the entry point
				for all our unit tests. It will be referenced in the test suite that we will set up
				later on.</p>
			<p>Inside the <code>unitTests.qunit.ts</code> file we import the unit test for
				the custom formatter. This ensures that any tests related to the custom formatter
				functionality will be included when running our unit tests.</p>
			<section class="lang-ts"><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock"><span class="emphasis">import "./model/formatter";</span></pre></div></div></section>
		</section><section id="section_gnt_54c_yfb">
			<h2 class="title ">webapp/test/Test.qunit.html (New)</h2>
			<p>We also need a generic test page that can be used to run individual tests. It
				includes the <code>sap/ui/test/starter/runTest.js</code> script which is
				responsible for loading the test suite configuration and starting the test. Unlike
				with the UI5 bootstrap, this script only accepts the
					<code>data-sap-ui-resource-roots</code> configuration where we need to
				register our project-specific test namespace so that our modules can be loaded.</p>
			<p>The page will be referenced in the test suite that we will create next.</p>
			<section class="lang-html"><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock"><span class="emphasis">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
     &lt;meta charset="utf-8"&gt;
     &lt;script
		  src="../resources/sap/ui/test/starter/runTest.js"
		  data-sap-ui-resource-roots='{
			      "test-resources.ui5.walkthrough": "./"
		  }' 
	&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body class="sapUiBody"&gt;
     &lt;div id="qunit"&gt;&lt;/div&gt;
     &lt;div id="qunit-fixture"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</span></pre></div></div></section>
		</section><section id="section_zqh_x1x_kdc">
			<h2 class="title ">webapp/test/testsuite.qunit.ts (New)</h2>
			<p>The <code>testsuite.qunit.ts</code> file contains the configuration for our
				test suite. Although it comes with a set of defaults, we recommend specifying the
				used QUnit version to prevent potential future updates from breaking our tests.</p>
			<p>Additionally, the <code>sap_horizon</code> theme is configured in the
					<code>ui5</code> section, where you can provide the UI5 runtime
				configuration.</p>
			<p>The test suite serves as the entry point for all tests within our project such as the
				previously created <code>unit/unitTests</code> (The
					<code>.qunit.ts</code> extension is omitted and will be added
				automatically during runtime).</p>
			<p>The previously created generic <code>Test.qunit.html</code> file is
				referenced as the test <code>page</code> and configured with query parameters so
				that individual tests can be run. The placeholders <code>{suite}</code> and
					<code>{name}</code> are replaced with the suite and test names
				respectively.</p>
			<p>For more information, see <a href="topic/22f50c0f0b104bf3ba84620880793d3f" title="To apply the test starter concept to your SAPUI5 project, you need to create a test suite and a generic test page that allows for the running of one or multiple test modules." class="sap-doc">Concept and Basic Setup</a>.</p>
			<div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>
				</p><p>There are currently no types available for the test suite configuration. Please
					refer to <a href="topic/738ed025b36e484fa99046d0f80552fd" title="The UI5 test suite module contains the configuration for the UI5 test suite." class="sap-doc">Configuration Options</a> to see all
					options.</p>
			<p></p></div></div>
			<section class="lang-ts"><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">export default {
        name: "QUnit test suite for UI5 TypeScript Walkthrough",
        defaults: {
		      page: "ui5://test-resources/ui5/walkthrough/Test.qunit.html?testsuite={suite}&test={name}",
		      qunit: {
			        version: 2
		      },
		      ui5: {
			        theme: "sap_horizon"
		      },
		      loader: {
			        paths: {
				          "ui5/walkthrough": "../"
			       }
		      }
        },
        tests: {
               "unit/unitTests": {
                       title: "UI5 TypeScript Walkthrough - Unit Tests"
               }
        }
};</pre></div></div></section>
		</section><section id="section_yhs_pcx_kdc">
			<h2 class="title ">webapp/test/testsuite.qunit.html (New)</h2>
			<p>We also create a corresponding <code>testsuite.qunit.html</code> in the same
				folder. This is the page we will open in the browser to see a list of all our tests
				and run them by clicking on the test name. It registers a resource root mapping for
				the test resources of our project and references the
					<code>testsuite.qunit</code> module we created in the previous step.</p>
			<section class="lang-html"><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
	 &lt;meta charset="utf-8"&gt;
	 &lt;script
		   src="../resources/sap/ui/test/starter/createSuite.js"
		   data-sap-ui-testsuite="test-resources/ui5/walkthrough/testsuite.qunit"
		   data-sap-ui-resource-roots='{
			       "test-resources.ui5.walkthrough": "./"
		   }'
	&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div></div></section>
			<p>If we now open the <code>webapp/test/testsuite.qunit.html</code> file in the
				browser and select <code>unit/unitTests</code>, we should see our test
				running and verifying the formatter logic.</p>
		</section><section>
			<h2 class="title "> Conventions</h2>
			<ul class="ul ">
				<li class="li">
					<p>All unit tests are placed in the webapp/test/unit folder of the app.</p>
				</li>
				<li class="li">
					<p>The default naming convention for the test suite is
							<code>testsuite.qunit.html</code> and
							<code>testsuite.qunit.ts</code>. When adding additional test
						suites, the naming must follow the pattern
							<code>testsuite.&lt;name&gt;.qunit.html</code>/<code>testsuite.&lt;name&gt;.qunit.ts</code>.</p>
				</li>
				<li class="li">
					<p>All test files referenced in the test suite end with <code>.qunit.ts</code>.</p>
				</li>
				<li class="li">
					<p>A unit test should be written for formatters, controller logic, and other
						individual functionality.</p>
				</li>
				<li class="li">
					<p>All dependencies are replaced by stubs to test only the functionality in
						scope.</p>
				</li>
			</ul>
		</section><section class="contentInSection hidden"><h2>In this section:</h2></section><section class="familyLinks"><div class="parentLink"><br><strong>Parent topic: </strong><a href="topic/dad1905a07f849ce9c509721317d38d8">Walkthrough Tutorial (TypeScript)</a></div><div class="previousLink"><br><strong>Previous: </strong><a href="topic/3e1c64fd34e247afaf468a92414ed722">Step 26: Mock Server Configuration (TypeScript)</a></div><div class="nextLink"><br><strong>Next: </strong><a href="topic/412f0b6fa5af4ba191241435b92b3f2d">Step 28: Integration Test with OPA (TypeScript)</a></div></section><section class="relatedLinks "><div class="collapsible-icon sap-icon title"><h2>Related information</h2></div><ul class="fig">
		<li><a href="topic/09d145cd86ee4f8e9d08715f1b364c51" title="QUnit is a powerful, easy-to-use JavaScript unit testing framework. It is used by the jQuery, jQuery UI and jQuery Mobile projects and is capable of testing any generic JavaScript code. It supports asynchronous tests out-of-the-box." class="sap-doc">Unit Testing with QUnit</a></li>
		<li><a href="https://qunitjs.com/" title="https://qunitjs.com/" class="external-link" target="_blank" rel="noopener">QUnit Home Page</a></li>
		<li><a href="topic/291c9121e6044ab381e0b51716f97f52" title="In this tutorial we will test application functionality with the testing tools that are delivered with SAPUI5. At different steps of this tutorial you will write tests using QUnit, OPA5, and the OData V2 mock server. Additionally, you will learn about testing strategies, Test Driven Development (TDD), and much more." class="sap-doc">Testing Tutorial</a></li>
		<li><a href="topic/032be2cb2e1d4115af20862673bedcdb" title="The test starter is a concept intended to simplify the test setup for SAPUI5 applications and libraries by orchestrating your QUnit and OPA5 tests." class="sap-doc">Test Starter</a></li>
	</ul></section></div></section></div></body></html>
<html><head></head><body><div id="d4h5-main-container" class="dk-main"><section id="loioae61211b1bb744f7ab42731a37b7738c" class=" section topic"><div class="section-mdeditlink hidden">
				<a class="mdeditlink hidden" href="https://github.com/SAP-docs/sapui5/blob/main/docs/03_Get-Started/step-32-routing-back-and-history-typescript-ae61211.md">Edit on GitHub</a>
			</div><div class="collapsible-icon sap-icon innerTitle"><h2 class="title ">Step 32: Routing Back and History (TypeScript)</h2></div><div class="fig"><div class="topictitle1 title"><h2 class="title ">Step 32: Routing Back and History (TypeScript)</h2></div><div class="shortdesc">Now we can navigate to our detail page and display an invoice, but we cannot go back
		to the overview page yet. We'll add a back button to the detail page and implement a
		function that shows our overview page again.</div><section><h2 class="title ">Preview</h2>
			<div><div class="fig"><img src="loio33a8341077bb458685274c64d2317f6b_LowRes.png" title="The graphic has an explanatory text" alt="The graphic has an explanatory text" usemap="#"></div><span class="collapsible-icon sap-icon figcap title"><h2 class="title ">A back button is now displayed on the detail page</h2></span></div>

			</section><section id="section_l5n_zvm_tyb">
			<h2 class="title ">Coding</h2>
			<p>You can view all files at <a href="https://github.com/sap-samples/ui5-typescript-walkthrough/tree/main/steps/32" title="https://github.com/sap-samples/ui5-typescript-walkthrough/tree/main/steps/32" class="external-link" target="_blank" rel="noopener">OpenUI5 TypeScript Walkthrough - Step 32: Routing Back and History</a> and <a href="https://sap-samples.github.io/ui5-typescript-walkthrough/ui5-typescript-walkthrough-step-32.zip" title="https://sap-samples.github.io/ui5-typescript-walkthrough/ui5-typescript-walkthrough-step-32.zip" class="external-link" target="_blank" rel="noopener">download the solution as a zip file</a>.</p>
		</section><section id="section_nxm_dqv_4zb">
			<h2 class="title ">webapp/controller/Detail.controller.ts </h2>
			<p>To be able to navigate from the detail view back to the view we came from, we implement a new event handler function in the controller
				of the detail view.</p>
			<p>We load a new class called <code>History</code> from the <code>sap.ui.core.routing</code> namespace. This class provides methods for
				navigating through the history of the application.</p>
			<p>In the event handler we access the navigation history and try to determine the previous hash. In contrast to the browser history, we will get a
				valid result only if a navigation step inside our app has already happened. The <code>History.getInstance()</code> method returns
				a singleton instance of the "History" class. Then, we use the <code>getPreviousHash</code> method to get the hash of the previous
				page. If there's a previous page (i.e., <code>previousHash</code> isn't <code>undefined</code>), we will simply use the
				browser history to go back to the previous page.</p>
			<p>If no navigation has happened before, we get a reference to the router and use the <code>navTo</code> method to navigate to the
				"overview" route. As a second parameter we specify an empty array empty array (<code>{}</code>) as we do not pass any additional
				parameters to the route. The third parameter is set to <code>true</code>. This tells the router to replace the current history
				state with the new one since we actually do a back navigation by ourselves and don't want to have an entry in the browser history.</p>
			<section class="lang-js"><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">import Controller from "sap/ui/core/mvc/Controller";
import UIComponent from "sap/ui/core/ UIComponent";
import { Route$PatternMatchedEvent } from "sap/ui/core/routing/Route";
<span class="emphasis">import History from "sap/ui/core/routing/History";</span>

/**
 * @namespace ui5.walkthrough.controller
 */
export default class Detail extends Controller {

    onInit(): void {
        const router = UIComponent.getRouterFor(this);
        router.getRoute("detail").attachPatternMatched(this.onObjectMatched, this);
    }

    onObjectMatched(event: Route$PatternMatchedEvent): void {
        this.getView().bindElement({
            path: "/" + window.decodeURIComponent( (event.getParameter("arguments") as any).invoicePath),
            model: "invoice"
        });
    }<span class="emphasis">

    onNavBack(): void {
        const history = History.getInstance();
        const previousHash = history.getPreviousHash();

        if (previousHash !== undefined) {
            window.history.go(-1);
        } else {
            const router = UIComponent.getRouterFor(this);
            router.navTo("overview", {}, true);
        }
    }</span>
};</pre></div></div></section>
			<p>This implementation is a bit better than the browser's back button for our use case. The browser would simply go back one step in the
				history even though we were on another page outside of the app. In the app, we always want to go back to the overview page even if we
				came from another link or opened the detail page directly with a bookmark. You can try it by loading the detail page in a new tab
				directly and clicking on the back button in the app, it will still go back to the overview page.</p>
		</section><section id="section_m5n_zvm_tyb">
			<h2 class="title ">webapp/view/Detail.view.xml</h2>
			<p>Now only the back button is missing on the detail page. We do this by telling the page control on the view to display the back button
				using the control parameter <code>showNavButton</code> and register the event handler we defined in its controller to be called
				when the back button is pressed.</p>
			<section class="lang-xml"><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">&lt;mvc:View
	controllerName="ui5.walkthrough.controller.Detail"
	xmlns="sap.m"
	xmlns:mvc="sap.ui.core.mvc"&gt;
	&lt;Page
		title="{i18n&gt;detailPageTitle}"
		<span class="emphasis">showNavButton="true"
		navButtonPress=".onNavBack"&gt;</span>
		&lt;ObjectHeader
			intro="{invoice&gt;ShipperName}"
			title="{invoice&gt;ProductName}"/&gt;
	&lt;/Page&gt;
&lt;/mvc:View&gt;</pre></div></div></section>
		</section><section>
			<h2 class="title ">Conventions</h2>
			<ul class="ul ">
				<li class="li">
					<p>Add a path to go back to the parent page when the history state is
						unclear.</p>
				</li>
			</ul>
		</section><section class="contentInSection hidden"><h2>In this section:</h2></section><section class="familyLinks"><div class="parentLink"><br><strong>Parent topic: </strong><a href="topic/dad1905a07f849ce9c509721317d38d8">Walkthrough Tutorial (TypeScript)</a></div><div class="previousLink"><br><strong>Previous: </strong><a href="topic/afd5eb688b234c37a2a57e86fe729745">Step 31: Routing with Parameters (TypeScript)</a></div><div class="nextLink"><br><strong>Next: </strong><a href="topic/3cc020e232a2472c9f7fde2e99230633">Step 33: Custom Controls (TypeScript)</a></div></section><section class="relatedLinks "><div class="collapsible-icon sap-icon title"><h2>Related information</h2></div><ul class="fig">
	<li><a href="api/sap.m.routing.Router" title="api/sap.m.routing.Router" class="sap-doc" alt="api/sap.m.routing.Router">API Reference: sap.m.routing.Router</a></li>
	<li><a href="entity/sap.m.routing.Router" title="entity/sap.m.routing.Router" class="sap-doc" alt="entity/sap.m.routing.Router">Samples: sap.m.routing.Router
		</a></li>
		<li><a href="api/sap.ui.core.routing.History" title="api/sap.ui.core.routing.History" class="sap-doc" alt="api/sap.ui.core.routing.History">API Reference: sap.ui.core.routing.History</a></li>
	</ul></section></div></section></div></body></html>
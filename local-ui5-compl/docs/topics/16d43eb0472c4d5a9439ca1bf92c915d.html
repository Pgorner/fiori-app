<html><head></head><body><div id="d4h5-main-container" class="dk-main"><section id="loio16d43eb0472c4d5a9439ca1bf92c915d" class=" section topic"><div class="section-mdeditlink hidden">
				<a class="mdeditlink hidden" href="https://github.com/SAP-docs/sapui5/blob/main/docs/06_SAP_Fiori_Elements/enhancing-valuelist-annotations-for-visual-filters-16d43eb.md">Edit on GitHub</a>
			</div><div class="collapsible-icon sap-icon innerTitle"><h2 class="title ">Enhancing <code>ValueList</code>
		Annotations for Visual Filters</h2></div><div class="fig"><div class="topictitle1 title"><h2 class="title ">Enhancing <code>ValueList</code>
		Annotations for Visual Filters</h2></div><div class="shortdesc">The value list annotation lets you map an entity to another entity that is associated with a different entity set. The value list
		annotation defines the relationship between filter fields of the main entity set and the fields in the value help entity set.</div><section id="section_w1n_5tx_cqb">
			<p>You must enhance the value list annotation corresponding to a filter field with <code>"PresentationVariantQualifier"</code> as
				shown in the sample code below to ensure that the value list annotation (and therefore the filter field) is considered for the visual
				filter rendering. The value for this term
				must
				point to a <code>UI.PresentationVariant</code> that contains the <code>UI.Chart</code> annotation required to render the
				visual filter.</p>
			<div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>
				</p><p>The <code>UI.PresentationVariant</code> referred to by <code>"PresentationVariantQualifier"</code> is always associated
					with the value help entity set to which the value
					list annotation points, and
						<span class="emphasis">not</span>
					the main entity set of the analytical list page.</p>
			<p></p></div></div>
			<div class="note other samplecode "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Sample Code
				</strong></div></div><div class="fig"><p>XML
				Annotation</p><section class="collapsible"><div class="collapsible-icon sap-icon title"><strong>
						Sample Code
					</strong></div><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">&lt;Annotations Target="Z0020_CDS.Z0020Type/CountryID"&gt;
&lt;Annotation Term="Common.ValueList" Qualifier="0020_Country"&gt;
    &lt;Record&gt;
        &lt;PropertyValue Property="Label" String="Country"/&gt;
        &lt;PropertyValue Property="CollectionPath" String="Z0022"/&gt;
        &lt;PropertyValue Bool="false" Property="SearchSupported"/&gt;
        &lt;PropertyValue Property="Parameters"&gt;
            &lt;Collection&gt;
                &lt;Record Type="Common.ValueListParameterOut"&gt;
                    &lt;PropertyValue Property="LocalDataProperty" PropertyPath="CountryID"/&gt;
                    &lt;PropertyValue Property="ValueListProperty" String="CountryIdentifier"/&gt;
                &lt;/Record&gt;
                &lt;Record Type="Common.ValueListParameterIn"&gt;
                    &lt;PropertyValue Property="LocalDataProperty" PropertyPath="RegionID"/&gt;
                    &lt;PropertyValue Property="ValueListProperty" String="RegionIdentifier"/&gt;
                &lt;/Record&gt;
            &lt;/Collection&gt;
        &lt;/PropertyValue&gt;
        &lt;PropertyValue Property="PresentationVariantQualifier" String="Country_Chart"/&gt;
    &lt;/Record&gt;
&lt;/Annotation&gt;
&lt;/Annotations&gt;</pre></div></div></section><p></p></div></div>
			
			<div class="note other samplecode "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Sample Code
				</strong></div></div><div class="fig"><p>ABAP CDS Annotation</p><section class="collapsible"><div class="collapsible-icon sap-icon title"><strong>
						Sample Code
					</strong></div><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">@Consumption.valueHelpDefinition:
        [{
          entity :{
            name    : 'Z0022', //(collectionPath)
            element : 'CountryIdentifier'   // (valuelistproperty in parameterInOut)
          },
          label  : 'Country',   // valuelist label
          qualifier: '0020_Country',  //(valuelist qualifier)
           presentationVariantQualifier: 'Country_Chart'  // value list presentvariantqualifier
          }]
CountryID
</pre></div></div></section><p></p></div></div>
			<div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>
				</p><p>In ABAP CDS, <code>Common.ValueListParameterIn</code> and <code>Common.ValueListParameterOut</code> parameters cannot be
					modeled separately and only the <code>Common.ValueListParameterInOut</code> equivalent is supported.</p>
			<p></p></div></div>
			<div class="note other samplecode "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Sample Code
				</strong></div></div><div class="fig"><p>CAP CDS
				Annotation</p><section class="collapsible"><div class="collapsible-icon sap-icon title"><strong>
						Sample Code
					</strong></div><div class="fig fig-codeblock"><div class="copyButton"><span style="display: none;">Hidden</span></div><div class="codeblock-wrapper"><pre class="codeblock">CountryID @(
     Common         : {
     ValueList     #0020_Country                  : {
          Label          : 'Country',
          CollectionPath : 'Z0022',
          SearchSupported: false,
          Parameters     : [
          {
               $Type             : 'Common. ValueListParameterOut,
               LocalDataProperty : CountryID,
               ValueListProperty : 'CountryIdentifier'
          },
          {
               $Type             : 'Common.ValueListParameterIn',
               LocalDataProperty : RegionID,
               ValueListProperty : 'RegionIdentifier'
          }
          ],
          PresentationVariantQualifier: ' Country_Chart '
     }
     }
);</pre></div></div></section><p></p></div></div>
			<div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>
				</p><p>In SAP Fiori elements for OData
                            V4, the <code>"CollectionPath"</code> of the
					corresponding value list annotation must point to the result entity set in the same manner as described in
					the <a href="topic/4bd7590569c74c61a0124c6e370030f6.html#loio4bd7590569c74c61a0124c6e370030f6/suppprting_parameterized_entities_subsection" title="4bd7590569c74c61a0124c6e370030f6.xml#loio4bd7590569c74c61a0124c6e370030f6/suppprting_parameterized_entities_subsection" class="sap-doc">Supporting Parameterized
						Entities</a>
					section
					in <a href="topic/4bd7590569c74c61a0124c6e370030f6" title="You can configure filter bars in both list report applications and analytical list pages." class="sap-doc">Configuring Filter Bars</a>.</p>
			<p></p></div></div>
			
			<p>In continuation with the value list annotations given in the example in <a href="topic/4de40b31324e4876a8421f6f642e0140" title="You can use the In/Out mappings as part of the ValueList annotation for linking purposes." class="sap-doc">In/Out Mappings in the ValueList Annotation</a>, assume
				that the following visual filters have been defined:</p>
			<ul class="ul ">
				<li class="li">
					<p><code>RegionID</code> showing the top 3 regions from value help entity set Z0021 (so each bar = RegionCode from Z0021) </p>
				</li>
				<li class="li">
					<p><code>CountryID</code> showing the top 3 countries from value help entity set Z0022 (so each bar = CountryIdentifier from
						Z0022)</p>
				</li>
				<li class="li">
					<p><code>PlantID</code> showing the top 3 plants from value help entity set Z0023 (so each bar = PlantNumber from Z0023)</p>
				</li>
			</ul>
			<section>
				<h3 class="title ">Scenario 1: Selection in the Region Chart</h3>
				<p>If you select a bar in the region chart with this configuration, it then passes the <code>RegionID</code>=&lt;chosen value from
						<code>RegionCode</code> of Z0021&gt; to the filter query in the main entity set. As a result, ALP refreshes the data in
					the main content area and the other 2 charts (A <code>RegionID</code> is an IN parameter for the ValueList annotation of the
						<code>CountryID</code> and <code>PlantID</code>). The top 3 countries and plants are displayed for the chosen
					region.</p>
			</section>
			<section>
				<h3 class="title ">Scenario 2: Selection in the Region Chart and Country Chart</h3>
				<p>After selecting the region chart, if you select a bar in the country chart then it passes the <code>CountryID</code>=&lt;chosen
					value from <code>CountryIdentifier</code> of Z0022&gt; to the filter query in the main entity set. As a result, the ALP
					refreshes data in the main content area and the third chart (A <code>CountryID</code> is an IN parameter only for "PlantID").
					Plants within the chosen region and country are displayed.</p>
			</section>
			<section>
				<h3 class="title ">Scenario 3: Selection in the Plant Chart</h3>
				<p><code>PlantID</code> is an IN parameter used only for the <code>RegionID</code>. This means that along with the main
					content area only the first chart is refreshed and displays the top three countries for the chosen plant. </p>
				
				<div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>
					</p><ul class="ul ">
						<li class="li">
							<p>The IN mapping defined for a field is ignored when the same field has a <code>ValueList</code> annotation defined
								for it. For example, when <code>PlantID</code> is the IN mapping for the <code>ValueList </code>of the
									<code>PlantID</code>. However, the existing mapping values of the <code>PlantID</code> in the filter query
								would have no impact on a visual filter. The ignored value is considered for the main filter query and shows up in the
								visual filter Selected button.</p>
						</li>
						<li class="li">
							<p>Mandatory filter field values are passed automatically to the visual filter query only if the valuehelp entity of the
								visual filter is same as the main entity. Otherwise, the application developer must explicitly define the IN mapping
								to ensure that the values are passed. </p>
						</li>
					</ul>
				<p></p></div></div>
				
				<div class="note   "><div class="collapsible-icon sap-icon"><div class="title"><strong>
					Note
				</strong></div></div><div class="fig"><p>The ALP ignores the <code>UI.Hidden</code> fields when you select filters if the IN mapping points to a field marked with
						<code>UI.Hidden</code> in the value
					list entity set. For example, the <code>Status_ID</code> from the main entity set points to
						<code>StatusCode</code> in the value help entity set (of the visual filter). If the <code>StatusCode</code> is marked
					as <code>UI.Hidden</code>, then the incoming value is ignored.</p></div></div>
			</section>
		</section><section class="contentInSection hidden"><h2>In this section:</h2></section><section class="familyLinks"><div class="parentLink hidden"><br><strong>Parent topic: </strong></div><div class="previousLink hidden"><br><strong>Previous: </strong></div><div class="nextLink hidden"><br><strong>Next: </strong></div></section><section class="relatedLinks "><div class="collapsible-icon sap-icon title"><h2>Related information</h2></div><ul class="fig">
		<li><a href="topic/33f3d807c10b47d9a8141692d2619dc2" title="The visual filter bar enables end users to select filter values based on measure values in addition to the filters and filter values already selected in the regular filter bar." class="sap-doc">Configuring the Visual Filter Bar</a></li>
		<li><a href="topic/00c19e14b02c462c80566fa8b8751137" title="ALP offers compact and visual filter modes. You can choose to set filters from both modes." class="sap-doc">Choosing Filter Modes</a></li>
	</ul></section></div></section></div></body></html>
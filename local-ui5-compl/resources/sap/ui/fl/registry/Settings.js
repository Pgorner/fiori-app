/*!
 * OpenUI5
 * (c) Copyright 2009-2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/initial/_internal/Storage","sap/ui/fl/Utils","sap/base/Log"],function(e,t,n){"use strict";function r(e){if(e&&e.logonUser){return Promise.resolve(e.logonUser)}var r=t.getUshellContainer();if(r){return t.getUShellService("UserInfo").then(function(e){var t=e.getUser();return t&&t.getId()}).catch(function(e){n.error(`Error getting service from Unified Shell: ${e.message}`)})}return Promise.resolve()}var i=function(e){if(!e){throw new Error("no flex settings provided")}this._oSettings=e};i.attachEvent=function(e,t){i._oEventProvider.attachEvent(e,t)};i.detachEvent=function(e,t){i._oEventProvider.detachEvent(e,t)};i.getInstance=function(){if(i._instance){return Promise.resolve(i._instance)}if(i._oLoadSettingsPromise){return i._oLoadSettingsPromise}return i._loadSettings()};i._loadSettings=function(){var t;var o=e.loadFeatures().then(function(e){t=e;return r(t)}).then(function(e){if(!t){n.error("The request for flexibility settings failed; A default response is generated and returned to consuming APIs");t={isKeyUser:false,isKeyUserTranslationEnabled:false,isVariantSharingEnabled:false,isVariantPersonalizationEnabled:true,isAtoAvailable:false,isAtoEnabled:false,isAppVariantSaveAsEnabled:false,isContextSharingEnabled:true,isContextBasedAdaptationEnabled:false,isCondensingEnabled:false,isProductiveSystem:true,isPublicLayerAvailable:false,isLocalResetEnabled:false,isVariantAdaptationEnabled:false,isVariantAuthorNameAvailable:false,isSeenFeaturesAvailable:false,versioning:{},_bFlexChangeMode:false,_bFlexibilityAdaptationButtonAllowed:false}}t.userId=e;return i._storeInstance(t)});i._oLoadSettingsPromise=o;return o};i._storeInstance=function(e){i._instance||=new i(e);return i._instance};i.getInstanceOrUndef=function(){return i._instance};i.getDefaultLayerPermissions=function(){return{VENDOR:true,CUSTOMER_BASE:true,CUSTOMER:true,PUBLIC:false,USER:false}};i.getDeveloperModeLayerPermissions=function(){return{VENDOR:true,CUSTOMER_BASE:true,CUSTOMER:false,PUBLIC:false,USER:false}};i.prototype._getBooleanProperty=function(e){return this._oSettings[e]||false};i.prototype.isKeyUser=function(){return this._getBooleanProperty("isKeyUser")};i.prototype.isKeyUserTranslationEnabled=function(){return this._getBooleanProperty("isKeyUserTranslationEnabled")};i.prototype.isPublicLayerAvailable=function(){return this._getBooleanProperty("isPublicLayerAvailable")};i.prototype.isVariantAdaptationEnabled=function(){return this._getBooleanProperty("isVariantAdaptationEnabled")};i.prototype.isAppVariantSaveAsEnabled=function(){return!this.isContextBasedAdaptationEnabled()&&this._getBooleanProperty("isAppVariantSaveAsEnabled")};i.prototype.isContextBasedAdaptationEnabled=function(){var e=new URLSearchParams(window.location.search);var t=e.get("sap-ui-xx-rta-adaptations");return t==="true"||this._getBooleanProperty("isContextBasedAdaptationEnabled")};i.prototype.isVersioningEnabled=function(e){return!!(this._oSettings.versioning[e]||this._oSettings.versioning.ALL)};i.prototype.isModelS=function(){return this._getBooleanProperty("isAtoAvailable")};i.prototype.isAtoEnabled=function(){return this._getBooleanProperty("isAtoEnabled")};i.prototype.isAtoAvailable=function(){return this._getBooleanProperty("isAtoAvailable")};i.prototype.isProductiveSystem=function(){return this._getBooleanProperty("isProductiveSystem")};i.prototype.isVariantSharingEnabled=function(){return this._getBooleanProperty("isVariantSharingEnabled")};i.prototype.isPublicFlVariantEnabled=function(){return this._getBooleanProperty("isPublicFlVariantEnabled")};i.prototype.isContextSharingEnabled=function(){return this._getBooleanProperty("isContextSharingEnabled")};i.prototype.isVariantPersonalizationEnabled=function(){return this._getBooleanProperty("isVariantPersonalizationEnabled")};i.prototype.isVariantAuthorNameAvailable=function(){return this._getBooleanProperty("isVariantAuthorNameAvailable")};i.prototype.isCondensingEnabled=function(){return this._getBooleanProperty("isCondensingEnabled")};i.prototype.hasPersoConnector=function(){return this._getBooleanProperty("hasPersoConnector")};i.prototype.isSystemWithTransports=function(){return!!(this._oSettings.system&&this._oSettings.client)};i.prototype.isPublishAvailable=function(){return!!this._oSettings.isPublishAvailable};i.prototype.isProductiveSystemWithTransports=function(){return this.isProductiveSystem()&&this.isSystemWithTransports()};i.prototype.isLocalResetEnabled=function(){return this._getBooleanProperty("isLocalResetEnabled")};i.prototype.isSeenFeaturesAvailable=function(){return this._getBooleanProperty("isSeenFeaturesAvailable")};i.prototype.getSystem=function(){return this._oSettings.system};i.prototype.getClient=function(){return this._oSettings.client};i.prototype._getHostname=function(){return document.location.hostname};i.prototype.isCustomerSystem=function(){var e=this._oSettings.systemType;var t={CUSTOMER:true,SAP:false}[e];var n=this._getHostname();return t!==undefined?t:!(n==="localhost"||n==="127.0.0.1")};i.prototype.getUserId=function(){return this._oSettings.userId};return i},true);
//# sourceMappingURL=Settings.js.map
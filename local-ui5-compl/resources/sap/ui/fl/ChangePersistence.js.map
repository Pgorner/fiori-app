{"version":3,"file":"ChangePersistence.js","names":["sap","ui","define","Log","CompVariant","States","DependencyHandler","FlexObjectState","FlexState","Version","Settings","Condenser","FlexObjectManager","Storage","Layer","LayerUtils","ChangePersistence","mComponent","this","_mComponent","name","error","Error","_oMessagebundle","undefined","prototype","_deleteNotSavedChanges","aChanges","aCondensedChanges","bAlreadyDeletedViaCondense","filter","oChange","some","oCondensedChange","getId","forEach","removeChange","updateStorageResponse","flexObject","convertToFileContent","type","deleteFlexObjects","reference","flexObjects","bind","checkIfOnlyOne","sFunctionName","aProperties","map","aUniqueProperties","sValue","iIndex","indexOf","length","canGivenChangesBeCondensed","oAppComponent","bCondenseAnyLayer","bCondenserEnabled","sLayer","getLayer","CUSTOMER","USER","includes","oUriParameters","URLSearchParams","window","location","search","has","get","isBackendCondensingEnabled","getInstanceOrUndef","isCondensingEnabled","updateCacheAndDeleteUnsavedChanges","aAllChanges","bSkipUpdateCache","_massUpdateCacheAndDirtyState","getAllRelevantChangesForCondensing","aDirtyChanges","aDraftFilenames","aPersistedAndSameLayerChanges","getFlexObjectsDataSelector","getState","LifecycleState","PERSISTED","compareAgainstCurrentLayer","concat","checkLayerAndSingleTransportRequest","aRequests","getRequests","bCheckLayer","hasPersoConnector","aLayers","getLayers","executeWriteAndRemoveCalls","sCurrentLayer","sRequest","sParentVersion","pRemoveCallsPromise","Promise","resolve","aDeletedChanges","DELETED","aNewChanges","saveSequenceOfDirtyChanges","then","write","layer","prepareDirtyChanges","transport","isLegacyVariant","parentVersion","oResponse","call","saveDirtyChanges","getDirtyFlexObjects","aRelevantChangesForCondensing","bIsCondensingEnabled","aAllFlexObjects","aChangesClone","slice","oCondensedChangesPromise","condense","allChanges","condensedChanges","async","oFirstNewChange","NEW","shift","oCollectedResponse","response","oDirtyChange","performSingleSaveAction","_updateCacheAndDirtyState","push","checkUpdate","oFirstChange","Number","Draft","getRequest","remove","UPDATED","setState","removeDirtyFlexObjects","_deleteChangeInMap","bRunTimeCreatedChange","sChangeKey","removeChangeFromMap","getLiveDependencyMap","removeChangeFromDependencies"],"sources":["ChangePersistence-dbg.js"],"mappings":"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","ignoreList":[]}
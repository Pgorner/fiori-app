/*!
 * OpenUI5
 * (c) Copyright 2009-2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/ManagedObject","sap/ui/core/Fragment","sap/ui/fl/apply/api/FlexRuntimeInfoAPI","sap/ui/fl/write/api/PersistenceWriteAPI","sap/ui/model/json/JSONModel","sap/ui/model/resource/ResourceModel","sap/ui/rta/plugin/annotations/AnnotationChangeDialogController"],function(t,o,e,n,i,a,r){"use strict";const s=t.extend("sap.ui.rta.plugin.annotations.AnnotationChangeDialog");s.prototype._createDialog=async function(){this._oController=new r;const t=await o.load({name:"sap.ui.rta.plugin.annotations.AnnotationChangeDialog",controller:this._oController});this.oChangeAnnotationModel=new i;t.setModel(this.oChangeAnnotationModel);const e=new a({bundleName:"sap.ui.rta.messagebundle"});t.setModel(e,"i18n");return t};s.prototype._openDialog=function(){this._oPopover.open();return this._oController.initialize()};s.prototype.openDialogAndHandleChanges=async function(t){const{title:o,type:e,delegate:i,control:a,annotation:r,description:s=""}=t;const{serviceUrl:l,properties:p,possibleValues:c,preSelectedProperty:u}=i.getAnnotationsChangeInfo(a,r);const h=n._getAnnotationChanges({control:a});const d=h.map(t=>t.getContent().annotationPath);this._oPopover||=await this._createDialog();const g={};p.forEach(({annotationPath:t,currentValue:o})=>{g[t]=o});const f=u?p.find(t=>t.annotationPath===u).propertyName:"";this.oChangeAnnotationModel.setData({title:o,description:s,properties:p,changedProperties:p.filter(({annotationPath:t})=>d.includes(t)),propertiesToDisplay:p,showChangedPropertiesOnly:false,filterText:f,possibleValues:c,valueType:e});if(f){this._oController.filterProperties(f)}const y=await this._openDialog();this._oPopover.close();return Object.entries(y).map(([t,o])=>{if(g[t]===o){return null}return{serviceUrl:l,content:{annotationPath:t,value:o}}}).filter(Boolean)};s.prototype.destroy=function(...o){t.prototype.destroy.apply(this,o);if(this._oPopover){this._oPopover.destroy()}if(this._oController){this._oController.destroy()}};return s});
//# sourceMappingURL=AnnotationChangeDialog.js.map
/*!
 * OpenUI5
 * (c) Copyright 2009-2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/ui/dt/Util","sap/ui/rta/plugin/annotations/AnnotationChangeDialog","sap/ui/rta/plugin/Plugin"],function(t,n,e,i){"use strict";async function o(t,n,e){const i=await this.getCommandFactory().getCommandFor(t,"composite");for(const o of e){const e=await this.getCommandFactory().getCommandFor(t,"annotation",{changeType:n.changeType,serviceUrl:o.serviceUrl,content:o.content});i.addCommand(e)}if(i.getCommands().length>0){this.fireElementModified({command:i,hasAnnotationCommand:true})}}function a(n,e){const i=e.title;const o=n.getElement();if(i){if(typeof i==="function"){return i(o)}const t=n.getDesignTimeMetadata()?.getLibraryText(o,i);if(t){return t}}t.error("Annotation action title is not properly defined in the designtime metadata");return undefined}function s(n){const e="sap-icon://request";const i=n.icon;if(!i){return e}if(typeof i!=="string"){t.error("Icon setting for annotation action should be a string");return e}return i}const r=i.extend("sap.ui.rta.plugin.annotations.AnnotationPlugin",{metadata:{library:"sap.ui.rta",associations:{},events:{}}});const c="CTX_ANNOTATION";r.prototype.init=function(...t){i.prototype.init.apply(this,t);this._oDialog=new e};r.prototype._isEditable=function(t){const n=this.getAction(t);if(n){return Object.values(n).some(t=>t.changeType)}return false};r.prototype.isEnabled=function(t){const n=t[0];const e=this.getResponsibleElementOverlay(n);const i=this.getAction(e);if(i){return Object.values(i).some(t=>{if(typeof t.isEnabled!=="undefined"){if(typeof t.isEnabled==="function"){return t.isEnabled(e.getElement())}return t.isEnabled}return true})}return false};r.prototype.handler=async function(t,e){const i=t[0];const s=i.getElement();try{const t=await this._oDialog.openDialogAndHandleChanges({title:a(i,e),type:e.type,control:s,delegate:e.delegate,annotation:e.annotation,description:e.description});if(t.length>0){return o.call(this,s,e,t)}return undefined}catch(t){throw n.propagateError(t,"AnnotationPlugin#handler","Error occurred during handler execution","sap.ui.rta.plugin.annotations.annotationplugin")}};r.prototype.getMenuItems=async function(t){const n=t[0];const e=this.getResponsibleElementOverlay(n);const i=this.getAction(e);const o=[];if(i){const n=this.getRank(c);if(this._isEditableByPlugin(e)===undefined){await this.evaluateEditable([e],{onRegistration:false})}Object.values(i).forEach(function(i,r){if(this.isAvailable([e])){const l=a(e,i);if(!l){return}o.push({id:c+r,rank:n+r,text:l,icon:s(i),enabled:typeof i.isEnabled==="function"&&i.isEnabled(t[0].getElement())||i.isEnabled!==false&&this.isEnabled(t),handler:this.handler.bind(this,t,i)})}},this)}return o};r.prototype.getActionName=function(){return"annotation"};return r});
//# sourceMappingURL=AnnotationPlugin.js.map
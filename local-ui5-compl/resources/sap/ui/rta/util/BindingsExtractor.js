/*!
 * OpenUI5
 * (c) Copyright 2009-2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/dt/ElementUtil","sap/ui/dt/OverlayRegistry","sap/base/util/isPlainObject","sap/base/util/restricted/_uniqWith","sap/base/util/deepEqual"],function(t,e,n,a,i){"use strict";var r={};r.collectBindingPaths=function(e,a,i,g){var o={bindingPaths:[],bindingContextPaths:[]};var d=e.sParentAggregationName;var l=e.getParent();var s=r.getBindings({element:e,model:a,relevantContainerElement:i,parent:l,depth:g});if(l){var u=l.getMetadata().getAggregation();if(u){var f=t.getAggregation(l,d).indexOf(e);var p=u.name;var v=l.getBindingInfo(p);var c=v&&v.template;if(c){var m=c.getMetadata().getAggregation();if(m){var h=m.name;var P=t.getAggregation(c,h)[f];s=s.concat(r.getBindings({model:a,element:P,template:true,relevantContainerElement:i,parent:l,depth:g}))}}}}for(var B=0,b=s.length;B<b;B++){if(s[B].getPath){var C=s[B].getPath();if(C&&o.bindingPaths.indexOf(C)===-1){o.bindingPaths.push(C)}}if(s[B].getContext&&s[B].getContext()&&s[B].getContext().getPath){var M=s[B].getContext().getPath();if(M&&o.bindingContextPaths.indexOf(M)===-1){o.bindingContextPaths.push(M)}}if(n(s[B])){var x=s[B].parts[0]&&s[B].parts[0].path;if(x&&o.bindingPaths.indexOf(x)===-1){o.bindingPaths.push(x)}}}return o};function g(t,n){if(n&&t!==n){var a=e.getOverlay(t);var i=a&&(a.getRelevantContainer()||a.getElement());return i?i.getId()===n.getId():true}return true}r.getBindings=function(t){var e=t.element;var n=t.model;var d=t.parent;var s=t.aggregationName;var u=t.relevantContainerElement;var f=[];if(g(e,u)){f=t.template?l(e,d,n):r.getBindingsFromProperties(e,n)}var p=s?[s]:Object.keys(e.getMetadata().getAllAggregations());if(!Number.isInteger(t.depth)||t.depth>0){p.forEach(function(a){f=f.concat(o(e,n,t.template,a,u,t.depth&&t.depth-1))})}return a(f,i)};function o(e,n,a,i,o,d){var s=[];var u=[];var f;var p=a;var v=e.getModel();var c=e.getBindingInfo(i);f=c&&c.template;if(f&&v&&v!==n){return[]}if(f){p=true;u=[f]}else{u=t.getAggregation(e,i)}u.forEach(function(t){if(t.getMetadata){if(g(e,o)){s=s.concat(p?l(t,e,n):r.getBindingsFromProperties(t,n))}s=s.concat(r.getBindings({element:t,model:n,template:p,relevantContainerElement:o,parent:e,depth:d}))}});return s}r.filterAndFlattenBindings=function(t,e){var n=[];var a=t.getMetadata().getName();if(a==="sap.ui.model.CompositeBinding"){t.getBindings().forEach(function(t){n=n.concat(r.filterAndFlattenBindings(t,e))})}else if((a==="sap.ui.model.odata.ODataPropertyBinding"||a==="sap.ui.model.odata.v2.ODataPropertyBinding"||a==="sap.ui.model.odata.v4.ODataPropertyBinding"||a==="sap.ui.model.json.JSONPropertyBinding"||a==="sap.ui.model.json.XMLPropertyBinding"||a==="sap.ui.model.resource.ResourcePropertyBinding")&&t.getModel()===e&&t.isRelative()&&typeof t.getPath==="function"&&t.getPath()){n.push(t)}return n};function d(t){var e=[];var n=t.parts;n.forEach(function(t){e.push({parts:[t]})});return e}r.getBindingsFromProperties=function(t,e){var n=Object.keys(t.getMetadata().getAllProperties());return n.filter(t.getBinding.bind(t)).reduce(function(n,a){return n.concat(r.filterAndFlattenBindings(t.getBinding(a),e))},[])};function l(t,e,n){var a=Object.keys(t.getMetadata().getAllProperties());var i;return a.filter(function(a){var r=t.mBindingInfos[a];var g=r&&r.parts[0]&&r.parts[0].model;i=n===e.getModel(g);if(!g){var o=e.getDefaultModel?e.getDefaultModel():null;var d=t.getDefaultModel?t.getDefaultModel():null;i=o===d}else{i=n===e.getModel(g)}return r&&i}).reduce(function(e,n){return e.concat(d(t.mBindingInfos[n]))},[])}r.getBindingContextPath=function(t){if(t.getBindingContext()&&t.getBindingContext().getPath){return t.getBindingContext().getPath()}return undefined};return r},true);
//# sourceMappingURL=BindingsExtractor.js.map
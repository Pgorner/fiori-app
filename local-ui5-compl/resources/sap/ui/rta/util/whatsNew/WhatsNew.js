/*!
 * OpenUI5
 * (c) Copyright 2009-2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/library","sap/ui/base/ManagedObject","sap/ui/core/Element","sap/ui/core/Fragment","sap/ui/fl/write/api/FeaturesAPI","sap/ui/model/json/JSONModel","sap/ui/model/resource/ResourceModel","sap/ui/rta/util/ReloadManager","sap/ui/rta/util/whatsNew/WhatsNewUtils"],function(e,t,a,s,o,i,n,r,l){"use strict";const h=e.URLHelper;const u=t.extend("sap.ui.rta.util.whatsNew.WhatsNew",{metadata:{properties:{dontShowAgainFeatureIds:{type:"array",defaultValue:[]},layer:{type:"string",defaultValue:""}},aggregations:{whatsNewDialog:{type:"sap.m.Dialog",multiple:false}}}});u.prototype.setDontShowAgainFeatureIds=async function(e){this.setProperty("dontShowAgainFeatureIds",e);this.aUnseenFeatures=await l.getFilteredFeatures(e,this.getLayer())};u.prototype.initializeWhatsNewDialog=async function(){const e=await o.getSeenFeatureIds({layer:this.getLayer()});await this.setDontShowAgainFeatureIds(e);if(this.aUnseenFeatures.length===0||this.getLayer()!=="CUSTOMER"){return}const t=new i;t.setData({featureCollection:this.aUnseenFeatures});if(!this.oWhatsNewDialog){await this.createWhatsNewDialog(t)}r.setDontShowWhatsNewAfterReload();this.oWhatsNewDialog.open()};u.prototype.createWhatsNewDialog=async function(e){const t=new n({bundleName:"sap.ui.rta.messagebundle"});this.oWhatsNewDialog=await s.load({name:"sap.ui.rta.util.whatsNew.WhatsNewDialog",controller:this});this.oWhatsNewDialog.setModel(t,"i18n");this.oWhatsNewDialog.setModel(e,"whatsNewModel")};u.prototype.closeWhatsNewDialog=function(){if(this.oWhatsNewDialog){const e=a.getElementById("whatsNewDialog_DontShowAgain");if(e.getSelected()){const e=this.aUnseenFeatures.map(e=>e.featureId);const t=[...this.getDontShowAgainFeatureIds(),...e];const a={layer:this.getLayer(),seenFeatureIds:t};o.setSeenFeatureIds(a)}this.oWhatsNewDialog.close()}};u.prototype.onLearnMorePress=function(){const e=a.getElementById("sapWhatsNewDialogCarousel").getActivePage();const t=l.getLearnMoreURL(e,this.aUnseenFeatures);h.redirect(t,true)};u.prototype.destroy=function(...e){t.prototype.destroy.apply(this,e);if(this.oWhatsNewDialog){this.oWhatsNewDialog.destroy()}};return u});
//# sourceMappingURL=WhatsNew.js.map
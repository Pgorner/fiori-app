/*!
 * OpenUI5
 * (c) Copyright 2009-2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/api/ControlVariantApplyAPI","sap/ui/fl/variants/VariantManager","sap/ui/fl/Utils","sap/ui/rta/command/BaseCommand"],function(e,t,n,a,r){"use strict";var i=r.extend("sap.ui.rta.command.ControlVariantSwitch",{metadata:{library:"sap.ui.rta",properties:{targetVariantReference:{type:"string"},sourceVariantReference:{type:"string"},discardVariantContent:{type:"boolean"},discardedChanges:{type:"array"}},associations:{},events:{}},constructor:function(...e){r.apply(this,e);this.setRelevantForSave(false)}});function o(e){return n.eraseDirtyChangesOnVariant(this.sVariantManagementReference,e,this._getAppComponent()).then(function(e){this.setDiscardedChanges(e)}.bind(this))}i.prototype._getAppComponent=function(){var e=this.getElement();return e?a.getAppComponentForControl(e):this.getSelector().appComponent};i.prototype.execute=function(){var n=this.getElement();var a=this._getAppComponent();var r=this.getTargetVariantReference();this.oModel=a.getModel(t.getVariantModelName());this.sVariantManagementReference=e.getSelector(n,a).id;return Promise.resolve().then(function(){if(this.getDiscardVariantContent()){return o.call(this,this.getSourceVariantReference())}return undefined}.bind(this)).then(this._updateModelVariant.bind(this,r,a))};i.prototype.undo=function(){var e=this.getSourceVariantReference();var t=this._getAppComponent();return this._updateModelVariant(e,t).then(function(){if(this.getDiscardVariantContent()){return n.addAndApplyChangesOnVariant(this.getDiscardedChanges(),this._getAppComponent()).then(function(){this.setDiscardedChanges([]);this.oModel.checkUpdate(true)}.bind(this))}return undefined}.bind(this))};i.prototype._updateModelVariant=function(e,t){if(this.getTargetVariantReference()!==this.getSourceVariantReference()){return this.oModel.updateCurrentVariant({variantManagementReference:this.sVariantManagementReference,newVariantReference:e,appComponent:t})}return Promise.resolve()};return i});
//# sourceMappingURL=ControlVariantSwitch.js.map
ace.define("ace/ext/code_lens",["require","exports","module","ace/line_widgets","ace/lib/event","ace/lib/lang","ace/lib/dom","ace/editor","ace/config"],function(e,n,r){"use strict";var t=e("../line_widgets").LineWidgets;var i=e("../lib/event");var o=e("../lib/lang");var a=e("../lib/dom");function s(e){var n=e.$textLayer;var r=n.$lenses;if(r)r.forEach(function(e){e.remove()});n.$lenses=null}function c(e,n){var r=e&n.CHANGE_LINES||e&n.CHANGE_FULL||e&n.CHANGE_SCROLL||e&n.CHANGE_TEXT;if(!r)return;var t=n.session;var i=n.session.lineWidgets;var o=n.$textLayer;var c=o.$lenses;if(!i){if(c)s(n);return}var l=n.$textLayer.$lines.cells;var d=n.layerConfig;var f=n.$padding;if(!c)c=o.$lenses=[];var u=0;for(var v=0;v<l.length;v++){var g=l[v].row;var p=i[g];var L=p&&p.lenses;if(!L||!L.length)continue;var h=c[u];if(!h){h=c[u]=a.buildDom(["div",{class:"ace_codeLens"}],n.container)}h.style.height=d.lineHeight+"px";u++;for(var m=0;m<L.length;m++){var C=h.childNodes[2*m];if(!C){if(m!=0)h.appendChild(a.createTextNode(" | "));C=a.buildDom(["a"],h)}C.textContent=L[m].title;C.lensCommand=L[m]}while(h.childNodes.length>2*m-1)h.lastChild.remove();var $=n.$cursorLayer.getPixelPosition({row:g,column:0},true).top-d.lineHeight*p.rowsAbove-d.offset;h.style.top=$+"px";var w=n.gutterWidth;var x=t.getLine(g).search(/\S|$/);if(x==-1)x=0;w+=x*d.characterWidth;h.style.paddingLeft=f+w+"px"}while(u<c.length)c.pop().remove()}function l(e){if(!e.lineWidgets)return;var n=e.widgetManager;e.lineWidgets.forEach(function(e){if(e&&e.lenses)n.removeLineWidget(e)})}n.setLenses=function(e,n){var r=Number.MAX_VALUE;l(e);n&&n.forEach(function(n){var t=n.start.row;var i=n.start.column;var o=e.lineWidgets&&e.lineWidgets[t];if(!o||!o.lenses){o=e.widgetManager.$registerLineWidget({rowCount:1,rowsAbove:1,row:t,column:i,lenses:[]})}o.lenses.push(n.command);if(t<r)r=t});e._emit("changeFold",{data:{start:{row:r}}});return r};function d(e){e.codeLensProviders=[];e.renderer.on("afterRender",c);if(!e.$codeLensClickHandler){e.$codeLensClickHandler=function(n){var r=n.target.lensCommand;if(!r)return;e.execCommand(r.id,r.arguments);e._emit("codeLensClick",n)};i.addListener(e.container,"click",e.$codeLensClickHandler,e)}e.$updateLenses=function(){var r=e.session;if(!r)return;if(!r.widgetManager){r.widgetManager=new t(r);r.widgetManager.attach(e)}var i=e.codeLensProviders.length;var o=[];e.codeLensProviders.forEach(function(e){e.provideCodeLenses(r,function(e,n){if(e)return;n.forEach(function(e){o.push(e)});i--;if(i==0){a()}})});function a(){var t=r.selection.cursor;var i=r.documentToScreenRow(t);var a=r.getScrollTop();var s=n.setLenses(r,o);var c=r.$undoManager&&r.$undoManager.$lastDelta;if(c&&c.action=="remove"&&c.lines.length>1)return;var l=r.documentToScreenRow(t);var d=e.renderer.layerConfig.lineHeight;var f=r.getScrollTop()+(l-i)*d;if(s==0&&a<d/4&&a>-d/4){f=-d}r.setScrollTop(f)}};var r=o.delayedCall(e.$updateLenses);e.$updateLensesOnInput=function(){r.delay(250)};e.on("input",e.$updateLensesOnInput)}function f(e){e.off("input",e.$updateLensesOnInput);e.renderer.off("afterRender",c);if(e.$codeLensClickHandler)e.container.removeEventListener("click",e.$codeLensClickHandler)}n.registerCodeLensProvider=function(e,n){e.setOption("enableCodeLens",true);e.codeLensProviders.push(n);e.$updateLensesOnInput()};n.clear=function(e){n.setLenses(e,null)};var u=e("../editor").Editor;e("../config").defineOptions(u.prototype,"editor",{enableCodeLens:{set:function(e){if(e){d(this)}else{f(this)}}}});a.importCssString("\n.ace_codeLens {\n    position: absolute;\n    color: #aaa;\n    font-size: 88%;\n    background: inherit;\n    width: 100%;\n    display: flex;\n    align-items: flex-end;\n    pointer-events: none;\n}\n.ace_codeLens > a {\n    cursor: pointer;\n    pointer-events: auto;\n}\n.ace_codeLens > a:hover {\n    color: #0000ff;\n    text-decoration: underline;\n}\n.ace_dark > .ace_codeLens > a:hover {\n    color: #4e94ce;\n}\n","codelense.css",false)});(function(){ace.require(["ace/ext/code_lens"],function(e){if(typeof module=="object"&&typeof exports=="object"&&module){module.exports=e}})})();
//# sourceMappingURL=ext-code_lens.js.map
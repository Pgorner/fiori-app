/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["./CreateParametricGizmo","../svg/Element","../svg/Text","sap/ui/richtexteditor/RichTextEditor","sap/m/Popover","sap/m/VBox","sap/m/Button","sap/m/library"],function(t,e,i,o,r,n,s,a){"use strict";const l=a.PlacementType;var h=t.extend("sap.ui.vk.tools.CreateTextToolGizmo",{metadata:{library:"sap.ui.vk"}});h.prototype.hasDomElement=function(){return true};h.prototype.show=function(t,e){this._viewport=t;this._tool=e;this._editForm=null;this.updateParentNode()};h.prototype.hide=function(){this._viewport=null;this._tool=null;this._root=null;if(this._editForm){this._editForm.close();this._editForm=null}};h.prototype._createText=function(t,o){if(this._editForm){return}var r=1/this._viewport._camera.zoom;var n=e._multiplyMatrices(e._invertMatrix(this._root._matrixWorld()),[r,0,0,r,t.x,t.y]);var s=[1,0,0,n[3]<0?-1:1,0,0];if(n[3]<0){n[2]*=-1;n[3]*=-1}var a=new i({subelement:true,text:o,style:{size:this._tool.getFontSize(),fontFace:this._tool.getFontFace()},matrix:s,lineStyle:this._tool._lineStyle,fillStyle:this._tool._fillStyle});var l=new e({name:"Text",matrix:n});l.add(a);this._root.add(l);this._editText(a)};h.prototype._editText=function(t){var i=this.getDomRef();if(!i){this._editElementWhenReady=t;return}var a=e._transformPoint(t.x,t.y,t._matrixWorld());var h=this._viewport._camera._worldToScreen(a.x,a.y);i.style.left=h.x+"px";i.style.top=h.y+"px";var p=this._editForm=new r({showHeader:false,placement:l.PreferredLeftOrFlip,content:new n({items:[new o({width:"500px",height:"200px",wrapping:false,customToolbar:true,showGroupUndo:true,showGroupFont:true,showGroupTextAlign:false,value:t.getHtmlTextContent(),change:function(e){t.setHtmlTextContent(this.getValue())},customButtons:[new s({text:"OK",press:function(){p.close()}})]}).addStyleClass("sapUiSizeCompact"),new s({text:"OK",press:function(){p.close()}})]})});p.attachAfterClose(function(){this._tool.fireCompleted({node:t.parent,request:this._createRequest(t.parent)});this._editForm=null}.bind(this));p.openBy(this)};h.prototype.onAfterRendering=function(){if(this._editElementWhenReady){this._editText(this._editElementWhenReady);this._editElementWhenReady=null}};return h});
//# sourceMappingURL=CreateTextToolGizmo.js.map
{"version":3,"file":"Spreadsheet.js","names":["sap","ui","define","Library","ExportBase","ExportDialog","ExportUtils","SpreadsheetExport","Log","Formatting","Device","CLASS_NAME","Status","Spreadsheet","extend","constructor","mSettings","call","this","_mSettings","customizing","showProgress","worker","forEach","sProperty","bind","codeListsPromise","Promise","resolve","addUnit","sCurrencyCode","oCurrency","mCurrencies","Object","isNaN","digits","scale","UnitSpecificScale","prototype","setDefaultExportSettings","async","mParameters","oResourceBundle","getResourceBundle","timezone","getTimezoneTranslations","oWorkbookContext","workbook","context","title","getText","sheetName","mCurrencySettings","currency","mUnitSettings","unit","oCustomCurrencies","getCustomCurrencies","sUnitCode","mCurrencyCodes","mUnitsOfMeasure","requestCodeLists","oMetaModel","isA","all","requestCurrencyCodes","requestUnitsOfMeasure","catch","oError","warning","attachBeforeSave","oData","fnHandler","oListener","attachEvent","detachBeforeSave","detachEvent","cancel","process","getMimeType","onprogress","iFetched","iTotal","iProgress","Math","round","debug","createDataSourceFromBinding","oBinding","oDataSource","aData","getAllCurrentContexts","oContext","push","getObject","data","type","error","getMetadata","getName","getDownloadUrl","oModel","getModel","bV4ODataModel","sDataUrl","sServiceUrl","interceptUrl","bIgnoreCount","split","some","sQuery","includes","dataUrl","serviceUrl","headers","getHttpHeaders","getHeaders","count","undefined","getCountFromBinding","useBatch","bUseBatch","getMetaModel","processDataSource","sDataSourceType","mDataSource","Array","createBuildPromise","that","fnResolve","fnReject","progressDialog","MAX_ROWS","iCount","dataSource","iDownloadLimit","downloadLimit","nSizeLimit","system","desktop","nRows","length","nColumns","columns","onmessage","oMessage","progress","updateStatus","fetched","total","finished","spreadsheet","executeDefaultAction","fireEvent","exportDialog","window","setTimeout","finish","saveAsFile","Blob","fileName","announceExportStatus","FINISHED","assertive","sError","message","showErrorMessage","isDownloadLimitLessThanCount","startExport","execute","getProgressDialog","then","oDialogResolve","oncancel","open","min","oDialogSettings","rows","cellLimit","rowLimit","fileType","FileType","XLSX","showWarningDialog"],"sources":["Spreadsheet-dbg.js"],"mappings":"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","ignoreList":[]}
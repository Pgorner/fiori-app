{"version":3,"file":"ExportHandler.js","names":["sap","ui","define","library","ExportUtils","ExportDialog","PDFCapabilities","Log","MessageToast","EventProvider","ODataModel","openWindow","Destination","FileType","ExportHandler","extend","constructor","mCapabilities","that","this","call","_mCapabilities","Object","XLSX","PDF","oCapabilities","isA","isValid","_initialized","Promise","fnResolve","isGoogleSheetSupported","then","bSupported","GSHEET","_mDialogSettings","destination","REMOTE","fileType","finally","prototype","attachBeforeExport","oData","fnHandler","oListener","attachEvent","detachBeforeExport","detachEvent","initialized","destroy","apply","arguments","_oExportDialog","_oFilePicker","_oFileShareBinding","_oModel","_oDataSource","bIsDestroyed","getFileShareContexts","async","oModel","getFileShareModel","resolve","bindList","requestContexts","oError","error","message","getRemoteFileLocation","sFileName","oResourceBundle","CloudFilePicker","all","getResourceBundle","loadClass","oFilePicker","sharedModel","suggestedFileName","enableDuplicateCheck","fileNameMandatory","confirmButtonText","getText","title","fnReject","attachSelect","oEvent","aSelectedFiles","getParameter","oSelectedFolder","bReplaceFile","mCloudFileInfo","FileShare","getFileShareId","FileShareItemKind","FileShareItemName","ParentFileShareItem","getFileShareItemId","Array","isArray","length","oCloudFile","shift","FileShareItem","open","getExportInstance","mExportSettings","mCustomSettings","oExportInstance","aFilters","oFilterConfig","name","items","includeFilterSettings","oContext","workbook","context","metainfo","getFilters","dataSource","metaSheetName","push","bExecuteDefaultAction","fireEvent","exportSettings","userExportSettings","filterSettings","preventDefault","filter","oFilter","sort","firstElement","secondElement","sFirst","getLabel","toLowerCase","sSecond","forEach","key","value","getValue","attachBeforeSave","aArrayBuffer","oExportDialog","FileShareItemContentType","getMimeType","FileShareItemConvertToMimeType","uInt8Array","Uint8Array","stringArray","i","String","fromCharCode","FileShareItemContent","btoa","join","updateStatus","uploadFile","show","catch","showErrorMessage","finish","sUrl","sContentProperty","sTypeProperty","getKeepAliveContext","setProperty","getProperty","sPath","oBinding","_createFile","fnCreateCompleted","success","bSuccess","getParameters","detachCreateCompleted","attachCreateCompleted","create","export","reject","build","exportAs","oSettings","fnResolveColumnLabel","Error","assign","aContexts","mDialogSettings","getExportSettingsViaDialog","oDialog","validateFileSettings","mUserSettings","splitCells","columns","splitColumns","oUserConfig","parseTechnicalConfiguration","fileName","validateFileName","validateFileShare","aResolve","oFileShareContext","find","isGoogleWorkspace","oDataSource","fetchDataSource","serviceUrl","uri","autoExpandSelect","some","sVendorType","sDescription","indexOf"],"sources":["ExportHandler-dbg.js"],"mappings":"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","ignoreList":[]}
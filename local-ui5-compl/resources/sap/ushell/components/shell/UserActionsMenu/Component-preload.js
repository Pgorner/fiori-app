//@ui5-bundle sap/ushell/components/shell/UserActionsMenu/Component-preload.js
// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.predefine("sap/ushell/components/shell/UserActionsMenu/Component", ["sap/ui/core/EventBus","sap/ui/core/UIComponent","sap/ushell/components/shell/UserActionsMenu/UserActionsMenu.controller"],function(e,n,s){"use strict";return n.extend("sap.ushell.components.shell.UserActionsMenu.Component",{metadata:{version:"1.132.1",library:"sap.ushell",dependencies:{libs:["sap.m"]}},createContent:function(){this._bIsUserActionsMenuCreated=false;this.oUserActionsMenuController=new s;this.oUserActionsMenuController.onInit();e.getInstance().publish("shell","userActionsMenuCompLoaded",{delay:0})},exit:function(){this.oUserActionsMenuController.onExit()}})});
// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.predefine("sap/ushell/components/shell/UserActionsMenu/UserActionsMenu.controller", ["sap/base/Log","sap/m/library","sap/m/StandardListItem","sap/ui/core/Element","sap/ui/core/ElementMetadata","sap/ui/core/Fragment","sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/performance/Measurement","sap/ushell/Config","sap/ushell/Container","sap/ushell/EventHub","sap/ushell/resources","sap/ushell/ui/footerbar/AboutButton","sap/ushell/ui/footerbar/ContactSupportButton","sap/ushell/ui/launchpad/ActionItem","sap/ushell/ui/QuickAccess","sap/ushell/state/ShellModel","sap/ushell/state/StateManager"],function(e,t,n,o,i,s,r,a,l,c,u,d,g,p,h,f,A,v,m){"use strict";const B=t.ListType;const _=t.ButtonType;const y=m.Operation;return r.extend("sap.ushell.components.shell.UserActionsMenu.UserActionsMenu",{_aDanglingControl:[],_aDoables:[],onInit:function(){var e=this.getShellConfig();this._createActionButtons(e);var t=u.getUser();this.oModel=new a({userName:t.getFullName()||t.getId()});this._aDoables.push(d.on("showUserActionsMenu").do(function(e){var t=o.getElementById("sapUshellUserActionsMenuPopover");if(t&&t.isOpen()||!e){this._toggleUserActionsMenuPopover(false)}else{this._toggleUserActionsMenuPopover(true)}}.bind(this)))},onExit:function(){this._destroyDanglingControls();this._aDoables.forEach(function(e){e.off()});this._aDanglingControl=[];this._aDoables=[];var e=o.getElementById("sapUshellUserActionsMenuPopover");if(e){e.destroy()}},filterUserActions:function(t){if(!o.getElementById(t)){e.debug("Could not render ActionItem because it was not created: "+t);return false}return true},getModel:function(){return this.oModel},_createActionButtons:function(e){var t=c.last("/core/extension/enableHelp");var n=c.last("/core/shell/enableAbout");if(n){this._createAboutButton(t)}if(!e.moveAppFinderActionToShellHeader&&c.last("/core/catalog/enabled")){this._createAppFinderButton(e,t)}if(!e.moveUserSettingsActionToShellHeader){this._createSettingsButton(t)}if(!e.moveContactSupportActionToShellHeader){this._createSupportTicketButton(t)}if(e.enableRecentActivity&&c.last("/core/shell/model/showRecentActivity")){this._createRecentActivitiesButton();this._createFrequentActivitiesButton()}if(!e.disableSignOut){this._createLogoutButton()}},_createAppFinderButton:function(e,t){if(o.getElementById("openCatalogBtn")){return}var n=new f("openCatalogBtn",{text:g.i18n.getText("open_appFinderBtn"),icon:"sap-icon://sys-find",visible:!e.disableAppFinder,actionType:"action",press:function(){l.start("FLP:AppFinderLoadingStartToEnd","AppFinderLoadingStartToEnd","FLP");u.getServiceAsync("Navigation").then(function(e){e.navigate({target:{semanticObject:"Shell",action:"appfinder"}})})}});if(t){n.addStyleClass("help-id-openCatalogActionItem")}this._addDanglingControl(n);m.updateAllBaseStates("userActions.items",y.Add,n.getId())},_createAboutButton:function(e){var t="aboutBtn";if(!o.getElementById(t)){var n=new p(t);if(e){n.addStyleClass("help-id-"+t)}this._addDanglingControl(n);this.getRenderer().showActionButton(t,false)}},_createSettingsButton:function(e){var t="userSettingsBtn";if(!o.getElementById(t)){var n=new f(t,{tooltip:g.i18n.getText("ControlKey")+" + "+g.i18n.getText("CommaKey"),text:g.i18n.getText("userSettings"),icon:"sap-icon://action-settings",press:function(){d.emit("openUserSettings",Date.now())}});if(e){n.addStyleClass("help-id-loginDetails")}this._addDanglingControl(n)}m.updateAllBaseStates("userActions.items",y.Add,t)},_createSupportTicketButton:function(e){c.on("/core/extension/SupportTicket").do(function(t){var n="ContactSupportBtn";var i=o.getElementById(n);if(t&&!i){i=new h(n);this._addDanglingControl(i);if(e){i.addStyleClass("help-id-contactSupportBtn")}}if(t){this.getRenderer().showActionButton(n)}else{this.getRenderer().hideActionButton(n)}}.bind(this))},_createRecentActivitiesButton:function(){var e="recentActivitiesBtn";c.on("/core/shell/model/enableTrackingActivity").do(function(t){if(t){var n=o.getElementById(e);if(!n){n=new f(e,{text:g.i18n.getText("recentActivities"),icon:"sap-icon://customer-history",press:function(){A.openQuickAccessDialog("recentActivityFilter","userActionsMenuHeaderButton")}});this._addDanglingControl(n)}this.getRenderer().showActionButton(e,false)}else{this.getRenderer().hideActionButton(e,false)}}.bind(this))},_createFrequentActivitiesButton:function(){var e="frequentActivitiesBtn";c.on("/core/shell/model/enableTrackingActivity").do(function(t){if(t){var n=o.getElementById(e);if(!n){n=new f(e,{text:g.i18n.getText("frequentActivities"),icon:"sap-icon://activity-individual",tooltip:g.i18n.getText("frequentActivitiesTooltip"),press:function(){A.openQuickAccessDialog("frequentlyUsedFilter","userActionsMenuHeaderButton")}});this._addDanglingControl(n)}this.getRenderer().showActionButton(e,false)}else{this.getRenderer().hideActionButton(e,false)}}.bind(this))},_createLogoutButton:function(){var e="logoutBtn";if(o.getElementById(e)){return}var t=new f(e,{visible:true,type:_.Transparent,icon:"sap-icon://log",text:g.i18n.getText("signoutBtn_title"),press:this.logout});this._addDanglingControl(t);this.getRenderer().showActionButton(e,false)},logout:function(){sap.ui.require(["sap/m/MessageBox","sap/ushell/ui/launchpad/LoadingDialog"],function(e,t){var n=new t({text:""});var o=true;var s=false;var r={};u.getGlobalDirty().done(function(a){o=false;if(s===true){n.exit();n=new t({text:""})}var l=function(){var t=g.i18n;if(a===u.DirtyState.DIRTY){r.message=t.getText("unsaved_data_warning_popup_message");r.icon=e.Icon.WARNING;r.messageTitle=t.getText("unsaved_data_warning_popup_title")}else{r.message=t.getText("signoutConfirmationMsg");r.icon=e.Icon.QUESTION;r.messageTitle=t.getText("signoutMsgTitle")}return r};r=l(a);e.show(r.message,r.icon,r.messageTitle,[e.Action.OK,e.Action.CANCEL],function(t){if(t===e.Action.OK){n.openLoadingScreen();n.showAppInfo(g.i18n.getText("beforeLogoutMsg"),null);u.defaultLogout()}},i.uid("confirm"))});if(o===true){n.openLoadingScreen();s=true}})},_addDanglingControl:function(e){this._aDanglingControl.push(e)},_destroyDanglingControls:function(){if(this._aDanglingControl){this._aDanglingControl.forEach(function(e){if(e.destroyContent){e.destroyContent()}e.destroy()})}},_toggleUserActionsMenuPopover:async function(e){if(!this.oPopover){await s.load({name:"sap.ushell.components.shell.UserActionsMenu.UserActionsMenuPopover",type:"XML",controller:this}).then(function(t){this.oPopover=t;this.oPopover.setModel(this.getModel());this.oPopover.setModel(v.getModel(),"shellModel");return this._toggleUserActionsMenuPopover(e)}.bind(this))}else if(e){m.refreshState("userActions.items");this.oPopover.openBy(o.getElementById("userActionsMenuHeaderButton"))}else{this.oPopover.close();if(window.document.activeElement&&window.document.activeElement.id!=="userActionsMenuHeaderButton"){window.document.getElementById("userActionsMenuHeaderButton")?.focus()}}},userActionsMenuPopoverItemFactory:function(e,t){var i=o.getElementById(t.getObject());return new n({id:e+"-"+i.getId(),icon:i.getIcon(),tooltip:i.getTooltip(),iconInset:true,title:i.getText(),visible:i.getVisible(),type:B.Active,customData:[{key:"actionItemId",value:i.getId()}],press:function(){if(i){i.firePress();d.emit("showUserActionsMenu",false)}}}).addStyleClass("sapUshellUserActionsMenuActionItem")},getRenderer:function(){if(!this._oRenderer){this._oRenderer=u.getRendererInternal("fiori2")}return this._oRenderer},getShellConfig:function(){return this.getRenderer().getShellConfig()}})});
sap.ui.require.preload({
	"sap/ushell/components/shell/UserActionsMenu/UserActionsMenuPopover.fragment.xml":'<core:FragmentDefinition\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"><Popover\n        id="sapUshellUserActionsMenuPopover"\n        placement="Bottom"\n        showArrow="true"\n        showHeader="false"\n        class="sapUshellPopupContainer sapContrastPlus"><content><List\n                class="sapUshellPopoverList"\n                showSeparators="None"\n                includeItemInSelection="true"\n                items="{\n                    path: \'shellModel>/userActions/items\',\n                    factory: \'.userActionsMenuPopoverItemFactory\',\n                    filters: [{\n                        path: \'\',\n                        caseSensitive: true,\n                        test: \'.filterUserActions\'\n                    }]\n                }"><headerToolbar><Toolbar style="Clear"><Title level="H1" text="{/userName}" /></Toolbar></headerToolbar></List></content></Popover></core:FragmentDefinition>\n'
});
//# sourceMappingURL=Component-preload.js.map

//@ui5-bundle sap/ushell/components/shell/PostLoadingHeaderEnhancement/Component-preload.js
// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.predefine("sap/ushell/components/shell/PostLoadingHeaderEnhancement/Component", ["sap/base/i18n/Localization","sap/ui/Device","sap/ui/core/Component","sap/ui/core/CustomData","sap/ui/core/Element","sap/ui/core/IconPool","sap/ushell/Config","sap/ushell/EventHub","sap/ushell/library","sap/ushell/resources","sap/ushell/ui/shell/ShellHeadItem","sap/ushell/state/ShellModel","sap/ushell/state/StateManager","sap/ushell/Container","sap/ushell/utils/UrlParsing"],function(e,t,n,i,a,o,s,r,l,p,u,c,d,h,g){"use strict";var f=l.AppTitleState;var v=l.FloatingNumberType;const m=d.LaunchpadState;const B=d.Operation;const b=d.ShellMode;const{Default:S,Standalone:A,Embedded:y,Lean:M,Merged:w}=b;var C=[];return n.extend("sap.ushell.components.shell.PostLoadingHeaderEnhancement.Component",{metadata:{library:"sap.ushell"},init:function(){var e=h.getRendererInternal("fiori2").getShellConfig();C.push(this._createBackButton());C.push(this._createOverflowButton());if(e.moveAppFinderActionToShellHeader&&s.last("/core/catalog/enabled")&&!e.disableAppFinder){C.push(this._createAppFinderButton())}if(e.moveContactSupportActionToShellHeader){this._createSupportButton().then(function(e){C.push(e)})}this._createShellNavigationMenu();var t=a.getElementById("shell-header");t.updateAggregation("headItems");t.updateAggregation("headEndItems")},_createBackButton:function(){var t=e.getRTL()?"feeder-arrow":"nav-back";const n=d.getShellMode();var i=new u({id:"backBtn",tooltip:p.i18n.getText("backBtn_tooltip"),ariaLabel:p.i18n.getText("backBtn_tooltip"),icon:o.getIconURI(t),press:function(){r.emit("navigateBack",Date.now())}});if([S,A,y,w].includes(n)){d.updateBaseStates([m.App],"header.headItems",B.Add,i.getId())}else if(n===M){this._boundSetBackButtonVisibilityAfterHashChanged=this._setBackButtonVisibilityAfterHashChanged.bind(this);window.addEventListener("hashchange",this._boundSetBackButtonVisibilityAfterHashChanged)}return i.getId()},_setBackButtonVisibilityAfterHashChanged:function(e){const{oldURL:t,newURL:n}=e;const i=g.getHash(t);const a=g.getHash(n);const o=g.parseShellHash(i).appSpecificRoute;const s=g.parseShellHash(a).appSpecificRoute;const r=o!==s;if(r){d.updateBaseStates([m.App],"header.headItems",B.Add,"backBtn");window.removeEventListener("hashchange",this._boundSetBackButtonVisibilityAfterHashChanged);delete this._boundSetBackButtonVisibilityAfterHashChanged}},_createOverflowButton:function(){var e=new u({id:"endItemsOverflowBtn",tooltip:{path:"configModel>/notificationsCount",formatter:function(e){return this.tooltipFormatter(e)}},ariaLabel:p.i18n.getText("shellHeaderOverflowBtn_tooltip"),ariaHaspopup:"dialog",icon:"sap-icon://overflow",floatingNumber:"{configModel>/notificationsCount}",floatingNumberMaxValue:t.system.phone?99:999,floatingNumberType:v.OverflowButton,press:function(e){r.emit("showEndItemOverflow",e.getSource().getId(),true)}});e.setModel(c.getConfigModel(),"configModel");return e.getId()},_createAppFinderButton:function(){var e=new u({id:"openCatalogBtn",text:p.i18n.getText("open_appFinderBtn"),ariaLabel:p.i18n.getText("open_appFinderBtn"),tooltip:p.i18n.getText("open_appFinderBtn"),icon:"sap-icon://sys-find",press:function(){h.getServiceAsync("Navigation").then(function(e){e.navigate({target:{semanticObject:"Shell",action:"appfinder"}})})}});if(s.last("/core/extension/enableHelp")){e.addStyleClass("help-id-openCatalogActionItem")}d.updateAllBaseStates("userActions.items",B.Add,e.getId());return e.getId()},_createSupportButton:function(){return new Promise(function(e){sap.ui.require(["sap/ushell/ui/footerbar/ContactSupportButton"],function(t){var n="ContactSupportBtn";var i=a.getElementById(n);if(!i){var o=new t("tempContactSupportBtn",{visible:true});var s=o.getIcon();var r=o.getText();i=new u({id:n,icon:s,tooltip:r,text:r,ariaHaspopup:"dialog",press:function(){o.firePress()}})}d.updateAllBaseStates("userActions.items",B.Add,n);e(n)})})},_createShellNavigationMenu:function(){return new Promise(function(e){sap.ui.require(["sap/m/StandardListItem","sap/ushell/ui/shell/NavigationMiniTile","sap/ushell/ui/shell/ShellNavigationMenu"],function(t,n,o){var s="shellNavigationMenu";var l=function(e,n){var a=n.getProperty("icon")||"sap-icon://circle-task-2",o=n.getProperty("title"),s=n.getProperty("subtitle"),l=n.getProperty("intent");var p=new t({type:"Active",title:o,description:s,icon:a,wrapping:true,customData:[new i({key:"intent",value:l})],press:function(){if(l&&l[0]==="#"){r.emit("navigateFromShellApplicationNavigationMenu",l,true)}}}).addStyleClass("sapUshellNavigationMenuListItems");return p};var p=function(e,t){var i=t.getProperty("icon"),a=t.getProperty("title"),o=t.getProperty("subtitle"),s=t.getProperty("intent");return new n({title:a,subtitle:o,icon:i,intent:s,press:function(){var e=this.getIntent();if(e&&e[0]==="#"){r.emit("navigateFromShellApplicationNavigationMenu",e,true)}}})};var u=new o(s,{showRelatedApps:d.getShellMode()!==M,items:{path:"shellModel>/application/hierarchy",factory:l.bind(this)},miniTiles:{path:"shellModel>/application/relatedApps",factory:p.bind(this)},visible:{path:"configModel>/shellAppTitleState",formatter:function(e){return e===f.ShellNavMenu}}});u.setModel(c.getModel(),"shellModel");u.setModel(c.getConfigModel(),"configModel");var h=a.getElementById("shellAppTitle");if(h){h.setNavigationMenu(u)}C.push(s);e(u)}.bind(this))})},exit:function(){C.forEach(function(e){var t=a.getElementById(e);if(t){t.destroy()}});C=[];if(this._boundSetBackButtonVisibilityAfterHashChanged){window.removeEventListener("hashchange",this._boundSetBackButtonVisibilityAfterHashChanged)}}})});
//# sourceMappingURL=Component-preload.js.map

// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/i18n/Formatting","sap/base/i18n/Localization","sap/ui/core/Element","sap/ushell/utils","sap/ui/core/library","sap/ui/thirdparty/jquery","sap/base/Log","sap/ui/core/UIComponent","sap/ushell/services/AppConfiguration","sap/ushell/services/Navigation/compatibility","sap/ushell/EventHub","sap/ushell/components/applicationIntegration/application/PostMessageAPIInterface","sap/ui/thirdparty/URI","sap/base/util/deepExtend","sap/ushell/Config","sap/ushell/library","sap/ushell/utils/UrlParsing","sap/m/Button","sap/m/library","sap/ui/thirdparty/hasher","sap/ui/core/EventBus","sap/ushell/resources","sap/ushell/ui/shell/ShellHeadItem","sap/base/util/uid","sap/ushell/Container","sap/base/util/Deferred","sap/ushell/state/ShellModel","sap/ushell/ApplicationType/systemAlias"],function(e,t,a,s,n,jQuery,o,r,i,c,l,u,p,y,g,d,S,v,m,C,A,h,f,k,b,w,F,I){"use strict";const x=d.ContentNodeType;const D="sap.ushell.";const M=new r;const B=m.URLHelper;const P={"sap.ushell.services.Navigation":{oServiceCalls:{getHref:{executeServiceCallFn:async e=>{const{oTarget:t}=e.oMessageData.body;const a=await b.getServiceAsync("Navigation");return a.getHref(t)}},backToPreviousApp:{executeServiceCallFn:async()=>{const e=await b.getServiceAsync("Navigation");return e.backToPreviousApp()}},historyBack:{executeServiceCallFn:async e=>{const{iSteps:t}=e.oMessageData.body;const a=await b.getServiceAsync("Navigation");return a.historyBack(t)}},isInitialNavigation:{executeServiceCallFn:async()=>{const e=await b.getServiceAsync("Navigation");return e.isInitialNavigation()}},navigate:{executeServiceCallFn:async e=>{const{oTarget:t}=e.oMessageData.body;const a=await b.getServiceAsync("Navigation");const n=y({},t);s.storeSapSystemToLocalStorage(n);return a.navigate(n)}},getPrimaryIntent:{executeServiceCallFn:async e=>{const{sSemanticObject:t,oLinkFilter:a}=e.oMessageData.body;const s=await b.getServiceAsync("Navigation");return s.getPrimaryIntent(t,a)}},getLinks:{executeServiceCallFn:async e=>{const t=e.oMessageData.body;const a=await b.getServiceAsync("Navigation");return a.getLinks(t)}},getSemanticObjects:{executeServiceCallFn:async()=>{const e=await b.getServiceAsync("Navigation");return e.getSemanticObjects()}},isNavigationSupported:{executeServiceCallFn:async e=>{const{aTargets:t}=e.oMessageData.body;const a=await b.getServiceAsync("Navigation");return a.isNavigationSupported(t)}},getAppState:{executeServiceCallFn:async e=>{const{sAppStateKey:t}=e.oMessageData.body;const a=await b.getServiceAsync("Navigation");const s=await a.getAppState(M,t);delete s._oServiceInstance;return s}},resolveIntent:{executeServiceCallFn:async e=>{const{sHashFragment:t}=e.oMessageData.body;const a=await b.getServiceAsync("Navigation");return a.resolveIntent(t)}},isUrlSupported:{executeServiceCallFn:async e=>{const{sUrl:t}=e.oMessageData.body;const a=await b.getServiceAsync("Navigation");return a.isUrlSupported(t)}}}},"sap.ushell.services.CrossApplicationNavigation":{oServiceCalls:{hrefForExternal:{executeServiceCallFn:async e=>{const{oArgs:t}=e.oMessageData.body;const a=await b.getServiceAsync("Navigation");return a.getHref(t)}},getSemanticObjectLinks:{executeServiceCallFn:async e=>{const{sSemanticObject:t,mParameters:a,bIgnoreFormFactors:s,bCompactIntents:n}=e.oMessageData.body;return c.getSemanticObjectLinks(t,a,s,undefined,undefined,n)}},isIntentSupported:{executeServiceCallFn:async e=>{const{aIntents:t}=e.oMessageData.body;return c.isIntentSupported(t)}},isNavigationSupported:{executeServiceCallFn:async e=>{const{aIntents:t}=e.oMessageData.body;const a=await b.getServiceAsync("Navigation");return a.isNavigationSupported(t)}},backToPreviousApp:{executeServiceCallFn:async()=>{const e=await b.getServiceAsync("Navigation");e.backToPreviousApp()}},historyBack:{executeServiceCallFn:async e=>{const{iSteps:t}=e.oMessageData.body;const a=await b.getServiceAsync("Navigation");a.historyBack(t)}},getAppStateData:{executeServiceCallFn:async e=>{const{sAppStateKey:t}=e.oMessageData.body;return c.getAppStateData(t)}},toExternal:{executeServiceCallFn:async e=>{const{oArgs:t}=e.oMessageData.body;const a=await b.getServiceAsync("Navigation");const n=y({},t);s.storeSapSystemToLocalStorage(n);return a.navigate(n)}},registerBeforeAppCloseEvent:{executeServiceCallFn:async e=>{const t=e.oMessageData.body;e.oContainer.setProperty("beforeAppCloseEvent",{enabled:true,params:t},true)}},expandCompactHash:{executeServiceCallFn:async e=>{const{sHashFragment:t}=e.oMessageData.body;const a=await b.getServiceAsync("NavTargetResolutionInternal");const n=a.expandCompactHash(t);return s.promisify(n)}},getDistinctSemanticObjects:{executeServiceCallFn:async()=>{const e=await b.getServiceAsync("Navigation");return e.getSemanticObjects()}},getLinks:{executeServiceCallFn:async e=>{const t=e.oMessageData.body;return c.getLinks(t)}},getPrimaryIntent:{executeServiceCallFn:async e=>{const{sSemanticObject:t,mParameters:a}=e.oMessageData.body;const s=await b.getServiceAsync("Navigation");return s.getPrimaryIntent(t,a)}},hrefForAppSpecificHash:{executeServiceCallFn:async e=>{const{sAppHash:t}=e.oMessageData.body;const a=await b.getServiceAsync("Navigation");return a.getHref(t)}},isInitialNavigation:{executeServiceCallFn:async()=>{const e=await b.getServiceAsync("Navigation");return e.isInitialNavigation()}},getAppState:{executeServiceCallFn:async e=>{const{sAppStateKey:t}=e.oMessageData.body;const a=await b.getServiceAsync("Navigation");const s=await a.getAppState(M,t);delete s._oServiceInstance;return s}},setInnerAppRoute:{executeServiceCallFn:async e=>{const{appSpecificRoute:t,writeHistory:a}=e.oMessageData.body;const s=S.parseShellHash(C.getHash());if(s.appSpecificRoute===t){return}s.appSpecificRoute=t;const n=`#${S.constructShellHash(s)}`;C.disableBlueBoxHashChangeTrigger=true;if(a===true||a==="true"){C.setHash(n)}else{C.replaceHash(n)}C.disableBlueBoxHashChangeTrigger=false}},setInnerAppStateData:{executeServiceCallFn:e=>T.prototype._createNewInnerAppState(e)},resolveIntent:{executeServiceCallFn:async e=>{const{sHashFragment:t}=e.oMessageData.body;const a=await b.getServiceAsync("Navigation");return a.resolveIntent(t)}}}},"sap.ushell.ui5service.ShellUIService":{oServiceCalls:{setTitle:{executeServiceCallFn:async e=>{const{sTitle:t}=e.oMessageData.body;const a=e.oContainer.getShellUIService();a.setTitle(t)}},setBackNavigation:{executeServiceCallFn:async e=>{const t=e.oContainer.getShellUIService();let a;if(e?.oMessageData?.body?.callbackMessage?.service){a=T.prototype._backButtonPressedCallback.bind(null,e.oMessage.source,e.oMessageData.body.callbackMessage.service,e.oMessage.origin)}t.setBackNavigation(a)}}}},"sap.ushell.services.ShellUIService":{oServiceCalls:{setTitle:{executeServiceCallFn:async e=>{const{sTitle:t}=e.oMessageData.body;const a=e.oContainer.getShellUIService();a.setTitle(t)}},setHierarchy:{executeServiceCallFn:async e=>{const{aHierarchyLevels:t}=e.oMessageData.body;const a=e.oContainer.getShellUIService();a.setHierarchy(t)}},setRelatedApps:{executeServiceCallFn:async e=>{const{aRelatedApps:t}=e.oMessageData.body;const a=e.oContainer.getShellUIService();a.setRelatedApps(t)}},setDirtyFlag:{executeServiceCallFn:async e=>{const{bIsDirty:t}=e.oMessageData.body;b.setDirtyFlag(t)}},showShellUIBlocker:{executeServiceCallFn:async e=>{o.error("'sap.ushell.services.ShellUIService.showShellUIBlocker' was discontinued. This call will be ignored.")}},getFLPUrl:{executeServiceCallFn:e=>{const t=e?.oMessageData?.body?.bIncludeHash;return b.getFLPUrlAsync(t)}},getShellGroupIDs:{executeServiceCallFn:async e=>{if(true){const{bGetAll:t}=e.oMessageData.body||{};const a=await b.getServiceAsync("BookmarkV2");return a.getShellGroupIDs(t)}throw new Error("Bookmark.getShellGroupIDs is deprecated. Please use BookmarkV2.getContentNodes instead.")}},addBookmark:{executeServiceCallFn:async e=>{if(true){const{oParameters:t,groupId:a}=e.oMessageData.body;const s=await b.getServiceAsync("BookmarkV2");return s.addBookmarkByGroupId(t,a)}throw new Error("Bookmark.addBookmarkByGroupId is deprecated. Please use BookmarkV2.addBookmark instead.")}},addBookmarkDialog:{executeServiceCallFn:async()=>{const[e]=await s.requireAsync(["sap/ushell/ui/footerbar/AddBookmarkButton"]);const t=new e;t.firePress({})}},getShellGroupTiles:{executeServiceCallFn:async e=>{if(true){const{groupId:t}=e.oMessageData.body;const a=await b.getServiceAsync("FlpLaunchPage");const n=a.getTilesByGroupId(t);return s.promisify(n)}throw new Error("Classic homepage is deprecated.")}},sendUrlAsEmail:{executeServiceCallFn:async()=>{const e=F.getModel().getProperty("/application/title");let t;if(e===undefined){t=h.i18n.getText("linkToApplication")}else{t=`${h.i18n.getText("linkTo")} '${e}'`}T.prototype._sendEmail("",t,document.URL,"","",document.URL,true)}},sendEmailWithFLPButton:{executeServiceCallFn:async e=>{const{bSetAppStateToPublic:t}=e.oMessageData.body;const a=F.getModel().getProperty("/application/title");let s;if(a===undefined){s=h.i18n.getText("linkToApplication")}else{s=`${h.i18n.getText("linkTo")} '${a}'`}T.prototype._sendEmail("",s,document.URL,"","",document.URL,t)}},sendEmail:{executeServiceCallFn:async e=>{const{sTo:t,sSubject:a,sBody:s,sCc:n,sBcc:o,sIFrameURL:r,bSetAppStateToPublic:i}=e.oMessageData.body;T.prototype._sendEmail(t,a,s,n,o,r,i)}},processHotKey:{executeServiceCallFn:async e=>{const t=e.oMessageData.body;let a;try{a=new KeyboardEvent("keydown",t)}catch(e){const{altKey:s,ctrlKey:n,shiftKey:o,key:r,keyCode:i}=t;const c=document.createEvent("KeyboardEvent");let l="";if(s){l+="Alt "}if(n){l+="Control "}if(o){l+="Shift "}c.initKeyboardEvent("keydown",false,false,null,r,i,l,0,false);a=c}document.dispatchEvent(a)}}}},"sap.ushell.services.Container":{oServiceCalls:{setDirtyFlag:{executeServiceCallFn:async e=>{const{bIsDirty:t}=e.oMessageData.body;b.setDirtyFlag(t)}},registerDirtyStateProvider:{executeServiceCallFn:async e=>{const{bRegister:t}=e.oMessageData.body;if(t){T.prototype.registerAsyncDirtyStateProvider(e)}else{T.prototype.deregisterAsyncDirtyStateProvider(e)}}},getFLPUrl:{executeServiceCallFn:e=>{const t=e?.oMessageData?.body?.bIncludeHash;return b.getFLPUrlAsync(t)}},getFLPConfig:{executeServiceCallFn:async()=>b.getFLPConfig()},getFLPPlatform:{executeServiceCallFn:()=>b.getFLPPlatform()},attachLogoutEvent:{executeServiceCallFn:async e=>{b.attachLogoutEvent(async function(){const[t]=await s.requireAsync(["sap/ushell/components/applicationIntegration/application/PostMessageUtils"]);return t.postMessageToIframeApp(e.oContainer,"sap.ushell.appRuntime","executeLogoutFunctions",{},true)},true)}}}},"sap.ushell.services.AppState":{oServiceCalls:{getAppState:{executeServiceCallFn:async e=>{const{sKey:t}=e.oMessageData.body;const a=await b.getServiceAsync("AppState");const n=a.getAppState(t);const o=await s.promisify(n);delete o._oServiceInstance;return o}},_saveAppState:{executeServiceCallFn:async e=>{const{sKey:t,sData:a,sAppName:n,sComponent:o,bTransient:r,iPersistencyMethod:i,oPersistencySettings:c}=e.oMessageData.body;const l=await b.getServiceAsync("AppState");const u=l._saveAppState(t,a,n,o,r,i,c);return s.promisify(u)}},_loadAppState:{executeServiceCallFn:async e=>{const{sKey:t}=e.oMessageData.body;const a=await b.getServiceAsync("AppState");const n=a._loadAppState(t);return s.promisify(n)}},deleteAppState:{executeServiceCallFn:async e=>{const{sKey:t}=e.oMessageData.body;const a=await b.getServiceAsync("AppState");const n=a.deleteAppState(t);return s.promisify(n)}},makeStatePersistent:{executeServiceCallFn:async e=>{const{sKey:t,iPersistencyMethod:a,oPersistencySettings:n}=e.oMessageData.body;const o=await b.getServiceAsync("AppState");const r=o.makeStatePersistent(t,a,n);return s.promisify(r)}}}},"sap.ushell.services.Bookmark":{oServiceCalls:{addBookmarkUI5:{executeServiceCallFn:async e=>{const{oParameters:t,vContainer:a}=e.oMessageData.body;const s=await b.getServiceAsync("AppLifeCycle");const n=await s.getCurrentApplication().getSystemContext();T.prototype._stripBookmarkServiceUrlForLocalContentProvider(t,n);const o=await b.getServiceAsync("BookmarkV2");return o.addBookmark(t,a,n.id)}},addBookmark:{executeServiceCallFn:async e=>{if(true){const{oParameters:t,groupId:a}=e.oMessageData.body;const s=await b.getServiceAsync("BookmarkV2");return s.addBookmarkByGroupId(t,a)}throw new Error("Bookmark.addBookmarkByGroupId is deprecated. Please use BookmarkV2.addBookmark instead.")}},getShellGroupIDs:{executeServiceCallFn:async()=>{if(true){const e=await b.getServiceAsync("BookmarkV2");return e.getShellGroupIDs()}throw new Error("Bookmark.getShellGroupIDs is deprecated. Please use BookmarkV2.getContentNodes instead.")}},addCatalogTileToGroup:{executeServiceCallFn:async e=>{o.error("Bookmark.addCatalogTileToGroup is deprecated. Please use BookmarkV2.addBookmark instead.");if(true){const{sCatalogTileId:t,sGroupId:a,oCatalogData:n}=e.oMessageData.body;const o=await b.getServiceAsync("Bookmark");const r=o.addCatalogTileToGroup(t,a,n);return s.promisify(r)}throw new Error("Bookmark.addCatalogTileToGroup is deprecated. Please use BookmarkV2.addBookmark instead.")}},countBookmarks:{executeServiceCallFn:async e=>{const{sUrl:t}=e.oMessageData.body;const a=await b.getServiceAsync("AppLifeCycle");const s=await a.getCurrentApplication().getSystemContext();const n=await b.getServiceAsync("BookmarkV2");return n.countBookmarks(t,s.id)}},deleteBookmarks:{executeServiceCallFn:async e=>{const{sUrl:t}=e.oMessageData.body;const a=await b.getServiceAsync("AppLifeCycle");const s=await a.getCurrentApplication().getSystemContext();const n=await b.getServiceAsync("BookmarkV2");return n.deleteBookmarks(t,s.id)}},updateBookmarks:{executeServiceCallFn:async e=>{const{sUrl:t,oParameters:a}=e.oMessageData.body;const s=await b.getServiceAsync("AppLifeCycle");const n=await s.getCurrentApplication().getSystemContext();const o=await b.getServiceAsync("BookmarkV2");return o.updateBookmarks(t,a,n.id)}},getContentNodes:{executeServiceCallFn:async()=>{const e=await b.getServiceAsync("BookmarkV2");return e.getContentNodes()}},addCustomBookmark:{executeServiceCallFn:async e=>{const{sVizType:t,oConfig:a,vContentNodes:s}=e.oMessageData.body;const n=await b.getServiceAsync("AppLifeCycle");const o=await n.getCurrentApplication().getSystemContext();const r=await b.getServiceAsync("BookmarkV2");return r.addCustomBookmark(t,a,s,o.id)}},countCustomBookmarks:{executeServiceCallFn:async e=>{const{oIdentifier:t}=e.oMessageData.body;const a=await b.getServiceAsync("AppLifeCycle");const s=await a.getCurrentApplication().getSystemContext();t.contentProviderId=s.id;const n=await b.getServiceAsync("BookmarkV2");return n.countCustomBookmarks(t)}},updateCustomBookmarks:{executeServiceCallFn:async e=>{const{oIdentifier:t,oConfig:a}=e.oMessageData.body;const s=await b.getServiceAsync("AppLifeCycle");const n=await s.getCurrentApplication().getSystemContext();t.contentProviderId=n.id;const o=await b.getServiceAsync("BookmarkV2");return o.updateCustomBookmarks(t,a)}},deleteCustomBookmarks:{executeServiceCallFn:async e=>{const{oIdentifier:t}=e.oMessageData.body;const a=await b.getServiceAsync("AppLifeCycle");const s=await a.getCurrentApplication().getSystemContext();t.contentProviderId=s.id;const n=await b.getServiceAsync("BookmarkV2");return n.deleteCustomBookmarks(t)}},addBookmarkToPage:{executeServiceCallFn:async e=>{const{oParameters:t,sPageId:a}=e.oMessageData.body;const s=await b.getServiceAsync("AppLifeCycle");const n=await s.getCurrentApplication().getSystemContext();const o=await b.getServiceAsync("BookmarkV2");return o.addBookmarkToPage(t,a,n.id)}}}},"sap.ushell.services.BookmarkV2":{oServiceCalls:{addBookmarkUI5:{executeServiceCallFn:async e=>{const{oParameters:t,vContainer:a}=e.oMessageData.body;const s=await b.getServiceAsync("AppLifeCycle");const n=await s.getCurrentApplication().getSystemContext();T.prototype._stripBookmarkServiceUrlForLocalContentProvider(t,n);const o=await b.getServiceAsync("BookmarkV2");return o.addBookmark(t,a,n.id)}},addBookmark:{executeServiceCallFn:async e=>{if(true){const{oParameters:t,groupId:a}=e.oMessageData.body;const s=await b.getServiceAsync("BookmarkV2");return s.addBookmarkByGroupId(t,a)}throw new Error("BookmarkV2.addBookmarkByGroupId is deprecated. Please use BookmarkV2.addBookmark instead.")}},getShellGroupIDs:{executeServiceCallFn:async()=>{if(true){const e=await b.getServiceAsync("BookmarkV2");return e.getShellGroupIDs()}throw new Error("BookmarkV2.getShellGroupIDs is deprecated. Please use BookmarkV2.getContentNodes instead.")}},countBookmarks:{executeServiceCallFn:async e=>{const{sUrl:t}=e.oMessageData.body;const a=await b.getServiceAsync("AppLifeCycle");const s=await a.getCurrentApplication().getSystemContext();const n=await b.getServiceAsync("BookmarkV2");return n.countBookmarks(t,s.id)}},deleteBookmarks:{executeServiceCallFn:async e=>{const{sUrl:t}=e.oMessageData.body;const a=await b.getServiceAsync("AppLifeCycle");const s=await a.getCurrentApplication().getSystemContext();const n=await b.getServiceAsync("BookmarkV2");return n.deleteBookmarks(t,s.id)}},updateBookmarks:{executeServiceCallFn:async e=>{const{sUrl:t,oParameters:a}=e.oMessageData.body;const s=await b.getServiceAsync("AppLifeCycle");const n=await s.getCurrentApplication().getSystemContext();const o=await b.getServiceAsync("BookmarkV2");return o.updateBookmarks(t,a,n.id)}},getContentNodes:{executeServiceCallFn:async()=>{const e=await b.getServiceAsync("BookmarkV2");return e.getContentNodes()}},addCustomBookmark:{executeServiceCallFn:async e=>{const{sVizType:t,oConfig:a,vContentNodes:s}=e.oMessageData.body;const n=await b.getServiceAsync("AppLifeCycle");const o=await n.getCurrentApplication().getSystemContext();const r=await b.getServiceAsync("BookmarkV2");return r.addCustomBookmark(t,a,s,o.id)}},countCustomBookmarks:{executeServiceCallFn:async e=>{const{oIdentifier:t}=e.oMessageData.body;const a=await b.getServiceAsync("AppLifeCycle");const s=await a.getCurrentApplication().getSystemContext();t.contentProviderId=s.id;const n=await b.getServiceAsync("BookmarkV2");return n.countCustomBookmarks(t)}},updateCustomBookmarks:{executeServiceCallFn:async e=>{const{oIdentifier:t,oConfig:a}=e.oMessageData.body;const s=await b.getServiceAsync("AppLifeCycle");const n=await s.getCurrentApplication().getSystemContext();t.contentProviderId=n.id;const o=await b.getServiceAsync("BookmarkV2");return o.updateCustomBookmarks(t,a)}},deleteCustomBookmarks:{executeServiceCallFn:async e=>{const{oIdentifier:t}=e.oMessageData.body;const a=await b.getServiceAsync("AppLifeCycle");const s=await a.getCurrentApplication().getSystemContext();t.contentProviderId=s.id;const n=await b.getServiceAsync("BookmarkV2");return n.deleteCustomBookmarks(t)}},addBookmarkToPage:{executeServiceCallFn:async e=>{const{oParameters:t,sPageId:a}=e.oMessageData.body;const s=await b.getServiceAsync("AppLifeCycle");const n=await s.getCurrentApplication().getSystemContext();const o=await b.getServiceAsync("BookmarkV2");return o.addBookmarkToPage(t,a,n.id)}}}},"sap.ushell.services.AppLifeCycle":{oServiceCalls:{reloadCurrentApp:{executeServiceCallFn:async e=>{l.emit("reloadCurrentApp",{sCurrentHash:C.getHash(),date:Date.now()})}},getFullyQualifiedXhrUrl:{executeServiceCallFn:async e=>{const{path:t}=e.oMessageData.body;if(t!==""&&t!==undefined&&t!==null){const e=await b.getServiceAsync("AppLifeCycle");const a=await e.getCurrentApplication().getSystemContext();const s=a.getFullyQualifiedXhrUrl(t);let n="";let o="";let r="";const i=b.getFLPUrl(true);const c=new p(i);if(c.protocol()!==null&&c.protocol()!==undefined&&c.protocol()!==""){o=`${c.protocol()}://`}if(c.hostname()!==null&&c.hostname()!==undefined&&c.hostname()!==""){n=c.hostname()}if(c.port()!==null&&c.port()!==undefined&&c.port()!==""){r=`:${c.port()}`}const l=o+n+r+s;return l}}},getSystemAlias:{executeServiceCallFn:async e=>{const t=e.oContainer.getCurrentAppTargetResolution();const a=t.systemAlias;const s=t.contentProviderId;return I.getSystemAliasInProvider(a,s)}},setNewAppInfo:{executeServiceCallFn:async e=>{const t=e.oMessageData.body;const a=await b.getServiceAsync("AppLifeCycle");a.setAppInfo(t,true)}},updateCurrentAppInfo:{executeServiceCallFn:async e=>{const t=e.oMessageData.body;const a=await b.getServiceAsync("AppLifeCycle");a.setAppInfo(t,false)}}}},"sap.ushell.services.AppConfiguration":{oServiceCalls:{setApplicationFullWidth:{executeServiceCallFn:async e=>{const{bValue:t}=e.oMessageData.body;i.setApplicationFullWidthInternal(t)}}}},"sap.ushell.appRuntime":{oRequestCalls:{innerAppRouteChange:{isActiveOnly:true,distributionType:["all"]},keepAliveAppHide:{isActiveOnly:true,distributionType:["all"]},keepAliveAppShow:{isActiveOnly:true,distributionType:["all"]},hashChange:{isActiveOnly:true,distributionType:["URL"]},setDirtyFlag:{isActiveOnly:true,distributionType:["URL"]},getDirtyFlag:{isActiveOnly:true,distributionType:["URL"]},themeChange:{isActiveOnly:false,distributionType:["all"]},uiDensityChange:{isActiveOnly:false,distributionType:["all"]}},oServiceCalls:{hashChange:{executeServiceCallFn:async e=>{const{newHash:t,direction:a}=e.oMessageData.body;C.disableBlueBoxHashChangeTrigger=true;C.replaceHash(t);C.disableBlueBoxHashChangeTrigger=false;if(a){const e=await b.getServiceAsync("ShellNavigationInternal");e.hashChanger.fireEvent("hashReplaced",{hash:e.hashChanger.getHash(),direction:a});o.debug(`PostMessageAPI.hashChange :: Informed by the Iframe, to change the History direction property in FLP to: ${a}`)}return}},iframeIsValid:{executeServiceCallFn:async e=>{e.oContainer.setProperty("isIframeValidTime",{time:(new Date).getTime()},true)}},iframeIsBusy:{executeServiceCallFn:async e=>{}},isInvalidIframe:{executeServiceCallFn:async e=>{const{bValue:t}=e.oMessageData.body;e.oContainer.setProperty("isInvalidIframe",t,true)}}}},"sap.ushell.services.UserInfo":{oServiceCalls:{getThemeList:{executeServiceCallFn:async()=>{const e=await b.getServiceAsync("UserInfo");const t=e.getThemeList();return s.promisify(t)}},getShellUserInfo:{executeServiceCallFn:async()=>{const e=await b.getServiceAsync("UserInfo");return e.getShellUserInfo()}},getLanguageList:{executeServiceCallFn:async()=>{const e=await b.getServiceAsync("UserInfo");const t=e.getLanguageList();return s.promisify(t)}},updateUserPreferences:{executeServiceCallFn:async e=>{const{language:t}=e.oMessageData.body;if(t){const e=b.getUser();e.setLanguage(t);const a=await b.getServiceAsync("UserInfo");const n=a.updateUserPreferences();await s.promisify(n);e.resetChangedProperty("language")}}},openThemeManager:{executeServiceCallFn:async()=>{l.emit("openThemeManager",Date.now())}},getLocaleData:{executeServiceCallFn:async()=>{const a={calendarType:e.getCalendarType(),dateFormatShort:e.getDatePattern("short"),dateFormatMedium:e.getDatePattern("medium"),numberFormatGroup:e.getNumberSymbol("group"),numberFormatDecimal:e.getNumberSymbol("decimal"),timeFormatShort:e.getTimePattern("short"),timeFormatMedium:e.getTimePattern("medium"),calendarMapping:e.getCustomIslamicCalendarData(),timeZone:t.getTimezone(),currencyFormats:e.getCustomCurrencies()};return a}}}},"sap.ushell.services.UserDefaultParameters":{oServiceCalls:{getValue:{executeServiceCallFn:async e=>{const{sParameterName:t}=e.oMessageData.body;const[a,s]=await Promise.all([b.getServiceAsync("AppLifeCycle"),b.getServiceAsync("UserDefaultParameters")]);const n=await a.getCurrentApplication().getSystemContext();return s.getValue(t,n)}}}},"sap.ushell.services.ShellNavigation":{oServiceCalls:{toExternal:{executeServiceCallFn:async e=>{const{oArgs:t,bWriteHistory:a}=e.oMessageData.body;const s=await b.getServiceAsync("ShellNavigationInternal");s.toExternal(t,undefined,a)}},toAppHash:{executeServiceCallFn:async e=>{const{sAppHash:t,bWriteHistory:a}=e.oMessageData.body;const s=await b.getServiceAsync("ShellNavigationInternal");s.toAppHash(t,a)}}}},"sap.ushell.services.ShellNavigationInternal":{oServiceCalls:{toExternal:{executeServiceCallFn:async e=>{const{oArgs:t,bWriteHistory:a}=e.oMessageData.body;const s=await b.getServiceAsync("ShellNavigationInternal");s.toExternal(t,undefined,a)}},toAppHash:{executeServiceCallFn:async e=>{const{sAppHash:t,bWriteHistory:a}=e.oMessageData.body;const s=await b.getServiceAsync("ShellNavigationInternal");s.toAppHash(t,a)}}}},"sap.ushell.services.NavTargetResolution":{oServiceCalls:{getDistinctSemanticObjects:{executeServiceCallFn:async()=>{const e=await b.getServiceAsync("NavTargetResolutionInternal");const t=e.getDistinctSemanticObjects();return s.promisify(t)}},expandCompactHash:{executeServiceCallFn:async e=>{const{sHashFragment:t}=e.oMessageData.body;const a=await b.getServiceAsync("NavTargetResolutionInternal");const n=a.expandCompactHash(t);return s.promisify(n)}},resolveHashFragment:{executeServiceCallFn:async e=>{const{sHashFragment:t}=e.oMessageData.body;const a=await b.getServiceAsync("NavTargetResolutionInternal");const n=a.resolveHashFragment(t);return s.promisify(n)}},isIntentSupported:{executeServiceCallFn:async e=>{const{aIntents:t}=e.oMessageData.body;const a=await b.getServiceAsync("NavTargetResolutionInternal");const n=a.isNavigationSupported(t);const o=await s.promisify(n);return o.reduce((e,a,s)=>{const n=t[s];e[n]=a;return e},{})}},isNavigationSupported:{executeServiceCallFn:async e=>{const{aIntents:t}=e.oMessageData.body;const a=await b.getServiceAsync("NavTargetResolutionInternal");const n=a.isNavigationSupported(t);return s.promisify(n)}}}},"sap.ushell.services.NavTargetResolutionInternal":{oServiceCalls:{getDistinctSemanticObjects:{executeServiceCallFn:async()=>{const e=await b.getServiceAsync("NavTargetResolutionInternal");const t=e.getDistinctSemanticObjects();return s.promisify(t)}},expandCompactHash:{executeServiceCallFn:async e=>{const{sHashFragment:t}=e.oMessageData.body;const a=await b.getServiceAsync("NavTargetResolutionInternal");const n=a.expandCompactHash(t);return s.promisify(n)}},resolveHashFragment:{executeServiceCallFn:async e=>{const{sHashFragment:t}=e.oMessageData.body;const a=await b.getServiceAsync("NavTargetResolutionInternal");const n=a.resolveHashFragment(t);return s.promisify(n)}},isIntentSupported:{executeServiceCallFn:async e=>{const{aIntents:t}=e.oMessageData.body;const a=await b.getServiceAsync("NavTargetResolutionInternal");const n=a.isNavigationSupported(t);const o=await s.promisify(n);return o.reduce((e,a,s)=>{const n=t[s];e[n]=a;return e},{})}},isNavigationSupported:{executeServiceCallFn:async e=>{const{aIntents:t}=e.oMessageData.body;const a=await b.getServiceAsync("NavTargetResolutionInternal");const n=a.isNavigationSupported(t);return s.promisify(n)}}}},"sap.ushell.services.Renderer":{oServiceCalls:{addHeaderItem:{executeServiceCallFn:async e=>{const{sId:t,sTooltip:a,sIcon:n,iFloatingNumber:o,bVisible:r,bCurrentState:i,aStates:c}=e.oMessageData.body;const l=await b.getServiceAsync("FrameBoundExtension");const u=await l.createHeaderItem({id:t,tooltip:a,icon:n,floatingNumber:o,press:async function(){const[a]=await s.requireAsync(["sap/ushell/components/applicationIntegration/application/PostMessageUtils"]);a.postMessageToIframeApp(e.oContainer,"sap.ushell.appRuntime","buttonClick",{buttonId:t})}},{position:"begin"});R(t,u);U(u,r,i,c)}},addHeaderEndItem:{executeServiceCallFn:async e=>{const{sId:t,sTooltip:a,sIcon:n,iFloatingNumber:o,bVisible:r,bCurrentState:i,aStates:c}=e.oMessageData.body;const l=await b.getServiceAsync("FrameBoundExtension");const u=await l.createHeaderItem({id:t,tooltip:a,icon:n,floatingNumber:o,press:async function(){const[a]=await s.requireAsync(["sap/ushell/components/applicationIntegration/application/PostMessageUtils"]);a.postMessageToIframeApp(e.oContainer,"sap.ushell.appRuntime","buttonClick",{buttonId:t})}},{position:"end"});R(t,u);U(u,r,i,c)}},showHeaderItem:{executeServiceCallFn:async e=>{const{aIds:t,bCurrentState:a,aStates:s}=e.oMessageData.body;const n=Array.isArray(t)?t:[t];q(n,e=>{U(e,true,a,s)})}},showHeaderEndItem:{executeServiceCallFn:async e=>{const{aIds:t,bCurrentState:a,aStates:s}=e.oMessageData.body;const n=Array.isArray(t)?t:[t];q(n,e=>{U(e,true,a,s)})}},hideHeaderItem:{executeServiceCallFn:async e=>{const{aIds:t,bCurrentState:a,aStates:s}=e.oMessageData.body;const n=Array.isArray(t)?t:[t];q(n,e=>{U(e,false,a,s)})}},hideHeaderEndItem:{executeServiceCallFn:async e=>{const{aIds:t,bCurrentState:a,aStates:s}=e.oMessageData.body;const n=Array.isArray(t)?t:[t];q(n,e=>{U(e,false,a,s)})}},setHeaderTitle:{executeServiceCallFn:async e=>{const{sTitle:t}=e.oMessageData.body;const a=await b.getServiceAsync("Extension");a.setSecondTitle(t)}},setHeaderVisibility:{executeServiceCallFn:async e=>{const{bVisible:t,bCurrentState:a,aStates:s}=e.oMessageData.body;const n=b.getRendererInternal("fiori2");n.setHeaderVisibility(t,!!a,s)}},createShellHeadItem:{executeServiceCallFn:async e=>{const{params:t}=e.oMessageData.body;t.press=async function(){const[a]=await s.requireAsync(["sap/ushell/components/applicationIntegration/application/PostMessageUtils"]);a.postMessageToIframeApp(e.oContainer,"sap.ushell.appRuntime","buttonClick",{buttonId:t.id})};new f(t)}},showActionButton:{executeServiceCallFn:async e=>{const{aIds:t,bCurrentState:a,aStates:s}=e.oMessageData.body;const n=Array.isArray(t)?t:[t];q(n,e=>{U(e,true,a,s)})}},hideActionButton:{executeServiceCallFn:async e=>{const{aIds:t,bCurrentState:a,aStates:s}=e.oMessageData.body;const n=Array.isArray(t)?t:[t];q(n,e=>{U(e,true,a,s)})}},addUserAction:{executeServiceCallFn:async e=>{const{controlType:t,oControlProperties:a,bIsVisible:n,bCurrentState:o,aStates:r}=e.oMessageData.body.oParameters;const i=await b.getServiceAsync("Extension");a.press=async function(){const[t]=await s.requireAsync(["sap/ushell/components/applicationIntegration/application/PostMessageUtils"]);t.postMessageToIframeApp(e.oContainer,"sap.ushell.appRuntime","buttonClick",{buttonId:a.id})};const c=await i.createUserAction(a,{controlType:t});R(a.id,c);U(c,n,o,r)}},addOptionsActionSheetButton:{executeServiceCallFn:async e=>{const t=e.oMessageData.body;const a=await b.getServiceAsync("Extension");const n=Array.isArray(t)?t:[t];n.forEach(async t=>{H(t.id);new v({id:t.id,text:t.text,icon:t.icon,tooltip:t.tooltip,press:async function(){const[a]=await s.requireAsync(["sap/ushell/components/applicationIntegration/application/PostMessageUtils"]);a.postMessageToIframeApp(e.oContainer,"sap.ushell.appRuntime","buttonClick",{buttonId:t.id})}});const n=await a.createUserAction({id:t.id});R(t.id,n);U(n,true,true,t.aStates)})}},removeOptionsActionSheetButton:{executeServiceCallFn:async e=>{const t=e.oMessageData.body;const a=Array.isArray(t)?t:[t];a.forEach(e=>{const t=V(e.id);if(t){U(t,true,true,e.aStates);return H(e.id)}o.warning(`User action with id ${e.id} not found`)})}},updateHeaderItem:{executeServiceCallFn:async e=>{const{sId:t,oControlProperties:a}=e.oMessageData.body;if(!Object.hasOwn(a,"floatingNumber")){return}const s=V(t);if(s?.getControl){const e=await s.getControl();e?.setFloatingNumber?.(a.floatingNumber)}}},destroyButton:{executeServiceCallFn:async e=>{const{aIds:t}=e.oMessageData.body;const a=Array.isArray(t)?t:[t];a.forEach(e=>{H(e)})}}}},"sap.ushell.services.Extension":{oServiceCalls:{createHeaderItem:{executeServiceCallFn:async e=>{const{controlProperties:t,events:a,parameters:n}=e.oMessageData.body;const o=E();a.forEach(a=>{t[a]=async function(){const[t]=await s.requireAsync(["sap/ushell/components/applicationIntegration/application/PostMessageUtils"]);t.postMessageToIframeApp(e.oContainer,"sap.ushell.services.Extension","handleControlEvent",{eventName:a,itemId:o})}});const r=await b.getServiceAsync("Extension");const i=await r.createHeaderItem(t,n);R(o,i);return{itemId:o}}},createUserAction:{executeServiceCallFn:async e=>{const{controlProperties:t,events:a,parameters:n}=e.oMessageData.body;const o=E();a.forEach(a=>{t[a]=async function(){const[t]=await s.requireAsync(["sap/ushell/components/applicationIntegration/application/PostMessageUtils"]);t.postMessageToIframeApp(e.oContainer,"sap.ushell.services.Extension","handleControlEvent",{eventName:a,itemId:o})}});const r=await b.getServiceAsync("Extension");const i=await r.createUserAction(t,n);R(o,i);return{itemId:o}}},"Item.destroy":{executeServiceCallFn:async e=>{const{itemId:t}=e.oMessageData.body;const a=V(t);if(a?.destroy){a.destroy();O(t)}}},"Item.showForCurrentApp":{executeServiceCallFn:async e=>{const{itemId:t}=e.oMessageData.body;const a=V(t);if(a?.showForCurrentApp){a.showForCurrentApp()}}},"Item.hideForCurrentApp":{executeServiceCallFn:async e=>{const{itemId:t}=e.oMessageData.body;const a=V(t);if(a?.hideForCurrentApp){a.hideForCurrentApp()}}},"Item.showForAllApps":{executeServiceCallFn:async e=>{const{itemId:t}=e.oMessageData.body;const a=V(t);if(a?.showForAllApps){a.showForAllApps()}}},"Item.hideForAllApps":{executeServiceCallFn:async e=>{const{itemId:t}=e.oMessageData.body;const a=V(t);if(a?.hideForAllApps){a.hideForAllApps()}}},"Item.showOnHome":{executeServiceCallFn:async e=>{const{itemId:t}=e.oMessageData.body;const a=V(t);if(a?.showOnHome){a.showOnHome()}}},"Item.hideOnHome":{executeServiceCallFn:async e=>{const{itemId:t}=e.oMessageData.body;const a=V(t);if(a?.hideOnHome){a.hideOnHome()}}},setSecondTitle:{executeServiceCallFn:async e=>{const{title:t}=e.oMessageData.body;const a=await b.getServiceAsync("Extension");return a.setSecondTitle(t)}}}},"sap.ushell.services.LaunchPage":{oServiceCalls:{getGroupsForBookmarks:{executeServiceCallFn:async()=>{if(true){const e=await b.getServiceAsync("FlpLaunchPage");const t=e.getGroupsForBookmarks();return s.promisify(t)}throw new Error("LaunchPage.getGroupsForBookmarks is deprecated. Please use BookmarkV2.getContentNodes instead.")}}}},"sap.ushell.services.Menu":{oServiceCalls:{getSpacesPagesHierarchy:{executeServiceCallFn:async()=>{const e=await b.getServiceAsync("Menu");const t=e.getContentNodes([x.Space,x.Page]);return t.map(({id:e,label:t,children:a})=>({id:e,title:t,pages:(a||[]).map(({id:e,label:t})=>({id:e,title:t}))}))}}}},"sap.ushell.services.CommonDataModel":{oServiceCalls:{getAllPages:{executeServiceCallFn:async()=>{const e=await b.getServiceAsync("CommonDataModel");return e.getAllPages()}}}},"sap.ushell.services.UITracer":{oServiceCalls:{trace:{executeServiceCallFn:async e=>{const{trace:t}=e.oMessageData.body;await b.getServiceAsync("UITracer");l.emit("UITracer.trace",t)}}}},"sap.ushell.services.MessageBroker":{oServiceCalls:{_execute:{executeServiceCallFn:async e=>{if(g.last("/core/shell/enableMessageBroker")){await b.getServiceAsync("MessageBroker");const[t]=await s.requireAsync(["sap/ushell/services/MessageBroker/MessageBrokerEngine"]);return t.processPostMessage(e)}return{}}}}},"sap.ushell.services.SearchableContent":{oServiceCalls:{getApps:{executeServiceCallFn:async e=>{const t=e?.oMessageData?.body?.oOptions||{};const a=await b.getServiceAsync("SearchableContent");return a.getApps(t)}}}},"sap.ushell.services.ReferenceResolver":{oServiceCalls:{resolveReferences:{executeServiceCallFn:async e=>{const{aReferences:t}=e.oMessageData.body;const a=await b.getServiceAsync("ReferenceResolver");return a.resolveReferences(t)}}}}};function T(){this._getBrowserURL=function(){return document.URL};Object.keys(P).forEach(e=>{if(e.indexOf(D)!==0){throw new Error(`All Post Message APIs must start with '${D}' - ${e}`)}});u.init(true,T.prototype.registerShellCommunicationHandler.bind(this))}T.prototype.getAPIs=function(){return P};function N(e,t){const a=P[e];if(a){if(t.oServiceCalls){Object.keys(t.oServiceCalls).forEach(e=>{a.oServiceCalls[e]=t.oServiceCalls[e]})}if(!a.oRequestCalls){a.oRequestCalls={}}if(t.oRequestCalls){Object.keys(t.oRequestCalls).forEach(e=>{a.oRequestCalls[e]=t.oRequestCalls[e]})}return}const s={oRequestCalls:{},oServiceCalls:{}};if(t.oServiceCalls){Object.keys(t.oServiceCalls).forEach(e=>{s.oServiceCalls[e]=t.oServiceCalls[e]})}if(t.oRequestCalls){Object.keys(t.oRequestCalls).forEach(e=>{s.oRequestCalls[e]=t.oRequestCalls[e]})}P[e]=s}T.prototype._getPostMesageInterface=function(e,t){const a=this.getAPIs();if(a[e]){const s=a[e];if(s?.oRequestCalls?.[t]){return s.oRequestCalls[t]}}};T.prototype.registerShellCommunicationHandler=function(e){Object.keys(e).forEach(t=>{N(t,e[t])})};T.prototype.isActiveOnly=function(e,t){const a=this._getPostMesageInterface(e,t);if(a){return a.isActiveOnly}};T.prototype._createNewInnerAppState=async function(e){const{sData:t}=e.oMessageData.body;let a;if(t!==undefined){try{a=JSON.parse(t)}catch(e){a=t}}else{a=""}const s=await b.getServiceAsync("AppState");const n=s.createEmptyAppState();n.setData(a);n.save();const o=n.getKey();let r=C.getHash();if(r.indexOf("&/")>0){if(r.indexOf("sap-iapp-state=")>0){const e=/(?:sap-iapp-state=)([^&/]+)/.exec(r)[1];r=r.replace(e,o)}else{r=`${r}/sap-iapp-state=${o}`}}else{r=`${r}&/sap-iapp-state=${o}`}C.disableBlueBoxHashChangeTrigger=true;C.replaceHash(r);C.disableBlueBoxHashChangeTrigger=false;return o};function H(e){const t=a.getElementById(e);if(t?.destroy){t.destroy()}}function U(e,t,a,s){if(a){t?e.showForCurrentApp():e.hideForCurrentApp()}else{t?e.hideForCurrentApp():e.showForCurrentApp();if(Array.isArray(s)){if(s.includes("app")){t?e.showForAllApps():e.hideForAllApps()}else{t?e.hideForAllApps():e.showForAllApps()}if(s.includes("home")){t?e.showOnHome():e.hideOnHome()}else{t?e.hideOnHome():e.showOnHome()}}}}const L={};function E(){const e=k();if(Object.hasOwn(L,e)){return E()}L[e]=null;return e}function R(e,t){L[e]=t}function V(e){return L[e]}function O(e){delete L[e]}function q(e,t){e.forEach(e=>{const a=V(e);if(a){t(a)}else{o.warning(`Item with id ${e} not found`)}})}T.prototype.registerAsyncDirtyStateProvider=function(e){b.setAsyncDirtyStateProvider(async function(t){const[a]=await s.requireAsync(["sap/ushell/components/applicationIntegration/application/PostMessageUtils"]);const n=new w;const o=setTimeout(()=>{n.resolve(false)},2500);a.postMessageToIframeApp(e.oContainer,"sap.ushell.appRuntime","handleDirtyStateProvider",{oNavigationContext:t},true).then(e=>{if(o){clearTimeout(o)}n.resolve(e?.body?.result||false)});return n.promise})};T.prototype.deregisterAsyncDirtyStateProvider=function(){b.setAsyncDirtyStateProvider()};T.prototype._sendEmail=async function(e="",t="",a="",s="",n="",r,i){let c=this._getBrowserURL&&this._getBrowserURL()||document.URL;function l(e,s,n,o,r,i){t=t.includes(e)?t.replace(e,s):t;a=a.includes(e)?a.replace(e,s):a;if(n&&r){t=t.includes(n)?t.replaceAll(n,r):t;a=a.includes(n)?a.replaceAll(n,r):a}if(o&&i){t=t.includes(o)?t.replaceAll(o,i):t;a=a.includes(o)?a.replaceAll(o,i):a}}if(i){const i=await b.getServiceAsync("AppState");i.setAppStateToPublic(r).then((o,i,u,p="",y="")=>{if(p){c=c.replace(i,p)}if(y){c=c.replace(u,y)}l(r,c,i,u,p,y);B.triggerEmail(e,t,a,s,n)},o.error)}else{l(r,c);B.triggerEmail(e,t,a,s,n)}};T.prototype._stripBookmarkServiceUrlForLocalContentProvider=function(e,t){if(!e||!e.serviceUrl||!t){return}if(t.id===""||t.id==="saas_approuter"){e.serviceUrl=undefined;o.warning("Dynamic data bookmarks tiles are not supported for local content providers",null,"sap/ushell/components/applicationIntegration/application/PostMessageAPI")}};T.prototype._backButtonPressedCallback=function(e,t,a){const s=JSON.stringify({type:"request",service:t,request_id:k(),body:{}});o.debug(`Sending post message request to origin ' ${a}': ${s}`,null,"sap.ushell.components.container.ApplicationContainer");e.postMessage(s,a)};return new T});
//# sourceMappingURL=PostMessageAPI.js.map
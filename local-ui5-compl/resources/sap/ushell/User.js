// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/base/i18n/Localization","sap/base/util/deepExtend","sap/ui/base/EventProvider","sap/ui/core/Core","sap/ui/core/Locale","sap/ui/core/LocaleData","sap/ui/thirdparty/URI"],function(e,t,n,i,o,r,a,s){"use strict";function h(e){if(e===undefined){return undefined}return n({},e)}function m(e){var t;if(e.host&&typeof e.host==="function"&&e.host()){t=e.host();if(typeof e.protocol==="function"&&e.protocol()){t=e.protocol()+"://"+t}return t}return""}function u(e){return e.indexOf("sap_")===0}var c=function(h){var g=[];var l;var p;var f;var d;var y=new i;const T={};h.userProfile?.forEach(e=>{if(e.id&&e.editState){T[e.id]=e.editState}});this.getEditState=function(e){return T[e]};this.getEmail=function(){return h.email};this.getFirstName=function(){return h.firstName};this.getFullName=function(){return h.fullName};this.getTimeZone=function(){return h.timeZone};this.getInitials=function(){var e=h.fullName||"";var t="";var n=true;for(var i=0,o=e.length;i<o;++i){if(e[i]===" "){n=true}else if(n){n=false;t+=e[i]}}return t};this.getId=function(){return h.id};this.getLanguage=function(){return h.language};this.getLanguageBcp47=function(){return h.languageBcp47};this.getLanguageText=function(){var e=new r(t.getLanguageTag());var n=new a(e);var i=t.getLanguageTag().toString();return n.getLanguageName(i)||this.getLanguage()};this.getLastName=function(){return h.lastName};this.getImage=function(){return h.image};this.getCalendarWeekNumbering=function(){return h.calendarWeekNumbering||"Default"};this.setImage=function(e){h.image=e;y.fireEvent("onSetImage",e)};this.attachOnSetImage=function(e,t){y.attachEvent("onSetImage",e,t)};this.isJamActive=function(){return h.isJamActive===true};this.isLanguagePersonalized=function(){return h.isLanguagePersonalized===true};this.getTheme=function(e){if(e===c.prototype.constants.themeFormat.ORIGINAL_THEME){return d.originalTheme.theme}if(e===c.prototype.constants.themeFormat.THEME_NAME_PLUS_URL){return f.theme+(f.locationPath?"@"+f.locationOrigin+f.locationPath:"")}if(e===c.prototype.constants.themeFormat.NWBC){if(u(f.theme)){return f.theme}return this.getTheme(c.prototype.constants.themeFormat.THEME_NAME_PLUS_URL)}return f.theme};this.getThemeRoot=function(e){if(h.ranges&&h.ranges.theme&&h.ranges.theme[e]&&h.ranges.theme[e].themeRoot){return h.ranges.theme[e].themeRoot}return""};this.setTheme=function(t){if(this.isSetThemePermitted()===false){var n="setTheme not permitted";e.error(n);throw new Error(n)}f=this._amendTheme({theme:t,root:this.getThemeRoot(t)},p);if(t!==d.originalTheme.theme){this.setChangedProperties({propertyName:"theme",name:"THEME"},d.originalTheme.theme,t);d=f}this.applyTheme(t)};this.applyTheme=function(e){var t=this._amendTheme({theme:e,root:this.getThemeRoot(e)},p);f=t;const n=o["applyTheme"];if(!n){sap.ui.require("sap/ui/core/Theming").setTheme(t.theme)}else if(t.suppliedRoot){n(t.theme,t.suppliedRoot+"/UI5/")}else if(t.path){n(t.theme,t.path+"/UI5/")}else{n(t.theme)}sap.ui.require(["sap/ushell/components/applicationIntegration/application/PostMessageUtils"],function(e){e.postMessageToMultipleIframes("sap.ushell.appRuntime","themeChange",{currentThemeId:this.getTheme(c.prototype.constants.themeFormat.NWBC),themeServiceRoute:window.location.protocol+"//"+window.location.host+"/comsapuitheming.runtime/themeroot/v1"})}.bind(this))};this.setLanguage=function(e){if(e){this.setChangedProperties({propertyName:"language",name:"LANGUAGE"},h.language,e);h.language=e}};this.getAccessibilityMode=function(){return h.accessibility};this.setAccessibilityMode=function(t){if(this.isSetAccessibilityPermitted()===false){var n="setAccessibilityMode not permitted";e.error(n);throw new Error(n)}h.accessibility=t};this.isAdminUser=function(){return h.isAdminUser===true};this.isSetAccessibilityPermitted=function(){return h.setAccessibilityPermitted};this.isSetThemePermitted=function(){return h.setThemePermitted};this.getContentDensity=function(){return h.contentDensity};this.setContentDensity=function(t){if(this.isSetContentDensityPermitted()===false){var n="setContentDensity not permitted";e.error(n);throw new Error(n)}e.debug("[000] setContentDensity",t,"User");this.setChangedProperties({propertyName:"contentDensity",name:"CONTENT_DENSITY"},h.contentDensity,t);h.contentDensity=t};this.isSetContentDensityPermitted=function(){return h.setContentDensityPermitted};this.getChangedProperties=function(){e.debug("[000] user: getChangedProperties: aChangedProperties",JSON.stringify(g),"User");return n([],g)};this.setChangedProperties=function(t,n,i){e.debug("[000] setChangedProperties",[t.name,n,i],"User");g.push({propertyName:t.propertyName,name:t.name,oldValue:n,newValue:i})};this.resetChangedProperties=function(){e.debug("[000] resetChangedProperties","User");g=[]};this.resetChangedProperty=function(t){e.debug("[000] resetChangedProperty: sPropertyName:",t,"User");g=g.filter(function(e){return!(t===e.propertyName)})};this.getTrackUsageAnalytics=function(){return h.trackUsageAnalytics};this.setTrackUsageAnalytics=function(e){this.setChangedProperties({propertyName:"trackUsageAnalytics",name:"TRACKING_USAGE_ANALYTICS"},h.trackUsageAnalytics,e);h.trackUsageAnalytics=e};this.setImageConsent=function(e){this.setChangedProperties({propertyName:"isImageConsent",name:"ISIMAGECONSENT"},h.isImageConsent,e);h.isImageConsent=e};this.getImageConsent=function(){return h.isImageConsent};this.getImportBookmarksFlag=function(){return h.importBookmarks||null};this.setImportBookmarksFlag=function(e){this.setChangedProperties({propertyName:"importBookmarks",name:"MYHOME_IMPORT_FROM_CLASSIC"},this.getImportBookmarksFlag()||"",e);h.importBookmarks=e};this.getShowMyHome=function(){return h.showMyHome!==false};this.setShowMyHome=function(e){e=!!e;this.setChangedProperties({propertyName:"showMyHome",name:"MYHOME_ENABLEMENT"},h.showMyHome,e);h.showMyHome=e};this.getDetectDarkMode=function(){return h.detectDarkMode!==false};this.setDetectDarkMode=function(e){e=!!e;this.setChangedProperties({propertyName:"detectDarkMode",name:"THEME_DARKMODE_AUTO_DETECTION"},h.detectDarkMode,e);h.detectDarkMode=e};p={locationPathUi5:new s(sap.ui.require.toUrl("")).absoluteTo(document.location).pathname(),locationPathCustom:h.themeRoot||"",locationOrigin:m(new s(document.location))};if(!p.locationPathUi5){e.warning("User: Could not set UI5 location path")}if(!p.locationPathCustom){e.warning("User: Could not set location path for custom themes")}if(!p.locationOrigin){e.warning("User: Could not set front-end server location origin")}l=h.bootTheme||{theme:"",root:""};f=this._amendTheme(l,p);d=f};c.prototype._amendTheme=function(e,t){if(!e||!e.theme||!t){return{originalTheme:{theme:"",root:""},theme:"",suppliedRoot:"",path:"",locationPath:"",locationOrigin:""}}function n(e,t){var n=new s(e);var i=m(n);return{locationOrigin:i||t.locationOrigin,locationPath:i?n.path():e}}var i={originalTheme:h(e)};var o;if(i.originalTheme.theme.indexOf("@")>0){var r=i.originalTheme.theme.split("@",2);i.theme=r[0];i.suppliedRoot=r[1];o=n(r[1],t);i.locationPath=o.locationPath;i.path=i.locationPath;i.locationOrigin=o.locationOrigin;return i}i.theme=i.originalTheme.theme;if(i.originalTheme.root){i.suppliedRoot=i.originalTheme.root;o=n(i.originalTheme.root,t);i.locationPath=o.locationPath;i.path=i.locationPath;i.locationOrigin=o.locationOrigin;return i}i.suppliedRoot="";if(u(i.theme)){i.locationOrigin=t.locationOrigin;i.locationPath=t.locationPathUi5;i.path="";return i}i.locationOrigin=t.locationOrigin;i.locationPath=t.locationPathCustom;i.path=i.locationPath;return i};c.prototype.constants={themeFormat:{ORIGINAL_THEME:"O",THEME_NAME_PLUS_URL:"N+U",NWBC:"NWBC"}};return c},true);
//# sourceMappingURL=User.js.map
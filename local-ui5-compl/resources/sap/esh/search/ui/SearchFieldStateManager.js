/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["./SearchShellHelperHorizonTheme","sap/ui/core/Element"],function(e,t){"use strict";function s(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const i=s(e);class a{isSearchInputFocused;isNoResultsScreen;isSearchFieldExpandedByDefault;constructor(e){this.isSearchInputFocused=e.isSearchInputFocused;this.isNoResultsScreen=e.isNoResultsScreen;this.isSearchFieldExpandedByDefault=e.isSearchFieldExpandedByDefault}equals(e){return this.isSearchInputFocused===e.isSearchInputFocused&&this.isNoResultsScreen===e.isNoResultsScreen&&this.isSearchFieldExpandedByDefault===e.isSearchFieldExpandedByDefault}toString(){return`focused:${this.isSearchInputFocused} no-results:${this.isNoResultsScreen} shall-be-expanded:${this.isSearchFieldExpandedByDefault}`}}class h{shellHeader;cancelButton;searchInput;model;isNoResultsScreen;focusInputFieldTimeout;state;checkState;checkMode;constructor(e){this.shellHeader=e.shellHeader;this.cancelButton=e.cancelButton;this.searchInput=e.searchInput;this.model=e.model;this.isNoResultsScreen=e.isNoResultsScreen;const t=this?.model?.config?.searchFieldCheckInterval??100;if(t>0){setInterval(this.checkStateChange.bind(this),t)}}checkStateChange(){const e=this.getState();if(!this.checkMode){if(!this.state||!e.equals(this.state)){this.checkMode=true;this.checkState=e}}else{if(e.equals(this.checkState)){this.handleStateChanged(e)}this.checkMode=false}}getState(){return new a({isNoResultsScreen:this.isNoResultsScreen(),isSearchInputFocused:this.isSearchInputFocused(),isSearchFieldExpandedByDefault:i.isSearchFieldExpandedByDefault()})}isOverlayShown(){return!!document.querySelector(".sapUshellShellShowSearchOverlay")}isSearchInputFocused(){if(!this.searchInput||!this.searchInput.getDomRef()){return false}return this.searchInput.getDomRef().contains(document.activeElement)}handleStateChanged(e){const t=this.state;this.state=e;if(this.model){this.model.calculateSearchButtonStatus()}const s=e.isSearchInputFocused&&!e.isNoResultsScreen;switch(this.shellHeader.getSearchState()){case"EXP":if(!e.isSearchFieldExpandedByDefault&&t&&t.isSearchFieldExpandedByDefault&&this.searchInput.getValue()===""){this.collapseSearch();return}if(s&&!this.isOverlayShown()){this.shellHeader.setSearchState("EXP_S",35,false);this.shellHeader.setSearchState("EXP",35,true)}if(!s&&this.isOverlayShown){this.shellHeader.setSearchState("EXP_S",35,false);this.shellHeader.setSearchState("EXP",35,false)}break;case"COL":if(e.isSearchFieldExpandedByDefault){this.expandSearch()}break}}getShellSearchButton(){return t.getElementById("sf")}expandSearch(e){const t=this.getShellSearchButton();if(!t){return}this.shellHeader.setSearchState("EXP",35,false);this.cancelButton.setVisible(true);t.setVisible(false);if(e){this.focusInputField({selectContent:false})}}collapseSearch(e){const s=this.getShellSearchButton();if(!s){return}this.model.abortSuggestions();this.shellHeader.setSearchState("COL",35,false);this.cancelButton.setVisible(false);s.setVisible(true);if(e){window.setTimeout(()=>{t.getElementById("sf").focus()},1e3)}}focusInputField(e={}){if(this.focusInputFieldTimeout){window.clearTimeout(this.focusInputFieldTimeout);this.focusInputFieldTimeout=null}const t=s=>{if(!this.searchInput){return}this.focusInputFieldTimeout=null;const i=this.searchInput.getDomRef();if(i&&jQuery(i).is(":visible")){if(this.searchInput.getEnabled()){this.searchInput.focus();if(e.selectContent){this.searchInput.selectText(0,9999)}return}}if(s>0){this.focusInputFieldTimeout=window.setTimeout(()=>{if(!this.model.getProperty("/initializingObjSearch")){s--}t(s)},100)}};t(10)}}return h})})();
//# sourceMappingURL=SearchFieldStateManager.js.map
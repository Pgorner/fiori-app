/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["../../i18n","sap/m/IconTabFilter","sap/m/Button","../../error/errors","./types/SearchFacetQuickSelectDataSource","./types/SearchFacetHierarchyDynamic","./types/SearchFacetHierarchyStatic","./types/tabbarfacet/SearchFacetBarChart","./types/tabbarfacet/SearchFacetPieChart","sap/ui/core/Control","./types/tabbarfacet/SearchFacetTabBar","../../eventlogging/UserEvents","../OpenShowMoreDialog","sap/m/library","./FacetTypeUI","./types/tabbarfacet/SearchFacetSimpleList","sap/m/FlexBox","sap/m/Label"],function(e,t,a,n,r,c,s,o,i,l,h,d,u,p,f,S,g,y){"use strict";function F(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const b=F(e);const w=F(n);const C=F(r);const B=F(c);const A=F(s);const m=F(o);const T=F(i);const U=F(h);const x=d["UserEventType"];const D=u["openShowMoreDialog"];const I=p["ButtonType"];const k=p["FlexAlignItems"];const H=p["FlexJustifyContent"];const _=f["FacetTypeUI"];const M=F(S);const v=l.extend("sap.esh.search.ui.controls.SearchFacetList",{renderer:{apiVersion:2,render(e,t){const a=t.getModel();e.openStart("div",t);e.class("sapUshellSearchFacetList");e.class("sapUshellSearchFacetFilter");e.openEnd();const n=t.getAggregation("facets");for(let a=0,r=n.length;a<r;a++){const r=n[a];t.renderSectionHeader(e,n,a);const c=r.getBindingContext().getObject();switch(c.facetType){case _.Attribute:r.switchFacetType(_.Attribute);r.attachSelectionChange(null,()=>{const e=t._getShowAllButton();const a=e.getDomRef();if(a){jQuery(a).hide()}else{}});if(c.position<=499){r.addStyleClass("sapUshellSearchFacetSearchInAttribute")}e.renderControl(r);break;case _.DataSource:r.switchFacetType(_.DataSource);r.addStyleClass("sapUshellSearchFacetDataSource");e.renderControl(r);break;case _.QuickSelectDataSource:r.addStyleClass("sapUshellSearchFacetQuickSelectDataSource");e.renderControl(r);break;case _.Hierarchy:if(c.position<=499){r.addStyleClass("sapUshellSearchFacetSearchInAttribute")}r.addStyleClass("sapUshellSearchFacetHierarchyDynamic");e.renderControl(r);break;case _.HierarchyStatic:r.addStyleClass("sapUshellSearchFacetHierarchyStatic");e.renderControl(r);break;default:throw"program error: unknown facet type :"+c.facetType}}if(a.getDataSource()?.type==="BusinessObject"){const n=a.oFacetFormatter.hasDialogFacetsFromMetaData(a);const r=t.getModel().getProperty("/boCount")>0;if(n&&r){const a=t._getShowAllButton();if(a!==null){e.openStart("div",t.getId()+"-showAllFilters");e.openEnd();a.setModel(t.getModel("i18n"));a.addStyleClass("sapUshellSearchFacetListShowAllFilterBtn");a.addStyleClass("sapUshellSearchFacetFilterShowAllFilterBtn");e.renderControl(a);e.close("div")}}}e.close("div")}},metadata:{aggregations:{facets:{singularName:"facet",bindable:"bindable",multiple:true},_showAllBtn:{type:"sap.m.Button",multiple:false,visibility:"hidden"}}},constructor:function e(t,a){l.prototype.constructor.call(this,t,a);this.data("sap-ui-fastnavgroup","true",true);this.bindFacets()},bindFacets:function e(){if(!this.getBindingInfo("facets")){this.bindAggregation("facets",{path:"/facets",factory:(e,a)=>{const n=a.getObject();const r=a.getModel();const c=r.config;switch(n.facetType){case _.Attribute:{let a=`${e}-attribute_facet`;if(typeof c?.getSpaceFacetId==="function"){a=c.getSpaceFacetId(n.dimension,a)}const r=new U(a,{items:[new t({text:b.getText("facetList"),icon:"sap-icon://list",key:`list${e}`,content:new M(`list${e}`)}),new t({text:b.getText("facetBarChart"),icon:"sap-icon://horizontal-bar-chart",key:`barChart${e}`,content:new m(`barChart${e}`)}),new t({text:b.getText("facetPieChart"),icon:"sap-icon://pie-chart",key:`pieChart${e}`,content:new T(`pieChart${e}`)})]});r.addStyleClass("sapUshellSearchFacetIconTabBar");return r}case _.DataSource:{const e=new M((c?.id?c.id+"-":"")+"dataSourceFacet",{facetType:_.DataSource});if(c.exclusiveDataSource){e.setVisible(false)}return e}case _.QuickSelectDataSource:{const e=new C((c?.id?c.id+"-":"")+"sapUshellSearchFacetQuickSelectDataSource",{});return e}case _.Hierarchy:{const t=`${e}-hierarchy_facet`;const a=new B(t,{openShowMoreDialogFunction:D});return a}case _.HierarchyStatic:{const t=`${e}-hierarchyStatic_facet`;return new A(t,{})}default:{const e=new Error(`Program error: Unknown facet type: '${n.facetType}'`);throw new w.UnknownFacetType(e)}}}})}},getFirstFilterByFacet:function e(t){for(const e of t){const t=e.getBindingContext().getObject();if(t.facetType===_.Attribute||t.facetType===_.Hierarchy){return e}}},doRenderSectionHeader:function e(t,n,r,c){const s=[];const o=new y({text:n});o.addStyleClass("sapUshellSearchFacetSectionHeader");s.push(o);if(r){const e=this.getModel();let t=false;const n=e.getProperty("/uiFilter/rootCondition");if(n.hasFilters()){t=true;if(e.filterWithoutFilterByConditions()){t=false}if(typeof e.config.hasSpaceFiltersOnly==="function"){if(e.config.hasSpaceFiltersOnly(n)===true){t=false}}}else{t=false}const r=new a("",{icon:"sap-icon://clear-filter",tooltip:b.getText("resetFilterButton_tooltip"),type:I.Transparent,enabled:t,press:()=>{e.eventLogger.logEvent({type:x.CLEAR_ALL_FILTERS});e.resetFilterByFilterConditions(true)}});r.addStyleClass("sapUshellSearchFilterByResetButton");s.push(r)}const i=new g({justifyContent:H.SpaceBetween,alignItems:k.Center,items:s});if(c){i.addStyleClass(c)}t.renderControl(i)},renderSectionHeader:function e(t,a,n){const r=a[n];if(n===0){this.doRenderSectionHeader(t,b.getText("searchIn"),false,"sapUshellSearchInSection");return}if(this.getFirstFilterByFacet(a)===r){this.doRenderSectionHeader(t,b.getText("filterBy"),true);return}},onAfterRendering:function e(){const t=$(".searchFacetList .searchFacet").first().find("ul");const a=t.find("li");t.attr("role","tree");a.attr("role","treeitem")},_getShowAllButton:function e(){if(this.getAggregation("_showAllBtn")===null){const e=async()=>{const e=this.getModel();await D({searchModel:e,dimension:undefined,selectedTabBarIndex:0,tabBarItems:undefined,sourceControl:this})};const t=new a(`${this.getId()}-ShowMoreAll`,{text:"{showAllFilters}",press:e,visible:true});this.setAggregation("_showAllBtn",t)}return this.getAggregation("_showAllBtn")}});return v})})();
//# sourceMappingURL=SearchFacetList.js.map
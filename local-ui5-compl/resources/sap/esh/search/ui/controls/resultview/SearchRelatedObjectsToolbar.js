/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["../../i18n","sap/m/Toolbar","sap/m/library","sap/m/Button","sap/m/ToolbarLayoutData","sap/m/ToolbarSpacer","sap/m/ActionSheet","sap/ui/core/InvisibleText","sap/ui/core/IconPool","sap/ui/core/delegate/ItemNavigation","sap/ui/core/Control","../../sinaNexTS/sina/NavigationTarget","../SearchLink"],function(t,e,o,s,i,a,n,r,l,c,d,h,g){"use strict";function u(t){return t&&t.__esModule&&typeof t.default!=="undefined"?t.default:t}const p=u(t);const b=o["ToolbarDesign"];const f=o["ButtonType"];const m=o["PlacementType"];const _=h["NavigationTarget"];const v=u(g);const y=d.extend("sap.esh.search.ui.controls.SearchRelatedObjectsToolbar",{renderer:{apiVersion:2,render(t,e){t.openStart("div",e);t.class("sapUshellSearchResultListItem-RelatedObjectsToolbar");const o=e.getModel();if(o.config.optimizeForValueHelp){t.class("sapUshellSearchResultListItem-RelatedObjectsToolbarValueHelp")}t.openEnd();t.renderControl(e.getAggregation("_ariaDescriptionForLinks"));e._renderToolbar(t,e);t.close("div")}},metadata:{properties:{itemId:"string",navigationObjects:{type:"object",multiple:true},positionInList:"int"},aggregations:{_relatedObjectActionsToolbar:{type:"sap.m.Toolbar",multiple:false,visibility:"hidden"},_ariaDescriptionForLinks:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"}}},constructor:function t(o,s){d.prototype.constructor.call(this,o,s);const i=new e(`${this.getId()}--toolbar`,{design:b.Solid});i.data("sap-ui-fastnavgroup","false",true);i.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Toolbar");i.addEventDelegate({onAfterRendering:this.layoutToolbarElements.bind(this)});this.setAggregation("_relatedObjectActionsToolbar",i);this.setAggregation("_ariaDescriptionForLinks",new r({text:p.getText("result_list_item_aria_has_more_links")}));$(window).on("resize",()=>{this.layoutToolbarElements()})},exit:function t(...e){if(d.prototype.exit){d.prototype.exit.apply(this,e)}if(this._overFlowSheet){this._overFlowSheet.destroy()}},_renderToolbar:function t(e,o){const r=o.getModel();const c=o.getAggregation("_relatedObjectActionsToolbar");c.destroyContent();if(r.config.optimizeForValueHelp){c.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-ToolbarValueHelp")}const d=o.getProperty("navigationObjects");if(Array.isArray(d)&&d.length>0){const t=[];for(let e=0;e<d.length;e++){const s=d[e];const a=new v(`${o.getId()}--link_${e}`,{text:s?.text||"",navigationTarget:s,layoutData:new i({shrinkable:false})});a.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Element");t.push(a)}const h=new a;h.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Spacer");c.addContent(h);for(let e=0;e<t.length;e++){c.addContent(t[e])}this._overFlowButton=new s(`${this.getId()}--overflowButton`,{icon:l.getIconURI("overflow")});this._overFlowButton.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-OverFlowButton");if(r.config.optimizeForValueHelp){this._overFlowButton.addStyleClass("sapUiSmallMarginBegin");this._overFlowButton.addStyleClass("sapUiTinyMarginEnd");this._overFlowButton.setType(f.Transparent)}c.addContent(this._overFlowButton);if(!this._overFlowSheet){this._overFlowSheet=new n(`${this.getId()}--actionSheet`,{placement:m.Top})}this._overFlowButton.attachPress(()=>{if(this._overFlowSheet.isOpen()){this._overFlowSheet.close()}else{this._overFlowSheet.openBy(this._overFlowButton)}});e.renderControl(c)}},onAfterRendering:function t(){if(this.getAggregation("_relatedObjectActionsToolbar")){this._addAriaInformation()}},layoutToolbarElements:function t(){if(this.isDestroyed()||this.isDestroyStarted()){return}const e=this.getAggregation("_relatedObjectActionsToolbar");if(!(this.getDomRef()&&e.getDomRef())){return}const o=$(e.getDomRef());const i=o.width();if($(this.getDomRef()).css("display")==="none"||o.css("display")==="none"){return}this.toolbarWidth=i;const a=$(this._overFlowButton.getDomRef());a.css("display","none");let n=0;const r=(t,e)=>{if(e instanceof _){e.performNavigation({event:t})}};const l=o.find(".sapUshellSearchResultListItem-RelatedObjectsToolbar-Element");for(let t=0;t<l.length;t++){let e=$(l[t]);e.css("display","");let o=n+e.outerWidth(true);if(o>i){a.css("display","");const n=a.outerWidth(true);for(;t>=0;t--){e=$(l[t]);o-=e.outerWidth(true);if(o+n<=i){break}}const c=this.getProperty("navigationObjects");this._overFlowSheet.destroyButtons();t=t>=0?t:0;for(;t<l.length;t++){e=$(l[t]);e.css("display","none");const o=c[t];const i=new s({text:o?.text||""});i.attachPress(o,r);this._overFlowSheet.addButton(i)}break}n=o}this._setupItemNavigation()},_setupItemNavigation:function t(){if(!this._theItemNavigation){this._theItemNavigation=new c(null,[]);this["addDelegate"](this._theItemNavigation)}this._theItemNavigation.setCycling(false);this._theItemNavigation.setRootDomRef(this.getDomRef());const e=[];const o=this.getAggregation("_relatedObjectActionsToolbar");const s=o.getContent();for(let t=0;t<s.length;t++){if(!s[t].hasStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Element")){continue}if(!$(s[t].getDomRef()).attr("tabindex")){let e="-1";if(s[t]["getPressed"]&&s[t]["getPressed"]()){e="0"}$(s[t].getDomRef()).attr("tabindex",e)}e.push(s[t].getDomRef())}const i=this._overFlowButton.getDomRef();e.push(i);$(i).attr("tabindex","-1");this._theItemNavigation.setItemDomRefs(e)},_addAriaInformation:function t(){const e=$(this.getAggregation("_relatedObjectActionsToolbar").getDomRef());const o=e.find(".sapUshellSearchResultListItem-RelatedObjectsToolbar-Element");const s=$(this._overFlowButton.getDomRef());if(o.length>0||s.is(":visible")){const t=this.getAggregation("_ariaDescriptionForLinks").getId();o.each(function(){const e=$(this);let o=e.attr("aria-describedby")||"";o+=" "+t;e.attr("aria-describedby",o)});if(s.is(":visible")){let e=s.attr("aria-describedby")||"";e+=" "+t;s.attr("aria-describedby",e)}}}});return y})})();
//# sourceMappingURL=SearchRelatedObjectsToolbar.js.map
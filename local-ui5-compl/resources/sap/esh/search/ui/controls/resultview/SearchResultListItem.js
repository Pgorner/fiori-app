/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["../../i18n","./SearchText","sap/esh/search/ui/SearchHelper","./SearchRelatedObjectsToolbar","../../SearchUtil","sap/m/Button","sap/m/library","sap/m/Label","sap/m/Text","sap/m/CheckBox","sap/ui/core/Icon","sap/ui/core/IconPool","sap/ui/core/InvisibleText","sap/ui/core/Control","sap/ui/base/ManagedObject","../../eventlogging/UserEvents","../../UIUtil","../SearchLink","../../sinaNexTS/sina/NavigationTarget","../../uiConstants"],function(e,t,i,s,a,n,l,r,o,c,d,h,u,p,g,m,f,b,I,S){"use strict";function y(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const A=y(e);const L=y(t);const _=y(s);const x=l["ButtonType"];const R=l["ListType"];const T=m["UserEventType"];const C=f["registerHandler"];const U=y(b);const D=I["NavigationTarget"];const E=S["initialValueUnicode"];const v=p.extend("sap.esh.search.ui.controls.SearchResultListItem",{renderer:{apiVersion:2,render(e,t){t._renderer(e,t)}},metadata:{properties:{dataSource:"object",itemId:"string",title:"string",isTitleHighlighted:"boolean",titleDescription:"string",isTitleDescriptionHighlighted:"boolean",titleNavigation:"object",titleIconUrl:"string",titleInfoIconUrl:"string",geoJson:"object",type:"string",imageUrl:"string",imageFormat:"string",imageNavigation:"object",attributes:{type:"object",multiple:true},navigationObjects:{type:"object",multiple:true},selected:"boolean",selectionEnabled:"boolean",customItemStyleClass:"string",expanded:"boolean",parentListItem:"object",additionalParameters:"object",positionInList:"int",resultSetId:"string",layoutCache:"object",countBreadcrumbsHiddenElement:"object"},aggregations:{_titleLink:{type:"sap.esh.search.ui.controls.SearchLink",multiple:false,visibility:"hidden"},_titleText:{type:"sap.esh.search.ui.controls.SearchText",multiple:false,visibility:"hidden"},_titleLinkDescription:{type:"sap.esh.search.ui.controls.SearchText",multiple:false,visibility:"hidden"},_titleInfoIcon:{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"},_titleDelimiter:{type:"sap.m.Text",multiple:false,visibility:"hidden"},_typeText:{type:"sap.esh.search.ui.controls.SearchText",multiple:false,visibility:"hidden"},_typeLink:{type:"sap.esh.search.ui.controls.SearchLink",multiple:false,visibility:"hidden"},_typeLinkAriaDescription:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"},_multiLineDescriptionText:{type:"sap.esh.search.ui.controls.SearchText",multiple:false,visibility:"hidden"},_selectionCheckBox:{type:"sap.m.CheckBox",multiple:false,visibility:"hidden"},_expandButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"},_attributeLabels:{type:"sap.m.Label",multiple:true,visibility:"hidden"},_attributeValues:{type:"sap.ui.core.Control",multiple:true,visibility:"hidden"},_attributeValuesWithoutWhyfoundHiddenTexts:{type:"sap.ui.core.InvisibleText",multiple:true,visibility:"hidden"},_relatedObjectActionsToolbar:{type:"sap.esh.search.ui.controls.SearchRelatedObjectsToolbar",multiple:false,visibility:"hidden"},_titleLabeledByText:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"},_attributesLabeledByText:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"},_expandStateLabeledByText:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"}}},constructor:function e(t,i){p.prototype.constructor.call(this,t,i);this._visibleAttributes=undefined;this._detailsArea=undefined;this._showExpandButton=false;this.setAggregation("_titleLink",new U(`${this.getId()}--titleLink`).addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-Title").addStyleClass("sapUshellSearchResultListItem-MightOverflow"));this.setAggregation("_titleText",new L(`${this.getId()}--titleText`,{wrapping:false}).addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-Title").addStyleClass("sapUshellSearchResultListItem-MightOverflow"));this.setAggregation("_titleLinkDescription",new L(`${this.getId()}--titleLinkDescription`,{wrapping:false}).addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-TitleDescription").addStyleClass("sapUshellSearchResultListItem-MightOverflow"));const s={src:{path:"titleInfoIconUrl"}};const a=new d(`${this.getId()}--titleInfoIcon`,s);a.addStyleClass("sapUiSmallMarginEnd");this.setAggregation("_titleInfoIcon",a);a.addStyleClass("sapUshellSearchResultListItem-TitleInfoIcon");const l=new o(`${this.getId()}--titleDelimiter`,{text:"|"});l.addEventDelegate({onAfterRendering:()=>{$(l.getDomRef()).attr("aria-hidden","true")}});this.setAggregation("_titleDelimiter",l.addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-TitleDelimiter").addStyleClass("sapUshellSearchResultListItem-MightOverflow"));this.setAggregation("_typeText",new L(`${this.getId()}--typeText`).addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-TitleCategory").addStyleClass("sapUshellSearchResultListItem-MightOverflow"));this.setAggregation("_typeLinkAriaDescription",new u({text:A.getText("result_list_item_type_link_description")}));this.setAggregation("_typeLink",new U(`${this.getId()}--typeLink`).addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-TitleCategoryLink").addStyleClass("sapUshellSearchResultListItem-MightOverflow").addAriaDescribedBy(this.getAggregation("_typeLinkAriaDescription")));this.setAggregation("_multiLineDescriptionText",new L(`${this.getId()}--multilineDescription`,{maxLines:5}).addStyleClass("sapUshellSearchResultListItem-MultiLineDescription").addStyleClass("sapUshellSearchResultListItem-MightOverflow").data("islongtext","true",true));this.setAggregation("_selectionCheckBox",new c(`${this.getId()}--selectionCheckbox`,{select:e=>{this.setProperty("selected",e.getParameter("selected"),true);const t=this.getModel();t.updateMultiSelectionSelected();if(e.getParameter("selected")){this.addStyleClass("sapUshellSearchResultListItem-Selected")}else{this.removeStyleClass("sapUshellSearchResultListItem-Selected")}}}));this.setAggregation("_expandButton",new n(`${this.getId()}--expandButton`,{type:x.Transparent,press:()=>{this.toggleDetails()}}));this.setAggregation("_relatedObjectActionsToolbar",new _(`${this.getId()}--relatedObjectActionsToolbar`));this.setAggregation("_titleLabeledByText",new u);this.setAggregation("_attributesLabeledByText",new u);this.setAggregation("_expandStateLabeledByText",new u)},_renderer:function e(t,i){const s=$(this.getDomRef());const a=s.find(".sapUshellSearchResultListItem-RelatedObjectsToolbar");if(a.css("display")==="none"){const e=this.getModel();if(e.config.optimizeForValueHelp){a.css("display","block")}}this._registerItemPressHandler();this._resetPrecalculatedValues();this._renderContainer(t,i);this._renderAccessibilityInformation(t)},_renderContainer:function e(t,i){const s=this.getModel();t.openStart("div",this);if(this.getProperty("customItemStyleClass")){t.class(this.getProperty("customItemStyleClass"))}t.class("sapUshellSearchResultListItem-Container");if(this.getProperty("imageUrl")){t.class("sapUshellSearchResultListItem-WithImage")}if(this.getProperty("imageFormat")?.toLowerCase()==="documentthumbnail"){t.class("sapUshellSearchResultListItem-Document")}t.openEnd();this._renderContentContainer(t,i);if(!s.config.optimizeForValueHelp){this._renderExpandButtonContainer(t)}t.close("div")},_renderContentContainer:function e(t,i){const s=i.getModel();t.openStart("div",i.getId()+"-content");t.class("sapUshellSearchResultListItem-Content");if(!s.config.optimizeForValueHelp){t.class("sapUshellSearchResultListItem-ContentValueHelp")}t.openEnd();this._renderTitleContainer(t,i);this._renderAttributesContainer(t);t.close("div")},_renderExpandButtonContainer:function e(t){t.openStart("div",this.getId()+"-expand-button-container");t.class("sapUshellSearchResultListItem-ExpandButtonContainer");t.openEnd();t.openStart("div",this.getId()+"-expand-button");t.class("sapUshellSearchResultListItem-ExpandButton");t.openEnd();let i,s;const a=this.getProperty("expanded");if(a){i=h.getIconURI("slim-arrow-up");s=A.getText("hideDetailBtn_tooltip")}else{i=h.getIconURI("slim-arrow-down");s=A.getText("showDetailBtn_tooltip")}const n=this.getAggregation("_expandButton");n.setIcon(i);n.setTooltip(s);n.addEventDelegate({onAfterRendering:()=>{this.setAriaExpandedState()}});t.renderControl(n);t.close("div");t.close("div")},_renderTitleContainer:function e(t,i){const s=this.getModel();if(!s.config.optimizeForValueHelp){t.openStart("div",this.getId()+"-title-and-image-container");t.class("sapUshellSearchResultListItem-TitleAndImageContainer");t.openEnd()}t.openStart("div",this.getId()+"-title-container");t.class("sapUshellSearchResultListItem-TitleContainer");if(s.config.optimizeForValueHelp){t.class("sapUshellSearchResultListItem-TitleContainerValueHelp")}t.openEnd();this._renderCheckbox(t);const a=this.getProperty("titleNavigation");let n=this.getProperty("title");let l;if(!n||n.trim().length===0){n=v.noValue;l=this.getAggregation("_titleText")}else if(!a&&!this.isHierarchyItem()){l=this.getAggregation("_titleText")}else{l=this.getAggregation("_titleLink");l.setNavigationTarget(a);if(this.isHierarchyItem()){setTimeout(()=>{if(this.supportsDragAndDrop(l,s)){l.getDomRef()["draggable"]=false;this.addStyleClass("sapUshellSearchResultListItem-NotDraggableNotClickable")}},100)}else if(s.config.optimizeForValueHelp){setTimeout(()=>{if(this.supportsDragAndDrop(l,s)){l.getAggregation("_link").getDomRef()["draggable"]=false;const e=l.getAggregation("icon");if(e instanceof d){e.getDomRef()["draggable"]=false}}},100)}}l.setText(n);if(this.getProperty("isTitleHighlighted")){l.addStyleClass("sapUshellSearchResultItem-AttributeValueHighlighted")}const r=l.getAggregation("icon");if(r instanceof d){r.addStyleClass("sapUshellSearchResultListItem-Clickable")}else if(this.getProperty("titleIconUrl")){const e=new d(`${this.getId()}--titleIcon`,{src:g.escapeSettingsValue(this.getProperty("titleIconUrl"))});e?.addStyleClass("sapUshellSearchResultListItem-Clickable");l.setIcon(e);setTimeout(()=>{if(!this.isHierarchyItem()&&this.supportsDragAndDrop(l,s)){const t=e?.getDomRef();if(t){t["draggable"]=false}}},100)}t.renderControl(l);if(i.getProperty("titleInfoIconUrl")){const e=i.getAggregation("_titleInfoIcon");if(e){if(s.config.optimizeForValueHelp){e.addStyleClass("sapUshellSearchResultListItem-TitleInfoIconValueHelp")}t.renderControl(e)}}if(!s.config.optimizeForValueHelp){const e=this.getProperty("titleDescription");if(e&&e.trim().length>0){const i=this.getAggregation("_titleLinkDescription");i.setText(e);if(this.getProperty("isTitleDescriptionHighlighted")){i.addStyleClass("sapUshellSearchResultItem-AttributeValueHighlighted")}t.renderControl(i)}}if(s.config.optimizeForValueHelp){this._renderRelatedObjectsToolbar(t)}else if(!s.config.exclusiveDataSource){const e=this.getAggregation("_titleDelimiter");t.renderControl(e);if(s.getDataSource()===this.getProperty("dataSource")){const e=this.getAggregation("_typeText");e.setText(this.getProperty("type"));t.renderControl(e)}else{const e=this.getModel().getProperty("/uiFilter").clone();e.setDataSource(this.getProperty("dataSource"));const i=s.createSearchNavigationTarget(e,this.getProperty("type"));const a=this.getAggregation("_typeLink");a.setNavigationTarget(i);a.setText(this.getProperty("type"));a.setTooltip(A.getText("searchInDataSourceTooltip",[this.getProperty("dataSource").labelPlural]));t.renderControl(this.getAggregation("_typeLinkAriaDescription"));t.renderControl(a)}}t.close("div");if(!s.config.optimizeForValueHelp){this._renderImageForPhone(t);t.close("div")}},_renderCheckbox:function e(t){t.openStart("div",this.getId()+"-checkbox-expand-container");t.class("sapUshellSearchResultListItem-CheckboxExpandContainer");t.openEnd();t.openStart("div",this.getId()+"-checkbox-container");t.class("sapUshellSearchResultListItem-CheckboxContainer");t.openEnd();t.openStart("div",this.getId()+"-checkbox-alignment-container");t.class("sapUshellSearchResultListItem-CheckboxAlignmentContainer");t.openEnd();const i=this.getAggregation("_selectionCheckBox");const s=this.getProperty("selected");const a=this.getProperty("selectionEnabled");i.setSelected(s);i.setEnabled(a);t.renderControl(i);t.close("div");t.close("div");t.close("div")},_renderImageForPhone:function e(t){if(this.getProperty("imageUrl")){t.openStart("div",this.getId()+"-title-image");t.class("sapUshellSearchResultListItem-TitleImage");if(this.getProperty("imageFormat")==="round"){t.class("sapUshellSearchResultListItem-ImageContainerRound")}t.openEnd();t.openStart("div",this.getId()+"-image-container-aligmnent-helper");t.class("sapUshellSearchResultListItem-ImageContainerAlignmentHelper");t.openEnd();t.close("div");t.openStart("img",this.getId()+"-image-1");t.class("sapUshellSearchResultListItem-Image");t.attr("src",this.getProperty("imageUrl"));t.openEnd();t.close("div");t.close("div")}},_renderImageForDocument:function e(t){if(this.getProperty("imageFormat")&&this.getProperty("imageFormat").toLowerCase()==="documentthumbnail"){const e=this.getProperty("imageNavigation");const i=e?e.targetUrl:"";if(typeof this._zoomIcon!=="undefined"){this._zoomIcon.destroy()}this._zoomIcon=new d("",{src:h.getIconURI("search"),useIconTooltip:false});this._zoomIcon.addStyleClass(`${this.getId()}--zoomIcon`);this._zoomIcon.addStyleClass("sapUshellSearchResultListItem-DocumentThumbnailZoomIcon");const s=this.getProperty("imageUrl");t.openStart("div",this.getId()+"-document-thumbnail-container");t.class("sapUshellSearchResultListItem-DocumentThumbnailContainer");t.openEnd();if(i&&i.length>0){t.openStart("a",this.getId()+"-document-thumbnail-border-1");t.attr("href",i);t.class("sapUshellSearchResultListItem-DocumentThumbnailBorder");t.openEnd();t.openStart("div",this.getId()+"-document-thumbnail-dogear-1");t.class("sapUshellSearchResultListItem-DocumentThumbnail-DogEar");t.openEnd();t.close("div");t.renderControl(this._zoomIcon);if(s&&s.length>0){t.openStart("img",this.getId()+"-document-thumbnail-1");t.class("sapUshellSearchResultListItem-DocumentThumbnail");t.attr("src",this.getProperty("imageUrl"));t.openEnd();t.close("img")}t.close("a")}else{t.openStart("div",this.getId()+"-document-thumbnail-border-2");t.class("sapUshellSearchResultListItem-DocumentThumbnailBorder");t.openEnd();t.openStart("div",this.getId()+"-document-thumbnail-dogear-2");t.class("sapUshellSearchResultListItem-DocumentThumbnail-DogEar");t.openEnd();t.close("div");t.renderControl(this._zoomIcon);if(s&&s.length>0){t.openStart("img",this.getId()+"-document-thumbnail-2");t.class("sapUshellSearchResultListItem-DocumentThumbnail");t.attr("src",this.getProperty("imageUrl"));t.openEnd();t.close("img")}t.close("div")}t.close("div")}},_cutDescrAttributeOutOfAttributeList:function e(){const t=this.getProperty("attributes");for(let e=0;e<t.length;e++){const i=t[e];if(i.longtext){t.splice(e,1);this.setProperty("attributes",t);return i}}return undefined},_renderMultiLineDescription:function e(t){const i=this.getModel();if(this.getProperty("imageFormat")?.toLowerCase()==="documentthumbnail"){const e=this._cutDescrAttributeOutOfAttributeList();if(e?.value?.length>0){const s=this.getAggregation("_multiLineDescriptionText");s.setText(e.value);if(e.whyfound){s.data("ishighlighted","true",true)}else{s.data("ishighlighted","false",true)}if(e.valueWithoutWhyfound){const i=new u({});i.setText(e.valueWithoutWhyfound);s.data("tooltippedBy",i.getId(),true);s.addEventDelegate({onAfterRendering:()=>{const e=$(s.getDomRef());e.attr("aria-describedby",e.attr("data-tooltippedby"))}});this.addAggregation("_attributeValuesWithoutWhyfoundHiddenTexts",i,true);t.renderControl(i)}this.adjustCssDragAndDrop(s,i);t.renderControl(s)}else{t.openStart("div",this.getId()+"-multiline-description");t.class("sapUshellSearchResultListItem-MultiLineDescription");t.openEnd();t.close("div")}}},_renderAttributesContainer:function e(t){const i=this.getModel();t.openStart("div",this.getId()+"-attribute-expand-container");t.class("sapUshellSearchResultListItem-AttributesExpandContainer");if(i.config.optimizeForValueHelp){t.class("sapUshellSearchResultListItem-AttributesExpandContainerValueHelp")}const s=this.getProperty("expanded");if(s){t.class("sapUshellSearchResultListItem-AttributesExpanded")}t.openEnd();t.openStart("div",this.getId()+"-attributes-and-actions");t.class("sapUshellSearchResultListItem-AttributesAndActions");t.openEnd();if(!i.config.optimizeForValueHelp){this._renderImageForDocument(t);this._renderMultiLineDescription(t)}t.openStart("ul",this.getId()+"-attributes");t.class("sapUshellSearchResultListItem-Attributes");t.openEnd();const a=this.getProperty("attributes");if(!i.config.optimizeForValueHelp){this._renderImageAttribute(t,a.length===0)}this._renderAllAttributes(t,a);if(!i.config.optimizeForValueHelp){t.openStart("li",this.getId()+"-expand-spacer-attribute");t.class("sapUshellSearchResultListItem-ExpandSpacerAttribute");t.attr("aria-hidden","true");t.openEnd();t.close("li")}t.close("ul");if(!i.config.optimizeForValueHelp){this._renderRelatedObjectsToolbar(t)}t.close("div");t.close("div")},_renderAllAttributes:function e(t,i){const s=this.getModel();if(i.length===0){t.openStart("li",this.getId()+"-generic-attribute-1");t.class("sapUshellSearchResultListItem-GenericAttribute");if(s.config.optimizeForValueHelp){t.class("sapUshellSearchResultListItem-GenericAttributeValueHelp")}t.class("sapUshellSearchResultListItem-MainAttribute");t.class("sapUshellSearchResultListItem-EmptyAttributePlaceholder");t.attr("aria-hidden","true");t.openEnd();t.close("li");return}let a;let n;let l;let o;let c,h,p;let m;let f;const b=this.getProperty("layoutCache")||{};this.setProperty("layoutCache",b,true);if(!b.attributes){b.attributes={}}let I=0,S=0;let y=4;let A=3;let _=[0,0,0];let x=[0,0,0,0];let R=2;let T=2;let C;const E=this.getProperty("imageFormat")&&this.getProperty("imageFormat").toLowerCase()==="documentthumbnail";const P=this.getProperty("imageUrl")&&!E&&!s.config.optimizeForValueHelp;if(E&&!s.config.optimizeForValueHelp){y=A=2;_=x=[0,0];R=T=4}let w=y*_.length;let H=A*x.length;if(P){w--;H--;_[0]++;x[0]++}this.destroyAggregation("_attributeLabels");this.destroyAggregation("_attributeValues");this.destroyAggregation("_attributeValuesWithoutWhyfoundHiddenTexts");const O=e=>()=>{const e=$(this.getDomRef());e.attr("aria-describedby",e.attr("data-tooltippedby"))};for(I=0;!(R<=0&&T<=0)&&I<i.length;I++){a=i[I];const e=this.getModel();if(e.config.optimizeForValueHelp&&!a.whyfound){continue}if(E&&S>=4){break}if(a.isTitle){continue}if(w<=0&&H<=0&&!a.whyfound){continue}n=a.name;l=a.value;if(n===undefined||l===undefined){continue}if(!l||l.trim().length===0){l=v.noValue}if(a.longtext===undefined||a.longtext===null||a.longtext===""){p=false}else{p=true}o=a.valueWithoutWhyfound;let s=-1,F=-1,k={desktop:1,tablet:1};const V=b.attributes[a.key]||{};b.attributes[a.key]=V;t.openStart("li",this.getId()+"-generic-attribute-2-"+I);t.class("sapUshellSearchResultListItem-GenericAttribute");if(e.config.optimizeForValueHelp){t.class("sapUshellSearchResultListItem-GenericAttributeValueHelp")}t.class("sapUshellSearchResultListItem-MainAttribute");if(p){C=V.longTextColumnNumber||this._howManyColumnsToUseForLongTextAttribute(o);V.longTextColumnNumber=C;k=C;t.class("sapUshellSearchResultListItem-LongtextAttribute")}if(w<=0){if(a.whyfound&&R>0){t.class("sapUshellSearchResultListItem-WhyFoundAttribute-Desktop");R--}else{t.class("sapUshellSearchResultListItem-DisplayNoneAttribute-Desktop")}}if(H<=0){if(a.whyfound&&T>0){t.class("sapUshellSearchResultListItem-WhyFoundAttribute-Tablet");T--}else{t.class("sapUshellSearchResultListItem-DisplayNoneAttribute-Tablet")}}if(p&&P&&_[0]===1){F=0;C=V.longTextColumnNumber.desktop<y?V.longTextColumnNumber.desktop:y-1;_[0]+=C;w-=C}else{for(let e=0;e<_.length;e++){if(_[e]+k.desktop<=y){_[e]+=k.desktop;w-=k.desktop;F=e;break}}}if(F<0){F=_.length}if(p&&P&&x[0]===1){s=0;C=V.longTextColumnNumber.tablet<A?V.longTextColumnNumber.tablet:A-1;x[0]+=C;H-=C}else{for(let e=0;e<x.length;e++){if(x[e]+k.tablet<=A){x[e]+=k.tablet;H-=k.tablet;s=e;break}}}if(s<0){s=x.length}t.class("sapUshellSearchResultListItem-OrderTablet-"+s);t.class("sapUshellSearchResultListItem-OrderDesktop-"+F);if(p){t.attr("data-sap-searchresultitem-attributeweight-desktop",k.desktop);t.attr("data-sap-searchresultitem-attributeweight-tablet",k.tablet)}t.openEnd();c=new r(`${this.getId()}--attr${I}_labelText`,{displayOnly:true,showColon:true});c.setText(n);c.addStyleClass("sapUshellSearchResultListItem-AttributeKey");c.addStyleClass("sapUshellSearchResultListItem-MightOverflow");this.adjustCssDragAndDrop(c,e);t.renderControl(c);t.openStart("span",this.getId()+"-attribute-value-container-"+I);t.class("sapUshellSearchResultListItem-AttributeValueContainer");if(e.config.optimizeForValueHelp){t.class("sapUshellSearchResultListItem-AttributeValueContainerValueHelp")}t.openEnd();if(a.defaultNavigationTarget instanceof D){const e=a.defaultNavigationTarget;h=new U(`${this.getId()}--attr${I}_defNavTarget_Link`,{navigationTarget:null,wrapping:false,tooltip:g.escapeSettingsValue(a.tooltip||"")});h.setNavigationTarget(e);h.setText(l);h.addStyleClass("sapUshellSearchResultListItem-AttributeLink")}else{h=new L(`${this.getId()}--attr${I}_noDefNavTarget_Text`);h.setText(l)}f=undefined;const B=h?.getAggregation("icon");if(B instanceof d){B.addStyleClass("sapUshellSearchResultListItem-AttributeIcon")}else if(a.iconUrl){f=new d(`${this.getId()}--attr${I}_itemAttributeIcon`,{src:g.escapeSettingsValue(a.iconUrl)});f.addStyleClass("sapUshellSearchResultListItem-AttributeIcon")}if(f){h.setIcon(f)}h.addStyleClass("sapUshellSearchResultListItem-AttributeValue");h.addStyleClass("sapUshellSearchResultListItem-MightOverflow");if(a.whyfound){h.data("ishighlighted","true",true);h.addStyleClass("sapUshellSearchResultItem-AttributeValueHighlighted")}if(p){h.data("islongtext","true",true)}if(o&&!(h instanceof U&&h.getTooltip())){m=new u({});m.addStyleClass("sapUshellSearchResultListItem-AttributeValueContainer-HiddenText");m.setText(o);h.data("tooltippedBy",m.getId(),true);h.addEventDelegate({onAfterRendering:O(h)});this.addAggregation("_attributeValuesWithoutWhyfoundHiddenTexts",m,true);t.renderControl(m)}this.adjustCssDragAndDrop(h,e);t.renderControl(h);t.close("span");t.close("li");this.addAggregation("_attributeLabels",c,true);this.addAggregation("_attributeValues",h,true);S++}if(P){const e=y-_[0];const i=A-x[0];if(e>0||i>0){t.openStart("li",this.getId()+"-generic-attribute-3");t.class("sapUshellSearchResultListItem-GenericAttribute");if(s.config.optimizeForValueHelp){t.class("sapUshellSearchResultListItem-GenericAttributeValueHelp")}t.class("sapUshellSearchResultListItem-MainAttribute");t.class("sapUshellSearchResultListItem-OrderTablet-0");t.class("sapUshellSearchResultListItem-OrderDesktop-0");t.attr("data-sap-searchresultitem-attributeweight-desktop",e);t.attr("data-sap-searchresultitem-attributeweight-tablet",i);t.openEnd();t.close("li")}}},_howManyColumnsToUseForLongTextAttribute:function e(t){if(t.length<50){return{tablet:1,desktop:1}}if(t.length<85){return{tablet:2,desktop:2}}if(t.length<135){return{tablet:3,desktop:3}}return{tablet:3,desktop:4}},_renderImageAttribute:function e(t,i){const s=this.getModel();if(!this.getProperty("imageUrl")||this.getProperty("imageFormat")&&this.getProperty("imageFormat").toLowerCase()==="documentthumbnail"){return}t.openStart("li",this.getId()+"-generic-attribute-4");t.class("sapUshellSearchResultListItem-GenericAttribute");if(s.config.optimizeForValueHelp){t.class("sapUshellSearchResultListItem-GenericAttributeValueHelp")}t.class("sapUshellSearchResultListItem-ImageAttribute");if(i){t.class("sapUshellSearchResultListItem-LonelyImageAttribute")}t.openEnd();t.openStart("div",this.getId()+"-image-container");t.class("sapUshellSearchResultListItem-ImageContainer");if(this.getProperty("imageFormat")==="round"){t.class("sapUshellSearchResultListItem-ImageContainerRound")}t.openEnd();if(this.getProperty("imageUrl")){t.openStart("img",this.getId()+"-image-2");t.class("sapUshellSearchResultListItem-Image");if(this.getProperty("imageFormat")==="round"){}t.attr("src",this.getProperty("imageUrl"));t.openEnd();t.close("img")}if(this.getProperty("imageFormat")!=="round"){t.openStart("div",this.getId()+"-image-container-aligment-helper");t.class("sapUshellSearchResultListItem-ImageContainerAlignmentHelper");t.openEnd();t.close("div")}t.close("div");t.close("li")},_renderRelatedObjectsToolbar:function e(t){const i=this.getProperty("navigationObjects");if(!i||i.length===0){return}this._showExpandButton=true;const s=this.getAggregation("_relatedObjectActionsToolbar");s.setProperty("navigationObjects",i);s.setProperty("positionInList",this.getProperty("positionInList"));t.renderControl(s)},_renderAccessibilityInformation:function e(t){const i=this.getProperty("parentListItem");if(i){this._renderAriaDescriptionElementForTitle(t,true,true);this._renderAriaDescriptionElementForAttributes(t,true);this._renderAriaDescriptionElementForCollapsedOrExpandedState(t,true);i.addEventDelegate({onAfterRendering:()=>{const e=$(i.getDomRef());this._addAriaDescriptionToParentListElement(i,true);C("acc-listitem-focusin",e,"focusin",e=>{const s=$(e.relatedTarget);if(s.hasClass("sapUshellSearchResultListItem")||s.closest(".sapUshellSearchResultListItemApps").length>0&&!s.hasClass("sapUshellResultListMoreFooter")){this._renderAriaDescriptionElementForTitle(t,false,false);this._renderAriaDescriptionElementForAttributes(t,false);this._renderAriaDescriptionElementForCollapsedOrExpandedState(t,false);this._addAriaDescriptionToParentListElement(i,false)}else{this._renderAriaDescriptionElementForTitle(t,true,false);this._renderAriaDescriptionElementForAttributes(t,false);this._renderAriaDescriptionElementForCollapsedOrExpandedState(t,false);this._addAriaDescriptionToParentListElement(i,true)}})},onsapspace:e=>{if(e["target"]===e["currentTarget"]){this.toggleDetails()}},onsapenter:e=>{if(e["target"]===e["currentTarget"]){const e=this.getProperty("titleNavigation");if(e instanceof D){e.performNavigation()}}}})}},getAccessibilityInfo:function e(...t){let i={};if(p.prototype.getAccessibilityInfo){i=p.prototype.getAccessibilityInfo.apply(this,t)||i}i["description"]="";return i},_renderAriaDescriptionElementForTitle:function e(t,i,s){this._searchResultListPrefix=this._searchResultListPrefix||A.getText("result_list_announcement_screenreaders");let a=this.getProperty("title")+", "+this.getProperty("type")+".";if(i){a=this._searchResultListPrefix+" "+a}const n=this.getAggregation("_titleLabeledByText");if(n){n.setText(a)}if(s&&t){t.renderControl(n)}},_renderAriaDescriptionElementForAttributes:function e(t,i){const s=this.getAggregation("_attributesLabeledByText");const a=$(this.getDomRef()).find(".sapUshellSearchResultListItem-Attributes").find(".sapUshellSearchResultListItem-MainAttribute");let n;if(a.length===0){n=A.getText("result_list_item_aria_no_attributes")}else{n=A.getText("result_list_item_aria_has_attributes");a.each(function(){const e=$(this);if(e.is(":visible")&&e.attr("aria-hidden")!=="true"){const t=e.find(".sapUshellSearchResultListItem-AttributeKey").text();const i=e.find(".sapUshellSearchResultListItem-AttributeValueContainer");let s=i.find(".sapUshellSearchResultListItem-AttributeValueContainer-HiddenText");if(s.length===0){s=i.find(".sapUshellSearchResultListItem-AttributeValue")}const a=s.text();n+=A.getText("result_list_item_aria_attribute_and_value",[t,a])}})}if(s){s.setText(n)}if(i&&t){t.renderControl(s)}},_renderAriaDescriptionElementForCollapsedOrExpandedState:function e(t,i){const s=this.getAggregation("_expandStateLabeledByText");let a;const n=this.getAggregation("_expandButton");if(!n){return}const l=$(n.getDomRef());if(l.css("visibility")!=="hidden"){if(this.isShowingDetails()){a=A.getText("result_list_item_aria_expanded");const e=this.getProperty("navigationObjects");if(Array.isArray(e)&&e.length>0){a=A.getText("result_list_item_aria_has_links")+a}}else{a=A.getText("result_list_item_aria_collapsed")}}s.setText(a);if(i&&t){t.renderControl(s)}},_addAriaDescriptionToParentListElement:function e(t,i){const s=this.getAggregation("_titleLabeledByText");if(!s){return}let a=s.getId();if(i){const e=this.getProperty("countBreadcrumbsHiddenElement");if(e){a+=" "+e.getId()}}const n=this.getAggregation("_attributesLabeledByText");a+=" "+n.getId();const l=this.getAggregation("_expandStateLabeledByText");a+=" "+l.getId();const r=$(t.getDomRef());r.attr("aria-labelledby",a)},_getExpandAreaObjectInfo:function e(){const t=this.getModel();const i=$(this.getDomRef());i.addClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");const s=i.find(".sapUshellSearchResultListItem-AttributesExpandContainer");const a=i.find(".sapUshellSearchResultListItem-RelatedObjectsToolbar");let n=false;if(a.css("display")==="none"&&!t.config.optimizeForValueHelp){a.css("display","block");n=true}const l=s.height();const r=i.find(".sapUshellSearchResultListItem-AttributesAndActions").height();i.removeClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");if(n){a.css("display","")}const o=this._getElementsInExpandArea();const c=200;const d=c/10;const h={resultListItem:i,attributesExpandContainer:s,currentHeight:l,expandedHeight:r,elementsToFadeInOrOut:o,expandAnimationDuration:c,fadeInOrOutAnimationDuration:d,relatedObjectsToolbar:a};return h},_getElementsInExpandArea:function e(){const t=$(this.getDomRef());const i=[];t.addClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");const s=t.find(".sapUshellSearchResultListItem-GenericAttribute:not(.sapUshellSearchResultListItem-ImageAttribute)");if(s.length>0){const e=s.position().top;s.each(function(){if($(this).position().top>e){i.push(this)}})}t.removeClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");return i},isShowingDetails:function e(){const t=this._getExpandAreaObjectInfo();if(t.currentHeight<t.expandedHeight){return false}return true},showDetails:function e(){const t=this;if(this.isShowingDetails()){return}const i=this._getExpandAreaObjectInfo();i.relatedObjectsToolbar["css"]("opacity",0);i.relatedObjectsToolbar["css"]("display","block");const s=this.getAggregation("_relatedObjectActionsToolbar");if(s){s.layoutToolbarElements()}this.forwardEllipsis($(t.getDomRef()).find(".sapUshellSearchResultListItem-Title, .sapUshellSearchResultItem-AttributeValueHighlighted"));$(this.getDomRef()).addClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");let a,n=false;const l=i.attributesExpandContainer["animate"]({height:i.expandedHeight},{duration:i.expandAnimationDuration,progress:function(e,s,r){if(!n&&s>.5){a=i.relatedObjectsToolbar["animate"]({opacity:1},r).promise();n=true;jQuery.when(l,a).done(function(){t.setProperty("expanded",true,true);$(this).addClass("sapUshellSearchResultListItem-AttributesExpanded");$(this).css("height","");$(i.elementsToFadeInOrOut).css("opacity","");$(t.getDomRef()).removeClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");const e=h.getIconURI("slim-arrow-up");const s=t.getAggregation("_expandButton");if(s){s.setTooltip(A.getText("hideDetailBtn_tooltip"));s.setIcon(e)}i.relatedObjectsToolbar["css"]("display","");i.relatedObjectsToolbar["css"]("opacity","");t._renderAriaDescriptionElementForAttributes(undefined,false);t._renderAriaDescriptionElementForCollapsedOrExpandedState(undefined,false)}.bind(this))}}}).promise();$(i.elementsToFadeInOrOut).animate({opacity:1},i.fadeInOrOutAnimationDuration)},hideDetails:function e(){const t=$(this.getDomRef());if(!this.isShowingDetails()){return}const i=this._getExpandAreaObjectInfo();i.relatedObjectsToolbar["css"]("opacity",1);i.relatedObjectsToolbar["animate"]({opacity:0},i.expandAnimationDuration/2);const s=t.find(".sapUshellSearchResultListItem-MainAttribute").outerHeight(true)+t.find(".sapUshellSearchResultListItem-ExpandSpacerAttribute").outerHeight(true);let a=false;const n=i.attributesExpandContainer["animate"]({height:s},{duration:i.expandAnimationDuration,progress:(e,t,s)=>{if(!a&&s<=i.fadeInOrOutAnimationDuration){a=true;const e=$(i.elementsToFadeInOrOut).animate({opacity:0},i.fadeInOrOutAnimationDuration).promise();jQuery.when(n,e).done(()=>{this.setProperty("expanded",false,true);i.attributesExpandContainer["removeClass"]("sapUshellSearchResultListItem-AttributesExpanded");$(i.elementsToFadeInOrOut).css("opacity","");i.relatedObjectsToolbar["css"]("opacity","");const e=h.getIconURI("slim-arrow-down");const t=this.getAggregation("_expandButton");t.setTooltip(A.getText("showDetailBtn_tooltip"));t.setIcon(e);this._renderAriaDescriptionElementForAttributes(undefined,false);this._renderAriaDescriptionElementForCollapsedOrExpandedState(undefined,false)})}}}).promise()},toggleDetails:function e(){let t;const i=this.getModel();if(this.isShowingDetails()){t=T.ITEM_HIDE_DETAILS;this.hideDetails()}else{t=T.ITEM_SHOW_DETAILS;this.showDetails()}i.eventLogger.logEvent({type:t,itemPosition:this.getProperty("positionInList"),executionId:this.getProperty("resultSetId")})},isSelectionModeEnabled:function e(){let t=false;const i=$(this.getDomRef()).find(".sapUshellSearchResultListItem-multiSelect-selectionBoxContainer");if(i){t=i.css("opacity")>0}return t},enableSelectionMode:function e(){const t=$(this.getDomRef()).find(".sapUshellSearchResultListItem-multiSelect-innerContainer");const i=t.find(".sapUshellSearchResultListItem-multiSelect-selectionBoxContainer");const s=200;let a=false;t.animate({width:"2rem"},{duration:s,progress:(e,t)=>{if(!a&&t>.5){i.css("display","");i.animate({opacity:"1.0"},s/2);a=true}}})},disableSelectionMode:function e(){const t=$(this.getDomRef()).find(".sapUshellSearchResultListItem-multiSelect-innerContainer");const i=t.find(".sapUshellSearchResultListItem-multiSelect-selectionBoxContainer");const s=200;i.animate({opacity:"0.0"},s/2,()=>{i.css("display","none")});t.animate({width:"0"},s)},toggleSelectionMode:function e(t){if(this.isSelectionModeEnabled()){this.disableSelectionMode()}else{this.enableSelectionMode()}},onAfterRendering:function e(){const t=$(this.getDomRef());this._showOrHideExpandButton();this._setListItemStatusBasedOnWindowSize();this._renderAriaDescriptionElementForTitle(undefined,false,false);this._renderAriaDescriptionElementForAttributes(undefined,false);this._renderAriaDescriptionElementForCollapsedOrExpandedState(undefined,false);this.forwardEllipsis(t.find(".sapUshellSearchResultListItem-Title, .sapUshellSearchResultItem-AttributeValueHighlighted"));i.attachEventHandlersForTooltip(this.getDomRef())},resizeEventHappened:function e(){const t=$(this.getDomRef());this._showOrHideExpandButton();this._setListItemStatusBasedOnWindowSize();this.forwardEllipsis(t.find(".sapUshellSearchResultItem-AttributeValueHighlighted"));const i=this.getAggregation("_titleLink");const s=this.getAggregation("_titleText");const a=i.getDomRef()?i:s;const n=this.getModel();if(this.supportsDragAndDrop(i,n)){if(n.config.optimizeForValueHelp){a.getDomRef()["draggable"]=false}}},isHierarchyItem:function e(){return this.getProperty("titleIconUrl")==="sap-icon://folder-blank"},supportsDragAndDrop:function e(t,i){return typeof i.getSearchCompositeControlInstanceByChildControl(t)!=="undefined"&&i.getSearchCompositeControlInstanceByChildControl(t).getDragDropConfig().length>0},_getPhoneSize:function e(){return 767},_resetPrecalculatedValues:function e(){this._visibleAttributes=undefined;this._detailsArea=undefined;this._showExpandButton=false},_setListItemStatusBasedOnWindowSize:function e(){const t=window.innerWidth;const i=this.getProperty("parentListItem");if(this.getProperty("titleNavigation")&&t<=this._getPhoneSize()){i.setType(R.Active)}else{i.setType(R.Inactive)}},_showOrHideExpandButton:function e(){const t=$(this.getDomRef());const i=t.find(".sapUshellSearchResultListItem-ExpandButtonContainer");const s=i.css("visibility")!=="hidden";let a=false;const n=this.getProperty("imageFormat")?.toLowerCase()==="documentthumbnail";if(!n){const e=t.find(".sapUshellSearchResultListItem-RelatedObjectsToolbar");a=e.length>0}if(!n&&!a){const e=this._getElementsInExpandArea();if(e.length>0){a=true}}if(s&&!a){i.css("visibility","hidden");i.attr("aria-hidden","true");this.setAriaExpandedState()}else if(!s&&a){i.css("visibility","");i.removeAttr("aria-hidden");this.setAriaExpandedState()}},setAriaExpandedState:function e(){const t=this.getAggregation("_expandButton");if(!t){return}const i=$(t.getDomRef());const s=$(this.getDomRef());const a=this.getProperty("parentListItem")?$(this.getProperty("parentListItem").getDomRef()):s.closest("li");const n=s.find(".sapUshellSearchResultListItem-ExpandButtonContainer");if(n.css("visibility")==="hidden"){i.removeAttr("aria-expanded");a.removeAttr("aria-expanded")}else{const e=this.getProperty("expanded");if(e){i.attr("aria-expanded","true");a.attr("aria-expanded","true")}else{i.attr("aria-expanded","false");a.attr("aria-expanded","false")}}},_registerItemPressHandler:function e(){const t=this.getProperty("parentListItem");if(t){t.attachPress(e=>{this._performTitleNavigation({event:e})});this._registerItemPressHandler=()=>{}}},_performTitleNavigation:function e(t){const i=this.getProperty("titleNavigation");if(i instanceof D){i.performNavigation({event:t?.event})}},adjustCssDragAndDrop:function e(t,i){setTimeout(()=>{if(typeof i.getSearchCompositeControlInstanceByChildControl(t)!=="undefined"&&i.getSearchCompositeControlInstanceByChildControl(t).getDragDropConfig().length>0){t.addStyleClass("sapUshellSearchResultListItem-SupportsDragAndDrop")}})},forwardEllipsis:function e(t){const i=$(this.getDomRef());i.addClass("sapUshellSearchResultListItem-AttributesPrepareExpansion");t.each((e,t)=>{a.forwardEllipsis4Whyfound(t)});i.removeClass("sapUshellSearchResultListItem-AttributesPrepareExpansion")}});v.noValue=E;return v})})();
//# sourceMappingURL=SearchResultListItem.js.map
/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["./error/ErrorHandler","./i18n","sap/ui/model/resource/ResourceModel","./controls/searchfieldgroup/SearchFieldGroup","sap/esh/search/ui/SearchModel","sap/esh/search/ui/controls/SearchLayoutResponsive","./controls/resultview/SearchResultContainer","./controls/resultview/SearchCountBreadcrumbs","sap/esh/search/ui/controls/SearchFilterBar","sap/esh/search/ui/SearchHelper","sap/ui/core/Control","sap/ui/core/IconPool","sap/ui/layout/VerticalLayout","sap/ui/model/BindingMode","sap/m/Button","sap/m/library","sap/m/Bar","sap/m/OverflowToolbarLayoutData","sap/m/OverflowToolbar","sap/m/ViewSettingsItem","sap/m/MessagePopover","sap/m/MessageItem","sap/m/VBox","./error/errors","sap/base/Log","sap/m/IllustratedMessage","sap/m/IllustratedMessageType","sap/m/IllustratedMessageSize","sap/esh/search/ui/error/errors","sap/ui/core/ResizeHandler","./controls/OpenShowMoreDialog","./UIEvents","./SearchCompositeControlDragDropConfig","sap/base/assert","./controls/facets/SearchFacetList","sap/ui/core/Element","./compositecontrol/ToolbarAssembler","./compositecontrol/ResultViewsAssembler","./controls/SearchSelectionBar","./controls/resultview/SearchResultPanel"],function(e,t,r,s,o,n,i,a,l,c,u,h,d,p,f,g,S,y,m,C,b,M,I,T,w,D,R,B,V,F,E,v,P,x,A,L,N,H,U,_){"use strict";function G(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const O=G(e);const z=G(t);const W=G(s);const $=G(i);const j=G(a);const k=g["ButtonType"];const Q=g["ToolbarDesign"];const q=g["PlacementType"];const J=g["OverflowToolbarPriority"];const K=g["FlexJustifyContent"];const X=T["ProgramError"];const Y=E["openShowMoreDialog"];const Z=G(v);const ee=g["BarDesign"];const te=G(P);const re=G(A);const se=G(N);const oe=G(H);const ne=G(U);const ie=G(_);const ae=d.extend("sap.esh.search.ui.SearchCompositeControl",{renderer:{apiVersion:2},metadata:{library:"sap.esh.search.ui",dnd:{draggable:true,droppable:false},properties:{cssClass:{type:"string"},searchTerm:{type:"string",group:"Misc",defaultValue:""},searchOnStart:{type:"boolean",group:"Behavior",defaultValue:true},filterRootCondition:{type:"object",group:"Misc"},sinaConfiguration:{type:"object",group:"Misc"},dataSource:{type:"string",group:"Misc"},exclusiveDataSource:{type:"string",group:"Misc"},resultViewTypes:{type:"string[]",group:"Misc",defaultValue:["searchResultList","searchResultTable"]},resultViewType:{type:"string",group:"Misc",defaultValue:"searchResultList"},resultViewSettings:{settings:{resultViewTypes:"string[]",resultViewType:"string"},group:"Misc",defaultValue:{resultViewTypes:["searchResultList","searchResultTable"],resultViewType:"searchResultList"}},tabStripsFormatter:{type:"function",group:"Misc"},folderMode:{type:"boolean",group:"Misc",defaultValue:false},folderModeForInitialSearch:{type:"boolean",group:"Misc",defaultValue:false},autoAdjustResultViewTypeInFolderMode:{type:"boolean",group:"Misc",defaultValue:false},enableQueryLanguage:{type:"boolean",group:"Misc",defaultValue:false},applicationComponent:{type:"string",group:"Misc",defaultValue:"HAN-AS-INA-UI"},facetPanelResizable:{type:"boolean",group:"Misc",defaultValue:true},facetPanelWidthInPercent:{type:"float",group:"Misc",defaultValue:25},getCustomNoResultScreen:{type:"function",group:"Misc"},getSearchInputPlaceholderLabel:{type:"function",group:"Misc"},overwriteBrowserTitle:{type:"boolean",group:"Misc"},defaultDataSource:{type:"string",group:"Misc"},optimizeForValueHelp:{type:"boolean",group:"Misc"},filterDataSources:{type:"function",group:"Misc"},facetVisibility:{type:"boolean",group:"Misc",defaultValue:false},boSuggestions:{type:"boolean",group:"Misc",defaultValue:false},displayFacetPanelInCaseOfNoResults:{type:"boolean",group:"Misc",defaultValue:false},updateUrl:{type:"boolean",group:"Misc",defaultValue:true},renderSearchUrl:{type:"function",group:"Misc"},isSearchUrl:{type:"function",group:"Misc"},parseSearchUrlParameters:{type:"function",group:"Misc"},quickSelectDataSources:{type:"object",group:"Misc"},selectionChange:{type:"function",group:"Misc"},initAsync:{type:"function",group:"Misc"},enableMultiSelectionResultItems:{type:"boolean",group:"Misc",defaultValue:false},pageSize:{type:"int",group:"Misc",defaultValue:10},formatFilterBarText:{type:"function",group:"Misc"},isFilterBarVisible:{type:"function",group:"Misc"},eventConsumers:{singularName:"eventConsumer",multiple:true,group:"Misc"},searchTermLengthLimit:{type:"int",group:"Misc",defaultValue:1e3},limitAjaxRequests:{type:"boolean",group:"Misc",defaultValue:true}},aggregations:{content:{singularName:"content",multiple:true}},events:{searchStarted:{},searchFinished:{},selectionChanged:{},resultViewTypeChanged:{}}},constructor:function e(t,s){const n=O.getInstance({label:t});let i;let a=false;try{const e=ae.unifyInputParameters(t,s);t=e.sId;s=e.settings;x(s?.applicationComponent!==undefined&&s?.applicationComponent!=="",`Provide property 'applicationComponent' (example: "LOD-ANA-LS").\nRelevant for SAP partners and SAP, the "Application Component" you expect customers to create incidents.`);x(s.exclusiveDataSource===undefined||s.exclusiveDataSource===""||s.dataSource===undefined&&s.defaultDataSource===undefined,`Property 'exclusiveDataSource' is provided ('${s.exclusiveDataSource}').\nDo NOT fill properties 'dataSource' and 'defaultDataSource'.`);i=s["model"]||s["searchModel"];if(!i){i=new o({configuration:s})}else{i.config.id=t}n.setSearchModel(i);const l=ae.getUI5ControlSettings(i.config);d.prototype.constructor.call(this,t,l);this.errorHandler=n;this._oLogger=w.getLogger("sap.esh.search.ui.SearchCompositeControl");this.addStyleClass("sapUshellSearchInputHelpPage");this.addStyleClass("sapElisaSearchCompositeControl");if(i.config.optimizeForValueHelp){this.addStyleClass("sapUshellSearchInputHelpPageValueHelp")}this.setModelInternal(i);this.setModelInternal(i.publicSearchModel,i.publicSearchModel.modelName);this.setModelInternal(new r({bundle:z}),"i18n");const u=this;this.oFocusHandler=new c.SearchFocusHandler(u);i.focusHandler=this.oFocusHandler;this.toolbarAssembler=new se(u);this.resultViewsAssembler=new oe(u);i.config.performanceLogger.enterMethod({name:"createContent"},{isSearch:true});a=true;this.createContent();i.config.performanceLogger.leaveMethod({name:"createContent"});a=false;this.oSearchCompositeControlDragDropConfig=new te({eshComp:this});F.register(this,()=>{this._resizeHandler()});this.attachEvent("searchStarted",function(){this.closePopovers()});this.initSearch()}catch(e){n.onError(e);throw e}finally{if(a){i.config.performanceLogger.leaveMethod({name:"createContent"});a=false}}},getModel:function e(t){const r=(new Error).stack;if(t!==undefined||r.includes("._setModelInternal")||r.includes("setModelInternal")||r.includes("onAllSearchFinished")||r.includes(".updateBindingContext")||r.includes(".updatePropertyValue")||r.includes("addContent")){}else{x(false,`The main model of this control is private.\nTo access the public search model, call function 'getPublicSearchModel' or bind to it (model name 'publicSearchModel').\nThe main model of this control is private and cannot be accessed (for internal use, see function 'getSearchModelInternal').`)}return this.getModelInternal(t)},setModel:function e(t,r){const s=this.getModelInternal();if(!r){x(false,`Main model cannot be set (for internal use, see function 'setModelInternal').`);return this}else if(r===s?.publicSearchModel?.modelName){x(false,`Model cannot be set, name '${s?.publicSearchModel?.modelName}' is reserved for public search model (for internal use, see function 'setModelInternal').`);return this}else{return d.prototype.setModel.call(this,t,r)}},setModelInternal:function e(t,r){return d.prototype.setModel.call(this,t,r)},initSearch:function e(){const t=this.getModelInternal();t.config.performanceLogger.enterMethod({name:"init search"},{isSearch:true});t.searchUrlParser.parse().then(()=>{t.initAsync().then(()=>{if(this.getProperty("searchOnStart")&&!t.config.isUshell){this.search()}if(t){t.config.performanceLogger.leaveMethod({name:"init search"})}})})},exit:function e(){this.closePopovers();if(this.oFilterBar){this.oFilterBar.destroy()}if(this.noResultScreen){this.noResultScreen.destroy()}if(this.noResultScreenFolder){this.noResultScreenFolder.destroy()}this.searchResultTable?.tablePersonalizer?.destroyControllerAndDialog();if(this["oFacetDialog"]){this["oFacetDialog"].destroy();this["oFacetDialog"]=null}const t=this.getModelInternal();t.unsubscribe(Z.ESHSearchStarted,this.onAllSearchStarted,this);t.unsubscribe(Z.ESHSearchFinished,this.onAllSearchFinished,this);t.unsubscribe(Z.ESHSelectionChanged,this.onSelectionChanged,this)},createContent:function e(){const t=this.getModelInternal();if(!t.config.isUshell){this.oSearchFieldGroup=new W(this.getId()+"-searchInputHelpPageSearchFieldGroup");if(t.config.exclusiveDataSource){this.oSearchFieldGroup.setSelectActive(false)}this.oSearchFieldGroup.setCancelButtonActive(false);this.oSearchFieldGroup.addStyleClass("sapUshellSearchInputHelpPageSearchFieldGroup");this.oSearchFieldGroup.input.setShowValueHelp(false);t.setProperty("/inputHelp",this.oSearchFieldGroup.input);if(t.config.optimizeForValueHelp){this.oSearchFieldGroup.setActionsMenuButtonActive(true);this.oSearchFieldGroup.setSelectQsDsActive(true);this.oSearchFieldGroup.addStyleClass("sapUiTinyMarginBegin");this.oSearchFieldGroup.addStyleClass("sapUiTinyMarginEnd")}}if(t?.subscribe){if(!this.subscribeDone_SearchStarted){t.subscribe(Z.ESHSearchStarted,this.onAllSearchStarted,this);this.subscribeDone_SearchStarted=true}if(!this.subscribeDone_SearchFinished){t.subscribe(Z.ESHSearchFinished,this.onAllSearchFinished,this);this.subscribeDone_SearchFinished=true}if(!this.subscribeDone_SelectionChanged){t.subscribe(Z.ESHSelectionChanged,this.onSelectionChanged,this);this.subscribeDone_SelectionChanged=true}if(!this.subscribeDone_ResultViewTypeChanged){t.subscribe(Z.ESHResultViewTypeChanged,this.onResultViewTypeChanged,this);this.subscribeDone_SelectionChanged=true}}if(this.oSearchFieldGroup){if(t){t.subscribe(Z.ESHSearchFinished,()=>{this.oSearchFieldGroup.input.setValue(t.getSearchBoxTerm())},this)}}this.oFilterButton=this.toolbarAssembler.assembleFilterButton();this.oDataSourceTabBar=this.toolbarAssembler.assembleDataSourceTabBar();const r=[this.oFilterButton,this.oDataSourceTabBar];const s=this.toolbarAssembler.assembleGenericButtonsToolbar();this.oGenericItemsToolbar=s.toolbar;this.oSearchBar=new m(this.getId()+"-searchBar",{width:"100%",visible:{parts:[{path:"/count"}],formatter:e=>e!==0||t?.config?.showSearchBarForNoResults},content:r.concat(this.oGenericItemsToolbar),design:Q.Transparent});this.oSearchBar.addStyleClass("sapUshellSearchBar");if(s.hasCustomButtons){this.oDataSourceTabBar.addStyleClass("sapUshellSearchBarHasCustomButtons")}else{this.oDataSourceTabBar.removeStyleClass("sapUshellSearchBarHasCustomButtons")}if(t.config.optimizeForValueHelp){this.oSearchBar.addStyleClass("sapUshellSearchBarValueHelp")}this.oFilterBar=new l(this.getId()+"-searchFilterBar");this.createSearchPage(this.getId())},onAfterRendering:function e(){const t=this?.getModelInternal();if(t?.subscribe){if(!this.subscribeDone_SearchStarted){t.subscribe(Z.ESHSearchStarted,this.onAllSearchStarted,this);this.subscribeDone_SearchStarted=true}if(!this.subscribeDone_SearchFinished){t.subscribe(Z.ESHSearchFinished,this.onAllSearchFinished,this);this.subscribeDone_SearchFinished=true}if(!this.subscribeDone_SelectionChanged){t.subscribe(Z.ESHSelectionChanged,this.onSelectionChanged,this);this.subscribeDone_SelectionChanged=true}if(!this.subscribeDone_ResultViewTypeChanged){t.subscribe(Z.ESHResultViewTypeChanged,this.onResultViewTypeChanged,this);this.subscribeDone_ResultViewTypeChanged=true}}},isShowMoreFooterVisible:function e(){const t=this.getModelInternal();return t.getProperty("/boCount")>t.getProperty("/boResults").length},assignDragDropConfig:function e(){this.oSearchCompositeControlDragDropConfig.assignDragDropConfig()},addDragDropConfig:function e(t){return this.oSearchCompositeControlDragDropConfig.addDragDropConfig(t)},insertDragDropConfig:function e(t,r){return this.oSearchCompositeControlDragDropConfig.insertDragDropConfig(t,r)},indexOfDragDropConfig:function e(t){return this.oSearchCompositeControlDragDropConfig.indexOfDragDropConfig(t)},getDragDropConfig:function e(){return this.oSearchCompositeControlDragDropConfig.getDragDropConfig()},removeDragDropConfig:function e(t){return this.oSearchCompositeControlDragDropConfig.removeDragDropConfig(t)},removeAllDragDropConfig:function e(){return this.oSearchCompositeControlDragDropConfig.removeAllDragDropConfig()},destroyDragDropConfig:function e(){return this.oSearchCompositeControlDragDropConfig.destroyDragDropConfig()},onAllSearchStarted:function e(){this.fireEvent("searchStarted")},onAllSearchFinished:function e(){const t=this.getModelInternal();this.assignDragDropConfig();this.chooseNoResultScreen();this.oFocusHandler.setFocus();if(t.config.isUshell){const e=L.getElementById("viewPortContainer");if(e?.switchState){e.switchState("Center")}}this.fireEvent("searchFinished");setTimeout(()=>{this.adjustSearchbarCustomGenericButtonWidth()},0)},onSelectionChanged:function e(){const t=this.getModelInternal();this.fireEvent("selectionChanged");if(typeof t.config.selectionChange==="function"){t.config.selectionChange(t)}},onResultViewTypeChanged:function e(){this.fireEvent("resultViewTypeChanged")},createSearchPage:function e(t){const r=this.getModelInternal();this.oFilterBar.bindProperty("visible",{parts:[{path:"/count"},{path:"/facetVisibility"},{path:"/uiFilter/rootCondition"}],formatter:(e,t,s)=>{let o=false;if(!t&&s&&s.hasFilters()){o=true}if(s&&r.filterWithoutFilterByConditions()){o=false}if(s&&typeof r.config.hasSpaceFiltersOnly==="function"){if(r.config.hasSpaceFiltersOnly(s)===true){o=false}}if(s&&typeof r.config.isFilterBarVisible==="function"){try{if(!r.config.isFilterBarVisible(s)){o=false}}catch(e){const t=new V.ConfigurationExitError("isFilterBarVisible",r.config.applicationComponent,e);this.errorHandler.onError(t)}}return o}});this.oFooter=this.createFooter(this.getId());if(this.oFooter){this.oFooter.bindProperty("visible",{parts:[{path:"/errors/length"}],formatter:e=>{const t=e>0?true:false;return t}})}this.searchContainer=this.createSearchContainer(t);let s=[];if(this.oSearchFieldGroup){s.push(this.oSearchFieldGroup)}s=s.concat([this.oSearchBar,this.oFilterBar,this.searchContainer,this.oFooter]);for(const e of s){this.addContent(e)}this.setWidth("100%")},createNoResultScreen:function e(t,r){const s=[];const o=B.Auto;let n;let i;let a;if(r==="folder"){n={parts:[{path:"/queryFilter/searchTerm"}],formatter:e=>z.getText("no_results_info_1_folderEmpty",[e])};i=z.getText("no_results_info_2_folderEmpty");a=R.EmptyList}else{n={parts:[{path:"/queryFilter/searchTerm"}],formatter:e=>z.getText("no_results_info_1",[e])};i=z.getText("no_results_info_2");a=R.NoSearchResults}const l={title:n,description:i,illustrationSize:o,illustrationType:a,additionalContent:s};let c;if(r==="folder"){c=`${t}-searchContainerResultsView-noResultFolderScreen`}else{c=`${t}-searchContainerResultsView-noResultScreen`}const u=new D(`${c}-searchContainerResultsView-noResultScreen-illustratedMessage`,l).addStyleClass("sapElisaNoResultScreen");u.addStyleClass("sapUiMediumMarginTop");const h=new I(`${c}-searchContainerResultsView-noResultScreen`,{items:u,width:"100%",justifyContent:K.Center,visible:{parts:[{path:"/count"},{path:"/isBusy"},{path:"/firstSearchWasExecuted"}],formatter:function(e,t,r){return e===0&&!t&&r}}});if(r==="folder"){this.noResultScreenFolder=h}else{this.noResultScreen=h}return h},createSearchContainer:function e(t){const r=this.getModelInternal();this.countBreadcrumbsHiddenElement=this.resultViewsAssembler.assembleCountBreadcrumbsHiddenElement();this.centerArea=this.resultViewsAssembler.assembleCenterArea(t);this.centerArea.push(this.createNoResultScreen(t,"default"));this.oSearchCountBreadcrumbs=new j(this.getId()+"-SearchCountBreadcrumbs").addStyleClass("sapElisaSearchContextBarContent");this.oContextBar=new S(this.getId()+"-searchContextBar",{contentLeft:this.oSearchCountBreadcrumbs,design:{parts:[{path:"/isFolderMode"}],formatter:e=>{if(r.config.folderMode===true&&e===true){this.oContextBar.addStyleClass("sapElisaSearchContextBarFolderMode")}else{this.oContextBar.removeStyleClass("sapElisaSearchContextBarFolderMode")}return ee.Auto}}}).addStyleClass("sapElisaSearchContextBar");this.oSearchSelectionBar=new ne(this.getId()+"-searchSelectionBar");this.oContextBarContainer=new d("",{content:[this.oSearchSelectionBar,this.oContextBar]});this.oContextBarContainer.addStyleClass("sapElisaSearchContextBarContainer");this.oContextBarContainer.addStyleClass("sapUiNoMarginBegin");this.oContextBarContainer.addStyleClass("sapUiNoMarginEnd");this.oSearchResultContainer=new $(`${t}-searchContainerResultsView`);this.centerArea.forEach(e=>{this.oSearchResultContainer.addContent(e)});this.oSearchResultPanel=new ie(`${t}-searchResultPanel`,{fixContent:[this.oContextBarContainer],flexContent:this.oSearchResultContainer});const s={resultPanelContent:this.oSearchResultPanel,searchIsBusy:{path:"/isBusy"},busyDelay:{path:"/busyDelay"},facetPanelResizable:r.config.facetPanelResizable,facetPanelWidthInPercent:r.config.facetPanelWidthInPercent,facetPanelContent:new re(`${this.getId()}-SearchFacetList`),showFacets:{parts:[{path:"/count"},{path:"/facetVisibility"},{path:"/uiFilter/rootCondition"},{path:"/isBusy"},{path:"/config"}],formatter:(e,t,r,s,o)=>{let n=true;if(!t){n=false}const i=r&&r.conditions&&r.conditions.length>0;if(e===0&&!o.displayFacetPanelInCaseOfNoResults&&!i&&!s){n=false}return n}}};const o=new n(`${this.getId()}-searchLayout`,s).addStyleClass("sapUshellSearchLayout");return o},isSearchFieldGroupLocatedInsideSearchComposite:function e(t){if(typeof t==="undefined"||t===null){return false}else if(t.classList){if(t.classList.contains("sapUshellSearchInputHelpPage")){return true}else if(typeof t.parentNode!=="undefined"){return this.isSearchFieldGroupLocatedInsideSearchComposite(t.parentNode)}else{console.error("function: isSearchFieldGroupLocatedInsideSearchComposite: Element has no property 'parentNode' but has property 'classlist'");return false}}else if(t.nodeType===Node.DOCUMENT_NODE){return false}else{console.error("function: isSearchFieldGroupLocatedInsideSearchComposite: Element has no property 'classlist'");return false}},adjustSearchbarCustomGenericButtonWidth:function e(){if(this.getDomRef()===null){return}if(this.oFilterButton.getVisible()&&this.oFilterButton.getDomRef()===null){return}const t=window.document.getElementById(this.getDomRef().id).getBoundingClientRect();const r=this.oFilterButton.getVisible()?window.document.getElementById(this.oFilterButton.getDomRef().id).getBoundingClientRect().width:0;let s=0;if(this.oDataSourceTabBar.getVisible()){const e=this.oDataSourceTabBar.getItems().reduce((e,t)=>e+t["getText"]().length,0);if(e<20){this.oDataSourceTabBar.addStyleClass("searchDataSourceTabStripBarTinyItemsTextLength");this.oDataSourceTabBar.removeStyleClass("searchDataSourceTabStripBarMediumItemsTextLength")}else if(e<45){this.oDataSourceTabBar.addStyleClass("searchDataSourceTabStripBarMediumItemsTextLength");this.oDataSourceTabBar.removeStyleClass("searchDataSourceTabStripBarTinyItemsTextLength")}else{this.oDataSourceTabBar.removeStyleClass("searchDataSourceTabStripBarTinyItemsTextLength");this.oDataSourceTabBar.removeStyleClass("searchDataSourceTabStripBarMediumItemsTextLength")}const t=this.oDataSourceTabBar.getDomRef();if(t?.id){s=window.document.getElementById(t.id).getBoundingClientRect().width}else{}}const o=t.width-r-s;const n=this.convertPixelToRem(o);if(s===0){if(n<30){this.oGenericItemsToolbar.setWidth(`${n-1.1}rem`)}else{this.oGenericItemsToolbar.setWidth(`${n-3}rem`)}}else{this.oGenericItemsToolbar.setWidth(`${n-2.75}rem`)}},_resizeHandler:function e(){setTimeout(()=>this.adjustSearchbarCustomGenericButtonWidth(),0)},convertPixelToRem:function e(t){return t/parseFloat(getComputedStyle(document.documentElement).fontSize)},createFooter:function e(t){const r=this.getModelInternal();this.oErrorPopover=new b(t+"-"+le+++"-"+"-searchMessagePopover",{placement:q.Top});this.oErrorPopover.setModel(r);r.setProperty("/messagePopoverControlId",this.oErrorPopover.getId());this.oErrorPopover.bindAggregation("items",{path:"/errors",factory:()=>{const e=new M("",{type:"{type}",title:"{title}",description:"{description}"});return e}});const s=new f(this.getId()+"-searchErrorButton",{icon:h.getIconURI("alert"),text:{parts:[{path:"/errors/length"}],formatter:function(e){return e}},visible:{parts:[{path:"/errors/length"}],formatter:e=>e>0,mode:p.OneWay},type:k.Emphasized,tooltip:z.getText("errorBtn"),press:()=>{if(this.oErrorPopover.isOpen()){this.oErrorPopover.close()}else{this.oErrorPopover.setVisible(true);this.oErrorPopover.openBy(s)}}});s.addStyleClass("sapUiSmallMarginBegin");s["addDelegate"]({onAfterRendering:()=>{const e=this.getModelInternal();if(!e.getProperty("/isErrorPopovered")){s.firePress();e.setProperty("/isErrorPopovered",true)}}});s.setLayoutData(new y("",{priority:J.NeverOverflow}));const o=new m(this.getId()+"-searchFooter",{content:[s]});o.addStyleClass("sapUiTinyMarginTop");return o},chooseNoResultScreen:function e(){const t=this.getModelInternal();let r;if(typeof t?.config?.getCustomNoResultScreen==="function"){try{const e=t.config.getCustomNoResultScreen(t.getDataSource(),t);if(e&&e.isDestroyed()){const e=new V.ConfigurationExitError("getCustomNoResultScreen",t.config.applicationComponent,new Error(`The 'no results screen' instance provided by exit 'getCustomNoResultScreen' is already destroyed.\nWe have switched to standard 'no results screen'.\nFor stability reasons, we are destroying old instances with each roundtrip unless custom 'no results screen' instance stays the same.\nThis is needed to keep a cleaned-up dom with no ghost instances (i.e. still described to events).`));this.errorHandler.onError(e);r=this.oSearchResultContainer.getNoResultScreen()}const s=this.oSearchResultContainer.getNoResultScreen();if(s!==this.noResultScreenFolder&&s!==this.noResultScreen&&s!==e){if(s instanceof u){s.destroy()}}r=e}catch(e){const s=new V.ConfigurationExitError("getCustomNoResultScreen",t.config.applicationComponent,e);this.errorHandler.onError(s);r=this.oSearchResultContainer.getNoResultScreen()}}if(!r){if(t.getProperty("/isFolderMode")){if(!this.noResultScreenFolder){this.noResultScreenFolder=this.createNoResultScreen(this.getId(),"folder")}r=this.noResultScreenFolder}else{r=this.noResultScreen}}this.oSearchResultContainer.setNoResultScreen(r)},openSortDialog:function e(){this.sortDialog.unbindAggregation("sortItems",false);this.sortDialog.bindAggregation("sortItems",{path:"/sortableAttributes",factory:()=>new C("",{key:{path:"key"},text:{path:"name"},selected:{path:"selected"}})});this.sortDialog.open()},openShowMoreDialog:function e(t){Y({searchModel:this.getModelInternal(),dimension:t,selectedTabBarIndex:0,tabBarItems:undefined,sourceControl:this})},parseURL:function e(){this.getModelInternal().parseURL();return this},getPublicSearchModel:function e(){return this.getModelInternal("publicSearchModel")},getModelInternal:function e(t){return d.prototype.getModel.call(this,t)},getSearchResultSet:function e(){let t;const r=this.getModelInternal();if(typeof r["resultSet"]==="undefined"||r["resultSet"]===null){t={items:[]}}else{t=this.getModelInternal("publicSearchModel").getProperty("/results")}return t},getResultViewTypes:function e(){const t=this.getModelInternal();return t?.getResultViewTypes()},setResultViewTypes:function e(t){const r=this.getModelInternal();if(typeof t==="undefined"){throw Error("Search Result View Type Error In SearchCompositeControl:\n\n"+"The function parameter 'resultViewTypes' is mandatory.\n"+'Valid example: setResultViewTypes(["searchResultList"])')}else if(typeof r==="undefined"||typeof r.config==="undefined"){return this}this.setResultViewSettings({resultViewTypes:t,resultViewType:r.getResultViewType()});return this},getResultViewType:function e(){const t=this.getModelInternal();return t?.getResultViewType()},setResultViewType:function e(t){const r=this.getModelInternal();if(typeof t==="undefined"){throw Error("Search Result View Type Error In SearchCompositeControl:\n\n"+"The function parameter 'resultlViewType' is mandatory.\n"+'Valid example: setResultViewType("searchResultList")')}else if(typeof r==="undefined"||typeof r.config==="undefined"){return this}this.setResultViewSettings({resultViewTypes:r.getResultViewTypes(),resultViewType:t});return this},getResultViewSettings:function e(){const t=this.getModelInternal();if(t){return{resultViewTypes:t.getResultViewTypes(),resultViewType:t.getResultViewType()}}},setResultViewSettings:function e(t){const r=this.getModelInternal();if(typeof t==="undefined"){throw Error("Search Result View Type Error In SearchCompositeControl:\n\n"+"The function parameter 'resultlViewSettings' is mandatory.\n"+'Valid example: setResultViewSettings({resultViewTypes: ["searchResultList", "searchResultTable"], resultViewType: "searchResultList"})')}else if(typeof r==="undefined"||typeof r.config==="undefined"){return this}if(typeof t.resultViewTypes==="undefined"||typeof t.resultViewType==="undefined"){throw Error("Search Result View Type Error In SearchCompositeControl:\n\n"+"One of properties of function parameter is undefined.\n"+'Valid example: setResultViewSettings({resultViewTypes: ["searchResultList", "searchResultTable"], resultViewType: "searchResultList"})')}r.calculateResultViewSwitchVisibility({resultViewTypes:t.resultViewTypes,resultViewType:t.resultViewType});this.showMoreFooter.setVisible(this.isShowMoreFooterVisible());r.enableOrDisableMultiSelection();this.search();return this},getControllerName:function e(){return"sap.esh.search.ui.container.Search"},getCssClass:function e(){return this._cssClass},setCssClass:function e(t){if(t&&!this.hasStyleClass(t)){this._cssClass=t;this.addStyleClass(t)}return this},getDataSource:function e(){if(typeof this.getModelInternal()!=="undefined"){const e=this.getModelInternal();const t=e.getDataSource();return t.id}},setDataSource:function e(t,r,s){if(typeof this.getModelInternal()!=="undefined"){const e=this.getModelInternal();e.setDataSourceById(t,r,s)}return this},resetDataSource:async function e(t=true){if(typeof this.getModelInternal()!=="undefined"){const e=this.getModelInternal();return e.resetDataSource(t)}return this},search:async function e(t=false,r=true){const s=this.getModelInternal();if(t){s.invalidateQuery()}if(r){return s.fireSearchQuery()}},resetSearch:async function e(){const t=this.getModelInternal();t.resetQuery();this.retriggerSearch()},retriggerSearch:async function e(){this.search(true,true)},invalidateSearchResultCache:async function e(){this.search(true,false)},getSearchTerm:function e(){if(typeof this.getModelInternal()!=="undefined"){const e=this.getModelInternal();return e.getSearchBoxTerm()}return ae.getMetadata().getPropertyDefaults()["searchTerm"]},setSearchTerm:function e(t,r){if(typeof this.getModelInternal()!=="undefined"){const e=this.getModelInternal();e.setSearchBoxTerm(t,r)}return this},getConfig:function e(){if(this.getModelInternal()){const e=this.getModelInternal();return e.config}return},getFilter:function e(){if(this.getModelInternal()){const e=this.getModelInternal();return e.getProperty("/uiFilter")}return},getFilterRootCondition:function e(){if(this.getModelInternal()){const e=this.getModelInternal();return e.getFilterRootCondition()}return ae.getMetadata().getPropertyDefaults()["filterRootCondition"]},updateStaticHierarchyFacet:async function e(){const t=this.getModelInternal();const r=this.getDataSource();const s=t.sinaNext.getDataSource(r).getStaticHierarchyAttributeMetadata().id;if(s){const e=t.getProperty("/facets").filter(e=>e.attributeId===s);if(e.length>0){await(e[0]?.updateTree())}}},setFilterRootCondition:function e(t,r){if(this.getModelInternal()){const e=this.getModelInternal();e.setFilterRootCondition(t,r)}return this},renderSearchUrlFromParameters:function e(t,r,s){const o=this.getModelInternal();if(!o){throw new X(null,"cannot construct URL because model is undefined")}return o.createSearchNavigationTarget({top:t,filter:r,encodeFilter:s,updateUrl:true}).targetUrl},createSearchNavigationTarget:function e(t,r){const s=this.getModelInternal();return s.createSearchNavigationTarget(t,r)},createStaticHierarchySearchNavigationTarget:function e(t,r,s,o){const n=this.getModelInternal();return n.sinaNext.createStaticHierarchySearchNavigationTarget(t,r,s,o)},addEventConsumer:function e(t){const r=this.getModelInternal();r?.eventLogger?.addConsumer(t)},getEventConsumers:function e(){const t=this.getModelInternal();return t?.eventLogger?.consumers},setEventConsumers:function e(t){const r=this.getModelInternal();r?.eventLogger?.setConsumers(t);return this},closePopovers:function e(){let t=document.getElementsByClassName("sapUshellSearchFacetDialog")[0];if(t){const e=L.getElementById(t.id);const r=e?.getButtons();for(const e of r){if(e?.getType()===k.Default){e.firePress();break}}}t=document.getElementsByClassName("sapUshellSearchResultSortDialog")[0];if(t){const e=L.getElementById(t.id);const r=e?.getButtons();for(const e of r){if(e?.getId()?.endsWith("cancelbutton")){e.firePress();break}}}t=document.getElementsByClassName("sapUshellSearchResultTablePersonalizationDialog")[0]||document.getElementsByClassName("sapMP13nPopup")[0];if(t){const e=L.getElementById(t.id);const r=e?.getButtons();for(const e of r){if(e?.getId()?.endsWith("cancelBtn")){e.firePress();break}}}t=document.getElementsByClassName("sapUshellSearchResultExportDialog")[0];if(t){const e=L.getElementById(t.id);e?.close()}t=document.getElementsByClassName("sapUshellSearchResultShareActionSheet")[0];if(t){const e=L.getElementById(t.id);e?.close()}},getInitializationStatus:function e(){return this.getModelInternal().getInitializationStatus()}});ae.eshCompCounter=0;ae.getUI5ControlSettings=function e(t){const r={};const s=ae.getMetadata().getProperties();for(const e in s){if(typeof t[e]==="undefined"){continue}r[e]=t[e]}const o=ae.getMetadata().getEvents();for(const e in o){if(typeof t[e]==="undefined"){continue}r[e]=t[e]}return r};ae.unifyInputParameters=function e(t,r){if(typeof t!=="string"&&t!==undefined&&r===undefined){r=t;t=r&&r.id}else if(typeof r==="undefined"){r={}}if(typeof t==="string"&&t.length>0){r.id=t}if(!t||t.length===0){t="eshComp"+"GenId_"+ae.eshCompCounter++;r.id=t}if(typeof t==="string"&&t.length>0&&typeof r.id!=="undefined"){if(t!==r.id){throw new Error("Constructor of component 'sap.esh.search.ui.SearchCompositeControl' has failed\n\n"+"sId and mSettings.id are not the same. It is sufficient to set either 'id' (sId) or 'settings.id' (mSettings.id).")}}return{sId:t,settings:r}};let le=1;return ae})})();
//# sourceMappingURL=SearchCompositeControl.js.map
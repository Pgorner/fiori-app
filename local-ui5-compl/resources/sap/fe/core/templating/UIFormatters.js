/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2024 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/base/BindingToolkit","sap/fe/core/converters/MetaModelConverter","sap/fe/core/formatters/ValueFormatter","sap/fe/core/helpers/BindingHelper","sap/fe/core/helpers/TypeGuards","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/DisplayModeFormatter","sap/fe/core/templating/FieldControlHelper","sap/fe/core/templating/PropertyHelper"],function(e,t,n,a,i,o,s,r,l){"use strict";var u={};var d=l.isMultiLineText;var c=l.isKey;var f=l.isImmutable;var p=l.isComputed;var g=l.hasValueHelp;var m=l.hasStaticPercentUnit;var y=l.getAssociatedUnitProperty;var v=l.getAssociatedCurrencyProperty;var b=r.isRequiredExpression;var h=r.isReadOnlyExpression;var D=r.isNonEditableExpression;var T=r.isDisabledExpression;var O=o.isPathUpdatable;var E=o.getTargetObjectPath;var x=o.getRelativePaths;var M=o.getContextRelativeTargetObjectPath;var I=o.enhanceDataModelPath;var $=i.isProperty;var V=i.isPathAnnotationExpression;var C=i.isMultipleNavigationProperty;var P=i.isAnnotationOfType;var U=a.singletonPathVisitor;var F=a.bindingContextPathVisitor;var j=a.UI;var S=t.getInvolvedDataModelObjects;var A=t.convertMetaModelContext;var w=e.unresolvableExpression;var R=e.pathInModel;var B=e.or;var N=e.not;var k=e.isTruthy;var q=e.isConstant;var W=e.ifElse;var z=e.getExpressionFromAnnotation;var L=e.formatWithTypeInformation;var H=e.formatResult;var Q=e.equal;var G=e.constant;var K=e.compileExpression;var _=e.and;var Y=e.addTypeInformation;var J=e.EDM_TYPE_MAPPING;const X={Disabled:"Disabled",Display:"Display",Editable:"Editable",EditableDisplay:"EditableDisplay",EditableReadOnly:"EditableReadOnly",ReadOnly:"ReadOnly"};u.FieldEditMode=X;const Z=function(e){return s.getDisplayMode(e.targetObject,e)};u.getDisplayMode=Z;const ee=function(e,t,n){let a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:j.IsEditable;let i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:true;return te(e,t,n,true,a,i)};u.getEditableExpressionAsObject=ee;const te=function(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:undefined;let n=arguments.length>2?arguments[2]:undefined;let a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:j.IsEditable;let o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:true;const s=x(n);if(!e||typeof e==="string"){return K(false)}let r=G(true);if(t!==undefined&&!$(t)){r=W(D(t),false,i)}else if(t!==undefined){r=i}const l=V(e)?e.$target:e;const u=O(n,{propertyPath:e,pathVisitor:(e,t)=>U(e,n.convertedTypes,t)});if(K(u)==="false"&&o){return a?u:"false"}const d=l!==undefined?W(B(_(N(u),o),p(l),c(l),f(l),D(l,s)),W(B(p(l),D(l,s)),false,j.IsTransientBinding),i):w;if(a){return _(d,r)}return K(_(d,r))};u.getEditableExpression=te;const ne=function(e,t){const n=E(e);const a=R(`/collaboration/activities${n}`,"internal");const i=e?.targetEntityType?.keys;const o=[];i?.forEach(function(e){const t=R(e.name);o.push(t)});return H([a,...o],t)};u.getCollaborationExpression=ne;const ae=function(e,t,n){return ie(e,t,true,n)};u.getEnabledExpressionAsObject=ae;const ie=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let a=arguments.length>3?arguments[3]:undefined;if(!e||typeof e==="string"){return K(true)}let i;if(a){i=x(a)}let o=G(true);if(t!==undefined&&!$(t)){o=W(T(t),false,true)}const s=V(e)?e.$target:e;const r=s!==undefined?W(T(s,i),false,true):w;if(n){return _(r,o)}return K(_(r,o))};u.getEnabledExpression=ie;const oe=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:undefined;let o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:j.IsEditable;if(!e||typeof e==="string"||!$(i)&&i?.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath"){return X.Display}const s=V(e)?e.$target:e;const r=x(t);const l=O(t,{propertyPath:s,pathVisitor:(e,n)=>U(e,t.convertedTypes,n)});const u=ee(e,i,t,o,false);const d=ae(e,i,t);const c=v(s);const g=c||y(s);let m=G(X.Editable);if(g){const e=h(g,r);m=W(B(e,p(g),_(f(g),N(j.IsTransientBinding)),n),W(!q(e)&&e,X.EditableReadOnly,X.EditableDisplay),X.Editable)}if(!g&&(s?.annotations?.Measures?.ISOCurrency||s?.annotations?.Measures?.Unit)){m=G(X.EditableDisplay)}let b;if(i!=undefined&&!$(i)){b=B(h(s,r),h(i))}else{b=h(s,r)}const D=W(B(l,j.IsTransientBinding),W(d,W(u,m,W(_(!q(b)&&b,o),X.ReadOnly,X.Display)),W(o,X.Disabled,X.Display)),X.Display);if(a){return D}return K(D)};u.getEditMode=oe;const se=function(e){const t=e?.targetObject;const n=t?.annotations?.Measures?.ISOCurrency;const a=n?n:t?.annotations?.Measures?.Unit;if(a){return K(B(k(z(a)),N(j.IsTotal)))}else{return K(G(true))}};u.hasValidAnalyticalCurrencyOrUnit=se;const re=function(e,t,n){const a=V(e)&&e.$target||e;const i=a.annotations?.Common?.Text!==undefined;if(g(a)){return K(t)}else{return i?K(W(Q(n,"Editable"),"Value",t)):"Value"}};u.getFieldDisplay=re;const le=function(e,t){const n=J[e?.type]||(t?J[t]:undefined);const a={type:n.type,constraints:{},formatOptions:{}};if($(e)){a.constraints={scale:n.constraints?.$Scale?e.scale:undefined,precision:n.constraints?.$Precision?e.precision:undefined,maxLength:n.constraints?.$MaxLength?e.maxLength:undefined,nullable:n.constraints?.$Nullable?e.nullable:undefined,minimum:n.constraints?.["@Org.OData.Validation.V1.Minimum/$Decimal"]&&!isNaN(e.annotations?.Validation?.Minimum)?`${e.annotations?.Validation?.Minimum}`:undefined,maximum:n.constraints?.["@Org.OData.Validation.V1.Maximum/$Decimal"]&&!isNaN(e.annotations?.Validation?.Maximum)?`${e.annotations?.Validation?.Maximum}`:undefined,isDigitSequence:a.type==="sap.ui.model.odata.type.String"&&n.constraints?.["@com.sap.vocabularies.Common.v1.IsDigitSequence"]&&e.annotations?.Common?.IsDigitSequence?true:undefined,V4:n.constraints?.$V4?true:undefined}}a.formatOptions={parseAsString:a?.type?.indexOf("sap.ui.model.odata.type.Int")===0||a?.type?.indexOf("sap.ui.model.odata.type.Double")===0?false:undefined,emptyString:a?.type?.indexOf("sap.ui.model.odata.type.Int")===0||a?.type?.indexOf("sap.ui.model.odata.type.Double")===0?"":undefined,parseKeepsEmptyString:a.type==="sap.ui.model.odata.type.String"?true:undefined};return a};u.getTypeConfig=le;const ue=function(e){return e?.annotations?.UI?.DoNotCheckScaleOfMeasuredQuantity&&e?.annotations?.UI.DoNotCheckScaleOfMeasuredQuantity?.valueOf()?{skipDecimalsValidation:true}:{}};u.getConstraintOptions=ue;const de=function(e,t,a,i){const o=e.targetObject;let s=o.annotations?.Measures?.Unit;const r=x(e);t=L(o,t);if(m(o)){if(i?.showMeasure===false){return t}return H([t],n.formatWithPercentage)}const l=s?"sap.ui.model.odata.type.Unit":"sap.ui.model.odata.type.Currency";s=s?s:o.annotations?.Measures?.ISOCurrency;const u=V(s)&&s.$target?L(s.$target,z(s,r),a):z(s,r);const d=l==="sap.ui.model.odata.type.Unit"?ue(e.targetObject):undefined;return Y([t,u],l,undefined,i,d)};u.getBindingWithUnitOrCurrency=de;const ce=function(e,t){const n=e.targetObject;const a=x(e);const i={};t=L(n,t);const o="sap.fe.core.type.Date";const s=n?.annotations?.Validation?.Minimum?.$Date?n?.annotations?.Validation?.Minimum?.$Date:n?.annotations?.Validation?.Minimum;const r=n?.annotations?.Validation?.Maximum?.$Date?n?.annotations?.Validation?.Maximum?.$Date:n?.annotations?.Validation?.Maximum;const l=s&&V(s)?L(n?.annotations?.Validation?.Minimum,z(n?.annotations?.Validation?.Minimum,a)):s;const u=r&&V(r)?L(n?.annotations?.Validation?.Maximum,z(n?.annotations?.Validation?.Maximum,a)):r;return(l||u)&&Y([t,l,u],o,undefined,i)};u.getBindingForDatePicker=ce;const fe=function(e){const t=e?.targetObject;if(!t){return""}let n=t.annotations?.Measures?.Unit;if(m(t)){return G("%")}const a=x(e);const i=n?"sap.ui.model.odata.type.Unit":"sap.ui.model.odata.type.Currency";n=n?n:t.annotations?.Measures?.ISOCurrency;const o=V(n)&&n.$target?L(n.$target,z(n,a)):z(n,a);let s=R(M(e));s=L(t,s,true);const r=i==="sap.ui.model.odata.type.Unit"?ue(e.targetObject):undefined;return Y([s,o],i,undefined,{parseKeepsEmptyString:true,showNumber:false},r)};u.getBindingForUnitOrCurrency=fe;const pe=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let i=arguments.length>4?arguments[4]:undefined;const o=e.targetObject;const s=o.annotations?.Common?.Timezone;const r=o.annotations?.UI?.DateTimeStyle;const l=x(e);t=L(o,t);const u="sap.fe.core.type.DateTimeWithTimezone";const d=V(s)&&s.$target?L(s.$target,z(s,l),n):z(s,l);let c={};if(a){c={showTimezoneForEmptyValues:false}}if(r){c={...c,...{style:r}}}else if(i?.dateTimeStyle!==undefined){c={...c,...{style:i.dateTimeStyle}}}if(i?.dateTimePattern!==undefined){c={...c,...{pattern:i.dateTimePattern}}}if(i?.showTime!==undefined){c={...c,...{showTime:i.showTime}}}if(i?.showDate!==undefined){c={...c,...{showDate:i.showDate}}}if(i?.showTimezone!==undefined){c={...c,...{showTimezone:i.showTimezone}}}return Y([t,d],u,undefined,c)};u.getBindingWithTimezone=pe;const ge=function(e,t,n){const a=e.targetObject;const i=n?.dateTimePattern;const o=a.annotations?.UI?.DateTimeStyle??n?.dateTimeStyle;t=L(a,t);t.type=J[a.type].type;t.formatOptions={...o&&{style:o.toString()},...i&&{pattern:i}};return t};u.getBindingForDateFormat=ge;const me=function(e,t){const n=e.targetObject;t=L(n,t);t.type="any";const a="sap.ui.model.odata.type.DateTimeWithTimezone";const i={showTime:false,showDate:false,showTimezone:true};return Y([null,t],a,undefined,i)};u.getBindingForTimezone=me;const ye=function(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"Begin";let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"Begin";return K(W(Q(e,"Display"),t,n))};u.getAlignmentExpression=ye;const ve=function(e,t){if(t&&t.context){return A(t.context)}return null};ve.requiresIContext=true;u.getConverterContext=ve;const be=function(e,t){if(t&&t.context){return S(t.context)}return null};be.requiresIContext=true;u.getDataModelObjectPath=be;const he=function(e){if(e.navigationProperties?.length){const t=e?.navigationProperties.findIndex(t=>{if(C(t)){if(e.contextLocation?.navigationProperties?.length){return e.contextLocation?.navigationProperties.findIndex(e=>e.name===t.name)===-1}return true}return false})>-1;if(t){return true}}return false};u.isMultiValueField=he;const De=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return Te(e,t,n,true)};u.getRequiredExpressionAsObject=De;const Te=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:{};let o=arguments.length>5?arguments[5]:undefined;const s=i.requiredPropertiesFromInsertRestrictions;const r=i.requiredPropertiesFromUpdateRestrictions;if(!e||typeof e==="string"){if(a){return G(false)}return K(G(false))}let l;if(o){l=x(o)}let u=G(false);if(t!==undefined&&!$(t)){u=b(t)}let d=G(false);let c=G(false);const f=V(e)&&e.$target||e;const p=b(f,l);const g=n||j.IsEditable;if(s?.includes(f.name)){d=j.IsCreateMode}if(r?.includes(f.name)){c=_(j.IsEditable,N(j.IsCreateMode))}const m=B(_(B(p,u),g),d,c);if(a){return m}return K(m)};u.getRequiredExpression=Te;const Oe=function(e){const t=e?.targetObject?.$target?.Data??{};const n=Object.keys(t);const a=[];let i;const o=[];for(const e of n){if(t[e]?.["$Type"]&&t[e]["$Type"]?.includes("DataField")){a.push(t[e])}}for(const e of a){switch(e.$Type){case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":if(typeof e.Value==="object"){i=e.Value.$target}break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":if(e.Target?.$target){if(P(e.Target.$target,["com.sap.vocabularies.UI.v1.DataField","com.sap.vocabularies.UI.v1.DataPointType"])){if(typeof e.Target.$target.Value==="object"){i=e.Target.$target.Value.$target}}else{if(typeof e.Target==="object"){i=e.Target.$target}break}}break;default:break}o.push(De(i,e,false))}return K(B(...o))};u.getRequiredExpressionForConnectedDataField=Oe;function Ee(e,t){return N(Q(z(e?.annotations?.UI?.Hidden,t),true))}u.isVisible=Ee;const xe=function(e){return d(e.targetObject)};u.isMultiLine=xe;function Me(e,t,n,a){const i=e.annotations.Core?.OperationAvailable?.term==="Org.OData.Core.V1.OperationAvailable";if(!i){return G(true)}let o="";if(n&&a&&a===true&&n.contextLocation?.targetEntityType&&n.contextLocation.targetEntityType!==e.sourceEntityType){const t=x(n);let a=I(n.contextLocation);for(const n of t){a=I(a,n);if(a.targetEntityType===e.sourceEntityType){o=`${x(a).join("/")}/`;break}}}const s=e.isBound?e.parameters[0]?.fullyQualifiedName:undefined;const r=z(e.annotations.Core?.OperationAvailable,[],undefined,e=>`${o}${F(e,t,s)}`);return Q(r,true)}u.getActionEnabledExpression=Me;function Ie(e){let t=G(true);if(P(e.targetObject?.Target?.$target,"com.sap.vocabularies.UI.v1.FieldGroupType")){t=Ee(e.targetObject?.Target?.$target)}return K(_(Ee(e.targetObject),t))}u.isQuickViewFacetVisible=Ie;return u},false);
//# sourceMappingURL=UIFormatters.js.map
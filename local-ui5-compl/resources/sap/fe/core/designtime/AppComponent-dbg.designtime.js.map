{"version":3,"names":["urlParams","URLSearchParams","window","location","search","fioriToolsRtaMode","get","toLowerCase","getAllowList","element","allowList","elementName","getMetadata","getName","getParent","getId","includes","getExtensionAPI","appComponent","rootViewController","getRootViewController","appContentContainer","getAppContentContainer","currentPage","getCurrentPage","currentView","getViewFromContainer","undefined","controller","getController","Error","_exports","AppComponentDesignTime","actions","aggregations","rootControl","propagateMetadata","tool","start","setAdaptationMode","getEnvironmentCapabilities","setCapability","stop","versionWasActivated","AppStateHandler","setRTAVersionWasActivated","extensionAPI","updateAppState"],"sourceRoot":".","sources":["AppComponent.designtime.ts"],"sourcesContent":["import type NavContainer from \"sap/m/NavContainer\";\nimport type ManagedObject from \"sap/ui/base/ManagedObject\";\nimport type AppComponent from \"../AppComponent\";\nimport type { VersionActivated } from \"../AppStateHandler\";\nimport AppStateHandler from \"../AppStateHandler\";\nimport type ExtensionAPI from \"../ExtensionAPI\";\nimport type PageController from \"../PageController\";\n\nconst urlParams = new URLSearchParams(window.location.search);\nconst fioriToolsRtaMode: boolean = urlParams.get(\"fiori-tools-rta-mode\")?.toLowerCase() === \"true\";\n\nconst getAllowList = function (element: ManagedObject): Record<string, boolean> {\n\tlet allowList: Record<string, boolean> = {};\n\tconst elementName = element.getMetadata().getName();\n\tif (fioriToolsRtaMode) {\n\t\t// build the allow list for Fiori tools (developers)\n\t\tallowList = {\n\t\t\t\"sap.fe.macros.controls.FilterBar\": true,\n\t\t\t\"sap.ui.fl.variants.VariantManagement\": true,\n\t\t\t\"sap.ui.mdc.Table\": true\n\t\t};\n\t} else {\n\t\t// build the allow list for UI Adaptation (key users)\n\t\tallowList = {\n\t\t\t\"sap.fe.macros.controls.FilterBar\": true,\n\t\t\t\"sap.fe.templates.ObjectPage.controls.StashableHBox\": true,\n\t\t\t\"sap.fe.templates.ObjectPage.controls.StashableVBox\": true,\n\t\t\t\"sap.m.IconTabBar\": true,\n\t\t\t\"sap.ui.fl.util.IFrame\": true,\n\t\t\t\"sap.ui.fl.variants.VariantManagement\": true,\n\t\t\t\"sap.ui.layout.form.Form\": true,\n\t\t\t\"sap.ui.layout.form.FormContainer\": true,\n\t\t\t\"sap.ui.layout.form.FormElement\": true,\n\t\t\t\"sap.ui.mdc.Table\": true,\n\t\t\t\"sap.uxap.AnchorBar\": true,\n\t\t\t\"sap.m.IconTabHeader\": true,\n\t\t\t\"sap.uxap.ObjectPageLayout\": true,\n\t\t\t\"sap.fe.macros.controls.Section\": true,\n\t\t\t\"sap.uxap.ObjectPageSection\": true,\n\t\t\t\"sap.uxap.ObjectPageSubSection\": true,\n\t\t\t\"sap.f.DynamicPage\": true,\n\t\t\t\"sap.uxap.ObjectPageDynamicHeaderTitle\": true,\n\t\t\t\"sap.m.OverflowToolbar\": true,\n\t\t\t\"sap.m.ToggleButton\": true,\n\t\t\t\"sap.m.Button\": true,\n\t\t\t\"sap.m.MenuButton\": true,\n\t\t\t\"sap.ui.mdc.actiontoolbar.ActionToolbarAction\": true,\n\t\t\t\"sap.ui.mdc.ActionToolbar\": true,\n\t\t\t\"sap.f.DynamicPageTitle\": true\n\t\t};\n\t\t// currently we support the adaptation of IconTabfilter only for the IconTabHeader on Object Page (adaptation of sections and subsections)\n\t\tif (elementName === \"sap.m.IconTabFilter\" && element.getParent()?.getMetadata().getName() === \"sap.m.IconTabHeader\") {\n\t\t\tallowList[\"sap.m.IconTabFilter\"] = true;\n\t\t}\n\t\tif (elementName === \"sap.m.FlexBox\" && element.getId().includes(\"--fe::HeaderContentContainer\")) {\n\t\t\tallowList[\"sap.m.FlexBox\"] = true;\n\t\t}\n\t}\n\treturn allowList;\n};\n\n/**\n * Retrieves the Extension API for the current page from the provided app component.\n * If the current view or controller does not provide an Extension API, the function will either return `undefined` or throw an error.\n * @param appComponent An instance of the app component or page controller from which to retrieve the Extension API.\n * @returns The Extension API for the current page, or `undefined` if it cannot be retrieved.\n * @throws {Error} If the controller does not expose the `getExtensionAPI` method.\n */\nexport function getExtensionAPI(appComponent: PageController | AppComponent): ExtensionAPI | undefined {\n\tif (appComponent) {\n\t\tconst rootViewController = (appComponent as AppComponent).getRootViewController();\n\n\t\tconst appContentContainer = rootViewController.getAppContentContainer();\n\t\tconst currentPage = (appContentContainer as NavContainer).getCurrentPage();\n\n\t\tconst currentView = rootViewController.getViewFromContainer(currentPage);\n\t\tif (!currentView) return undefined;\n\n\t\tconst controller = currentView.getController() as PageController;\n\t\tif (controller.getExtensionAPI) {\n\t\t\treturn controller.getExtensionAPI();\n\t\t}\n\n\t\tthrow new Error(\"getExtensionAPI is not available on the controller.\");\n\t}\n\n\t// To handle cases where `appComponent` is undefined, you may explicitly return undefined.\n\treturn undefined;\n}\n\n// To enable all actions, remove the propagateMetadata function. Or, remove this file and its entry in AppComponent.js referring 'designTime'.\nconst AppComponentDesignTime = {\n\tactions: \"not-adaptable\",\n\taggregations: {\n\t\trootControl: {\n\t\t\tactions: \"not-adaptable\",\n\t\t\tpropagateMetadata: function (element: ManagedObject): { actions?: string } {\n\t\t\t\tconst allowList = getAllowList(element);\n\t\t\t\tif (allowList[element.getMetadata().getName()]) {\n\t\t\t\t\t// by returning the empty object, the same will be merged with element's native designtime definition, i.e. all actions will be enabled for this element\n\t\t\t\t\treturn {};\n\t\t\t\t} else {\n\t\t\t\t\t// not-adaptable will be interpreted by flex to disable all actions for this element\n\t\t\t\t\treturn {\n\t\t\t\t\t\tactions: \"not-adaptable\"\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\ttool: {\n\t\tstart: function (appComponent: AppComponent): void {\n\t\t\tappComponent.setAdaptationMode(true);\n\t\t\tappComponent.getEnvironmentCapabilities().setCapability(\"AppState\", false);\n\t\t},\n\t\tstop: function (appComponent: AppComponent, versionWasActivated: VersionActivated): void {\n\t\t\tappComponent.setAdaptationMode(false);\n\t\t\tappComponent.getEnvironmentCapabilities().setCapability(\"AppState\", true);\n\n\t\t\tAppStateHandler.setRTAVersionWasActivated(appComponent.getId(), versionWasActivated?.versionWasActivated ?? false);\n\t\t\t// Access the extension API and call updateAppState()\n\t\t\tconst extensionAPI = getExtensionAPI(appComponent);\n\t\t\textensionAPI?.updateAppState();\n\t\t}\n\t}\n};\n\nexport default AppComponentDesignTime;\n"],"mappings":"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","ignoreList":[],"file":"AppComponent-dbg.designtime.js"}
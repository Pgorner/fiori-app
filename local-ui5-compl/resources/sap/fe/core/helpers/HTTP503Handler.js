/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2024 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/controllerextensions/BusyLocker","sap/fe/core/helpers/PromiseKeeper","sap/m/Button","sap/m/Dialog","sap/m/ProgressIndicator","sap/m/Text","sap/m/VBox"],function(e,t,n,s,r,a,o){"use strict";const l={createDialog(e){return new s(e)},async _handleDelayBusy(t,n){e.lock(n);return new Promise(s=>{setTimeout(()=>{e.unlock(n);s(undefined)},t)})},async _handleDelayProgressBar(e,s,l){const c=new t;const i=new a;const u=new r({displayOnly:true,percentValue:0,showValue:false});const f=new o({items:[new a({text:l.getText("C_MESSAGE_HANDLING_SAPFE_503_TITLE")})]});if(s.message){f.addItem(new a({text:s.message.replaceAll(/[\n\r]/g," ")}))}f.addItem(i);f.addItem(u);function d(){const t=s.retryAfter.getTime()-Date.now();if(t<=0){return false}else{const n=100-t/e*100;u.setPercentValue(n);const s=Math.ceil(t/1e3);const r=Math.floor(s/60);const a=s%60;if(r>0){i.setText(l.getText("C_UNAVAILABLE_SERVER_MESSAGE_MINUTES_SECONDS",[r,a]))}else{i.setText(l.getText("C_UNAVAILABLE_SERVER_MESSAGE_SECONDS",[a]))}return true}}const _=setInterval(()=>{if(!d()){clearInterval(_);g.close();c.resolve(undefined)}},100);const m=()=>{clearInterval(_);g.close();c.reject(s)};const g=this.createDialog({type:"Message",title:l.getText("WARNING"),content:[f],endButton:new n({text:l.getText("C_COMMON_DIALOG_CANCEL"),press:m}),state:"Warning"});d();g.open();return c.promise},async handle503Delay(e,t,n){if(e.retryAfter===undefined){return Promise.reject(e)}const s=e.retryAfter.getTime()-Date.now();if(s<5e3){return this._handleDelayBusy(s,t)}else if(s<6e5){return this._handleDelayProgressBar(s,e,n)}else{return Promise.reject(e)}}};return l},false);
//# sourceMappingURL=HTTP503Handler.js.map
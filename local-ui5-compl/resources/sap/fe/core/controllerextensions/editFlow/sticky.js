/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2024 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/helpers/ResourceModelHelper","sap/fe/core/library","sap/m/MessageBox","sap/ui/core/Lib","../../operationsHelper"],function(e,t,n,o,i,s,c){"use strict";var a=n.getResourceModel;const r=o.ProgrammingModel;async function d(e,t,n){const o=e.getModel(),i=o.getMetaModel(),s=i.getMetaPath(e.getPath()),r=i.getObject(`${s}@com.sap.vocabularies.Session.v1.StickySessionSupported/EditAction`);if(!r){throw new Error(`Edit Action for Sticky Session not found for ${s}`)}const d=a(t);const u=d.getText("C_COMMON_OBJECT_PAGE_EDIT");const f=o.bindContext(`${r}(...)`,e,{$$inheritExpandSelect:true});const l="direct";const S=e.getObject()===undefined?true:undefined;const p=f.execute(l,S,c.fnOnStrictHandlingFailed.bind(g,l,{appComponent:t,label:u,model:o},null,null,null,n,undefined,undefined),e.getBinding().isA("sap.ui.model.odata.v4.ODataListBinding"));o.submitBatch(l);const A=await p;const O=t.getSideEffectsService().getODataActionSideEffects(r,A);if(O?.triggerActions&&O.triggerActions.length){await t.getSideEffectsService().requestSideEffectsForODataAction(O,A)}return A}async function u(t,n,o){const i=t.getModel(),s=i.getMetaModel(),r=s.getMetaPath(t.getPath()),d=s.getObject(`${r}@com.sap.vocabularies.Session.v1.StickySessionSupported/SaveAction`);if(!d){throw new Error(`Save Action for Sticky Session not found for ${r}`)}const u=a(n);const f=u.getText("C_OP_OBJECT_PAGE_SAVE");const l=i.bindContext(`${d}(...)`,t,{$$inheritExpandSelect:true});const S="direct";const p=l.execute(S,true,c.fnOnStrictHandlingFailed.bind(g,S,{appComponent:n,label:f,model:i},null,null,null,o,undefined,undefined),t.getBinding().isA("sap.ui.model.odata.v4.ODataListBinding"));i.submitBatch(S);try{return await p}catch(o){const i=s.getObject(`${r}/@${"com.sap.vocabularies.Common.v1.Messages"}/$Path`);if(i){try{await n.getSideEffectsService().requestSideEffects([i],t)}catch(t){e.error("Error while requesting side effects",t)}}throw o}}async function f(e){const t=e.getModel(),n=t.getMetaModel(),o=n.getMetaPath(e.getPath()),i=n.getObject(`${o}@com.sap.vocabularies.Session.v1.StickySessionSupported/DiscardAction`);if(!i){throw new Error(`Discard Action for Sticky Session not found for ${o}`)}const s=t.bindContext(`/${i}(...)`);return s.execute("$single").then(function(){return e})}function l(n,o,c){const a=t.getIsEditable(o),d=s.getResourceBundleFor("sap.fe.templates"),u=d.getText("T_COMMON_UTILS_NAVIGATION_AWAY_MSG"),f=d.getText("T_COMMON_UTILS_NAVIGATION_AWAY_CONFIRM_BUTTON"),l=d.getText("T_COMMON_UTILS_NAVIGATION_AWAY_CANCEL_BUTTON");if(c===r.Sticky&&a){return i.warning(u,{actions:[f,l],emphasizedAction:f,onClose:function(t){if(t===f){e.info("Navigation confirmed.");n()}else{e.info("Navigation rejected.")}}})}return n()}const g={editDocumentInStickySession:d,activateDocument:u,discardDocument:f,processDataLossConfirmation:l};return g},false);
//# sourceMappingURL=sticky.js.map
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2024 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/m/MessageBox","sap/ui/core/message/Message","sap/ui/core/message/MessageType","sap/ui/model/json/JSONModel","./controllerextensions/dialog/OperationsDialog","./controllerextensions/messageHandler/messageHandling","./helpers/ResourceModelHelper"],function(e,t,s,n,i,o,r,a){"use strict";function l(e,l,g,d,c,f,u,_){if(!g.length){return}const M=a.getResourceModel(e.appComponent);const E=a.getLocalizedText(e.label,e.appComponent);const C=e.model;const p=d?.strictHandlingPromises??[];let S;let O=M.getText("C_COMMON_DIALOG_CANCEL");let A="";let G="";A=e.bGrouped?M.getText("C_COMMON_DIALOG_CANCEL_MESSAGE_TEXT",[E]):M.getText("C_COMMON_DIALOG_SKIP_SINGLE_MESSAGE_TEXT");if(g.length===1){const s=g[0].getMessage();const n=g[0].getAdditionalText();G=M.getText("C_COMMON_DIALOG_CANCEL_SINGLE_MESSAGE_TEXT");if(!c){S=`${s}\n${M.getText("PROCEED")}`}else if(n!==undefined&&n!==""){O=e.bGrouped?O:M.getText("C_COMMON_DIALOG_SKIP");const t=e.control?.getParent()?.getTableDefinition().headerInfoTypeName;if(t){S=`${t.toString()} ${n}: ${s}\n\n${A}`}else{S=`${n}: ${s}\n\n${A}`}}else{O=e.bGrouped?O:M.getText("C_COMMON_DIALOG_SKIP");S=`${s}\n\n${A}`}if(c&&e.bGrouped){S=`${G}\n\n${S}`}t.warning(S,{title:M.getText("WARNING"),actions:[E,O],emphasizedAction:E,onClose:s=>{if(s===E){if(_){f?.(true);C.submitBatch(u);e.requestSideEffects?.()}else if(!c){const e=p[0];e.resolve(true);C.submitBatch(e.groupId);e.requestSideEffects?.()}else{for(const e of p){e.resolve(true);C.submitBatch(e.groupId);e.requestSideEffects?.()}if(d?.strictHandlingTransitionFails?.length){l?.removeTransitionMessages()}}if(d){d.is412Executed=true}}else{if(d){d.is412Executed=false}if(_){f?.(false)}else if(!c){p[0].resolve(false)}else{for(const e of p){e.resolve(false)}}if(e.bGrouped){t.information(M.getText("M_CHANGESET_CANCEL_MESSAGES"),{contentWidth:"150px"})}}if(d){d.strictHandlingWarningMessages=[]}}});return}const T=new i;let N="";let I="";if(c){O=e.bGrouped?O:M.getText("C_COMMON_DIALOG_SKIP");N=e.bGrouped?M.getText("C_COMMON_DIALOG_CANCEL_MESSAGES_WARNING"):M.getText("C_COMMON_DIALOG_SKIP_MESSAGES_WARNING");I=e.bGrouped?M.getText("C_COMMON_DIALOG_CANCEL_MESSAGES_TEXT",[E]):M.getText("C_COMMON_DIALOG_SKIP_MESSAGES_TEXT",[E])}else{N=M.getText("C_COMMON_DIALOG_CANCEL_MESSAGES_GENERIC_ACTION_WARNING",[E])}const m=new s({message:N,type:n.Information,target:undefined,persistent:true,description:I.length?I:undefined});g=[m].concat(g);T.setData(g);new o({messageObject:r.prepareMessageViewForDialog(T,true,c),isMultiContext412:c,isGrouped:e.bGrouped,requestSideEffects:e.requestSideEffects,resolve:f,model:C,groupId:u,actionName:E,strictHandlingUtilities:d,strictHandlingPromises:p,messageHandler:l,messageDialogModel:T,cancelButtonTxt:O,showMessageInfo:()=>{t.information(M.getText("M_CHANGESET_CANCEL_MESSAGES"),{contentWidth:"150px"})}}).open()}async function g(t,s,n,i,o,r,a,l){let g=arguments.length>8&&arguments[8]!==undefined?arguments[8]:[];const c=r.filterErrorMessages(g);g.forEach(t=>{if(c.includes(t)){e.warning("Warning: 412 ('Pre-condition Check Failed due to strict-handling') returns messages of type error but only warning messages are appropriate!")}});r.addWarningMessagesToMessageHandler(g);let f;if(n===null&&o===null||n===1&&o===1){return new Promise(e=>{d.renderMessageView(s,r,g,a,false,e,t,true)})}const u=new Promise(function(e){f={requestSideEffects:s.requestSideEffects,resolve:e,groupId:t}});a?.strictHandlingPromises.push(f);if(g.length&&a){const e=a.strictHandlingWarningMessages;let t="";if(o&&o>1){const e=s.control?.getParent();const n=e&&e.isA("sap.fe.macros.table.TableAPI")&&e.getIdentifierColumn();if(n){t=i?.getObject(n)}}for(const s of g){s.setAdditionalText(t);e.push(s)}a.strictHandlingWarningMessages=e}l?.();return u}const d={renderMessageView:l,fnOnStrictHandlingFailed:g};return d},false);
//# sourceMappingURL=operationsHelper.js.map
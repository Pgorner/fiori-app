/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2024 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/ui/VersionInfo","sap/ui/core/Lib","sap/ui/core/service/Service","sap/ui/core/service/ServiceFactory"],function(e,i,t,n,a){"use strict";function r(e){return new Promise((i,t)=>{sap.ui.require([e],t=>{if(!(t&&t.__esModule)){t=t===null||!(typeof t==="object"&&e.endsWith("/library"))?{default:t}:t;Object.defineProperty(t,"__esModule",{value:true})}i(t)},e=>{t(e)})})}var s={};function o(e,i){e.prototype=Object.create(i.prototype),e.prototype.constructor=e,l(e,i)}function l(e,i){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,i){return e.__proto__=i,e},l(e,i)}const u={SmartSummarize:{intent:"IntelligentPrompt-summarize",library:"ux.eng.fioriai.reuse"},MagicFiltering:{intent:"IntelligentPrompt-filter",library:"ux.eng.fioriai.reuse",imports:"ux/eng/fioriai/reuse/easyfilter/EasyFilter"},ErrorExplanation:{intent:"IntelligentPrompt-explain",library:"ux.eng.fioriai.reuse",imports:"ux/eng/fioriai/reuse/errorexplanation/ErrorExplanation"}};const c={Chart:true,MicroChart:true,Collaboration:false,UShell:true,IntentBasedNavigation:true,AppState:true,InsightsSupported:false,ContextSharingSupported:false,SmartSummarize:false,MagicFiltering:false,ErrorExplanation:false,DisableInputAssistance:false};s.DefaultEnvironmentCapabilities=c;let p=function(n){function a(){var e;for(var i=arguments.length,t=new Array(i),a=0;a<i;a++){t[a]=arguments[a]}e=n.call(this,...t)||this;e.optionalFeatureLibraries={};return e}s.EnvironmentCapabilitiesService=a;o(a,n);var l=a.prototype;l.prepareFeature=async function e(i){const n=this.optionalFeatureLibraries[i];if(!n){throw new Error(`Feature '${i}' is unavailable`)}await t.load(n)};l.initialize=async function n(){const a=this.getContext();this.environmentCapabilities=Object.assign({},c);const s=sap.ui.require("sap/ushell/Container");const o=await i.load();this.environmentCapabilities.Chart=o.libraries.some(e=>e.name==="sap.viz");this.environmentCapabilities.MicroChart=o.libraries.some(e=>e.name==="sap.suite.ui.microchart");this.environmentCapabilities.Collaboration=o.libraries.some(e=>e.name==="sap.suite.ui.commons");this.environmentCapabilities.UShell=!!s;this.environmentCapabilities.IntentBasedNavigation=!!s;this.environmentCapabilities.InsightsSupported=o.libraries.some(e=>e.name==="sap.insights");this.environmentCapabilities.ContextSharingSupported=o.libraries.some(e=>e.name==="sap.insights");const l=await(s?.getServiceAsync("Navigation"));for(const[i,n]of Object.entries(u)){this.environmentCapabilities[i]=false;if(l){try{const{url:e}=await l.resolveIntent(`#${n.intent}`);this.optionalFeatureLibraries[i]={name:n.library,url:e,imports:n.imports};if(n.imports){try{await t.load(this.optionalFeatureLibraries[i]);await r(n.imports);this.environmentCapabilities[i]=true}catch(e){this.environmentCapabilities[i]=false}}else{this.environmentCapabilities[i]=true}}catch(t){e.info(`Feature unavailable ${i}: ${t?.message}`)}}}this.environmentCapabilities=Object.assign(this.environmentCapabilities,a.settings)};a.resolveLibrary=async function e(i){return new Promise(function(e){t.load({name:`${i}`}).then(function(){e(true);return}).catch(function(){e(false)})})};l.setCapabilities=function e(i){this.environmentCapabilities=i};l.setCapability=function e(i,t){this.environmentCapabilities[i]=t};l.getCapabilities=function e(){return this.environmentCapabilities};l.isInsightsEnabled=async function e(){return new Promise(async e=>{try{const i=await a.resolveLibrary("sap.insights");if(i){sap.ui.require(["sap/insights/CardHelper"],async i=>{try{await i.getServiceAsync("UIService");e(!await m())}catch{e(false)}})}else{e(false)}}catch{e(false)}})};l.isContextSharingEnabled=async function e(){const i=await a.resolveLibrary("sap.insights");if(i){try{await r("sap/insights/channels/ContextChannel")}catch(e){return false}return true}else{return false}};l.getInterface=function e(){return this};return a}(n);s.EnvironmentCapabilitiesService=p;let f=function(e){function i(){return e.apply(this,arguments)||this}s.EnvironmentServiceFactory=i;o(i,e);var t=i.prototype;t.createInstance=async function e(i){const t=new p(i);await t.initialize();return t};return i}(a);s.EnvironmentServiceFactory=f;async function m(){let e=false;try{const{default:i}=await r("sap/suite/ui/commons/collaboration/CollaborationHelper");e=await i.isTeamsModeActive()}catch{return false}return e}s.getMSTeamsActive=m;return s},false);
//# sourceMappingURL=EnvironmentServiceFactory.js.map
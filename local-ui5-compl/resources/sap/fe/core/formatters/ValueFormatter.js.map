{"version":3,"file":"ValueFormatter.js","names":["valueFormatters","sName","hasOwnProperty","_len","arguments","length","oArgs","Array","_key","apply","this","formatWithBrackets","firstPart","secondPart","resourceBundle","Library","getResourceBundleFor","getText","__functionName","formatTitle","whitespaceReplacer","formatWithPercentage","sValue","undefined","computePercentage","value","target","sUnit","sPercentString","iValue","parseFloat","iTarget","toString","formatCriticalityValueState","val","sValueState","_exports","formatCriticalityButtonType","sType","formatCriticalityColorMicroChart","sColor","formatProgressIndicatorText","unit","isCurrency","customUnits","unitSplit","split","searchUnit","dateFormat","DateFormat","getDateInstance","localeData","oLocaleData","mData","oResourceModel","unitDisplayed","dateFields","displayName","units","short","formatter","NumberFormat","getCurrencyInstance","customCurrencies","showMeasure","getUnitInstance","displayValue","format","displayTarget","formatToKeepWhitespace","provideDateInstance","isDateValid","Date","isNaN","parse","UI5Date","getInstance","Log","warning","hasSemanticObjects","_len2","semanticObjects","_key2","currentUserSemanticObjectsList","dynamicSemanticObjectsResolved","i","push","getReachableSemanticObjectsSettings","semanticObjectsList","semanticObjectsExpressionList","qualifierMap","hasReachableStaticSemanticObject","ObjectPath","set"],"sources":["./ValueFormatter.ts"],"sourcesContent":["import Log from \"sap/base/Log\";\nimport whitespaceReplacer from \"sap/base/strings/whitespaceReplacer\";\nimport ObjectPath from \"sap/base/util/ObjectPath\";\nimport { getReachableSemanticObjectsSettings } from \"sap/fe/core/templating/SemanticObjectHelper\";\nimport Library from \"sap/ui/core/Lib\";\nimport UI5Date from \"sap/ui/core/date/UI5Date\";\nimport DateFormat from \"sap/ui/core/format/DateFormat\";\nimport NumberFormat from \"sap/ui/core/format/NumberFormat\";\n/**\n * Collection of table formatters.\n * @param this The context\n * @param sName The inner function name\n * @param oArgs The inner function parameters\n * @returns The value from the inner function\n */\nconst valueFormatters = function (this: object, sName: string, ...oArgs: unknown[]): unknown {\n\tif (valueFormatters.hasOwnProperty(sName)) {\n\t\treturn (valueFormatters as unknown as Record<string, Function>)[sName].apply(this, oArgs);\n\t} else {\n\t\treturn \"\";\n\t}\n};\n\nconst formatWithBrackets = (firstPart?: string, secondPart?: string): string => {\n\tif (firstPart && secondPart) {\n\t\tconst resourceBundle = Library.getResourceBundleFor(\"sap.fe.core\")!;\n\t\treturn resourceBundle.getText(\"C_FORMAT_FOR_TEXT_ARRANGEMENT\", [firstPart, secondPart]);\n\t} else {\n\t\treturn firstPart || secondPart || \"\";\n\t}\n};\nformatWithBrackets.__functionName = \"sap.fe.core.formatters.ValueFormatter#formatWithBrackets\";\n\nconst formatTitle = (firstPart?: string, secondPart?: string): string => {\n\treturn secondPart ? formatWithBrackets(whitespaceReplacer(firstPart), whitespaceReplacer(secondPart)) : whitespaceReplacer(firstPart);\n};\nformatTitle.__functionName = \"sap.fe.core.formatters.ValueFormatter#formatTitle\";\n\nconst formatWithPercentage = (sValue?: string): string => {\n\treturn sValue !== null && sValue !== undefined ? `${sValue} %` : \"\";\n};\nformatWithPercentage.__functionName = \"sap.fe.core.formatters.ValueFormatter#formatWithPercentage\";\n\nconst computePercentage = (value: string | number, target: string | number, sUnit?: string): string | undefined => {\n\tlet sPercentString: string;\n\t//BCP: 2370008548 If the base value is undefined return \"0\" by default\n\tif (value === undefined) {\n\t\treturn \"0\";\n\t}\n\n\tconst iValue: number = typeof value === \"string\" ? parseFloat(value) : value;\n\tconst iTarget: number = typeof target === \"string\" ? parseFloat(target) : target;\n\n\tif (sUnit === \"%\") {\n\t\tif (iValue > 100) {\n\t\t\tsPercentString = \"100\";\n\t\t} else if (iValue <= 0) {\n\t\t\tsPercentString = \"0\";\n\t\t} else {\n\t\t\tsPercentString = typeof value === \"string\" ? value : value?.toString();\n\t\t}\n\t} else if (iValue > iTarget) {\n\t\tsPercentString = \"100\";\n\t} else if (iValue <= 0) {\n\t\tsPercentString = \"0\";\n\t} else {\n\t\tsPercentString = iValue && iTarget ? ((iValue / iTarget) * 100).toString() : \"0\";\n\t}\n\treturn sPercentString;\n};\ncomputePercentage.__functionName = \"sap.fe.core.formatters.ValueFormatter#computePercentage\";\n\nexport const formatCriticalityValueState = (val?: string | number): string | undefined => {\n\tlet sValueState: string;\n\tif (val === \"UI.CriticalityType/Negative\" || val === \"1\" || val === 1) {\n\t\tsValueState = \"Error\";\n\t} else if (val === \"UI.CriticalityType/Critical\" || val === \"2\" || val === 2) {\n\t\tsValueState = \"Warning\";\n\t} else if (val === \"UI.CriticalityType/Positive\" || val === \"3\" || val === 3) {\n\t\tsValueState = \"Success\";\n\t} else if (val === \"UI.CriticalityType/Information\" || val === \"5\" || val === 5) {\n\t\tsValueState = \"Information\";\n\t} else {\n\t\tsValueState = \"None\";\n\t}\n\treturn sValueState;\n};\nformatCriticalityValueState.__functionName = \"sap.fe.core.formatters.ValueFormatter#formatCriticalityValueState\";\n\nexport const formatCriticalityButtonType = (val?: string | number): string | undefined => {\n\tlet sType: string;\n\tif (val === \"UI.CriticalityType/Negative\" || val === \"1\" || val === 1) {\n\t\tsType = \"Reject\";\n\t} else if (val === \"UI.CriticalityType/Positive\" || val === \"3\" || val === 3) {\n\t\tsType = \"Accept\";\n\t} else {\n\t\tsType = \"Default\";\n\t}\n\treturn sType;\n};\nformatCriticalityButtonType.__functionName = \"sap.fe.core.formatters.ValueFormatter#formatCriticalityButtonType\";\n\nexport const formatCriticalityColorMicroChart = (val?: string | number): string | undefined => {\n\tlet sColor: string;\n\tif (val === \"UI.CriticalityType/Negative\" || val === \"1\" || val === 1) {\n\t\tsColor = \"Error\";\n\t} else if (val === \"UI.CriticalityType/Critical\" || val === \"2\" || val === 2) {\n\t\tsColor = \"Critical\";\n\t} else if (val === \"UI.CriticalityType/Positive\" || val === \"3\" || val === 3) {\n\t\tsColor = \"Good\";\n\t} else {\n\t\tsColor = \"Neutral\";\n\t}\n\treturn sColor;\n};\nformatCriticalityColorMicroChart.__functionName = \"sap.fe.core.formatters.ValueFormatter#formatCriticalityColorMicroChart\";\n\n/**\n * Formats the text to be displayed in the progress indicator. Takes into account the decimals and precision of the unit.\n * @param value The current value of the progress indicator\n * @param target The target value fo the progress indicator\n * @param unit The unit of the progress indicator\n * @param isCurrency Whether we have a currency or a uom\n * @param customUnits An object containing the custom units of the application\n * @param customUnits.customCurrencies\n * @param customUnits.showMeasure\n * @returns The translated and formatted text of the progress indicator\n */\nexport const formatProgressIndicatorText = (\n\tvalue: string | number,\n\ttarget: string | number,\n\tunit: string,\n\tisCurrency: boolean,\n\tcustomUnits?: Record<string, object>\n): string | undefined => {\n\tif (value && target && unit) {\n\t\tconst unitSplit = unit.split(\"-\");\n\t\tconst searchUnit = `${unitSplit[1] === undefined ? unit : unitSplit[1]}-narrow`;\n\t\tconst dateFormat = DateFormat.getDateInstance();\n\t\tconst localeData = (\n\t\t\tdateFormat as DateFormat & {\n\t\t\t\toLocaleData: {\n\t\t\t\t\tmData: {\n\t\t\t\t\t\tunits?: { short: Record<string, { displayName?: string }> };\n\t\t\t\t\t\tdateFields: Record<string, { displayName?: string }>;\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t}\n\t\t).oLocaleData.mData;\n\t\tconst oResourceModel = Library.getResourceBundleFor(\"sap.fe.macros\")!;\n\t\tlet unitDisplayed = unit;\n\t\tif (localeData?.dateFields[searchUnit]?.displayName) {\n\t\t\tunitDisplayed = localeData.dateFields[searchUnit].displayName!;\n\t\t} else if (localeData?.units?.short[unit]?.displayName) {\n\t\t\tunitDisplayed = localeData.units.short[unit].displayName!;\n\t\t}\n\n\t\tlet formatter;\n\t\tif (isCurrency) {\n\t\t\tformatter = NumberFormat.getCurrencyInstance({\n\t\t\t\tcustomCurrencies: customUnits,\n\t\t\t\tshowMeasure: false\n\t\t\t});\n\t\t} else {\n\t\t\tformatter = NumberFormat.getUnitInstance({\n\t\t\t\tcustomUnits: customUnits,\n\t\t\t\tshowMeasure: false\n\t\t\t});\n\t\t}\n\t\tconst displayValue = formatter.format(+value, unitDisplayed);\n\t\tconst displayTarget = formatter.format(+target, unitDisplayed);\n\n\t\treturn oResourceModel.getText(\"T_COMMON_PROGRESS_INDICATOR_DISPLAY_VALUE_WITH_UOM\", [displayValue, displayTarget, unitDisplayed]);\n\t}\n};\nformatProgressIndicatorText.__functionName = \"sap.fe.core.formatters.ValueFormatter#formatProgressIndicatorText\";\n\nexport const formatToKeepWhitespace = (value: string | boolean | number): string => {\n\treturn value === null || value === undefined ? \"\" : whitespaceReplacer(value + \"\");\n};\nformatToKeepWhitespace.__functionName = \"sap.fe.core.formatters.ValueFormatter#formatToKeepWhitespace\";\n\nfunction provideDateInstance(value: string | number | Date): Date | null {\n\tif (value) {\n\t\tconst isDateValid = new Date(value);\n\t\tif (!isNaN(Date.parse(isDateValid as unknown as string))) {\n\t\t\treturn UI5Date.getInstance(value);\n\t\t} else {\n\t\t\tLog.warning(\"Warning: Valid date format has to be sent to retrieve UI5 date instance\");\n\t\t}\n\t}\n\treturn null;\n}\nprovideDateInstance.__functionName = \"sap.fe.core.formatters.ValueFormatter#provideDateInstance\";\n\n/**\n * Format the semantic objects available to user.\n * @param semanticObjects The semantic objects from shell services and the dynamic semantic objects resolved\n * @returns True if the user has semantic objects to navigate\n */\nexport const hasSemanticObjects = function (...semanticObjects: unknown[]): boolean | undefined {\n\tconst currentUserSemanticObjectsList = semanticObjects[0];\n\tconst dynamicSemanticObjectsResolved: string[] = [];\n\tfor (let i = 1; i < semanticObjects.length; i++) {\n\t\tif (semanticObjects[i]) {\n\t\t\tdynamicSemanticObjectsResolved.push(semanticObjects[i] as string);\n\t\t}\n\t}\n\tif (dynamicSemanticObjectsResolved.length > 0) {\n\t\treturn getReachableSemanticObjectsSettings(currentUserSemanticObjectsList as string[], {\n\t\t\tsemanticObjectsList: dynamicSemanticObjectsResolved,\n\t\t\tsemanticObjectsExpressionList: [],\n\t\t\tqualifierMap: {}\n\t\t}).hasReachableStaticSemanticObject;\n\t}\n\treturn undefined;\n};\nhasSemanticObjects.__functionName = \"sap.fe.core.formatters.ValueFormatter#hasSemanticObjects\";\n\nvalueFormatters.hasSemanticObjects = hasSemanticObjects;\nvalueFormatters.formatWithBrackets = formatWithBrackets;\nvalueFormatters.formatTitle = formatTitle;\nvalueFormatters.provideDateInstance = provideDateInstance;\nvalueFormatters.formatWithPercentage = formatWithPercentage;\nvalueFormatters.computePercentage = computePercentage;\nvalueFormatters.formatCriticalityValueState = formatCriticalityValueState;\nvalueFormatters.formatCriticalityButtonType = formatCriticalityButtonType;\nvalueFormatters.formatCriticalityColorMicroChart = formatCriticalityColorMicroChart;\nvalueFormatters.formatProgressIndicatorText = formatProgressIndicatorText;\nvalueFormatters.formatToKeepWhitespace = formatToKeepWhitespace;\n\nObjectPath.set(\"sap.fe.core.formatters.ValueFormatter\", valueFormatters);\n\nexport default valueFormatters;\n"],"mappings":"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","ignoreList":[]}
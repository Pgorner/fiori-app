{"version":3,"names":["Log","setLevel","jest","setTimeout","nameSpaceMap","macro","macros","feBB","macroField","macrodata","log","customData","control","controls","core","dt","m","f","fl","internalMacro","mdc","actiontoolbar","mdcField","mdcTable","u","uxap","macroMicroChart","microChart","macroTable","mdcvc","mdcv","valueHelp","contentSwitcher","filterBar","fbControls","draftIndicator","reveseNamespaceMap","Object","keys","reduce","reverseMap","currentName","select","xpath","useNamespaces","defaultFakeSideEffectService","computeFieldGroupIds","_getTemplatedSelector","xmldom","selector","rootPath","nodeName","startsWith","_buildPreProcessorSettings","sMetadataUrl","mBindingContexts","mModels","fakeSideEffectService","oMetaModel","getMetaModel","hasOwnProperty","assign","converterContext","TemplateModel","forEach","sModelName","isTemplateModel","data","settings","models","metaModel","bindingContexts","appComponent","getSideEffectsService","fn","getDiagnostics","undefined","getShellServices","mockReturnValue","sKey","expect","getObject","toBeDefined","oModel","createBindingContext","_loadResourceView","viewName","name","replace","view","LoaderExtensions","loadResource","documentElement","runXPathQuery","extend","toHaveControl","nodes","message","outputXml","serializeXML","pass","length","toNotHaveControl","toHaveTemplatingErrors","xml","xmlText","base64Entries","match","errorMessages","map","atob","slice","join","_exports","formatBuildingBlockXML","xmlString","Array","isArray","formatXML","getControlAttribute","controlSelector","attributeName","xmlDom","serializer","window","XMLSerializer","node","serializeToString","START","END","UID","UID2","lines","currentLine","level","attributes","newline","push","repeat","appendAttributes","sort","a","b","localeCompare","includes","attribute","value","append","parser","read","createParser","onOpenTagStart","onOpenTagName","onAttrName","unshift","onAttrValue","onOpenTagEnd","selfClosed","onCloseTagStart","onCloseTagName","onCloseTagEnd","parse","trim","compileCDS","cdsUrl","options","arguments","cdsString","fs","readFileSync","edmxContent","cds2edmx","dir","path","resolve","allOptions","entries","edmxFileName","filename","_ref","optionKey","optionValue","toString","basename","edmxFilePath","mkdirSync","recursive","writeFileSync","cds","service","sources","require","csn","compiler","compileSources","edmxOptions","odataForeignKeys","odataFormat","odataContainment","edmx","to","Error","getFakeSideEffectsService","classNameODataModel","scopeObject","getModel","isA","getServiceUrl","getService","getCapabilities","serviceInstance","SideEffectsFactory","createInstance","scopeType","getInterface","getFakeDiagnostics","issues","addIssue","issueCategory","issueSeverity","details","getIssues","checkIfIssueExists","find","issue","getConverterContextForTest","manifestSettings","convertedTypes","convertTypes","dataModelPath","contextPath","getInvolvedDataModelObjects","entitySet","ConverterContext","merge","metaModelCache","oRequestor","_MetadataRequestor","create","ODataMetaModel","_requestAnnotationChanges","fetchEntityContainer","getDataModelObjectPathForProperty","property","targetPath","startingEntitySet","navigationProperties","targetObject","targetEntitySet","targetEntityType","entityType","contextLocation","evaluateBinding","bindingString","bindingElement","BindingParser","complexParser","_len","args","_key","formatter","apply","evaluateBindingWithModel","modelContent","namedModelsContent","text","InvisibleText","bindProperty","defaultModel","JSONModel","setModel","setBindingContext","content","model","getText","TESTVIEWID","applyFlexChanges","flexChanges","resultXML","querySelectorAll","id","changes","createFlexibilityChangesObject","appId","oManifest","type","crossNavigation","outbounds","oAppComponent","getComponentData","getManifestObject","getEntry","getLocalId","sId","spyOn","AppStorage","Promise","Loader","Component","Utils","FlexState","initialize","componentId","XmlPreprocessor","process","changesApplied","getChangesFromXML","toBe","variantDependentControlChanges","flatMap","e","filter","attr","getTemplatingResult","xmlInput","createMockResourceModel","templatedXml","DOMParser","xmlDoc","parseFromString","oPreprocessorSettings","XMLPreprocessor","firstElementChild","getTemplatedXML","jsx","defineXMLNamespaceMap","templatedXML","serialiedXML","not","processView","oViewDocument","oPreprocessedView","asElement","asString","outerHTML","processFragment","testData","inputXml","inputDoc","jsonModel","setData","resultDoc","fragments","getElementsByTagName","fragment","innerHTML","xmlResult","children","serializeControl","controlToSerialize","showCustomStyleClasses","tabCount","CONTROLID","getTab","toAdd","tab","i","serializeDelegate","start","sAggregationName","controlDetail","getParent","indexInParent","getAggregation","indexOf","getMetadata","getName","end","middle","getId","ManagedObjectMetadata","isGeneratedId","oControlKey","mProperties","propertyValue","JSON","stringify","mBindingInfos","bindingDetail","oOutputFormat","binding","mAssociations","associationValue","associationValueElement","aCustomStyleClasses","mEventRegistry","startAggregation","sName","out","endAggregation","controlToRender","Serializer","serialize","serializeControlAsXML","definedNamespaces","getNamespaceAlias","className","namesSplit","split","namespace","namespaceAlias","nameFull","hasAggregation","mAggregationsKey","mAggregations","concat","uniqueKeys","Set","from","template","fFunction","outXML","createAwaiter","fnResolve","myPromise","promise","renderBuildingBlockWithModels","buildingBlock","ManagedObject","runWithPreprocessors","getContent","controlSettings","registerMockFragments","_len2","_key2","originalLoadTemplate","XMLTemplateProcessor","loadTemplatePromise","loadTemplateStub","mockImplementation","templateName","extension","parseXMLString","initializeAppComponent","viewLevel","cdsFile","__dirname","guid","uid","cdsContent","sap","registerFakeFragment","DefaultPageContent","_PageController","_inheritsLoose","_proto","prototype","render","_jsx","Page","PageController","ui","define","_AppComponent","AppComponent","metadata","manifest","dataSources","mainService","uri","odataVersion","dataSource","routing","targets","Default","mainContextPath","viewType","viewContent","pageContent","routes","pattern","target","mockAppComponent","initialized","v","getRouter","getTarget","load","templateComponent","object","findElement","collection","element","item","waitForEvent","eventName","attachEventOnce","event","keepBindingStringForTest","enabled","_keepBindingStrings"],"sourceRoot":".","sources":["JestTemplatingHelper.tsx"],"sourcesContent":["import type { AnyAnnotation, ConvertedMetadata, EntitySet, Property } from \"@sap-ux/vocabularies-types\";\nimport compiler from \"@sap/cds-compiler\";\nimport * as fs from \"fs\";\nimport type { Range, Ranges } from \"htmljs-parser\";\nimport { createParser } from \"htmljs-parser\";\nimport * as path from \"path\";\nimport Log from \"sap/base/Log\";\nimport LoaderExtensions from \"sap/base/util/LoaderExtensions\";\nimport merge from \"sap/base/util/merge\";\nimport uid from \"sap/base/util/uid\";\nimport jsx from \"sap/fe/base/jsx-runtime/jsx\";\nimport AppComponent from \"sap/fe/core/AppComponent\";\nimport PageController from \"sap/fe/core/PageController\";\nimport type TemplateComponent from \"sap/fe/core/TemplateComponent\";\nimport TemplateModel from \"sap/fe/core/TemplateModel\";\nimport { parseXMLString } from \"sap/fe/core/buildingBlocks/templating/BuildingBlockTemplateProcessor\";\nimport ConverterContext from \"sap/fe/core/converters/ConverterContext\";\nimport type { ListReportManifestSettings, ObjectPageManifestSettings } from \"sap/fe/core/converters/ManifestSettings\";\nimport { convertTypes, getInvolvedDataModelObjects } from \"sap/fe/core/converters/MetaModelConverter\";\nimport type { IDiagnostics, PageContextPathTarget } from \"sap/fe/core/converters/TemplateConverter\";\nimport type { IssueCategory, IssueSeverity } from \"sap/fe/core/converters/helpers/IssueManager\";\nimport type { SideEffectsService } from \"sap/fe/core/services/SideEffectsServiceFactory\";\nimport SideEffectsFactory from \"sap/fe/core/services/SideEffectsServiceFactory\";\nimport type { DataModelObjectPath } from \"sap/fe/core/templating/DataModelPathHelper\";\nimport { createMockResourceModel } from \"sap/fe/test/UI5MockHelper\";\nimport Page from \"sap/m/Page\";\nimport BindingParser from \"sap/ui/base/BindingParser\";\nimport type EventProvider from \"sap/ui/base/EventProvider\";\nimport type { BaseAggregationBindingInfo } from \"sap/ui/base/ManagedObject\";\nimport ManagedObject from \"sap/ui/base/ManagedObject\";\nimport ManagedObjectMetadata from \"sap/ui/base/ManagedObjectMetadata\";\nimport Component from \"sap/ui/core/Component\";\nimport type UI5Element from \"sap/ui/core/Element\";\nimport InvisibleText from \"sap/ui/core/InvisibleText\";\nimport XMLTemplateProcessor from \"sap/ui/core/XMLTemplateProcessor\";\nimport XMLPreprocessor from \"sap/ui/core/util/XMLPreprocessor\";\nimport Serializer from \"sap/ui/core/util/serializer/Serializer\";\nimport Utils from \"sap/ui/fl/Utils\";\nimport FlexState from \"sap/ui/fl/apply/_internal/flexState/FlexState\";\nimport Loader from \"sap/ui/fl/apply/_internal/flexState/Loader\";\nimport XmlPreprocessor from \"sap/ui/fl/apply/_internal/preprocessors/XmlPreprocessor\";\nimport AppStorage from \"sap/ui/fl/initial/_internal/Storage\";\nimport type Control from \"sap/ui/mdc/Control\";\nimport type Context from \"sap/ui/model/Context\";\nimport type MetaModel from \"sap/ui/model/MetaModel\";\nimport type Model from \"sap/ui/model/Model\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\nimport _MetadataRequestor from \"sap/ui/model/odata/v4/lib/_MetadataRequestor\";\nimport xpath from \"xpath\";\nimport type { ManagedObjectEx } from \"../../../../../../types/extension_types\";\nimport { createFlexibilityChangesObject } from \"./JestFlexibilityHelper\";\n\ntype PreProcessorSettingsType = {\n\tmodels: {\n\t\t[name: string]: JSONModel | ODataMetaModel;\n\t};\n\tbindingContexts: {\n\t\t[name: string]: Context | undefined;\n\t};\n};\ntype MockFragment = {\n\tname: string;\n\tcontent: string;\n};\n\ntype JestTemplatedView = {\n\tasElement: Element | undefined;\n\tasString: string;\n};\n\nLog.setLevel(1 as any, \"sap.ui.core.util.XMLPreprocessor\");\njest.setTimeout(40000);\n\nconst nameSpaceMap: Record<string, string> = {\n\tmacro: \"sap.fe.macros\",\n\tmacros: \"sap.fe.macros\",\n\tfeBB: \"sap.fe.core.buildingBlocks.templating\",\n\tmacroField: \"sap.fe.macros.field\",\n\tmacrodata: \"http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1\",\n\tlog: \"http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1\",\n\tcustomData: \"http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1\",\n\tcontrol: \"sap.fe.core.controls\",\n\tcontrols: \"sap.fe.macros.controls\",\n\tcore: \"sap.ui.core\",\n\tdt: \"sap.ui.dt\",\n\tm: \"sap.m\",\n\tf: \"sap.ui.layout.form\",\n\tfl: \"sap.ui.fl\",\n\tinternalMacro: \"sap.fe.macros.internal\",\n\tmdc: \"sap.ui.mdc\",\n\tactiontoolbar: \"sap.ui.mdc.actiontoolbar\",\n\tmdcField: \"sap.ui.mdc.field\",\n\tmdcTable: \"sap.ui.mdc.table\",\n\tu: \"sap.ui.unified\",\n\tuxap: \"sap.uxap\",\n\tmacroMicroChart: \"sap.fe.macros.microchart\",\n\tmicroChart: \"sap.suite.ui.microchart\",\n\tmacroTable: \"sap.fe.macros.table\",\n\tmdcvc: \"sap.ui.mdc.valuehelp.content\",\n\tmdcv: \"sap.ui.mdc.valuehelp\",\n\tvalueHelp: \"sap.fe.macros.valueHelp\",\n\tcontentSwitcher: \"sap.fe.macros.contentSwitcher\",\n\tfilterBar: \"sap.fe.macros.filterBar\",\n\tfbControls: \"sap.fe.macros.controls.filterbar\",\n\tdraftIndicator: \"sap.fe.macros.draftIndicator\"\n};\nconst reveseNamespaceMap = Object.keys(nameSpaceMap).reduce((reverseMap: Record<string, string>, currentName) => {\n\treverseMap[nameSpaceMap[currentName]] = currentName;\n\treturn reverseMap;\n}, {});\nconst select = xpath.useNamespaces(nameSpaceMap);\n\nconst defaultFakeSideEffectService = { computeFieldGroupIds: () => [] };\n\nfunction _getTemplatedSelector(xmldom: Node, selector: string): string {\n\t/**\n\t * if a root element has been added during the templating by our Jest Templating methods\n\t * the root element is added to the selector path.\n\t */\n\tconst rootPath = \"/root\";\n\treturn `${xmldom.nodeName === \"root\" && !selector.startsWith(rootPath) ? rootPath : \"\"}${selector}`;\n}\n\nasync function _buildPreProcessorSettings(\n\tsMetadataUrl: string | undefined,\n\tmBindingContexts: { [x: string]: string },\n\tmModels: { [x: string]: any },\n\tfakeSideEffectService?: unknown\n): Promise<PreProcessorSettingsType> {\n\tlet oMetaModel: ODataMetaModel | undefined;\n\tif (sMetadataUrl) {\n\t\toMetaModel = await getMetaModel(sMetadataUrl);\n\t\t// To ensure our macro can use #setBindingContext we ensure there is a pre existing JSONModel for converterContext\n\t\t// if not already passed to teh templating\n\t\tif (!mModels.hasOwnProperty(\"converterContext\")) {\n\t\t\tmModels = Object.assign(mModels, { converterContext: new TemplateModel({}, oMetaModel!) });\n\t\t}\n\n\t\tObject.keys(mModels).forEach(function (sModelName) {\n\t\t\tif (mModels[sModelName] && mModels[sModelName].isTemplateModel) {\n\t\t\t\tmModels[sModelName] = new TemplateModel(mModels[sModelName].data, oMetaModel!);\n\t\t\t}\n\t\t});\n\t}\n\n\tconst settings: any = {\n\t\tmodels: Object.assign(\n\t\t\t{\n\t\t\t\tmetaModel: oMetaModel\n\t\t\t},\n\t\t\tmModels\n\t\t),\n\t\tbindingContexts: {},\n\t\tappComponent: { getSideEffectsService: jest.fn(), getDiagnostics: () => undefined, getShellServices: jest.fn() }\n\t};\n\n\tsettings.appComponent.getSideEffectsService.mockReturnValue(fakeSideEffectService ?? defaultFakeSideEffectService);\n\t//Inject models and bindingContexts\n\tObject.keys(mBindingContexts).forEach(function (sKey) {\n\t\t/* Assert to make sure the annotations are in the test metadata -> avoid misleading tests */\n\t\texpect(typeof oMetaModel?.getObject(mBindingContexts[sKey])).toBeDefined();\n\t\tconst oModel = mModels[sKey] || oMetaModel;\n\t\tsettings.bindingContexts[sKey] = oModel.createBindingContext(mBindingContexts[sKey]); //Value is sPath\n\t\tsettings.models[sKey] = oModel;\n\t});\n\treturn settings;\n}\n\nfunction _loadResourceView(viewName: string): Element {\n\tconst name = viewName.replace(/\\./g, \"/\") + \".view.xml\";\n\tconst view = LoaderExtensions.loadResource(name);\n\treturn view.documentElement;\n}\n\nexport const runXPathQuery = function (selector: string, xmldom: Node | undefined) {\n\treturn select(selector, xmldom);\n};\n\nexpect.extend({\n\ttoHaveControl(xmldom, selector) {\n\t\tconst nodes = runXPathQuery(_getTemplatedSelector(xmldom, selector), xmldom);\n\t\treturn {\n\t\t\tmessage: () => {\n\t\t\t\tconst outputXml = serializeXML(xmldom);\n\t\t\t\treturn `did not find controls matching ${selector} in generated xml:\\n ${outputXml}`;\n\t\t\t},\n\t\t\tpass: nodes && nodes.length >= 1\n\t\t};\n\t},\n\ttoNotHaveControl(xmldom, selector) {\n\t\tconst nodes = runXPathQuery(_getTemplatedSelector(xmldom, selector), xmldom);\n\t\treturn {\n\t\t\tmessage: () => {\n\t\t\t\tconst outputXml = serializeXML(xmldom);\n\t\t\t\treturn `There is a control matching ${selector} in generated xml:\\n ${outputXml}`;\n\t\t\t},\n\t\t\tpass: nodes && nodes.length === 0\n\t\t};\n\t},\n\t/**\n\t * Checks for errors in `xml` created during templating of an XML string or\n\t * an XML node.\n\t *\n\t * This function checkes for the xml errors created by the\n\t * function [BuildingBlockTemplateProcessor.createErrorXML]{@link sap.fe.core.buildingBlocks.templating.BuildingBlockTemplateProcessor#createErrorXML}.\n\t * @param xml XML String or XML Node to be tested for errors\n\t * @returns Jest Matcher result object\n\t */\n\ttoHaveTemplatingErrors(xml: string | Node) {\n\t\tconst xmlText = typeof xml === \"string\" ? xml : serializeXML(xml);\n\t\tconst base64Entries: string[] = xmlText.match(/BBF\\.base64Decode\\('([^']*)'\\)/gm) || ([] as string[]);\n\t\tconst errorMessages: string[] = base64Entries.map((message: string) => {\n\t\t\tif (message && message.length > 0) {\n\t\t\t\treturn atob(message.match(/('[^']*)/)?.[0]?.slice(1) || \"\");\n\t\t\t}\n\t\t\treturn \"\";\n\t\t});\n\t\tif (errorMessages.length <= 0) {\n\t\t\treturn {\n\t\t\t\tmessage: () => `XML Templating without errors`,\n\t\t\t\tpass: false\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tmessage: () => errorMessages.join(\"\\n\"),\n\t\t\t\tpass: true\n\t\t\t};\n\t\t}\n\t}\n});\n\nexport const formatBuildingBlockXML = function (xmlString: string | string[]): string {\n\tif (Array.isArray(xmlString)) {\n\t\txmlString = xmlString.join(\"\");\n\t}\n\treturn formatXML(xmlString);\n};\n\nexport const getControlAttribute = function (controlSelector: string, attributeName: string, xmlDom: Node) {\n\tconst selector = `string(${_getTemplatedSelector(xmlDom, controlSelector)}/@${attributeName})`;\n\treturn runXPathQuery(selector, xmlDom);\n};\n\n/**\n * Serialize the parts or the complete given XML DOM to string.\n * @param xmlDom DOM node that is to be serialized.\n * @param selector Optional selector of sub nodes\n * @returns XML string\n */\nexport const serializeXML = function (xmlDom: Node, selector?: string) {\n\tconst serializer = new window.XMLSerializer();\n\tlet xmlString: string;\n\tif (selector) {\n\t\tconst nodes = runXPathQuery(selector, xmlDom) as Node[];\n\t\txmlString = nodes.map((node) => serializer.serializeToString(node)).join(\"\\n\");\n\t} else {\n\t\txmlString = serializer.serializeToString(xmlDom);\n\t}\n\treturn formatXML(xmlString);\n};\n\n/**\n * Formats a string containing an XML document.\n *\n * This function only considers XML tags and attributes, ignoring everything else (text, comments). Additionally,\n * attribute values containing a varying UID are replaced with a constant value.\n *\n * An \"XML\" string containing multiple root elements can be.\n * @param xmlString  The input XML string. This function also accepts \"XML\" strings with multiple root elements.\n * @returns The formatted XML string.\n */\nexport const formatXML = function (xmlString: string): string {\n\tconst START = \"<__XML__>\",\n\t\tEND = \"</__XML__>\",\n\t\tUID = /uid--id-\\d{13}-\\d{1,3}/,\n\t\tUID2 = /id-\\d{13}-\\d{1,3}/,\n\t\tlines: string[] = [];\n\n\tlet currentLine = \"\",\n\t\tlevel = -1,\n\t\tattributes: { name: string; value?: string }[] = [];\n\n\tfunction newline() {\n\t\tif (currentLine && currentLine !== START) {\n\t\t\tlines.push(currentLine);\n\t\t}\n\n\t\tcurrentLine = level > 0 ? \"  \".repeat(level) : \"\";\n\t}\n\n\tfunction appendAttributes() {\n\t\tif (attributes.length > 0) {\n\t\t\tattributes = attributes.sort((a, b) => {\n\t\t\t\tif (a.name.startsWith(\"xmlns\") && !b.name.startsWith(\"xmlns\")) {\n\t\t\t\t\treturn -1;\n\t\t\t\t} else if (!a.name.startsWith(\"xmlns\") && b.name.startsWith(\"xmlns\")) {\n\t\t\t\t\treturn 1;\n\t\t\t\t} else if (a.name.startsWith(\"xmlns\") && b.name.startsWith(\"xmlns\")) {\n\t\t\t\t\treturn a.name.localeCompare(b.name);\n\t\t\t\t} else if (a.name.includes(\":\") && !b.name.includes(\":\")) {\n\t\t\t\t\treturn -1;\n\t\t\t\t} else if (!a.name.includes(\":\") && b.name.includes(\":\")) {\n\t\t\t\t\treturn 1;\n\t\t\t\t} else {\n\t\t\t\t\treturn a.name.localeCompare(b.name);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlevel++;\n\t\t\tfor (const attribute of attributes) {\n\t\t\t\tnewline();\n\t\t\t\tcurrentLine += attribute.name;\n\t\t\t\tif (attribute.value) currentLine += attribute.value;\n\t\t\t}\n\t\t\tlevel--;\n\t\t\tattributes = [];\n\t\t\tnewline();\n\t\t}\n\t}\n\n\tfunction append(data: Range) {\n\t\tcurrentLine += parser.read(data);\n\t}\n\n\tconst parser = createParser({\n\t\tonOpenTagStart(data: Range) {\n\t\t\tnewline();\n\t\t\tappend(data);\n\t\t},\n\n\t\tonOpenTagName: append,\n\n\t\tonAttrName(data: Range) {\n\t\t\tattributes.unshift({ name: parser.read(data) });\n\t\t},\n\n\t\tonAttrValue(data: Ranges.AttrValue) {\n\t\t\tattributes[0].value = parser.read(data).replace(UID, \"uid--id\"); // replace varying UIDs with a constant value\n\t\t\tattributes[0].value = parser.read(data).replace(UID2, \"id\"); // replace varying UIDs with a constant value\n\t\t},\n\n\t\tonOpenTagEnd(data: Ranges.OpenTagEnd) {\n\t\t\tappendAttributes();\n\t\t\tappend(data);\n\t\t\tif (!data.selfClosed) level++;\n\t\t},\n\n\t\tonCloseTagStart(data: Range) {\n\t\t\tlevel--;\n\t\t\tnewline();\n\t\t\tappend(data);\n\t\t},\n\n\t\tonCloseTagName: append,\n\t\tonCloseTagEnd: append\n\t});\n\n\tparser.parse(START + xmlString + END);\n\treturn lines.join(\"\\n\").trim();\n};\n\n/**\n * Compile a CDS file into an EDMX file.\n * @param cdsUrl The path to the file containing the CDS definition. This file must declare the namespace\n * sap.fe.test and a service JestService\n * @param options Options for creating the EDMX output\n * @returns The path of the generated EDMX\n */\nexport const compileCDS = function (cdsUrl: string, options: compiler.ODataOptions = {}) {\n\tconst cdsString = fs.readFileSync(cdsUrl, \"utf-8\");\n\tconst edmxContent = cds2edmx(cdsString, \"sap.fe.test.JestService\", options);\n\tconst dir = path.resolve(cdsUrl, \"..\", \"gen\");\n\n\t// If the caller provided CDS compiler options: Include them in the filename. This prevents unpredictable results if the same CDS source\n\t// file is used simultaneously with a different set of options (e.g. in a test running in parallel)\n\tconst allOptions = Object.entries(options);\n\tallOptions.sort((a, b) => b[0].localeCompare(a[0]));\n\n\tconst edmxFileName =\n\t\tallOptions.reduce(\n\t\t\t(filename, [optionKey, optionValue]) => `${filename}#${optionKey}=${optionValue.toString()}#`,\n\t\t\tpath.basename(cdsUrl).replace(\".cds\", \"\")\n\t\t) + \".xml\";\n\n\tconst edmxFilePath = path.resolve(dir, edmxFileName);\n\n\tfs.mkdirSync(dir, { recursive: true });\n\n\tfs.writeFileSync(edmxFilePath, edmxContent);\n\treturn edmxFilePath;\n};\n\n/**\n * Compile CDS to EDMX.\n * @param cds The CDS model. It must define at least one service.\n * @param service The fully-qualified name of the service to be compiled. Defaults to \"sap.fe.test.JestService\".\n * @param options Options for creating the EDMX output\n * @returns The compiled service model as EDMX.\n */\nexport function cds2edmx(cds: string, service = \"sap.fe.test.JestService\", options: compiler.ODataOptions = {}) {\n\tconst sources: Record<string, string> = { \"source.cds\": cds };\n\n\t// allow to include stuff from @sap/cds/common\n\tif (cds.includes(\"'@sap/cds/common'\")) {\n\t\tsources[\"common.cds\"] = fs.readFileSync(require.resolve(\"@sap/cds/common.cds\"), \"utf-8\");\n\t}\n\n\tconst csn = compiler.compileSources(sources, {});\n\n\tconst edmxOptions: compiler.ODataOptions = {\n\t\todataForeignKeys: true,\n\t\todataFormat: \"structured\",\n\t\todataContainment: true,\n\t\t...options,\n\t\tservice: service\n\t};\n\n\tconst edmx = compiler.to.edmx(csn, edmxOptions);\n\tif (!edmx) {\n\t\tthrow new Error(`Compilation failed. Hint: Make sure that the CDS model defines service ${service}.`);\n\t}\n\treturn edmx;\n}\n\nexport const getFakeSideEffectsService = async function (\n\tmetaModel: ODataMetaModel,\n\tclassNameODataModel = \"sap.ui.model.odata.v4.ODataModel\"\n): Promise<SideEffectsService> {\n\tconst scopeObject = {\n\t\tgetModel: () => {\n\t\t\treturn {\n\t\t\t\tisA: () => classNameODataModel === \"sap.ui.model.odata.v4.ODataModel\",\n\t\t\t\tgetMetaModel: () => {\n\t\t\t\t\treturn metaModel;\n\t\t\t\t},\n\t\t\t\tgetServiceUrl: () => undefined\n\t\t\t};\n\t\t},\n\t\tgetService: () => {\n\t\t\treturn {\n\t\t\t\tgetCapabilities: () => undefined\n\t\t\t};\n\t\t}\n\t};\n\tconst serviceInstance = await new SideEffectsFactory().createInstance({ scopeObject, scopeType: \"\", settings: {} });\n\treturn serviceInstance.getInterface();\n};\n\nexport const getFakeDiagnostics = function (): IDiagnostics {\n\tconst issues: any[] = [];\n\treturn {\n\t\taddIssue(issueCategory: IssueCategory, issueSeverity: IssueSeverity, details: string): void {\n\t\t\tissues.push({\n\t\t\t\tissueCategory,\n\t\t\t\tissueSeverity,\n\t\t\t\tdetails\n\t\t\t});\n\t\t},\n\t\tgetIssues(): any[] {\n\t\t\treturn issues;\n\t\t},\n\t\tcheckIfIssueExists(issueCategory: IssueCategory, issueSeverity: IssueSeverity, details: string): boolean {\n\t\t\treturn issues.find((issue) => {\n\t\t\t\treturn issue.issueCategory === issueCategory && issue.issueSeverity === issueSeverity && issue.details === details;\n\t\t\t});\n\t\t}\n\t};\n};\n\nexport const getConverterContextForTest = function (\n\tmetaModel: ODataMetaModel,\n\tmanifestSettings: ListReportManifestSettings | ObjectPageManifestSettings\n) {\n\tconst convertedTypes = convertTypes(metaModel);\n\tconst dataModelPath = manifestSettings.contextPath\n\t\t? getInvolvedDataModelObjects<PageContextPathTarget>(metaModel.createBindingContext(manifestSettings.contextPath) as Context)\n\t\t: getInvolvedDataModelObjects<PageContextPathTarget>(metaModel.createBindingContext(`/${manifestSettings.entitySet}`));\n\treturn new ConverterContext<PageContextPathTarget>(convertedTypes, manifestSettings, getFakeDiagnostics(), merge, dataModelPath);\n};\nconst metaModelCache: any = {};\nexport const getMetaModel = async function (sMetadataUrl: string) {\n\tconst oRequestor = _MetadataRequestor.create({}, \"4.0\", undefined, {}, {}, function () {\n\t\treturn null;\n\t});\n\tif (!metaModelCache[sMetadataUrl]) {\n\t\tconst oMetaModel = new (ODataMetaModel as any)(oRequestor, sMetadataUrl, undefined, { _requestAnnotationChanges: () => [] });\n\t\tawait oMetaModel.fetchEntityContainer();\n\t\tmetaModelCache[sMetadataUrl] = oMetaModel;\n\t}\n\n\treturn metaModelCache[sMetadataUrl];\n};\n\nexport const getDataModelObjectPathForProperty = function <T = Property | EntitySet | AnyAnnotation>(\n\tentitySet: EntitySet,\n\tconvertedTypes: ConvertedMetadata,\n\tproperty?: T\n): DataModelObjectPath<T> {\n\tconst targetPath: DataModelObjectPath<T> = {\n\t\tstartingEntitySet: entitySet,\n\t\tnavigationProperties: [],\n\t\ttargetObject: property,\n\t\ttargetEntitySet: entitySet,\n\t\ttargetEntityType: entitySet.entityType,\n\t\tconvertedTypes: convertedTypes\n\t};\n\ttargetPath.contextLocation = targetPath as DataModelObjectPath<EntitySet>;\n\treturn targetPath;\n};\n\nexport const evaluateBinding = function (bindingString: string, ...args: any[]) {\n\tconst bindingElement = BindingParser.complexParser(bindingString);\n\treturn bindingElement.formatter.apply(undefined, args);\n};\n\ntype ModelContent = {\n\t[name: string]: any;\n};\n\n/**\n * Evaluate a binding against a model.\n * @param bindingString The binding string.\n * @param modelContent Content of the default model to use for evaluation.\n * @param namedModelsContent Contents of additional, named models to use.\n * @returns The evaluated binding.\n */\nexport function evaluateBindingWithModel(\n\tbindingString: string | undefined,\n\tmodelContent: ModelContent,\n\tnamedModelsContent?: { [modelName: string]: ModelContent }\n): string {\n\tconst bindingElement = BindingParser.complexParser(bindingString);\n\tconst text = new InvisibleText();\n\ttext.bindProperty(\"text\", bindingElement);\n\n\tconst defaultModel = new JSONModel(modelContent);\n\ttext.setModel(defaultModel);\n\ttext.setBindingContext(defaultModel.createBindingContext(\"/\"));\n\n\tif (namedModelsContent) {\n\t\tfor (const [name, content] of Object.entries(namedModelsContent)) {\n\t\t\tconst model = new JSONModel(content);\n\t\t\ttext.setModel(model, name);\n\t\t\ttext.setBindingContext(model.createBindingContext(\"/\"), name);\n\t\t}\n\t}\n\n\treturn text.getText();\n}\n\nconst TESTVIEWID = \"testViewId\";\n\nconst applyFlexChanges = async function (flexChanges: { [x: string]: object[] }, oMetaModel: MetaModel, resultXML: any) {\n\t// prefix Ids\n\t[...resultXML.querySelectorAll(\"[id]\")].forEach((node) => {\n\t\tnode.id = `${TESTVIEWID}--${node.id}`;\n\t});\n\tconst changes = createFlexibilityChangesObject(TESTVIEWID, flexChanges);\n\tconst appId = \"someComponent\";\n\tconst oManifest = {\n\t\t\"sap.app\": {\n\t\t\tid: appId,\n\t\t\ttype: \"application\",\n\t\t\tcrossNavigation: {\n\t\t\t\toutbounds: []\n\t\t\t}\n\t\t}\n\t};\n\tconst oAppComponent: AppComponent = {\n\t\tgetDiagnostics: jest.fn().mockReturnValue(getFakeDiagnostics()),\n\t\tgetModel: jest.fn().mockReturnValue({\n\t\t\tgetMetaModel: jest.fn().mockReturnValue(oMetaModel)\n\t\t}),\n\t\tgetComponentData: jest.fn().mockReturnValue({}),\n\t\tgetManifestObject: jest.fn().mockReturnValue({\n\t\t\tgetEntry: function (name: string) {\n\t\t\t\treturn (oManifest as any)[name];\n\t\t\t}\n\t\t}),\n\t\tgetLocalId: jest.fn((sId) => sId)\n\t} as unknown as AppComponent;\n\t//fake changes\n\tjest.spyOn(AppStorage, \"loadFlexData\").mockReturnValue(Promise.resolve(changes));\n\tjest.spyOn(Loader, \"loadFlexData\").mockReturnValue(Promise.resolve(changes));\n\n\tjest.spyOn(Component as unknown as { getComponentById: () => AppComponent }, \"getComponentById\").mockReturnValue(oAppComponent);\n\tjest.spyOn(Utils, \"getAppComponentForControl\").mockReturnValue(oAppComponent);\n\tawait FlexState.initialize({\n\t\tcomponentId: appId\n\t});\n\tresultXML = await XmlPreprocessor.process(resultXML, { name: \"Test Fragment\", componentId: appId, id: TESTVIEWID });\n\n\t//Assert that all changes have been applied\n\tconst changesApplied = getChangesFromXML(resultXML);\n\texpect(changesApplied.length).toBe(flexChanges?.changes?.length ?? 0 + flexChanges?.variantDependentControlChanges?.length ?? 0);\n\treturn resultXML;\n};\n\nexport const getChangesFromXML = (xml: any) =>\n\t[...xml.querySelectorAll(\"*\")]\n\t\t.flatMap((e) => [...e.attributes].map((a) => a.name))\n\t\t.filter((attr) => attr.includes(\"sap.ui.fl.appliedChanges\"));\n\nexport const getTemplatingResult = async function (\n\txmlInput: string,\n\tsMetadataUrl: string | undefined,\n\tmBindingContexts: { [x: string]: any; entitySet?: string },\n\tmModels: { [x: string]: any },\n\tflexChanges?: { [x: string]: object[] },\n\tfakeSideEffectService?: unknown\n) {\n\tif (!mModels[\"sap.fe.i18n\"]) {\n\t\tmModels[\"sap.fe.i18n\"] = createMockResourceModel();\n\t}\n\n\tconst templatedXml = `<root>${xmlInput}</root>`;\n\tconst parser = new window.DOMParser();\n\tconst xmlDoc = parser.parseFromString(templatedXml, \"text/xml\");\n\t// To ensure our macro can use #setBindingContext we ensure there is a pre existing JSONModel for converterContext\n\t// if not already passed to teh templating\n\n\tconst oPreprocessorSettings = await _buildPreProcessorSettings(sMetadataUrl, mBindingContexts, mModels, fakeSideEffectService);\n\n\t//This context for macro testing\n\tif (oPreprocessorSettings.models[\"this\"]) {\n\t\toPreprocessorSettings.bindingContexts[\"this\"] = oPreprocessorSettings.models[\"this\"].createBindingContext(\"/\");\n\t}\n\n\tlet resultXML = (await XMLPreprocessor.process(xmlDoc.firstElementChild!, { name: \"Test Fragment\" }, oPreprocessorSettings)) as any;\n\n\tif (sMetadataUrl && flexChanges) {\n\t\t// apply flex changes\n\t\tconst oMetaModel = await getMetaModel(sMetadataUrl);\n\t\tresultXML = await applyFlexChanges(flexChanges, oMetaModel, resultXML);\n\t}\n\treturn resultXML;\n};\n\nexport const getTemplatedXML = async function (\n\txmlInput: string,\n\tsMetadataUrl: string | undefined,\n\tmBindingContexts: { [x: string]: string },\n\tmModels: { [x: string]: any },\n\tflexChanges?: { [x: string]: object[] },\n\tfakeSideEffectService?: unknown\n): Promise<string> {\n\treturn jsx.defineXMLNamespaceMap(reveseNamespaceMap, async () => {\n\t\tconst templatedXML = await getTemplatingResult(\n\t\t\txmlInput,\n\t\t\tsMetadataUrl,\n\t\t\tmBindingContexts,\n\t\t\tmModels,\n\t\t\tflexChanges,\n\t\t\tfakeSideEffectService\n\t\t);\n\t\tconst serialiedXML = serializeXML(templatedXML, undefined);\n\t\texpect(serialiedXML).not.toHaveTemplatingErrors();\n\t\treturn serialiedXML;\n\t}) as unknown as Promise<string>;\n};\n\n/**\n * Process the requested view with the provided data.\n * @param name Fully qualified name of the view to be tested.\n * @param sMetadataUrl Url of the metadata.\n * @param mBindingContexts Map of the bindingContexts to set on the models.\n * @param mModels Map of the models.\n * @param flexChanges Object with UI changes like 'changes' or 'variantDependentControlChanges'\n * @returns Templated view as string\n */\nexport async function processView(\n\tname: string,\n\tsMetadataUrl: string,\n\tmBindingContexts: { [x: string]: string },\n\tmModels: { [x: string]: any },\n\tflexChanges?: { [x: string]: object[] }\n): Promise<JestTemplatedView> {\n\tconst oMetaModel = await getMetaModel(sMetadataUrl);\n\tconst oViewDocument = _loadResourceView(name);\n\tconst oPreprocessorSettings = await _buildPreProcessorSettings(sMetadataUrl, mBindingContexts, mModels);\n\tlet oPreprocessedView = await XMLPreprocessor.process(oViewDocument, { name: name }, oPreprocessorSettings);\n\tif (flexChanges) {\n\t\toPreprocessedView = await applyFlexChanges(flexChanges ?? [], oMetaModel, oPreprocessedView);\n\t}\n\treturn {\n\t\tasElement: oPreprocessedView,\n\t\tasString: formatXML(oPreprocessedView?.outerHTML || \"\")\n\t};\n}\n\n/**\n * Process the requested XML fragment with the provided data.\n * @param name Fully qualified name of the fragment to be tested.\n * @param testData Test data consisting\n * @returns Templated fragment as string\n */\nexport async function processFragment(name: string, testData: { [model: string]: object }): Promise<string> {\n\tconst inputXml = `<root><core:Fragment fragmentName=\"${name}\" type=\"XML\" xmlns:core=\"sap.ui.core\" /></root>`;\n\tconst parser = new window.DOMParser();\n\n\tconst inputDoc = parser.parseFromString(inputXml, \"text/xml\");\n\n\t// build model and bindings for given test data\n\tconst settings = {\n\t\tmodels: {} as { [name: string]: JSONModel },\n\t\tbindingContexts: {} as { [name: string]: object },\n\t\tappComponent: { getSideEffectsService: jest.fn(), getDiagnostics: () => undefined }\n\t};\n\tfor (const model in testData) {\n\t\tconst jsonModel = new JSONModel();\n\t\tjsonModel.setData(testData[model]);\n\t\tsettings.models[model] = jsonModel;\n\t\tsettings.bindingContexts[model] = settings.models[model].createBindingContext(\"/\");\n\t}\n\tsettings.appComponent.getSideEffectsService.mockReturnValue(defaultFakeSideEffectService);\n\n\t// execute the pre-processor\n\tconst resultDoc = await XMLPreprocessor.process(inputDoc.firstElementChild, { name }, settings);\n\n\t// exclude nested fragments from test snapshots\n\tconst fragments = resultDoc.getElementsByTagName(\"core:Fragment\") as any;\n\tif (fragments?.length > 0) {\n\t\tfor (const fragment of fragments) {\n\t\t\tfragment.innerHTML = \"\";\n\t\t}\n\t}\n\n\t// Keep the fragment result as child of root node when fragment generates multiple root controls\n\tconst xmlResult = resultDoc.children.length > 1 ? resultDoc.outerHTML : resultDoc.innerHTML;\n\n\treturn formatXML(xmlResult);\n}\n\nexport function serializeControl(controlToSerialize?: UI5Element | UI5Element[], showCustomStyleClasses = false) {\n\tlet tabCount = 0;\n\tconst UID = /uid--id-\\d{13}-\\d{1,3}/;\n\tconst CONTROLID = /id-\\d{13}-\\d{1,3}/;\n\tfunction getTab(toAdd = 0) {\n\t\tlet tab = \"\";\n\t\tfor (let i = 0; i < tabCount + toAdd; i++) {\n\t\t\ttab += \"\\t\";\n\t\t}\n\t\treturn tab;\n\t}\n\tconst serializeDelegate = {\n\t\tstart: function (control: any, sAggregationName: string) {\n\t\t\tlet controlDetail = \"\";\n\t\t\tif (sAggregationName) {\n\t\t\t\tif (control.getParent()) {\n\t\t\t\t\tconst indexInParent = (control.getParent().getAggregation(sAggregationName) as ManagedObject[])?.indexOf?.(control);\n\t\t\t\t\tif (indexInParent > 0) {\n\t\t\t\t\t\tcontrolDetail += `,\\n${getTab()}`;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcontrolDetail += `${control.getMetadata().getName()}(`;\n\t\t\treturn controlDetail;\n\t\t},\n\t\tend: function () {\n\t\t\treturn \"})\";\n\t\t},\n\t\tmiddle: function (control: any) {\n\t\t\tlet id = control.getId();\n\t\t\tid = typeof id === \"string\" ? id?.replace?.(CONTROLID, \"id\") : id;\n\t\t\tlet data = `{id: ${ManagedObjectMetadata.isGeneratedId(id) ? \"__dynamicId\" : id}`;\n\t\t\tfor (const oControlKey in control.mProperties) {\n\t\t\t\tif (control.mProperties.hasOwnProperty(oControlKey)) {\n\t\t\t\t\tlet propertyValue = control.mProperties[oControlKey];\n\t\t\t\t\tpropertyValue = typeof propertyValue === \"string\" ? propertyValue?.replace?.(UID, \"uid--id\") : propertyValue;\n\t\t\t\t\tpropertyValue = typeof propertyValue === \"string\" ? propertyValue?.replace?.(CONTROLID, \"id\") : propertyValue;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tpropertyValue = typeof propertyValue === \"object\" ? JSON.stringify(propertyValue) : propertyValue;\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// Stringify may fail for circular references but it's not the end of the world\n\t\t\t\t\t}\n\n\t\t\t\t\tdata += `,\\n${getTab()} ${oControlKey}: ${propertyValue}`;\n\t\t\t\t} else if (control.mBindingInfos.hasOwnProperty(oControlKey)) {\n\t\t\t\t\tconst bindingDetail = { ...control.mBindingInfos[oControlKey] };\n\t\t\t\t\tif (bindingDetail.type?.oOutputFormat) {\n\t\t\t\t\t\tdelete bindingDetail.type.oOutputFormat;\n\t\t\t\t\t}\n\t\t\t\t\tif (bindingDetail.binding) {\n\t\t\t\t\t\tdelete bindingDetail.binding;\n\t\t\t\t\t}\n\t\t\t\t\tdata += `,\\n${getTab()} ${oControlKey}: ${JSON.stringify(bindingDetail)}`;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (const oControlKey in control.mAssociations) {\n\t\t\t\tif (control.mAssociations.hasOwnProperty(oControlKey)) {\n\t\t\t\t\tlet associationValue = control.mAssociations[oControlKey];\n\t\t\t\t\tif (!Array.isArray(associationValue)) {\n\t\t\t\t\t\tassociationValue = [associationValue];\n\t\t\t\t\t}\n\t\t\t\t\tassociationValue = associationValue.map((associationValueElement: string) => {\n\t\t\t\t\t\treturn typeof associationValueElement === \"string\"\n\t\t\t\t\t\t\t? associationValueElement?.replace?.(CONTROLID, \"id\")\n\t\t\t\t\t\t\t: associationValueElement;\n\t\t\t\t\t});\n\n\t\t\t\t\tdata += `,\\n${getTab()} ${oControlKey}: ${(associationValue?.join?.(\",\") ?? associationValue) || undefined}`;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (showCustomStyleClasses && control.aCustomStyleClasses?.length > 0) {\n\t\t\t\tdata += `,\\n${getTab()} customStyleClasses : ${control.aCustomStyleClasses.join(\", \")}`;\n\t\t\t}\n\t\t\tfor (const oControlKey in control.mEventRegistry) {\n\t\t\t\tif (control.mEventRegistry.hasOwnProperty(oControlKey)) {\n\t\t\t\t\tdata += `,\\n${getTab()} ${oControlKey}: true`;\n\t\t\t\t}\n\t\t\t}\n\t\t\tdata += ``;\n\t\t\treturn data;\n\t\t},\n\t\tstartAggregation: function (control: { mBindingInfos: Record<string, BaseAggregationBindingInfo> }, sName: string) {\n\t\t\tlet out = `,\\n${getTab()}${sName}`;\n\t\t\ttabCount++;\n\n\t\t\tif (control.mBindingInfos[sName]) {\n\t\t\t\tout += `={ path:'${control.mBindingInfos[sName].path}', template:\\n${getTab()}`;\n\t\t\t} else {\n\t\t\t\tout += `=[\\n${getTab()}`;\n\t\t\t}\n\t\t\treturn out;\n\t\t},\n\t\tendAggregation: function (control: any, sName: string) {\n\t\t\ttabCount--;\n\t\t\tif (control.mBindingInfos[sName]) {\n\t\t\t\treturn `\\n${getTab()}}`;\n\t\t\t} else {\n\t\t\t\treturn `\\n${getTab()}]`;\n\t\t\t}\n\t\t}\n\t};\n\tif (Array.isArray(controlToSerialize)) {\n\t\treturn controlToSerialize.map((controlToRender: UI5Element) => {\n\t\t\treturn new Serializer(controlToRender, serializeDelegate).serialize();\n\t\t});\n\t} else {\n\t\treturn new Serializer(controlToSerialize, serializeDelegate).serialize();\n\t}\n}\n\nexport function serializeControlAsXML(controlToSerialize?: UI5Element | UI5Element[], showCustomStyleClasses = false) {\n\tlet tabCount = 0;\n\tconst UID = /uid--id-\\d{13}-\\d{1,3}/;\n\tconst CONTROLID = /id-\\d{13}-\\d{1,3}/;\n\tconst definedNamespaces: Record<string, boolean> = {};\n\n\tfunction getNamespaceAlias(className: string): string {\n\t\tconst namesSplit = className.split(\".\");\n\t\tconst namespace = namesSplit.slice(0, -1);\n\t\tconst name = namesSplit[namesSplit.length - 1];\n\t\tlet namespaceAlias = namespace[namespace.length - 1];\n\t\tif (reveseNamespaceMap[namespace.join(\".\")]) {\n\t\t\tnamespaceAlias = reveseNamespaceMap[namespace.join(\".\")];\n\t\t}\n\t\tif (namespaceAlias === undefined) {\n\t\t\tnamespaceAlias = \"test\";\n\t\t}\n\t\treturn namespaceAlias;\n\t}\n\n\tfunction getTab(toAdd = 0) {\n\t\tlet tab = \"\";\n\t\tfor (let i = 0; i < tabCount + toAdd; i++) {\n\t\t\ttab += \"\\t\";\n\t\t}\n\t\treturn tab;\n\t}\n\tconst serializeDelegate = {\n\t\tstart: function (control: any, sAggregationName: string) {\n\t\t\tlet controlDetail = \"\";\n\t\t\tif (sAggregationName) {\n\t\t\t\tif (control.getParent()) {\n\t\t\t\t\tconst indexInParent = (control.getParent().getAggregation(sAggregationName) as ManagedObject[])?.indexOf?.(control);\n\t\t\t\t\tif (indexInParent > 0) {\n\t\t\t\t\t\tcontrolDetail += `\\n${getTab()}`;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst nameFull = control.getMetadata().getName();\n\t\t\tconst namesSplit = nameFull.split(\".\");\n\t\t\tconst name = namesSplit[namesSplit.length - 1];\n\t\t\tconst namespaceAlias = getNamespaceAlias(nameFull);\n\t\t\tcontrolDetail += `<${namespaceAlias}:${name}\\n`;\n\t\t\tif (!definedNamespaces[namespaceAlias]) {\n\t\t\t\tdefinedNamespaces[namespaceAlias] = true;\n\t\t\t\tcontrolDetail += `${getTab()}xmlns:${namespaceAlias}=\"${nameSpaceMap[namespaceAlias]}\"`;\n\t\t\t}\n\t\t\treturn controlDetail;\n\t\t},\n\t\tend: function (control: any) {\n\t\t\tconst nameFull = control.getMetadata().getName();\n\t\t\tconst namesSplit = nameFull.split(\".\");\n\t\t\tconst name = namesSplit[namesSplit.length - 1];\n\t\t\tconst namespaceAlias = getNamespaceAlias(nameFull);\n\t\t\tlet hasAggregation = false;\n\t\t\tfor (const mAggregationsKey in control.mAggregations) {\n\t\t\t\tif (\n\t\t\t\t\t(!Array.isArray(control.mAggregations[mAggregationsKey]) &&\n\t\t\t\t\t\tcontrol.mAggregations[mAggregationsKey] !== null &&\n\t\t\t\t\t\tcontrol.mAggregations[mAggregationsKey] !== undefined) ||\n\t\t\t\t\t(Array.isArray(control.mAggregations[mAggregationsKey]) && control.mAggregations[mAggregationsKey].length > 0)\n\t\t\t\t) {\n\t\t\t\t\thasAggregation = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (hasAggregation) {\n\t\t\t\treturn `</${namespaceAlias}:${name}>`;\n\t\t\t} else {\n\t\t\t\treturn `/>`;\n\t\t\t}\n\t\t},\n\t\tmiddle: function (control: any) {\n\t\t\tlet id = control.getId();\n\t\t\tid = typeof id === \"string\" ? id?.replace?.(CONTROLID, \"id\") : id;\n\t\t\tlet data = \"\";\n\t\t\tif (!ManagedObjectMetadata.isGeneratedId(id)) {\n\t\t\t\tdata = `id=\"${id}\"`;\n\t\t\t}\n\t\t\tlet keys = Object.keys(control.mProperties)\n\t\t\t\t.concat(Object.keys(control.mBindingInfos))\n\t\t\t\t.concat(Object.keys(control.mAssociations))\n\t\t\t\t.concat(Object.keys(control.mEventRegistry));\n\t\t\tkeys = keys.sort((a, b) => a.localeCompare(b));\n\t\t\tconst uniqueKeys = new Set(keys);\n\t\t\tkeys = Array.from(uniqueKeys);\n\t\t\tfor (const oControlKey of keys) {\n\t\t\t\tif (control.mBindingInfos.hasOwnProperty(oControlKey)) {\n\t\t\t\t\tconst bindingDetail = { ...control.mBindingInfos[oControlKey] };\n\t\t\t\t\tif (bindingDetail.bindingString) {\n\t\t\t\t\t\tdata += `\\n${getTab()}${oControlKey}=\"${bindingDetail.bindingString.replace(\">\", \"&gt;\")}\"`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (bindingDetail.type?.oOutputFormat) {\n\t\t\t\t\t\t\tdelete bindingDetail.type.oOutputFormat;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (bindingDetail.binding) {\n\t\t\t\t\t\t\tdelete bindingDetail.binding;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (bindingDetail.template) {\n\t\t\t\t\t\t\tdelete bindingDetail.template;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdata += `\\n${getTab()}${oControlKey}='${JSON.stringify(bindingDetail)}'`;\n\t\t\t\t\t}\n\t\t\t\t} else if (control.mProperties.hasOwnProperty(oControlKey) && control.mProperties[oControlKey] !== undefined) {\n\t\t\t\t\tlet propertyValue = control.mProperties[oControlKey];\n\t\t\t\t\tpropertyValue = typeof propertyValue === \"string\" ? propertyValue?.replace?.(UID, \"uid--id\") : propertyValue;\n\t\t\t\t\tpropertyValue = typeof propertyValue === \"string\" ? propertyValue?.replace?.(CONTROLID, \"id\") : propertyValue;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tpropertyValue = typeof propertyValue === \"object\" ? JSON.stringify(propertyValue) : propertyValue;\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// Stringify may fail for circular references but it's not the end of the world\n\t\t\t\t\t}\n\n\t\t\t\t\tdata += `\\n${getTab()} ${oControlKey}=\"${propertyValue}\"`;\n\t\t\t\t} else if (control.mAssociations.hasOwnProperty(oControlKey)) {\n\t\t\t\t\tlet associationValue = control.mAssociations[oControlKey];\n\t\t\t\t\tif (!Array.isArray(associationValue)) {\n\t\t\t\t\t\tassociationValue = [associationValue];\n\t\t\t\t\t}\n\t\t\t\t\tassociationValue = associationValue.map((associationValueElement: string) => {\n\t\t\t\t\t\treturn typeof associationValueElement === \"string\"\n\t\t\t\t\t\t\t? associationValueElement?.replace?.(CONTROLID, \"id\")\n\t\t\t\t\t\t\t: associationValueElement;\n\t\t\t\t\t});\n\n\t\t\t\t\tdata += `\\n${getTab()} ${oControlKey}=\"${(associationValue?.join?.(\",\") ?? associationValue) || undefined}\"`;\n\t\t\t\t} else if (control.mEventRegistry.hasOwnProperty(oControlKey)) {\n\t\t\t\t\tif (control.mEventRegistry[oControlKey][0]?.fFunction?.name) {\n\t\t\t\t\t\tdata += `\\n${getTab()} ${oControlKey}=\"${control.mEventRegistry[oControlKey][0]?.fFunction?.name}\"`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdata += `\\n${getTab()} ${oControlKey}=\"someEventHandler\"`;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (showCustomStyleClasses && control.aCustomStyleClasses?.length > 0) {\n\t\t\t\tdata += `\\n${getTab()} customStyleClasses : ${control.aCustomStyleClasses.join(\", \")}`;\n\t\t\t}\n\t\t\tdata += `\\n`;\n\t\t\tlet hasAggregation = false;\n\t\t\tfor (const mAggregationsKey in control.mAggregations) {\n\t\t\t\tif (\n\t\t\t\t\t(!Array.isArray(control.mAggregations[mAggregationsKey]) &&\n\t\t\t\t\t\tcontrol.mAggregations[mAggregationsKey] !== null &&\n\t\t\t\t\t\tcontrol.mAggregations[mAggregationsKey] !== undefined) ||\n\t\t\t\t\t(Array.isArray(control.mAggregations[mAggregationsKey]) && control.mAggregations[mAggregationsKey].length > 0)\n\t\t\t\t) {\n\t\t\t\t\thasAggregation = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (hasAggregation) {\n\t\t\t\tdata += \">\";\n\t\t\t}\n\t\t\treturn data;\n\t\t},\n\t\tstartAggregation: function (control: any, sName: string) {\n\t\t\tconst namespaceAlias = getNamespaceAlias(control.getMetadata().getName());\n\t\t\tlet out = `\\n${getTab()}<${namespaceAlias}:${sName}>`;\n\t\t\ttabCount++;\n\t\t\tout += `\\n${getTab()}`;\n\t\t\treturn out;\n\t\t},\n\t\tendAggregation: function (control: any, sName: string) {\n\t\t\ttabCount--;\n\t\t\tconst namespaceAlias = getNamespaceAlias(control.getMetadata().getName());\n\t\t\tif (control.mBindingInfos[sName]) {\n\t\t\t\treturn `\\n${getTab()}</${namespaceAlias}:${sName}>\\n`;\n\t\t\t} else {\n\t\t\t\treturn `\\n${getTab()}</${namespaceAlias}:${sName}>\\n`;\n\t\t\t}\n\t\t}\n\t};\n\tlet outXML;\n\tif (Array.isArray(controlToSerialize)) {\n\t\toutXML = controlToSerialize.map((controlToRender: UI5Element) => {\n\t\t\treturn new Serializer(controlToRender, serializeDelegate).serialize();\n\t\t});\n\t} else {\n\t\toutXML = new Serializer(controlToSerialize, serializeDelegate).serialize();\n\t}\n\treturn formatXML(`<root>${outXML}</root>`);\n}\n\nexport function createAwaiter() {\n\tlet fnResolve!: Function;\n\tconst myPromise = new Promise((resolve) => {\n\t\tfnResolve = resolve;\n\t});\n\treturn { promise: myPromise, resolve: fnResolve };\n}\n\nexport function renderBuildingBlockWithModels(buildingBlock: { getContent: Function }, models: { [key: string]: Model }): Control {\n\treturn (ManagedObject as ManagedObjectEx).runWithPreprocessors(\n\t\t() => {\n\t\t\treturn buildingBlock.getContent();\n\t\t},\n\t\t{\n\t\t\tsettings: function (controlSettings: { models: unknown }) {\n\t\t\t\tcontrolSettings.models = models;\n\t\t\t\treturn controlSettings;\n\t\t\t}\n\t\t}\n\t);\n}\n\nexport function registerMockFragments(...fragments: MockFragment[]): jest.SpyInstance {\n\t// eslint-disable-next-line @typescript-eslint/no-explicit-any\n\tconst originalLoadTemplate = (XMLTemplateProcessor as any).loadTemplatePromise;\n\t// eslint-disable-next-line @typescript-eslint/no-explicit-any\n\tconst loadTemplateStub = jest.spyOn(XMLTemplateProcessor as any, \"loadTemplatePromise\");\n\tloadTemplateStub.mockImplementation(((templateName: string, extension: string) => {\n\t\tfor (const fragment of fragments) {\n\t\t\tif (fragment.name === templateName) {\n\t\t\t\treturn parseXMLString(fragment.content)[0];\n\t\t\t}\n\t\t}\n\t\treturn originalLoadTemplate(templateName, extension);\n\t}) as (() => Element) | undefined);\n\treturn loadTemplateStub;\n}\n\n/**\n * Creates a new instance of an appComponent and templateComponent with the given options.\n * @param options\n * @param options.cdsFile The path to the CDS file to use for the appComponent\n * @param options.mainContextPath The main context path to use for the appComponent\n * @param options.pageContent The page content to use for the appComponent\n * @param options.content The content to use for the app Component\n * @param options.componentId\n * @param options.manifestSettings\n * @param name The name to use for the appComponent\n * @param viewLevel The view level to use for the appComponent\n * @returns The appcomponent and templateComponent to use for testing\n */\nexport async function initializeAppComponent(\n\toptions?: {\n\t\tcdsFile?: string;\n\t\tcomponentId?: string;\n\t\tmainContextPath?: string;\n\t\tpageContent?: Function;\n\t\tmanifestSettings?: Partial<ListReportManifestSettings | ObjectPageManifestSettings>;\n\t\tcontent?: {};\n\t},\n\tname?: string,\n\tviewLevel?: number\n): Promise<{ appComponent: AppComponent; templateComponent: TemplateComponent }> {\n\tlet cdsFile = options?.cdsFile;\n\tif (!cdsFile) {\n\t\tcdsFile = compileCDS(path.join(__dirname, \"./data/Products.cds\"));\n\t}\n\tconst guid = uid();\n\tconst id = options?.componentId ?? `sap.fe.test.${guid}`;\n\tconst cdsContent = fs.readFileSync(cdsFile).toString();\n\tsap.jest.registerFakeFragment(`/sap/fe/core/mock/${guid}/$metadata?sap-language=EN`, cdsContent);\n\tclass DefaultPageContent extends PageController {\n\t\trender() {\n\t\t\treturn <Page></Page>;\n\t\t}\n\t}\n\tsap.ui.define(`sap/fe/test/${guid}/Component`, [\"sap/fe/core/AppComponent\"], function (_AppComponent: AppComponent) {\n\t\t\"use strict\";\n\n\t\treturn AppComponent.extend(`sap.fe.test.${guid}.Component`, {\n\t\t\tmetadata: {\n\t\t\t\tmanifest: {\n\t\t\t\t\t\"sap.app\": {\n\t\t\t\t\t\tid: `test${guid}`,\n\t\t\t\t\t\tdataSources: {\n\t\t\t\t\t\t\tmainService: {\n\t\t\t\t\t\t\t\turi: `/sap/fe/core/mock/${guid}/`,\n\t\t\t\t\t\t\t\ttype: \"OData\",\n\t\t\t\t\t\t\t\tsettings: {\n\t\t\t\t\t\t\t\t\todataVersion: \"4.0\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t\"sap.ui5\": {\n\t\t\t\t\t\tmodels: {\n\t\t\t\t\t\t\t\"\": {\n\t\t\t\t\t\t\t\tdataSource: \"mainService\",\n\t\t\t\t\t\t\t\tsettings: {}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\trouting: {\n\t\t\t\t\t\t\ttargets: {\n\t\t\t\t\t\t\t\tDefault: {\n\t\t\t\t\t\t\t\t\ttype: \"Component\",\n\t\t\t\t\t\t\t\t\tname: name ?? \"sap.fe.core.fpm\",\n\t\t\t\t\t\t\t\t\tid: \"Default\",\n\t\t\t\t\t\t\t\t\tviewLevel: viewLevel,\n\t\t\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\t\t\tsettings: {\n\t\t\t\t\t\t\t\t\t\t\t...(options?.manifestSettings ?? {}),\n\t\t\t\t\t\t\t\t\t\t\tcontextPath: options?.mainContextPath ?? \"/Products\",\n\t\t\t\t\t\t\t\t\t\t\tviewType: \"JSX\",\n\t\t\t\t\t\t\t\t\t\t\tviewContent: options?.pageContent ?? DefaultPageContent,\n\t\t\t\t\t\t\t\t\t\t\tcontent: options?.content\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\troutes: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tpattern: \":?query:\",\n\t\t\t\t\t\t\t\t\tname: \"Default\",\n\t\t\t\t\t\t\t\t\ttarget: \"Default\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\tconst mockAppComponent = (await Component.create({ name: `sap.fe.test.${guid}`, id: id })) as AppComponent;\n\n\tawait mockAppComponent.initialized;\n\tconst v = await (mockAppComponent.getRouter().getTarget(\"Default\") as { load?: Function }).load?.();\n\treturn { appComponent: mockAppComponent, templateComponent: v.object };\n}\n\n/**\n * Find an element in a collection that matches the given selector.\n * @param collection\n * @param selector\n * @returns The element that matches the selector or undefined if no element matches the selector\n */\nexport function findElement(collection: HTMLCollection, selector: (element: HTMLElement) => boolean): HTMLElement | undefined {\n\tfor (let i = 0; i < collection.length; i++) {\n\t\tconst element = collection.item(i) as HTMLElement;\n\t\tif (selector(element)) {\n\t\t\treturn element;\n\t\t}\n\t}\n\treturn undefined;\n}\n\n/**\n * Wait for an event to be resolved before continuing.\n * @param control\n * @param eventName\n * @returns A Promise that resolves when the event is received\n */\nexport async function waitForEvent(control: EventProvider, eventName: string): Promise<Event> {\n\treturn new Promise((resolve) => {\n\t\tcontrol.attachEventOnce(eventName, (event: Event) => {\n\t\t\tresolve(event);\n\t\t});\n\t});\n}\n\n/**\n * Tell the binding parser to keep the binding strings for testing.\n * @param enabled\n */\nexport function keepBindingStringForTest(enabled: boolean): void {\n\tBindingParser._keepBindingStrings = enabled;\n}\n"],"mappings":"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","ignoreList":[],"file":"JestTemplatingHelper-dbg.js"}
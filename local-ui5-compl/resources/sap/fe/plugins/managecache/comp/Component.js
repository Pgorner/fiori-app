/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2024 SAP SE. All rights reserved
 */
sap.ui.define(["sap/ui/core/UIComponent", "sap/ui/core/cache/CacheManager", "sap/ui/core/mvc/View", "sap/ui/core/mvc/ViewType", "sap/ui/model/json/JSONModel", "sap/ui/model/resource/ResourceModel"], function (UIComponent, CacheManager, View, ViewType, JSONModel, i18nModel) {
  "use strict";

  function _inheritsLoose(t, o) { t.prototype = Object.create(o.prototype), t.prototype.constructor = t, _setPrototypeOf(t, o); }
  function _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }
  let RequestSettingsComponent = /*#__PURE__*/function (_UIComponent) {
    function RequestSettingsComponent() {
      return _UIComponent.apply(this, arguments) || this;
    }
    _inheritsLoose(RequestSettingsComponent, _UIComponent);
    var _proto = RequestSettingsComponent.prototype;
    _proto.getWaitInit = async function getWaitInit() {
      return this.waitInit;
    };
    _proto.init = async function init() {
      let resolveFunction;
      _UIComponent.prototype.init.call(this);
      this.waitInit = new Promise(resolve => {
        resolveFunction = resolve;
      });
      const container = sap.ui.require("sap/ushell/Container");
      const personalizationService = await container.getServiceAsync("PersonalizationV2");
      this.model = new JSONModel({});
      this.personalizationService = personalizationService;
      this.scope = {
        clientStorageAllowed: false,
        keyCategory: personalizationService.constants.keyCategory.FIXED_KEY,
        validity: "Infinity",
        writeFrequency: personalizationService.constants.writeFrequency.LOW
      };
      this.personalizationId = {
        container: "sap.ushell.optimisticreq.personalization",
        item: "data"
      };
      const period = await this._getPersonalizedPeriod(personalizationService);
      // Remove old managecache entries via cache manager
      const timeStamp = new Date(Date.now() - period * 86400000);
      const filters = {
        olderThan: timeStamp,
        prefix: "sap.ui.model.odata.v4.managecache"
      };
      CacheManager.delWithFilters(filters);
      // Enhance user activities section with optimistic batch settings
      await this._createActivitiesSection();
      resolveFunction();
    };
    _proto._getPersonalizedPeriod = async function _getPersonalizedPeriod(personalizationService) {
      const personalizer = await personalizationService.getPersonalizer(this.personalizationId, this.scope);
      const personalizationContainer = await personalizer.getPersData();
      // Use personalization service to get/set period
      let period = personalizationContainer?.period;
      period ??= 30;
      this.model.setProperty("/period", period);
      this.model.setProperty("/oldperiod", period);
      return period;
    };
    _proto._setPersonalizedPeriod = async function _setPersonalizedPeriod(personalizationService, period) {
      const personalizer = await personalizationService.getPersonalizer(this.personalizationId, this.scope);
      return personalizer.setPersData(period);
    };
    _proto._createActivitiesSection = async function _createActivitiesSection() {
      const i18n = new i18nModel({
        bundleName: "sap.fe.plugins.managecache.comp.i18n.messagebundle"
      });
      const viewType = ViewType.XML;
      const viewSettings = {
        type: viewType,
        id: "requestCacheView",
        viewName: "sap.fe.plugins.managecache.comp.view.settings"
      };
      const container = sap.ui.require("sap/ushell/Container");
      const frameBoundExtension = await container.getServiceAsync("FrameBoundExtension");
      await frameBoundExtension.addGroupedUserSettingsEntry({
        title: i18n.getResourceBundle().getText("T_GROUP"),
        icon: "sap-icon://laptop",
        entryHelpId: "userActivitiesEntry",
        groupingId: "userActivities",
        groupingTabTitle: i18n.getResourceBundle().getText("title"),
        groupingTabHelpId: "requestCacheUserActivities-helpId",
        value: async function () {
          return Promise.resolve("Request Cache"); //check
        },
        content: async () => {
          return View.create(viewSettings).then(view => {
            view.setModel(this.model);
            view.setModel(i18n, "i18n");
            this.viewInstance = view;
            return this.viewInstance;
          });
        },
        onSave: async () => {
          const period = this.model.getProperty("/period");
          await this._setPersonalizedPeriod(this.personalizationService, {
            period: period
          });
          return this.viewInstance.getController().onSave(period);
        },
        onCancel: () => {
          return this.viewInstance.getController().onCancel();
        }
      });
    };
    return RequestSettingsComponent;
  }(UIComponent);
  return RequestSettingsComponent;
}, false);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSZXF1ZXN0U2V0dGluZ3NDb21wb25lbnQiLCJfVUlDb21wb25lbnQiLCJhcHBseSIsImFyZ3VtZW50cyIsIl9pbmhlcml0c0xvb3NlIiwiX3Byb3RvIiwicHJvdG90eXBlIiwiZ2V0V2FpdEluaXQiLCJ3YWl0SW5pdCIsImluaXQiLCJyZXNvbHZlRnVuY3Rpb24iLCJjYWxsIiwiUHJvbWlzZSIsInJlc29sdmUiLCJjb250YWluZXIiLCJzYXAiLCJ1aSIsInJlcXVpcmUiLCJwZXJzb25hbGl6YXRpb25TZXJ2aWNlIiwiZ2V0U2VydmljZUFzeW5jIiwibW9kZWwiLCJKU09OTW9kZWwiLCJzY29wZSIsImNsaWVudFN0b3JhZ2VBbGxvd2VkIiwia2V5Q2F0ZWdvcnkiLCJjb25zdGFudHMiLCJGSVhFRF9LRVkiLCJ2YWxpZGl0eSIsIndyaXRlRnJlcXVlbmN5IiwiTE9XIiwicGVyc29uYWxpemF0aW9uSWQiLCJpdGVtIiwicGVyaW9kIiwiX2dldFBlcnNvbmFsaXplZFBlcmlvZCIsInRpbWVTdGFtcCIsIkRhdGUiLCJub3ciLCJmaWx0ZXJzIiwib2xkZXJUaGFuIiwicHJlZml4IiwiQ2FjaGVNYW5hZ2VyIiwiZGVsV2l0aEZpbHRlcnMiLCJfY3JlYXRlQWN0aXZpdGllc1NlY3Rpb24iLCJwZXJzb25hbGl6ZXIiLCJnZXRQZXJzb25hbGl6ZXIiLCJwZXJzb25hbGl6YXRpb25Db250YWluZXIiLCJnZXRQZXJzRGF0YSIsInNldFByb3BlcnR5IiwiX3NldFBlcnNvbmFsaXplZFBlcmlvZCIsInNldFBlcnNEYXRhIiwiaTE4biIsImkxOG5Nb2RlbCIsImJ1bmRsZU5hbWUiLCJ2aWV3VHlwZSIsIlZpZXdUeXBlIiwiWE1MIiwidmlld1NldHRpbmdzIiwidHlwZSIsImlkIiwidmlld05hbWUiLCJmcmFtZUJvdW5kRXh0ZW5zaW9uIiwiYWRkR3JvdXBlZFVzZXJTZXR0aW5nc0VudHJ5IiwidGl0bGUiLCJnZXRSZXNvdXJjZUJ1bmRsZSIsImdldFRleHQiLCJpY29uIiwiZW50cnlIZWxwSWQiLCJncm91cGluZ0lkIiwiZ3JvdXBpbmdUYWJUaXRsZSIsImdyb3VwaW5nVGFiSGVscElkIiwidmFsdWUiLCJjb250ZW50IiwiVmlldyIsImNyZWF0ZSIsInRoZW4iLCJ2aWV3Iiwic2V0TW9kZWwiLCJ2aWV3SW5zdGFuY2UiLCJvblNhdmUiLCJnZXRQcm9wZXJ0eSIsImdldENvbnRyb2xsZXIiLCJvbkNhbmNlbCIsIlVJQ29tcG9uZW50Il0sInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyJDb21wb25lbnQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgUmVzb3VyY2VCdW5kbGUgZnJvbSBcInNhcC9iYXNlL2kxOG4vUmVzb3VyY2VCdW5kbGVcIjtcbmltcG9ydCBVSUNvbXBvbmVudCBmcm9tIFwic2FwL3VpL2NvcmUvVUlDb21wb25lbnRcIjtcbmltcG9ydCBDYWNoZU1hbmFnZXIgZnJvbSBcInNhcC91aS9jb3JlL2NhY2hlL0NhY2hlTWFuYWdlclwiO1xuaW1wb3J0IFZpZXcgZnJvbSBcInNhcC91aS9jb3JlL212Yy9WaWV3XCI7XG5pbXBvcnQgVmlld1R5cGUgZnJvbSBcInNhcC91aS9jb3JlL212Yy9WaWV3VHlwZVwiO1xuaW1wb3J0IEpTT05Nb2RlbCBmcm9tIFwic2FwL3VpL21vZGVsL2pzb24vSlNPTk1vZGVsXCI7XG5pbXBvcnQgaTE4bk1vZGVsIGZyb20gXCJzYXAvdWkvbW9kZWwvcmVzb3VyY2UvUmVzb3VyY2VNb2RlbFwiO1xuaW1wb3J0IHR5cGUgUmVxdWVzdFNldHRpbmdzQ29udHJvbGxlciBmcm9tIFwiLi9jb250cm9sbGVyL3NldHRpbmdzLmNvbnRyb2xsZXJcIjtcblxuZXhwb3J0IHR5cGUgU2NvcGUgPSB7XG5cdHZhbGlkaXR5OiBzdHJpbmc7XG5cdGtleUNhdGVnb3J5OiBzdHJpbmc7XG5cdHdyaXRlRnJlcXVlbmN5OiBzdHJpbmc7XG5cdGNsaWVudFN0b3JhZ2VBbGxvd2VkOiBib29sZWFuO1xufTtcbmV4cG9ydCB0eXBlIFBlcnNvbmFsaXphdGlvbklkID0ge1xuXHRjb250YWluZXI6IHN0cmluZztcblx0aXRlbTogc3RyaW5nO1xufTtcbmV4cG9ydCB0eXBlIEN1c3RvbVNjb3BlQ29uc3RhbnRzID0ge1xuXHRjb25zdGFudHM6IHtcblx0XHRrZXlDYXRlZ29yeToge1xuXHRcdFx0RklYRURfS0VZOiBzdHJpbmc7XG5cdFx0XHRHRU5FUkFURURfS0VZOiBzdHJpbmc7XG5cdFx0fTtcblx0XHR3cml0ZUZyZXF1ZW5jeToge1xuXHRcdFx0SElHSDogc3RyaW5nO1xuXHRcdFx0TE9XOiBzdHJpbmc7XG5cdFx0fTtcblx0fTtcblx0Z2V0UGVyc29uYWxpemVyOiAoXG5cdFx0cGVyc29uYWxpemF0aW9uSWQ6IFBlcnNvbmFsaXphdGlvbklkLFxuXHRcdHNjb3BlOiBTY29wZVxuXHQpID0+IFByb21pc2U8e1xuXHRcdGdldFBlcnNEYXRhOiAoKSA9PiBQcm9taXNlPHsgcGVyaW9kOiBudW1iZXIgfSB8IHVuZGVmaW5lZD47XG5cdFx0c2V0UGVyc0RhdGE6IChhcmc6IG9iamVjdCkgPT4gUHJvbWlzZTxvYmplY3Q+O1xuXHR9Pjtcbn07XG5cbmV4cG9ydCB0eXBlIFBlcnNvbmFsaXphdGlvbkNvbnN0YW50cyA9IHtcblx0a2V5Q2F0ZWdvcnk6IHtcblx0XHRGSVhFRF9LRVk6IHN0cmluZztcblx0XHRHRU5FUkFURURfS0VZOiBzdHJpbmc7XG5cdH07XG5cdHdyaXRlRnJlcXVlbmN5OiB7XG5cdFx0SElHSDogc3RyaW5nO1xuXHRcdExPVzogc3RyaW5nO1xuXHR9O1xufTtcblxuZXhwb3J0IHR5cGUgU2hlbGxDb250YWluZXIgPSB7XG5cdGdldFNlcnZpY2VBc3luYyhhcmc6IHN0cmluZyk6IFByb21pc2U8Q3VzdG9tU2NvcGVDb25zdGFudHM+O1xuXHRnZXRSZW5kZXJlcigpOiB7XG5cdFx0YWRkVXNlclByZWZlcmVuY2VzR3JvdXBlZEVudHJ5KGFyZzoge1xuXHRcdFx0b25TYXZlOiAoKSA9PiBQcm9taXNlPHZvaWQ+O1xuXHRcdFx0Z3JvdXBpbmdJZDogc3RyaW5nO1xuXHRcdFx0b25DYW5jZWw6ICgpID0+IHZvaWQ7XG5cdFx0XHRpY29uOiBzdHJpbmc7XG5cdFx0XHRncm91cGluZ1RhYkhlbHBJZDogc3RyaW5nO1xuXHRcdFx0dGl0bGU6IHN0cmluZztcblx0XHRcdGVudHJ5SGVscElkOiBzdHJpbmc7XG5cdFx0XHRncm91cGluZ1RhYlRpdGxlOiBzdHJpbmc7XG5cdFx0XHR2YWx1ZTogKCkgPT4gUHJvbWlzZTxBd2FpdGVkPHN0cmluZz4+O1xuXHRcdFx0Y29udGVudDogKCkgPT4gUHJvbWlzZTxWaWV3Pjtcblx0XHR9KTogUHJvbWlzZTx2b2lkPjtcblx0fTtcbn07XG5cbmNsYXNzIFJlcXVlc3RTZXR0aW5nc0NvbXBvbmVudCBleHRlbmRzIFVJQ29tcG9uZW50IHtcblx0dmlld0luc3RhbmNlITogVmlldztcblxuXHRwZXJzb25hbGl6YXRpb25TZXJ2aWNlITogQ3VzdG9tU2NvcGVDb25zdGFudHM7XG5cblx0bW9kZWwhOiBKU09OTW9kZWw7XG5cblx0cGVyc29uYWxpemF0aW9uSWQhOiBQZXJzb25hbGl6YXRpb25JZDtcblxuXHRzY29wZSE6IFNjb3BlO1xuXG5cdHByaXZhdGUgd2FpdEluaXQhOiBQcm9taXNlPHZvaWQ+O1xuXG5cdHB1YmxpYyBhc3luYyBnZXRXYWl0SW5pdCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRyZXR1cm4gdGhpcy53YWl0SW5pdDtcblx0fVxuXG5cdHB1YmxpYyBhc3luYyBpbml0KCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGxldCByZXNvbHZlRnVuY3Rpb24hOiAoKSA9PiB2b2lkO1xuXHRcdHN1cGVyLmluaXQoKTtcblx0XHR0aGlzLndhaXRJbml0ID0gbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmUpID0+IHtcblx0XHRcdHJlc29sdmVGdW5jdGlvbiA9IHJlc29sdmU7XG5cdFx0fSk7XG5cdFx0Y29uc3QgY29udGFpbmVyID0gc2FwLnVpLnJlcXVpcmUoXCJzYXAvdXNoZWxsL0NvbnRhaW5lclwiKSBhcyBTaGVsbENvbnRhaW5lcjtcblx0XHRjb25zdCBwZXJzb25hbGl6YXRpb25TZXJ2aWNlID0gKGF3YWl0IGNvbnRhaW5lci5nZXRTZXJ2aWNlQXN5bmMoXCJQZXJzb25hbGl6YXRpb25WMlwiKSkgYXMgdW5rbm93biBhcyBDdXN0b21TY29wZUNvbnN0YW50cztcblx0XHR0aGlzLm1vZGVsID0gbmV3IEpTT05Nb2RlbCh7fSk7XG5cdFx0dGhpcy5wZXJzb25hbGl6YXRpb25TZXJ2aWNlID0gcGVyc29uYWxpemF0aW9uU2VydmljZTtcblx0XHR0aGlzLnNjb3BlID0ge1xuXHRcdFx0Y2xpZW50U3RvcmFnZUFsbG93ZWQ6IGZhbHNlLFxuXHRcdFx0a2V5Q2F0ZWdvcnk6IChwZXJzb25hbGl6YXRpb25TZXJ2aWNlLmNvbnN0YW50cyBhcyBQZXJzb25hbGl6YXRpb25Db25zdGFudHMpLmtleUNhdGVnb3J5LkZJWEVEX0tFWSxcblx0XHRcdHZhbGlkaXR5OiBcIkluZmluaXR5XCIsXG5cdFx0XHR3cml0ZUZyZXF1ZW5jeTogKHBlcnNvbmFsaXphdGlvblNlcnZpY2UuY29uc3RhbnRzIGFzIFBlcnNvbmFsaXphdGlvbkNvbnN0YW50cykud3JpdGVGcmVxdWVuY3kuTE9XXG5cdFx0fTtcblx0XHR0aGlzLnBlcnNvbmFsaXphdGlvbklkID0ge1xuXHRcdFx0Y29udGFpbmVyOiBcInNhcC51c2hlbGwub3B0aW1pc3RpY3JlcS5wZXJzb25hbGl6YXRpb25cIixcblx0XHRcdGl0ZW06IFwiZGF0YVwiXG5cdFx0fTtcblx0XHRjb25zdCBwZXJpb2QgPSBhd2FpdCB0aGlzLl9nZXRQZXJzb25hbGl6ZWRQZXJpb2QocGVyc29uYWxpemF0aW9uU2VydmljZSk7XG5cdFx0Ly8gUmVtb3ZlIG9sZCBtYW5hZ2VjYWNoZSBlbnRyaWVzIHZpYSBjYWNoZSBtYW5hZ2VyXG5cdFx0Y29uc3QgdGltZVN0YW1wID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtIHBlcmlvZCAqIDg2NDAwMDAwKTtcblx0XHRjb25zdCBmaWx0ZXJzOiB7IG9sZGVyVGhhbjogRGF0ZTsgcHJlZml4OiBzdHJpbmcgfSA9IHtcblx0XHRcdG9sZGVyVGhhbjogdGltZVN0YW1wLFxuXHRcdFx0cHJlZml4OiBcInNhcC51aS5tb2RlbC5vZGF0YS52NC5tYW5hZ2VjYWNoZVwiXG5cdFx0fTtcblx0XHRDYWNoZU1hbmFnZXIuZGVsV2l0aEZpbHRlcnMoZmlsdGVycyk7XG5cdFx0Ly8gRW5oYW5jZSB1c2VyIGFjdGl2aXRpZXMgc2VjdGlvbiB3aXRoIG9wdGltaXN0aWMgYmF0Y2ggc2V0dGluZ3Ncblx0XHRhd2FpdCB0aGlzLl9jcmVhdGVBY3Rpdml0aWVzU2VjdGlvbigpO1xuXHRcdHJlc29sdmVGdW5jdGlvbigpO1xuXHR9XG5cblx0YXN5bmMgX2dldFBlcnNvbmFsaXplZFBlcmlvZChwZXJzb25hbGl6YXRpb25TZXJ2aWNlOiBDdXN0b21TY29wZUNvbnN0YW50cyk6IFByb21pc2U8bnVtYmVyPiB7XG5cdFx0Y29uc3QgcGVyc29uYWxpemVyID0gYXdhaXQgcGVyc29uYWxpemF0aW9uU2VydmljZS5nZXRQZXJzb25hbGl6ZXIodGhpcy5wZXJzb25hbGl6YXRpb25JZCwgdGhpcy5zY29wZSk7XG5cdFx0Y29uc3QgcGVyc29uYWxpemF0aW9uQ29udGFpbmVyID0gYXdhaXQgcGVyc29uYWxpemVyLmdldFBlcnNEYXRhKCk7XG5cdFx0Ly8gVXNlIHBlcnNvbmFsaXphdGlvbiBzZXJ2aWNlIHRvIGdldC9zZXQgcGVyaW9kXG5cdFx0bGV0IHBlcmlvZCA9IHBlcnNvbmFsaXphdGlvbkNvbnRhaW5lcj8ucGVyaW9kO1xuXHRcdHBlcmlvZCA/Pz0gMzA7XG5cdFx0dGhpcy5tb2RlbC5zZXRQcm9wZXJ0eShcIi9wZXJpb2RcIiwgcGVyaW9kKTtcblx0XHR0aGlzLm1vZGVsLnNldFByb3BlcnR5KFwiL29sZHBlcmlvZFwiLCBwZXJpb2QpO1xuXHRcdHJldHVybiBwZXJpb2Q7XG5cdH1cblxuXHRhc3luYyBfc2V0UGVyc29uYWxpemVkUGVyaW9kKHBlcnNvbmFsaXphdGlvblNlcnZpY2U6IEN1c3RvbVNjb3BlQ29uc3RhbnRzLCBwZXJpb2Q6IHsgcGVyaW9kOiBudW1iZXIgfSk6IFByb21pc2U8b2JqZWN0PiB7XG5cdFx0Y29uc3QgcGVyc29uYWxpemVyID0gYXdhaXQgcGVyc29uYWxpemF0aW9uU2VydmljZS5nZXRQZXJzb25hbGl6ZXIodGhpcy5wZXJzb25hbGl6YXRpb25JZCwgdGhpcy5zY29wZSk7XG5cdFx0cmV0dXJuIHBlcnNvbmFsaXplci5zZXRQZXJzRGF0YShwZXJpb2QpO1xuXHR9XG5cblx0YXN5bmMgX2NyZWF0ZUFjdGl2aXRpZXNTZWN0aW9uKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGkxOG4gPSBuZXcgaTE4bk1vZGVsKHsgYnVuZGxlTmFtZTogXCJzYXAuZmUucGx1Z2lucy5tYW5hZ2VjYWNoZS5jb21wLmkxOG4ubWVzc2FnZWJ1bmRsZVwiIH0pO1xuXHRcdGNvbnN0IHZpZXdUeXBlID0gVmlld1R5cGUuWE1MO1xuXHRcdGNvbnN0IHZpZXdTZXR0aW5ncyA9IHtcblx0XHRcdHR5cGU6IHZpZXdUeXBlLFxuXHRcdFx0aWQ6IFwicmVxdWVzdENhY2hlVmlld1wiLFxuXHRcdFx0dmlld05hbWU6IFwic2FwLmZlLnBsdWdpbnMubWFuYWdlY2FjaGUuY29tcC52aWV3LnNldHRpbmdzXCJcblx0XHR9O1xuXHRcdGNvbnN0IGNvbnRhaW5lciA9IHNhcC51aS5yZXF1aXJlKFwic2FwL3VzaGVsbC9Db250YWluZXJcIikgYXMgU2hlbGxDb250YWluZXI7XG5cdFx0Y29uc3QgZnJhbWVCb3VuZEV4dGVuc2lvbiA9IChhd2FpdCBjb250YWluZXIuZ2V0U2VydmljZUFzeW5jKFwiRnJhbWVCb3VuZEV4dGVuc2lvblwiKSkgYXMgdW5rbm93biBhcyB7XG5cdFx0XHRhZGRHcm91cGVkVXNlclNldHRpbmdzRW50cnk6IChzZXR0aW5nczogdW5rbm93bikgPT4gUHJvbWlzZTx2b2lkPjtcblx0XHR9O1xuXHRcdGF3YWl0IGZyYW1lQm91bmRFeHRlbnNpb24uYWRkR3JvdXBlZFVzZXJTZXR0aW5nc0VudHJ5KHtcblx0XHRcdHRpdGxlOiAoaTE4bi5nZXRSZXNvdXJjZUJ1bmRsZSgpIGFzIFJlc291cmNlQnVuZGxlKS5nZXRUZXh0KFwiVF9HUk9VUFwiKSxcblx0XHRcdGljb246IFwic2FwLWljb246Ly9sYXB0b3BcIixcblx0XHRcdGVudHJ5SGVscElkOiBcInVzZXJBY3Rpdml0aWVzRW50cnlcIixcblx0XHRcdGdyb3VwaW5nSWQ6IFwidXNlckFjdGl2aXRpZXNcIixcblx0XHRcdGdyb3VwaW5nVGFiVGl0bGU6IChpMThuLmdldFJlc291cmNlQnVuZGxlKCkgYXMgUmVzb3VyY2VCdW5kbGUpLmdldFRleHQoXCJ0aXRsZVwiKSxcblx0XHRcdGdyb3VwaW5nVGFiSGVscElkOiBcInJlcXVlc3RDYWNoZVVzZXJBY3Rpdml0aWVzLWhlbHBJZFwiLFxuXHRcdFx0dmFsdWU6IGFzeW5jIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZShcIlJlcXVlc3QgQ2FjaGVcIik7IC8vY2hlY2tcblx0XHRcdH0sXG5cdFx0XHRjb250ZW50OiBhc3luYyAoKSA9PiB7XG5cdFx0XHRcdHJldHVybiBWaWV3LmNyZWF0ZSh2aWV3U2V0dGluZ3MpLnRoZW4oKHZpZXc6IFZpZXcpID0+IHtcblx0XHRcdFx0XHR2aWV3LnNldE1vZGVsKHRoaXMubW9kZWwpO1xuXHRcdFx0XHRcdHZpZXcuc2V0TW9kZWwoaTE4biwgXCJpMThuXCIpO1xuXHRcdFx0XHRcdHRoaXMudmlld0luc3RhbmNlID0gdmlldztcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy52aWV3SW5zdGFuY2U7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSxcblx0XHRcdG9uU2F2ZTogYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRjb25zdCBwZXJpb2QgPSB0aGlzLm1vZGVsLmdldFByb3BlcnR5KFwiL3BlcmlvZFwiKSBhcyB1bmtub3duIGFzIG51bWJlcjtcblx0XHRcdFx0YXdhaXQgdGhpcy5fc2V0UGVyc29uYWxpemVkUGVyaW9kKHRoaXMucGVyc29uYWxpemF0aW9uU2VydmljZSwgeyBwZXJpb2Q6IHBlcmlvZCB9KTtcblx0XHRcdFx0cmV0dXJuICh0aGlzLnZpZXdJbnN0YW5jZS5nZXRDb250cm9sbGVyKCkgYXMgUmVxdWVzdFNldHRpbmdzQ29udHJvbGxlcikub25TYXZlKHBlcmlvZCk7XG5cdFx0XHR9LFxuXHRcdFx0b25DYW5jZWw6ICgpID0+IHtcblx0XHRcdFx0cmV0dXJuICh0aGlzLnZpZXdJbnN0YW5jZS5nZXRDb250cm9sbGVyKCkgYXMgUmVxdWVzdFNldHRpbmdzQ29udHJvbGxlcikub25DYW5jZWwoKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxufVxuZXhwb3J0IGRlZmF1bHQgUmVxdWVzdFNldHRpbmdzQ29tcG9uZW50O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7TUFvRU1BLHdCQUF3QiwwQkFBQUMsWUFBQTtJQUFBLFNBQUFELHlCQUFBO01BQUEsT0FBQUMsWUFBQSxDQUFBQyxLQUFBLE9BQUFDLFNBQUE7SUFBQTtJQUFBQyxjQUFBLENBQUFKLHdCQUFBLEVBQUFDLFlBQUE7SUFBQSxJQUFBSSxNQUFBLEdBQUFMLHdCQUFBLENBQUFNLFNBQUE7SUFBQUQsTUFBQSxDQWFoQkUsV0FBVyxHQUF4QixlQUFhQSxXQUFXQSxDQUFBLEVBQWtCO01BQ3pDLE9BQU8sSUFBSSxDQUFDQyxRQUFRO0lBQ3JCLENBQUM7SUFBQUgsTUFBQSxDQUVZSSxJQUFJLEdBQWpCLGVBQWFBLElBQUlBLENBQUEsRUFBa0I7TUFDbEMsSUFBSUMsZUFBNEI7TUFDaENULFlBQUEsQ0FBQUssU0FBQSxDQUFNRyxJQUFJLENBQUFFLElBQUE7TUFDVixJQUFJLENBQUNILFFBQVEsR0FBRyxJQUFJSSxPQUFPLENBQVFDLE9BQU8sSUFBSztRQUM5Q0gsZUFBZSxHQUFHRyxPQUFPO01BQzFCLENBQUMsQ0FBQztNQUNGLE1BQU1DLFNBQVMsR0FBR0MsR0FBRyxDQUFDQyxFQUFFLENBQUNDLE9BQU8sQ0FBQyxzQkFBc0IsQ0FBbUI7TUFD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
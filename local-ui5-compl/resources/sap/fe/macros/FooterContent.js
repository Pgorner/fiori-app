/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2024 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/base/BindingToolkit","sap/fe/base/ClassSupport","sap/fe/core/buildingBlocks/BuildingBlock","sap/fe/core/controls/CommandExecution","sap/fe/core/converters/ManifestSettings","sap/fe/core/converters/MetaModelConverter","sap/fe/core/converters/annotations/DataField","sap/fe/core/helpers/BindingHelper","sap/fe/core/helpers/FPMHelper","sap/fe/core/helpers/ModelHelper","sap/fe/core/library","sap/fe/core/templating/CriticalityFormatters","sap/fe/macros/messages/MessageButton","sap/m/Button","sap/m/DraftIndicator","sap/m/Menu","sap/m/MenuButton","sap/m/MenuItem","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/ui/core/InvisibleText","sap/fe/templates/ObjectPage/ObjectPageTemplating","sap/m/OverflowToolbarLayoutData","sap/fe/base/jsx-runtime/jsx","sap/fe/base/jsx-runtime/jsxs"],function(t,e,i,a,n,o,r,s,l,c,u,d,p,f,g,m,b,h,_,v,y,M,C,A,O,E){"use strict";var P,x,T,D,B,w,I,S,V,j,F,R,z,G,N;var L={};var J=l.UI;var k=l.Draft;var H=s.isActionWithDialog;var U=r.getInvolvedDataModelObjects;var W=o.ActionType;var $=i.property;var q=i.implementInterface;var Y=i.defineUI5Class;var X=i.defineReference;var K=e.pathInModel;var Q=e.ifElse;var Z=e.constant;function tt(t,e,i,a){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(a):void 0})}function et(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,it(t,e)}function it(t,e){return it=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},it(t,e)}function at(t,e,i,a,n){var o={};return Object.keys(a).forEach(function(t){o[t]=a[t]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=i.slice().reverse().reduce(function(i,a){return a(t,e,i)||i},o),n&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(n):void 0,o.initializer=void 0),void 0===o.initializer?(Object.defineProperty(t,e,o),null):o}function nt(t,e){throw Error("Decorating class property failed. Please ensure that transform-class-properties is enabled and runs after the decorators transform.")}let ot=(P=Y("sap.fe.macros.FooterContent"),x=q("sap.ui.core.Toolbar"),T=q("sap.m.IBar"),D=$({type:"string",required:true}),B=$({type:"string",required:true}),w=$({type:"string"}),I=X(),P(S=(V=function(e){function i(t,i){var a;a=e.call(this,t,i)||this;tt(a,"__implements__sap_ui_core_Toolbar",j,a);tt(a,"__implements__sap_m_IBar",F,a);tt(a,"id",R,a);tt(a,"metaPath",z,a);tt(a,"contextPath",G,a);tt(a,"cmdExecution",N,a);return a}L=i;et(i,e);var a=i.prototype;a.initialize=function t(){const e=this._getOwner();this.actions=e?.preprocessorContext?.bindingContexts?.converterContext?.getObject("footerActions");const i=e?.preprocessorContext?.fullContextPath;this.oDataMetaModel=e?.preprocessorContext?.models.metaModel;this.dataViewModelPath=this.getDataModelObjectForMetaPath(this.metaPath,i??this.contextPath);const a=this.dataViewModelPath.startingEntitySet;this.isDraftValidation=!!(u.getDraftRoot(a)?.PreparationAction&&a?.entityType.annotations.Common?.Messages);this.content=this.createContent()};a.onMetadataAvailable=function t(){if(!this.content){this.initialize()}};a.getActionModelPath=function t(e){const i=e.annotationPath;if(i){const t=this.oDataMetaModel.getContext(i);return U(t)}return undefined};a.getDraftIndicator=function t(){const e=this.dataViewModelPath.targetEntitySet||this.dataViewModelPath.startingEntitySet;const i=e.annotations?.Common;if(i?.DraftRoot||i?.DraftNode){return O(m,{state:"{ui>/draftStatus}",visible:"{ui>/isEditable}"})}return undefined};a.getApplyButton=function t(e){const i=this._getOwner()?.getRootController();const a=i.getView().getViewData();if(this.isDraftValidation&&!a.isDesktop&&!a.fclEnabled){return O(h,{text:"{sap.fe.i18n>T_COMMON_OBJECT_PAGE_APPLY_DRAFT}",defaultAction:async()=>{await i._applyDocument(i.getView().getBindingContext())},useDefaultActionOnly:"true",buttonMode:"Split",type:e,visible:J.IsEditable,"dt:designtime":"not-adaptable",children:O(b,{children:O(_,{text:"{sap.fe.i18n>T_COMMON_OBJECT_PAGE_VALIDATE_DRAFT}",press:async()=>{await i._validateDocument()}})})})}return O(g,{id:this.createId("StandardAction::Apply"),text:"{sap.fe.i18n>T_COMMON_OBJECT_PAGE_APPLY_DRAFT}",type:e,enabled:true,press:async()=>{await i._applyDocument(i.getView().getBindingContext())},visible:"{ui>/isEditable}","dt:designtime":"not-adaptable"})};a.getPrimary=function t(e){const i=this._getOwner()?.getRootController();const a=i.getView().getViewData();if(this.isDraftValidation&&!a.isDesktop){return O(h,{text:this.getTextSaveButton(),"jsx:command":"cmd:Save|defaultAction",useDefaultActionOnly:"true",buttonMode:"Split",type:e,visible:J.IsEditable,"dt:designtime":"not-adaptable",children:O(b,{children:O(_,{text:"{sap.fe.i18n>T_COMMON_OBJECT_PAGE_VALIDATE_DRAFT}",press:async()=>{await i._validateDocument()}})})})}return O(g,{id:this.createId("StandardAction::Save"),text:this.getTextSaveButton(),type:e,visible:J.IsEditable,enabled:true,"jsx:command":"cmd:Save|press","dt:designtime":"not-adaptable"})};a.getTextSaveButton=function t(){const e=this.getTranslatedText("T_OP_OBJECT_PAGE_SAVE");const i=this.getTranslatedText("T_OP_OBJECT_PAGE_CREATE");return Q(Q(this.dataViewModelPath.startingEntitySet.annotations.Session?.StickySessionSupported!==undefined,J.IsCreateMode,k.IsNewObject),i,e)};a.getCancelButton=function t(){return O(g,{id:this.createId("StandardAction::Cancel"),text:u.isDraftRoot(this.dataViewModelPath.targetEntitySet)?"{sap.fe.i18n>C_COMMON_OBJECT_PAGE_DISCARD_DRAFT}":"{sap.fe.i18n>C_COMMON_OBJECT_PAGE_CANCEL}","jsx:command":"cmd:Cancel|press",visible:J.IsEditable,ariaHasPopup:Q(K("/isDocumentModified","ui"),Z("Dialog"),Z("None")),enabled:true,"dt:designtime":"not-adaptable",children:{layoutData:O(A,{closeOverflowOnInteraction:false})}})};a.getDataFieldForActionButton=function t(e){if(e.annotationPath){const t=this._getOwner()?.getRootController();const i=e.annotationPath;let a;const n=t.getView();const o=this.oDataMetaModel.getContext(i);const r=U(o);const s=r.targetObject;if(s){const i={entitySetName:this.dataViewModelPath.targetEntitySet?.name,invocationGrouping:s.InvocationGrouping==="UI.OperationGroupingType/ChangeSet"?d.InvocationGrouping.ChangeSet:d.InvocationGrouping.Isolated,label:s.Label?.toString(),isNavigable:e.isNavigable,defaultValuesExtensionFunction:e.defaultValuesExtensionFunction};if(!e.command){a={press:()=>{t.handlers.onCallAction(n,s.Action,{...i,...{contexts:n.getBindingContext(),model:n.getModel()}})}}}else{if(!e.command.startsWith("cmd:")){e.command=`cmd:${e.command}`}a={"jsx:command":`${e.command}|press`}}return O(g,{id:this.createId(this.getActionModelPath(e)),"dt:designtime":e.visible==="true"||e.visible==="false"?undefined:"not-adaptable-visibility",text:i.label,...a,ariaHasPopup:H(r.targetObject),visible:e.visible,enabled:e.enabled,type:p.buildExpressionForCriticalityButtonType(r)})}}};a.getManifestButton=function e(i){if(C.isManifestAction(i)){let e;if(i.command){e={"jsx:command":`cmd:${i.command}|press`}}else{e={press:e=>{c.actionWrapper(e,i.handlerModule,i.handlerMethod,{}).catch(e=>t.error(e))}}}return O(g,{id:this.createId(i.id),"dt:designtime":i.visible==="true"||i.visible==="false"?undefined:"not-adaptable-visibility",text:i.text??"",...e,type:"Transparent",visible:i.visible,enabled:i.enabled})}};a.getActionControls=function t(){const e=C.buildEmphasizedButtonExpression(this.dataViewModelPath);return this.actions?.map(t=>{switch(t.type){case W.DefaultApply:return this.getApplyButton(e);case W.DataFieldForAction:return this.getDataFieldForActionButton(t);case W.Primary:return this.getPrimary(e);case W.Secondary:return this.getCancelButton();default:return this.getManifestButton(t)}}).filter(t=>!!t)};a.createContent=function t(){const e=this._getOwner()?.getRootController();const i=O(f,{id:this.createId("MessageButton"),messageChange:()=>e._getFooterVisibility(),ariaLabelledBy:[this.createId("MessageButton::AriaText")],type:"Emphasized",ariaHasPopup:"Dialog"});const a=E(v,{id:this.createId("_fc"),asyncMode:true,children:[O(M,{id:this.createId("MessageButton::AriaText"),text:"{sap.fe.i18n>C_COMMON_SAPFE_ERROR_MESSAGES_PAGE_BUTTON_ARIA_TEXT}"}),i,O(y,{}),this.getDraftIndicator(),this.getActionControls()]});e.getView().addDependent(O(n,{ref:this.cmdExecution,command:"OpenMessageButtonMenu",execute:()=>i.firePress()}));return a};return i}(a),j=at(V.prototype,"__implements__sap_ui_core_Toolbar",[x],{configurable:true,enumerable:true,writable:true,initializer:function(){return true}}),F=at(V.prototype,"__implements__sap_m_IBar",[T],{configurable:true,enumerable:true,writable:true,initializer:function(){return true}}),R=at(V.prototype,"id",[D],{configurable:true,enumerable:true,writable:true,initializer:null}),z=at(V.prototype,"metaPath",[B],{configurable:true,enumerable:true,writable:true,initializer:null}),G=at(V.prototype,"contextPath",[w],{configurable:true,enumerable:true,writable:true,initializer:null}),N=at(V.prototype,"cmdExecution",[I],{configurable:true,enumerable:true,writable:true,initializer:null}),V))||S);L=ot;return L},false);
//# sourceMappingURL=FooterContent.js.map
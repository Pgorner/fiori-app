{"version":3,"names":["SimpleLinkDelegate","Object","assign","LinkDelegate","apiVersion","CONSTANTS","iLinksShownInPopup","sapmLink","sapuimdcLink","sapuimdclinkLinkItem","sapmObjectIdentifier","sapmObjectStatus","getConstants","_getEntityType","oPayload","oMetaModel","createBindingContext","entityType","undefined","_getSemanticsModel","JSONModel","_getDataField","dataField","_getContact","contact","preparePayload","link","payload","calculatePayloadWithDynamicSemanticObjectsResolved","LinkId","oControl","isA","getId","titleLink","getModel","getProperty","fnTemplateFragment","containingView","CommonUtils","getTargetView","appComponent","getAppComponent","fragmentName","preProcessorSettings","bindingContexts","models","oPayloadToUse","oSemanticsModel","semanticModel","semantic","entitySet","metaModel","converterContext","viewData","fragment","XMLTemplateProcessor","loadTemplate","templatedFragment","XMLPreprocessor","process","name","templateComponent","getController","getOwnerComponent","popoverContent","runAsOwner","Fragment","load","definition","controller","setModel","setBindingContext","fetchAdditionalContent","mdcLinkControl","payLoad","getPayload","aNavigateRegexpMatch","navigationPath","match","listBinding","getBindingContext","getBinding","aggregation","getAggregation","isListBindingAnalytical","hierarchyQualifier","modelParameters","$$ownRequest","bindingContext","length","bindContext","getMetaModel","boundContext","getBoundContext","_fetchLinkCustomData","_oLink","getParent","getCustomData","fetchLinkItems","oLink","oBindingContext","oInfoLog","_getSemanticObjects","initialize","_oLinkCustomData","_link","aLinkCustomData","map","linkItem","getValue","oSemanticAttributesResolved","_calculateSemanticAttributes","oSemanticAttributes","results","oPayloadResolved","_retrieveNavigationTargets","then","aLinks","Promise","resolve","_findLinkType","aLinkItems","nLinkType","oLinkItem","LinkItem","text","getText","href","getHref","hasQuickViewFacets","LinkType","DirectLink","Popover","Text","linkType","fetchLinkType","_oCurrentLink","_oPayload","oDefaultInitialType","initialType","type","directLink","runtimeType","appStateKeyMap","semanticObjects","_retrieveUnmodifiedLinkItems","retrieveLinkItems","_LinkType","Error","oError","Log","error","_RemoveTitleLinkFromTargets","mdcLink","linkItems","titleHasLink","titleIntent","titleLinkHref","result","linkIntentWithoutParameters","titleIntentWithoutParameters","split","linkIsPrimaryAction","titleLinkhref","mdcLinkModel","setProperty","aMLinkItems","filter","linkItemFromMdc","key","_IsSemanticObjectDynamic","aNewLinkCustomData","oThis","otherLink","_getLineContext","oView","mLineContext","_setFilterContextUrlForSelectionVariant","oSelectionVariant","oNavigationService","getViewData","sContextUrl","constructContextUrl","setFilterContextUrl","_setObjectMappings","sSemanticObject","oParams","aSemanticObjectMappings","hasChanged","modifiedSelectionVariant","SelectionVariant","toJSONObject","forEach","mapping","mappingSemanticObject","semanticObject","mappingSemanticObjectPath","getDynamicPathFromSemanticObject","oMappings","items","i","sLocalProperty","sSemanticObjectProperty","value","removeParameter","removeSelectOption","renameParameter","renameSelectOption","localPropertySelectOptionName","getSelectOptionsPropertyNames","find","property","includes","replace","slice","params","selectionVariant","_getAppStateKeyAndUrlParameters","_this","navigationService","aValues","deepEqual","defaultCache","semanticAttributes","appstatekey","toES6Promise","getAppStateKeyAndUrlParameters","toJSONString","cache","_getLinkItemWithNewParameter","services","quickViewDelegate","mdcLinkToModify","appStateKey","mdcLinkItemHash","shellServices","expandCompactHash","mdcLinkItem","shellHash","parseShellHash","linkParametersFromSelectionVariant","oNewParams","semanticObjectMappings","updatedParameters","action","linksUpdatedWithParameters","getLinks","intentModified","intent","setHref","semanticPrimaryActions","some","primaryIntentFound","FieldHelper","findPrimaryActionWithinIntents","bind","_removeEmptyLinkItem","_checkImplicitSemanticObjectMapping","propertyPath","lineContext","view","lineContextData","_intentBasedNavigation","removeSensitiveData","getObject","getMetaPath","getPath","keys","filteredSemanticObjectMappings","push","modifyLinkItems","payloadResolved","oAppComponent","primaryActionIsActive","checkPrimaryActions","bTitleHasLink","hasTitleLink","oShellServices","getShellServices","hasUShell","reject","oTargetInfo","getNavigationService","oController","mLineContextData","sMetaPath","dataFieldPropPath","pathsToRetain","mappings","semanticMappingDef","processSemanticAttributes","prepareContextForExternalNavigation","mixAttributesAndSelectionVariant","propertiesWithoutConflict","linkContextPath","intentBasedNavigation","adaptNavigationContext","_removeTechnicalParameters","oNavHandler","_getURLParametersFromSelectionVariant","titleLinktoBeRemove","index","beforeNavigationCallback","event","source","getSource","urlParsing","Factory","getService","hash","KeepAliveHelper","storeControlRefreshStrategyForHash","hashToNavigate","decomposedHash","navigate","_getSemanticObjectCustomDataValue","oSemanticObjectsResolved","sPropertyName","sCustomDataValue","element","getKey","_isDynamicPath","pathOrValue","expression","resolveBindingString","_type","_updatePayloadWithResolvedSemanticObjectValue","newPayload","semanticObjectName","semanticObjectsResolved","j","_createNewPayloadWithDynamicSemanticObjectsResolved","semanticObjectNameToResolve","fnFindQualifier","internalQualifiers","qualifiers","semanticObjectNameResolved","_updateSemanticObjectsForMappings","mdcPayload","mdcPayloadWithDynamicSemanticObjectsResolved","semanticObjectMapping","indexOf","_updateSemanticObjectsUnavailableActions","mdcPayloadSemanticObjectUnavailableActions","_Index","semanticObjectUnavailableAction","findIndex","_removeEmptySemanticObjectsMappings","mappingsCount","splice","_setPayloadWithDynamicSemanticObjectsResolved","oPayloadWithDynamicSemanticObjectsResolved","propertyPathLabel","deepClone","semanticObjectUnavailableActions","_SemanticObjectUnavailableActions","_getPayloadWithDynamicSemanticObjectsResolved","linkCustomData","payloadWithDynamicSemanticObjectsResolved","_updatePayloadWithSemanticAttributes","aSemanticObjects","oContextObject","oResults","mSemanticObjectMappings","addContextObject","sAttributeName","oAttribute","oTransformationAdditional","getSemanticObjectAttribute","createAttributeStructure","addSemanticObjectAttribute","transformations","description","isPlainObject","aKeys","sNewAttributeNameMapped","sNewAttributeName","sValue","sKey","sAttributeNameMapped","reason","aAttributeNew","_convertSemanticObjectMapping","_getSemanticObjectMappings","checkPrimaryActionForHash","navLinks","hashs","targetHash","constructShellHash","target","substring","sAppStateKey","oNavigationTargets","ownNavigation","availableActions","iSuperiorActionLinksFound","Library","sap","ui","require","Utils","getAppComponentForControl","aParams","sortResultsBy","bHasLinks","elements","aSemanticObjectUnavailableActions","_getSemanticObjectUnavailableActions","oUnavailableActions","_convertSemanticObjectUnavailableAction","sCurrentHash","FieldRuntime","_fnFixHashQueryString","getHash","fnIsUnavailableAction","sAction","primaryIntents","_getPrimaryIntents","Boolean","fnAddLink","oShellHash","sHref","icon","initiallyVisible","tags","addSemanticObjectIntent","n","iLinkItemIndex","oSemanticObjectUnavailableAction","SemanticObjectUnavailableAction","actions","aSemanticObjectMappingItems","oSemanticObjectMapping","oSemanticObjectMappingItem","SemanticObjectMappingItem","SemanticObjectMapping","getSemanticObject","fromEntries","getItems","oItem","_SemanticObjectName","_SemanticObjectHasAlreadyUnavailableActions","_UnavailableActions","mSemanticObjectUnavailableActions","oSemanticObjectUnavailableActions","getActions","UnavailableAction","fetchPopoverTitle","oPanel","sTitle","oLabelledByControl","_getLabelledByControl"],"sourceRoot":".","sources":["QuickViewDelegate.ts"],"sourcesContent":["import Log from \"sap/base/Log\";\nimport deepClone from \"sap/base/util/deepClone\";\nimport deepEqual from \"sap/base/util/deepEqual\";\nimport isPlainObject from \"sap/base/util/isPlainObject\";\nimport type { CompiledBindingToolkitExpression } from \"sap/fe/base/BindingToolkit\";\nimport { resolveBindingString } from \"sap/fe/base/BindingToolkit\";\nimport type { EnhanceWithUI5 } from \"sap/fe/base/ClassSupport\";\nimport type AppComponent from \"sap/fe/core/AppComponent\";\nimport CommonUtils from \"sap/fe/core/CommonUtils\";\nimport type TemplateComponent from \"sap/fe/core/TemplateComponent\";\nimport KeepAliveHelper from \"sap/fe/core/helpers/KeepAliveHelper\";\nimport toES6Promise from \"sap/fe/core/helpers/ToES6Promise\";\nimport type { NavigationService } from \"sap/fe/core/services/NavigationServiceFactory\";\nimport type { IShellServices } from \"sap/fe/core/services/ShellServicesFactory\";\nimport { getDynamicPathFromSemanticObject } from \"sap/fe/core/templating/SemanticObjectHelper\";\nimport FieldHelper from \"sap/fe/macros/field/FieldHelper\";\nimport FieldRuntime from \"sap/fe/macros/field/FieldRuntime\";\nimport SelectionVariant from \"sap/fe/navigation/SelectionVariant\";\nimport type Link from \"sap/m/Link\";\nimport type Event from \"sap/ui/base/Event\";\nimport type Control from \"sap/ui/core/Control\";\nimport type CustomData from \"sap/ui/core/CustomData\";\nimport type UI5Element from \"sap/ui/core/Element\";\nimport Fragment from \"sap/ui/core/Fragment\";\nimport Library from \"sap/ui/core/Lib\";\nimport XMLTemplateProcessor from \"sap/ui/core/XMLTemplateProcessor\";\nimport XMLPreprocessor from \"sap/ui/core/util/XMLPreprocessor\";\nimport type flUtils from \"sap/ui/fl/Utils\";\nimport type MdcLink from \"sap/ui/mdc/Link\";\nimport type { LinkTypeWrapper, LinkType as MdcLinkType } from \"sap/ui/mdc/Link\";\n\nimport type { FEView } from \"sap/fe/core/BaseController\";\nimport type ManagedObject from \"sap/ui/base/ManagedObject\";\nimport LinkDelegate from \"sap/ui/mdc/LinkDelegate\";\nimport LinkType from \"sap/ui/mdc/enums/LinkType\";\nimport Factory from \"sap/ui/mdc/link/Factory\";\nimport LinkItem from \"sap/ui/mdc/link/LinkItem\";\nimport SemanticObjectMapping from \"sap/ui/mdc/ushell/SemanticObjectMapping\";\nimport SemanticObjectMappingItem from \"sap/ui/mdc/ushell/SemanticObjectMappingItem\";\nimport SemanticObjectUnavailableAction from \"sap/ui/mdc/ushell/SemanticObjectUnavailableAction\";\nimport type Context from \"sap/ui/model/Context\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport type ODataV4Context from \"sap/ui/model/odata/v4/Context\";\nimport type ODataListBinding from \"sap/ui/model/odata/v4/ODataListBinding\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\nimport type { LinkFilter, Link as NavigationLink } from \"sap/ushell/services/Navigation\";\nimport type { DecomposedHash, ParsedHash } from \"sap/ushell/services/URLParsing\";\n\nexport type RegisteredSemanticObjectMapping = { semanticObject: string; items: { key: string; value: string }[] };\ntype RegisteredSemanticObjectMappings = RegisteredSemanticObjectMapping[];\nexport type LinkDelegatePayload = {\n\tqualifiers: Record<string, CompiledBindingToolkitExpression>;\n\tsemanticObjects: string[];\n\tsemanticObjectsResolved?: string[];\n\tsemanticObjectMappings: RegisteredSemanticObjectMappings;\n\tsemanticObjectUnavailableActions: RegisteredSemanticObjectUnavailableAction[];\n\tsemanticPrimaryActions?: RegisteredPrimaryIntents;\n\tentityType?: string;\n\tdataField?: string;\n\tcontact?: string;\n\tnavigationPath?: string;\n\tpropertyPathLabel?: string;\n\thasQuickViewFacets?: string;\n\tLinkId?: string;\n\ttitleLink?: string;\n\tdataFieldPropPath?: string;\n\ttitleLinkhref?: string;\n};\n\nexport type RegisteredPrimaryIntent = {\n\tintent: string;\n\ttext: string;\n\ticon?: string;\n\tshortTitle?: string;\n\ttags?: string[];\n};\n\nexport type RegisteredPrimaryIntents = RegisteredPrimaryIntent[];\n\nexport type RegisteredSemanticObjectUnavailableAction = {\n\tsemanticObject: string;\n\tactions: string[];\n};\n\nexport type RegisteredSemanticAttributes = Record<string, Record<string, string>>;\n\nexport type SimpleLinkDelegatePayload = {\n\tnavigationPath: string;\n\tsemanticObjects: object[];\n\tcontact: string[];\n\tentityType: string;\n\ttitleLinkhref: string;\n};\n\n//FIXME: only necessary due to the access of private sap.ui.mdc.Link methods\ninterface FELink extends MdcLink {\n\t_retrieveUnmodifiedLinkItems: Function;\n}\n\ntype InfoLog = {\n\tinitialize: Function;\n\taddSemanticObjectAttribute: Function;\n\taddContextObject: Function;\n\tgetSemanticObjectAttribute: Function;\n\tcreateAttributeStructure: Function;\n\taddSemanticObjectIntent: Function;\n};\n\nconst SimpleLinkDelegate = Object.assign({}, LinkDelegate) as LinkDelegate & {\n\tapiVersion: number;\n\toMetaModel: ODataMetaModel;\n\tpayload: LinkDelegatePayload;\n\tsemanticModel: JSONModel | undefined;\n\toControl: UI5Element;\n\taLinkCustomData: unknown[] | undefined;\n\tappStateKeyMap: Record<string, { selectionVariant?: SelectionVariant; semanticAttributes?: string; appstatekey?: string }>;\n\t_link: MdcLink | undefined;\n\tgetConstants: () => typeof CONSTANTS;\n\t_getEntityType: (oPayload: LinkDelegatePayload, oMetaModel: ODataMetaModel) => Context | undefined;\n\t_getSemanticsModel: (oPayload: LinkDelegatePayload, oMetaModel: ODataMetaModel | undefined) => JSONModel | undefined;\n\t_getDataField: (oPayload: LinkDelegatePayload, oMetaModel: ODataMetaModel) => Context | undefined;\n\t_getContact: (oPayload: LinkDelegatePayload, oMetaModel: ODataMetaModel) => Context | undefined;\n\tpreparePayload: (link: MdcLink) => LinkDelegatePayload;\n\tfnTemplateFragment: (link: MdcLink) => Promise<Control | Control[]>;\n\t_fetchLinkCustomData: (_oLink: MdcLink) => CustomData[] | undefined;\n\tfetchLinkItems: (oLink: MdcLink, oBindingContext: Context, oInfoLog: InfoLog) => Promise<object | null>;\n\t_getSemanticObjects: (oPayload: LinkDelegatePayload) => string[];\n\t_getLabelledByControl: (oControl: UI5Element) => UI5Element | undefined;\n\t_getLinkItemWithNewParameter: (\n\t\tservices: { shellServices: IShellServices; navigationService: NavigationService },\n\t\tquickViewDelegate: typeof SimpleLinkDelegate,\n\t\tmdcLinkToModify: {\n\t\t\tmdcLink: MdcLink;\n\t\t\tpayload: LinkDelegatePayload;\n\t\t\tlinkParametersFromSelectionVariant: Record<string, string>;\n\t\t\ttitleHasLink: boolean;\n\t\t\tmdcLinkItem: LinkItem;\n\t\t},\n\t\tappStateKey: string | undefined,\n\t\tselectionVariant: SelectionVariant\n\t) => Promise<boolean>;\n\t_findLinkType: (\n\t\tpayload: LinkDelegatePayload,\n\t\taLinkItems: LinkItem[]\n\t) => {\n\t\tlinkType: LinkType;\n\t\tlinkItem: LinkItem | undefined;\n\t};\n\tcalculatePayloadWithDynamicSemanticObjectsResolved: (link: MdcLink) => LinkDelegatePayload;\n\t_calculateSemanticAttributes: (\n\t\toBindingContext: Context,\n\t\toPayload: LinkDelegatePayload,\n\t\toInfoLog: InfoLog,\n\t\toLink: MdcLink\n\t) => { payload: LinkDelegatePayload; results: Record<string, Record<string, string>> };\n\t_getSemanticObjectUnavailableActions: (oPayload: LinkDelegatePayload) => (typeof SemanticObjectUnavailableAction)[];\n\tcheckPrimaryActionForHash: (shellServices: IShellServices, navLinks: NavigationLink[], hash: ParsedHash) => boolean;\n\t_convertSemanticObjectUnavailableAction: (\n\t\taSemanticObjectUnavailableActions: (typeof SemanticObjectUnavailableAction)[]\n\t) => Record<string, string[]> | undefined;\n\t_getSemanticObjectMappings: (oPayload: LinkDelegatePayload) => SemanticObjectMapping[];\n\t_convertSemanticObjectMapping: (\n\t\taSemanticObjectMappings: SemanticObjectMapping[]\n\t) => Record<string, Record<string, unknown>> | undefined;\n\t_RemoveTitleLinkFromTargets: (\n\t\tmdcLink: MdcLink,\n\t\tlinkItems: LinkItem[],\n\t\ttitleHasLink: boolean,\n\t\ttitleIntent: string | undefined\n\t) => boolean;\n\t_IsSemanticObjectDynamic: (aNewLinkCustomData: unknown[], oThis: typeof SimpleLinkDelegate) => boolean;\n\t_checkImplicitSemanticObjectMapping: (\n\t\tpayload: LinkDelegatePayload,\n\t\tpropertyPath: string | undefined,\n\t\tlineContext: Context,\n\t\tview: FEView\n\t) => void;\n\t_setFilterContextUrlForSelectionVariant: (\n\t\toView: FEView,\n\t\toSelectionVariant: SelectionVariant,\n\t\toNavigationService: NavigationService\n\t) => SelectionVariant;\n\t_retrieveNavigationTargets: (\n\t\tsAppStateKey: string,\n\t\toSemanticAttributes: Record<string, Record<string, string>>,\n\t\toPayload: LinkDelegatePayload,\n\t\toInfoLog: InfoLog,\n\t\toLink: MdcLink | undefined\n\t) => Promise<LinkItem[]>;\n\t_updatePayloadWithSemanticAttributes: (\n\t\taSemanticObjects: string[],\n\t\toInfoLog: InfoLog,\n\t\toContextObject: Record<string, unknown>,\n\t\toResults: RegisteredSemanticAttributes,\n\t\tmSemanticObjectMappings?: Record<string, Record<string, unknown>>\n\t) => void;\n\t_getAppStateKeyAndUrlParameters: (\n\t\t_this: typeof SimpleLinkDelegate,\n\t\tnavigationService: NavigationService,\n\t\tselectionVariant: SelectionVariant,\n\t\tsemanticObject: string\n\t) => Promise<string[]>;\n\t_getPayloadWithDynamicSemanticObjectsResolved: (\n\t\tpayload: LinkDelegatePayload,\n\t\tlinkCustomData: CustomData[] | undefined\n\t) => LinkDelegatePayload | undefined;\n\t_getSemanticObjectCustomDataValue: (aLinkCustomData: CustomData[], oSemanticObjectsResolved: Record<string, { value: string }>) => void;\n\t_setObjectMappings: (\n\t\tsSemanticObject: string,\n\t\toParams: Record<string, string>,\n\t\taSemanticObjectMappings: RegisteredSemanticObjectMappings,\n\t\toSelectionVariant: SelectionVariant\n\t) => { params: Record<string, string>; hasChanged: boolean; selectionVariant: SelectionVariant };\n\t_removeTechnicalParameters: (oSelectionVariant: SelectionVariant) => void;\n\t_setPayloadWithDynamicSemanticObjectsResolved: (payload: LinkDelegatePayload, newPayload: LinkDelegatePayload) => LinkDelegatePayload;\n\t_getLineContext: (oView: FEView, mLineContext: Context | undefined) => Context;\n\t_removeEmptyLinkItem: (aLinkItems: LinkItem[]) => LinkItem[];\n\t_updateSemanticObjectsForMappings: (\n\t\tmdcPayload: LinkDelegatePayload,\n\t\tmdcPayloadWithDynamicSemanticObjectsResolved: LinkDelegatePayload,\n\t\tnewPayload: LinkDelegatePayload\n\t) => void;\n\t_isDynamicPath: (pathOrValue: string) => boolean;\n\t_updatePayloadWithResolvedSemanticObjectValue: (newPayload: LinkDelegatePayload, semanticObjectName: string | undefined) => void;\n\t_createNewPayloadWithDynamicSemanticObjectsResolved: (\n\t\tpayload: LinkDelegatePayload,\n\t\tsemanticObjectsResolved: Record<string, { value: string }>,\n\t\tnewPayload: LinkDelegatePayload\n\t) => void;\n\t_updateSemanticObjectsUnavailableActions: (\n\t\tmdcPayload: LinkDelegatePayload,\n\t\tmdcPayloadSemanticObjectUnavailableActions: RegisteredSemanticObjectUnavailableAction[],\n\t\tmdcPayloadWithDynamicSemanticObjectsResolved: LinkDelegatePayload\n\t) => void;\n\t_removeEmptySemanticObjectsMappings: (mdcPayloadWithDynamicSemanticObjectsResolved: LinkDelegatePayload) => void;\n};\n\nSimpleLinkDelegate.apiVersion = 2;\nconst CONSTANTS = {\n\tiLinksShownInPopup: 3,\n\tsapmLink: \"sap.m.Link\",\n\tsapuimdcLink: \"sap.ui.mdc.Link\",\n\tsapuimdclinkLinkItem: \"sap.ui.mdc.link.LinkItem\",\n\tsapmObjectIdentifier: \"sap.m.ObjectIdentifier\",\n\tsapmObjectStatus: \"sap.m.ObjectStatus\"\n};\nSimpleLinkDelegate.getConstants = function (): typeof CONSTANTS {\n\treturn CONSTANTS;\n};\n\n/**\n * This will return an array of the SemanticObjects as strings given by the payload.\n * @private\n * @param oPayload The payload defined by the application\n * @param oMetaModel The ODataMetaModel received from the Link\n * @returns The context pointing to the current EntityType.\n */\nSimpleLinkDelegate._getEntityType = function (oPayload: LinkDelegatePayload, oMetaModel: ODataMetaModel): Context | undefined {\n\tif (oMetaModel) {\n\t\treturn oMetaModel.createBindingContext(oPayload.entityType!) ?? undefined;\n\t} else {\n\t\treturn undefined;\n\t}\n};\n/**\n * This will return an array of the SemanticObjects as strings given by the payload.\n * @private\n * @param oPayload The payload defined by the application\n * @param oMetaModel The ODataMetaModel received from the Link\n * @returns A model containing the payload information\n */\nSimpleLinkDelegate._getSemanticsModel = function (\n\toPayload: LinkDelegatePayload,\n\toMetaModel: ODataMetaModel | undefined\n): JSONModel | undefined {\n\tif (oMetaModel) {\n\t\treturn new JSONModel(oPayload);\n\t} else {\n\t\treturn undefined;\n\t}\n};\n/**\n * This will return an array of the SemanticObjects as strings given by the payload.\n * @private\n * @param oPayload The payload defined by the application\n * @param oMetaModel The ODataMetaModel received from the Link\n * @returns An array containing SemanticObjects based of the payload\n */\nSimpleLinkDelegate._getDataField = function (oPayload: LinkDelegatePayload, oMetaModel: ODataMetaModel): Context | undefined {\n\treturn oMetaModel.createBindingContext(oPayload.dataField!) ?? undefined;\n};\n/**\n * This will return an array of the SemanticObjects as strings given by the payload.\n * @private\n * @param oPayload The payload defined by the application\n * @param oMetaModel The ODataMetaModel received from the Link\n * @returns Ancontaining SemanticObjects based of the payload\n */\nSimpleLinkDelegate._getContact = function (oPayload: LinkDelegatePayload, oMetaModel: ODataMetaModel): Context | undefined {\n\treturn oMetaModel.createBindingContext(oPayload.contact!) ?? undefined;\n};\n\nSimpleLinkDelegate.preparePayload = function (link: MdcLink): LinkDelegatePayload {\n\t// payload has been modified by fetching Semantic Objects names with path\n\tconst payload: LinkDelegatePayload = SimpleLinkDelegate.calculatePayloadWithDynamicSemanticObjectsResolved(link);\n\tif (!payload.LinkId) {\n\t\tpayload.LinkId = this.oControl?.isA<MdcLink>(CONSTANTS.sapuimdcLink) ? this.oControl.getId() : undefined;\n\t}\n\n\tif (payload.LinkId) {\n\t\tpayload.titleLink = this.oControl.getModel(\"$sapuimdcLink\")?.getProperty(\"/titleLinkHref\");\n\t}\n\treturn payload;\n};\n\nSimpleLinkDelegate.fnTemplateFragment = async function (link: MdcLink): Promise<Control> {\n\tconst containingView = CommonUtils.getTargetView(link);\n\tconst appComponent = CommonUtils.getAppComponent(containingView);\n\tlet fragmentName = \"\";\n\tconst preProcessorSettings: {\n\t\tbindingContexts: {\n\t\t\tdataField?: Context;\n\t\t\tentitySet?: Context;\n\t\t\tmetaModel?: Context;\n\t\t\tentityType?: Context;\n\t\t\tsemantic?: Context;\n\t\t\tconverterContext?: Context;\n\t\t\tviewData?: Context;\n\t\t};\n\t\tmodels: {\n\t\t\tdataField?: ODataMetaModel;\n\t\t\tentitySet?: ODataMetaModel;\n\t\t\tmetaModel?: ODataMetaModel;\n\t\t\tentityType?: ODataMetaModel;\n\t\t\tsemantic?: JSONModel;\n\t\t\tconverterContext?: JSONModel;\n\t\t\tviewData?: object;\n\t\t};\n\t\tappComponent: AppComponent;\n\t} = { bindingContexts: {}, models: {}, appComponent };\n\n\tconst oPayloadToUse = SimpleLinkDelegate.preparePayload(link);\n\n\tconst oSemanticsModel = this._getSemanticsModel(oPayloadToUse, this.oMetaModel);\n\tthis.semanticModel = oSemanticsModel;\n\n\tif (oPayloadToUse.entityType && this._getEntityType(oPayloadToUse, this.oMetaModel) && oSemanticsModel) {\n\t\tfragmentName = \"sap.fe.macros.quickView.fragments.QuickViewForEntity\";\n\t\tpreProcessorSettings.bindingContexts = {\n\t\t\tentityType: this._getEntityType(oPayloadToUse, this.oMetaModel),\n\t\t\tsemantic: oSemanticsModel.createBindingContext(\"/\")\n\t\t};\n\t\tpreProcessorSettings.models = {\n\t\t\tentityType: this.oMetaModel,\n\t\t\tsemantic: oSemanticsModel\n\t\t};\n\t} else if (oPayloadToUse.dataField && this._getDataField(oPayloadToUse, this.oMetaModel) && oSemanticsModel) {\n\t\tfragmentName = \"sap.fe.macros.quickView.fragments.QuickViewForDataField\";\n\t\tpreProcessorSettings.bindingContexts = {\n\t\t\tdataField: this._getDataField(oPayloadToUse, this.oMetaModel),\n\t\t\tsemantic: oSemanticsModel.createBindingContext(\"/\")\n\t\t};\n\t\tpreProcessorSettings.models = {\n\t\t\tdataField: this.oMetaModel,\n\t\t\tsemantic: oSemanticsModel\n\t\t};\n\t}\n\n\tpreProcessorSettings.models.entitySet = this.oMetaModel;\n\tpreProcessorSettings.models.metaModel = this.oMetaModel;\n\tpreProcessorSettings.models.converterContext = containingView.getModel(\"_pageModel\");\n\tpreProcessorSettings.bindingContexts.converterContext = preProcessorSettings.models.converterContext.createBindingContext(\"/\");\n\n\tif (this.oControl && this.oControl.getModel(\"viewData\")) {\n\t\tpreProcessorSettings.models.viewData = this.oControl.getModel(\"viewData\");\n\t\tpreProcessorSettings.bindingContexts.viewData = this.oControl.getModel(\"viewData\")?.createBindingContext(\"/\");\n\t}\n\n\tconst fragment = XMLTemplateProcessor.loadTemplate(fragmentName, \"fragment\");\n\tconst templatedFragment = await XMLPreprocessor.process(fragment, { name: fragmentName }, preProcessorSettings);\n\tconst templateComponent = containingView.getController().getOwnerComponent() as EnhanceWithUI5<TemplateComponent>;\n\tconst popoverContent = (await templateComponent.runAsOwner(async (): Promise<Control> => {\n\t\treturn (await Fragment.load({\n\t\t\tdefinition: templatedFragment as unknown as string,\n\t\t\tcontroller: containingView.getController()\n\t\t})) as Control;\n\t})) as Control;\n\tif (popoverContent) {\n\t\tif (preProcessorSettings.models && preProcessorSettings.models.semantic) {\n\t\t\tpopoverContent.setModel(preProcessorSettings.models.semantic, \"semantic\");\n\t\t\tpopoverContent.setBindingContext(preProcessorSettings.bindingContexts.semantic, \"semantic\");\n\t\t}\n\n\t\tif (preProcessorSettings.bindingContexts && preProcessorSettings.bindingContexts.entityType) {\n\t\t\tpopoverContent.setModel(preProcessorSettings.models.entityType, \"entityType\");\n\t\t\tpopoverContent.setBindingContext(preProcessorSettings.bindingContexts.entityType, \"entityType\");\n\t\t}\n\t}\n\treturn popoverContent;\n};\n\n/**\n * Retrieves and returns the relevant <code>additionalContent</code> for the <code>Link</code> control as an array.\n * @public\n * @param mdcLinkControl Instance of the <code>Link</code> control\n * @returns Once the promise resolves, an array of {@link sap.ui.core.Control} is returned\n */\nSimpleLinkDelegate.fetchAdditionalContent = async function (mdcLinkControl: MdcLink): Promise<Control[]> {\n\tconst payLoad = mdcLinkControl.getPayload() as LinkDelegatePayload;\n\tthis.oControl = mdcLinkControl;\n\tconst aNavigateRegexpMatch = payLoad?.navigationPath?.match(/{(.*?)}/);\n\tconst listBinding = (mdcLinkControl.getBindingContext() as ODataV4Context)?.getBinding() as ODataListBinding;\n\tconst aggregation = listBinding?.getAggregation && (listBinding.getAggregation() as { hierarchyQualifier?: string } | undefined);\n\tconst isListBindingAnalytical = aggregation !== undefined && !aggregation.hierarchyQualifier;\n\tconst modelParameters = isListBindingAnalytical ? { $$ownRequest: true } : undefined;\n\tconst bindingContext =\n\t\taNavigateRegexpMatch && aNavigateRegexpMatch.length > 1 && aNavigateRegexpMatch[1]\n\t\t\t? mdcLinkControl\n\t\t\t\t\t.getModel()\n\t\t\t\t\t?.bindContext(aNavigateRegexpMatch[1], mdcLinkControl.getBindingContext() || undefined, modelParameters)\n\t\t\t: null;\n\tthis.payload = payLoad;\n\tthis.oMetaModel = mdcLinkControl.getModel()?.getMetaModel() as ODataMetaModel;\n\tconst popoverContent = (await this.fnTemplateFragment(mdcLinkControl)) as Control;\n\tif (bindingContext) {\n\t\tconst boundContext = bindingContext.getBoundContext();\n\t\tif (boundContext) {\n\t\t\tpopoverContent.setBindingContext(boundContext);\n\t\t}\n\t}\n\treturn [popoverContent];\n};\nSimpleLinkDelegate._fetchLinkCustomData = function (_oLink: MdcLink): CustomData[] | undefined {\n\tif (\n\t\t_oLink.getParent() &&\n\t\t_oLink.isA(CONSTANTS.sapuimdcLink) &&\n\t\t(_oLink.getParent()?.isA(CONSTANTS.sapmLink) ||\n\t\t\t_oLink.getParent()?.isA(CONSTANTS.sapmObjectIdentifier) ||\n\t\t\t_oLink.getParent()?.isA(CONSTANTS.sapmObjectStatus) ||\n\t\t\t_oLink.getParent()?.isA(\"sap.fe.macros.controls.TextLink\"))\n\t) {\n\t\treturn _oLink.getCustomData();\n\t} else {\n\t\treturn undefined;\n\t}\n};\n/**\n * Fetches the relevant {@link sap.ui.mdc.link.LinkItem} for the Link and returns them.\n * @public\n * @param oLink The Payload of the Link given by the application\n * @param oBindingContext The ContextObject of the Link\n * @param oInfoLog The InfoLog of the Link\n * @returns Once the promise resolves an array of {@link sap.ui.mdc.link.LinkItem} is returned\n */\nSimpleLinkDelegate.fetchLinkItems = async function (\n\toLink: MdcLink,\n\toBindingContext: Context,\n\toInfoLog: InfoLog\n): Promise<LinkItem[] | null> {\n\tconst oPayload = oLink.getPayload() as LinkDelegatePayload;\n\tif (oBindingContext && SimpleLinkDelegate._getSemanticObjects(oPayload)) {\n\t\tif (oInfoLog) {\n\t\t\toInfoLog.initialize(SimpleLinkDelegate._getSemanticObjects(oPayload));\n\t\t}\n\t\tconst _oLinkCustomData = this._link && this._fetchLinkCustomData(this._link);\n\t\tthis.aLinkCustomData =\n\t\t\t_oLinkCustomData &&\n\t\t\tthis._fetchLinkCustomData(this._link!)?.map(function (linkItem: CustomData) {\n\t\t\t\treturn linkItem.getValue() as unknown;\n\t\t\t});\n\n\t\t//here oContext is the context of the link\n\t\tconst oSemanticAttributesResolved = SimpleLinkDelegate._calculateSemanticAttributes(oBindingContext, oPayload, oInfoLog, oLink);\n\t\tconst oSemanticAttributes = oSemanticAttributesResolved.results;\n\t\tconst oPayloadResolved = oSemanticAttributesResolved.payload;\n\n\t\treturn SimpleLinkDelegate._retrieveNavigationTargets(\"\", oSemanticAttributes, oPayloadResolved, oInfoLog, this._link).then(\n\t\t\tfunction (aLinks: LinkItem[] /*oOwnNavigationLink: any*/) {\n\t\t\t\treturn aLinks.length === 0 ? null : aLinks;\n\t\t\t}\n\t\t);\n\t} else {\n\t\treturn Promise.resolve(null);\n\t}\n};\n\n/**\n * Find the type of the link.\n * @param payload The payload of the mdc link.\n * @param aLinkItems Links returned by call to mdc _retrieveUnmodifiedLinkItems.\n * @returns The type of the link as defined by mdc.\n */\nSimpleLinkDelegate._findLinkType = function (\n\tpayload: LinkDelegatePayload,\n\taLinkItems: LinkItem[]\n): {\n\tlinkType: LinkType;\n\tlinkItem: LinkItem | undefined;\n} {\n\tlet nLinkType, oLinkItem;\n\tif (aLinkItems?.length === 1) {\n\t\toLinkItem = new LinkItem({\n\t\t\ttext: aLinkItems[0].getText(),\n\t\t\thref: aLinkItems[0].getHref()\n\t\t});\n\t\tnLinkType = payload.hasQuickViewFacets === \"false\" ? LinkType.DirectLink : LinkType.Popover;\n\t} else if (payload.hasQuickViewFacets === \"false\" && aLinkItems?.length === 0) {\n\t\tnLinkType = LinkType.Text;\n\t} else {\n\t\tnLinkType = LinkType.Popover;\n\t}\n\treturn {\n\t\tlinkType: nLinkType,\n\t\tlinkItem: oLinkItem\n\t};\n};\n\n/**\n * Calculates and returns the type of link that is displayed.\n * @public\n * @param oLink Instance of the <code>Link</code>\n * @returns Once the promise resolves, an object containing an initial {@link sap.ui.mdc.link.LinkType} and an optional <code>Promise</code> are returned.\n * The optional <code>Promise</code> also returns a {@link sap.ui.mdc.link.LinkType} object.\n * Once the optional <code>Promise</code> has been resolved, the returned {@link sap.ui.mdc.link.LinkType} overwrites the <code>initialType</code>.\n */\nSimpleLinkDelegate.fetchLinkType = async function (oLink: FELink): Promise<LinkTypeWrapper> {\n\tconst _oCurrentLink = oLink;\n\tconst _oPayload = Object.assign({}, oLink.getPayload()) as LinkDelegatePayload;\n\tlet oDefaultInitialType: LinkTypeWrapper = {\n\t\tinitialType: {\n\t\t\ttype: LinkType.Popover,\n\t\t\tdirectLink: undefined as unknown as LinkItem\n\t\t},\n\t\truntimeType: undefined as unknown as Promise<MdcLinkType>\n\t};\n\t// clean appStateKeyMap storage\n\tif (!this.appStateKeyMap) {\n\t\tthis.appStateKeyMap = {};\n\t}\n\n\ttry {\n\t\tif (_oPayload?.semanticObjects) {\n\t\t\tthis._link = oLink;\n\t\t\tlet aLinkItems = await _oCurrentLink._retrieveUnmodifiedLinkItems();\n\t\t\tif (aLinkItems.length === 1) {\n\t\t\t\t// This is the direct navigation use case so we need to perform the appropriate checks / transformations\n\t\t\t\taLinkItems = await _oCurrentLink.retrieveLinkItems();\n\t\t\t}\n\t\t\tconst _LinkType = SimpleLinkDelegate._findLinkType(_oPayload, aLinkItems);\n\t\t\treturn {\n\t\t\t\tinitialType: {\n\t\t\t\t\ttype: _LinkType.linkType,\n\t\t\t\t\tdirectLink: (_LinkType.linkItem ? _LinkType.linkItem : undefined) as unknown as LinkItem // Yes stupid type somewhere\n\t\t\t\t},\n\t\t\t\truntimeType: undefined as unknown as Promise<MdcLinkType>\n\t\t\t};\n\t\t} else if (_oPayload?.contact?.length && _oPayload?.contact?.length > 0) {\n\t\t\treturn oDefaultInitialType;\n\t\t} else if (_oPayload?.entityType && _oPayload?.navigationPath) {\n\t\t\treturn oDefaultInitialType;\n\t\t}\n\t\toDefaultInitialType = undefined as unknown as LinkTypeWrapper;\n\t\tthrow new Error(\"no payload or semanticObjects found\");\n\t} catch (oError: unknown) {\n\t\tLog.error(\"Error in SimpleLinkDelegate.fetchLinkType: \", oError as string);\n\t}\n\treturn oDefaultInitialType;\n};\n\nSimpleLinkDelegate._RemoveTitleLinkFromTargets = function (\n\tmdcLink: MdcLink,\n\tlinkItems: LinkItem[],\n\ttitleHasLink: boolean,\n\ttitleIntent: string | undefined\n): boolean {\n\tlet titleLinkHref;\n\tlet result = false;\n\tif (titleHasLink && titleIntent && linkItems.length) {\n\t\tconst linkIntentWithoutParameters = `#${linkItems[0].getProperty(\"key\")}`;\n\t\tconst titleIntentWithoutParameters = titleIntent.split(\"?\")[0];\n\t\tconst linkIsPrimaryAction = titleIntentWithoutParameters === linkIntentWithoutParameters;\n\t\tif (linkIsPrimaryAction) {\n\t\t\ttitleLinkHref = linkItems[0].getProperty(\"href\");\n\t\t\tthis.payload.titleLinkhref = titleLinkHref;\n\t\t\tconst mdcLinkModel = mdcLink.getModel(\"$sapuimdcLink\");\n\t\t\t(mdcLinkModel as JSONModel).setProperty(\"/titleLinkHref\", titleLinkHref);\n\t\t\tconst aMLinkItems = mdcLinkModel?.getProperty(\"/linkItems\").filter(function (linkItemFromMdc: LinkItem) {\n\t\t\t\tif (`#${linkItemFromMdc.key}` !== linkIntentWithoutParameters) {\n\t\t\t\t\treturn linkItemFromMdc;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (aMLinkItems && aMLinkItems.length > 0) {\n\t\t\t\t(mdcLinkModel as JSONModel).setProperty(\"/linkItems/\", aMLinkItems);\n\t\t\t}\n\t\t\tresult = true;\n\t\t}\n\t}\n\treturn result;\n};\nSimpleLinkDelegate._IsSemanticObjectDynamic = function (aNewLinkCustomData: unknown[], oThis: typeof SimpleLinkDelegate): boolean {\n\tif (aNewLinkCustomData && oThis.aLinkCustomData) {\n\t\treturn (\n\t\t\toThis.aLinkCustomData.filter(function (link: unknown) {\n\t\t\t\treturn (\n\t\t\t\t\taNewLinkCustomData.filter(function (otherLink: unknown) {\n\t\t\t\t\t\treturn otherLink !== link;\n\t\t\t\t\t}).length > 0\n\t\t\t\t);\n\t\t\t}).length > 0\n\t\t);\n\t} else {\n\t\treturn false;\n\t}\n};\nSimpleLinkDelegate._getLineContext = function (oView: FEView, mLineContext: Context | undefined): Context {\n\tif (!mLineContext) {\n\t\tif (\n\t\t\t(oView.getAggregation(\"content\") as ManagedObject[])[0] &&\n\t\t\t(oView.getAggregation(\"content\") as ManagedObject[])[0].getBindingContext()\n\t\t) {\n\t\t\treturn (oView.getAggregation(\"content\") as ManagedObject[])[0].getBindingContext()!;\n\t\t}\n\t}\n\treturn mLineContext!;\n};\nSimpleLinkDelegate._setFilterContextUrlForSelectionVariant = function (\n\toView: FEView,\n\toSelectionVariant: SelectionVariant,\n\toNavigationService: NavigationService\n): SelectionVariant {\n\tif (oView.getViewData().entitySet && oSelectionVariant) {\n\t\tconst sContextUrl = oNavigationService.constructContextUrl(oView.getViewData().entitySet!, oView.getModel());\n\t\toSelectionVariant.setFilterContextUrl(sContextUrl);\n\t}\n\treturn oSelectionVariant;\n};\n\nSimpleLinkDelegate._setObjectMappings = function (\n\tsSemanticObject: string,\n\toParams: Record<string, string>,\n\taSemanticObjectMappings: RegisteredSemanticObjectMappings,\n\toSelectionVariant: SelectionVariant\n): { params: Record<string, string>; hasChanged: boolean; selectionVariant: SelectionVariant } {\n\tlet hasChanged = false;\n\tconst modifiedSelectionVariant = new SelectionVariant(oSelectionVariant.toJSONObject());\n\t// if semanticObjectMappings has items with dynamic semanticObjects we need to resolve them using oParams\n\taSemanticObjectMappings.forEach(function (mapping) {\n\t\tlet mappingSemanticObject = mapping.semanticObject;\n\t\tconst mappingSemanticObjectPath = getDynamicPathFromSemanticObject(mapping.semanticObject);\n\t\tif (mappingSemanticObjectPath && oParams[mappingSemanticObjectPath]) {\n\t\t\tmappingSemanticObject = oParams[mappingSemanticObjectPath];\n\t\t}\n\t\tif (sSemanticObject === mappingSemanticObject) {\n\t\t\tconst oMappings = mapping.items;\n\t\t\tfor (const i in oMappings) {\n\t\t\t\tconst sLocalProperty = oMappings[i].key;\n\t\t\t\tconst sSemanticObjectProperty = oMappings[i].value;\n\t\t\t\tif (sLocalProperty !== sSemanticObjectProperty) {\n\t\t\t\t\tif (oParams[sLocalProperty]) {\n\t\t\t\t\t\tmodifiedSelectionVariant.removeParameter(sSemanticObjectProperty);\n\t\t\t\t\t\tmodifiedSelectionVariant.removeSelectOption(sSemanticObjectProperty);\n\t\t\t\t\t\tmodifiedSelectionVariant.renameParameter(sLocalProperty, sSemanticObjectProperty);\n\t\t\t\t\t\tmodifiedSelectionVariant.renameSelectOption(sLocalProperty, sSemanticObjectProperty);\n\t\t\t\t\t\toParams[sSemanticObjectProperty] = oParams[sLocalProperty];\n\t\t\t\t\t\tdelete oParams[sLocalProperty];\n\t\t\t\t\t\thasChanged = true;\n\t\t\t\t\t}\n\t\t\t\t\t// We remove the parameter as there is no value\n\n\t\t\t\t\t// The local property comes from a navigation property\n\t\t\t\t\telse if (sLocalProperty.split(\"/\").length > 1) {\n\t\t\t\t\t\t// find the property to be removed\n\t\t\t\t\t\t//1. If the property name also exist without nav, we need to look for a select option that looks like\n\t\t\t\t\t\t// contextEntity.navProperty.property\n\t\t\t\t\t\tlet localPropertySelectOptionName = modifiedSelectionVariant.getSelectOptionsPropertyNames().find((property) => {\n\t\t\t\t\t\t\treturn property.includes(sLocalProperty.replace(\"/\", \".\"));\n\t\t\t\t\t\t});\n\t\t\t\t\t\t//2. there is no property named the same on the contextEntity so the selectOption is named property\n\t\t\t\t\t\tlocalPropertySelectOptionName = localPropertySelectOptionName\n\t\t\t\t\t\t\t? localPropertySelectOptionName\n\t\t\t\t\t\t\t: sLocalProperty.split(\"/\").slice(-1)[0];\n\t\t\t\t\t\tif (!oParams[localPropertySelectOptionName]) {\n\t\t\t\t\t\t\t// The navigation property has no value\n\t\t\t\t\t\t\tdelete oParams[localPropertySelectOptionName];\n\t\t\t\t\t\t\tmodifiedSelectionVariant.removeParameter(localPropertySelectOptionName);\n\t\t\t\t\t\t\tmodifiedSelectionVariant.removeSelectOption(localPropertySelectOptionName);\n\t\t\t\t\t\t} else if (localPropertySelectOptionName !== sSemanticObjectProperty) {\n\t\t\t\t\t\t\t// The navigation property has a value and properties names are different\n\t\t\t\t\t\t\tmodifiedSelectionVariant.removeParameter(sSemanticObjectProperty);\n\t\t\t\t\t\t\tmodifiedSelectionVariant.removeSelectOption(sSemanticObjectProperty);\n\t\t\t\t\t\t\tmodifiedSelectionVariant.renameParameter(localPropertySelectOptionName, sSemanticObjectProperty);\n\t\t\t\t\t\t\tmodifiedSelectionVariant.renameSelectOption(localPropertySelectOptionName, sSemanticObjectProperty);\n\t\t\t\t\t\t\toParams[sSemanticObjectProperty] = oParams[localPropertySelectOptionName];\n\t\t\t\t\t\t\tdelete oParams[localPropertySelectOptionName];\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdelete oParams[sLocalProperty];\n\t\t\t\t\t\tmodifiedSelectionVariant.removeParameter(sSemanticObjectProperty);\n\t\t\t\t\t\tmodifiedSelectionVariant.removeSelectOption(sSemanticObjectProperty);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\treturn { params: oParams, hasChanged, selectionVariant: modifiedSelectionVariant };\n};\n\n/**\n * Call getAppStateKeyAndUrlParameters in navigation service and cache its results.\n * @param _this The instance of quickviewdelegate.\n * @param navigationService The navigation service.\n * @param selectionVariant The current selection variant.\n * @param semanticObject The current semanticObject.\n * @returns A promise with the semanticAttributes and appstatekey.\n */\nSimpleLinkDelegate._getAppStateKeyAndUrlParameters = async function (\n\t_this: typeof SimpleLinkDelegate,\n\tnavigationService: NavigationService,\n\tselectionVariant: SelectionVariant,\n\tsemanticObject: string\n): Promise<string[]> {\n\tlet aValues = [];\n\n\t// check if default cache contains already the unmodified selectionVariant\n\tif (deepEqual(selectionVariant, _this.appStateKeyMap[\"\"]?.selectionVariant)) {\n\t\tconst defaultCache = _this.appStateKeyMap[\"\"];\n\t\treturn [defaultCache.semanticAttributes!, defaultCache.appstatekey!];\n\t}\n\t// update url parameters because there is a change in selection variant\n\tif (\n\t\t_this.appStateKeyMap[`${semanticObject}`] === undefined ||\n\t\t!deepEqual(_this.appStateKeyMap[`${semanticObject}`].selectionVariant, selectionVariant)\n\t) {\n\t\taValues = await toES6Promise<string[]>(navigationService.getAppStateKeyAndUrlParameters(selectionVariant.toJSONString()));\n\t\t_this.appStateKeyMap[`${semanticObject}`] = {\n\t\t\tsemanticAttributes: aValues[0],\n\t\t\tappstatekey: aValues[1],\n\t\t\tselectionVariant: selectionVariant\n\t\t};\n\t} else {\n\t\tconst cache = _this.appStateKeyMap[`${semanticObject}`];\n\t\taValues = [cache.semanticAttributes!, cache.appstatekey!];\n\t}\n\treturn aValues;\n};\n\nSimpleLinkDelegate._getLinkItemWithNewParameter = async function (\n\tservices: { shellServices: IShellServices; navigationService: NavigationService },\n\tquickViewDelegate: typeof SimpleLinkDelegate,\n\tmdcLinkToModify: {\n\t\tmdcLink: MdcLink;\n\t\tpayload: LinkDelegatePayload;\n\t\tlinkParametersFromSelectionVariant: Record<string, string>;\n\t\ttitleHasLink: boolean;\n\t\tmdcLinkItem: LinkItem;\n\t},\n\tappStateKey: string | undefined,\n\tselectionVariant: SelectionVariant\n): Promise<boolean> {\n\tconst mdcLinkItemHash = await services.shellServices.expandCompactHash(mdcLinkToModify.mdcLinkItem.getHref());\n\tconst shellHash = services.shellServices.parseShellHash(mdcLinkItemHash);\n\tconst params = Object.assign({}, mdcLinkToModify.linkParametersFromSelectionVariant);\n\tlet titleIntent: string | undefined;\n\tconst { params: oNewParams } = SimpleLinkDelegate._setObjectMappings(\n\t\tshellHash.semanticObject,\n\t\tparams,\n\t\tmdcLinkToModify.payload.semanticObjectMappings,\n\t\tselectionVariant\n\t);\n\tdelete oNewParams[\"sap-xapp-state\"];\n\tdelete oNewParams[\"@odata.etag\"];\n\tconst updatedParameters = {\n\t\tsemanticObject: shellHash.semanticObject,\n\t\taction: shellHash.action,\n\t\tparams: oNewParams,\n\t\tappStateKey: appStateKey\n\t};\n\tconst linksUpdatedWithParameters = await services.shellServices.getLinks([updatedParameters]);\n\tconst intentModified = linksUpdatedWithParameters && linksUpdatedWithParameters[0] && linksUpdatedWithParameters[0][0].intent;\n\tmdcLinkToModify.mdcLinkItem.setHref(intentModified);\n\t// The link is removed from the target list because the title link has same target.\n\tif (\n\t\tmdcLinkToModify.payload.semanticPrimaryActions &&\n\t\tmdcLinkToModify.payload.semanticPrimaryActions.some((action) => action !== null)\n\t) {\n\t\tconst { primaryIntentFound } = FieldHelper.findPrimaryActionWithinIntents(\n\t\t\tmdcLinkToModify.payload.semanticPrimaryActions,\n\t\t\tmdcLinkToModify.payload\n\t\t);\n\t\ttitleIntent = primaryIntentFound ? primaryIntentFound.intent ?? \"\" : undefined;\n\t}\n\treturn SimpleLinkDelegate._RemoveTitleLinkFromTargets.bind(quickViewDelegate)(\n\t\tmdcLinkToModify.mdcLink,\n\t\t[mdcLinkToModify.mdcLinkItem],\n\t\tmdcLinkToModify.titleHasLink,\n\t\ttitleIntent\n\t);\n};\nSimpleLinkDelegate._removeEmptyLinkItem = function (aLinkItems: LinkItem[]): LinkItem[] {\n\treturn aLinkItems.filter((linkItem: LinkItem) => {\n\t\treturn linkItem !== undefined;\n\t});\n};\n\n/**\n * Update the payload with semantic object mapping if a semantic object is present with no mapping.\n * This is to ensure that the semantic object is passed with the corresponding property's value if no explicit mapping exists.\n * @private\n * @param payload The new updated payload.\n * @param propertyPath The property path for which the semantic object is mapped\n * @param lineContext Context for the row\n * @param view View\n */\nSimpleLinkDelegate._checkImplicitSemanticObjectMapping = function (\n\tpayload: LinkDelegatePayload,\n\tpropertyPath: string | undefined,\n\tlineContext: Context,\n\tview: FEView\n): void {\n\tif (!propertyPath) {\n\t\treturn;\n\t}\n\t//We ensure to remove the sensitive data so that we do not add the semanticobject mappings to the payload if they are sensitive\n\t//Also we have to remove these before processSemanticAttributes as semantic object mappings are used in it.\n\tconst lineContextData = view.getController()._intentBasedNavigation.removeSensitiveData(\n\t\tlineContext.getObject(),\n\t\tview\n\t\t\t.getModel()\n\t\t\t.getMetaModel()\n\t\t\t.getMetaPath(lineContext?.getPath() || \"\"),\n\t\tview.getModel().getMetaModel()\n\t);\n\tif (Object.keys(lineContextData)?.includes(propertyPath)) {\n\t\tpayload.semanticObjects?.forEach((semanticObject: string) => {\n\t\t\tconst filteredSemanticObjectMappings = payload.semanticObjectMappings.filter(\n\t\t\t\t(mapping: RegisteredSemanticObjectMapping) => mapping.semanticObject === semanticObject\n\t\t\t);\n\t\t\tif (!filteredSemanticObjectMappings.length) {\n\t\t\t\tpayload.semanticObjectMappings.push({\n\t\t\t\t\tsemanticObject: semanticObject,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tkey: propertyPath,\n\t\t\t\t\t\t\tvalue: semanticObject\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n};\n\n/**\n * Enables the modification of LinkItems before the popover opens. This enables additional parameters\n * to be added to the link.\n * @param mdcLink The Link control\n * @param oBindingContext The binding context of the Link\n * @param aLinkItems The LinkItems of the Link that can be modified\n * @returns Once resolved, an array of {@link sap.ui.mdc.link.LinkItem} is returned\n */\nSimpleLinkDelegate.modifyLinkItems = async function (\n\tmdcLink: MdcLink,\n\toBindingContext: Context,\n\taLinkItems: LinkItem[]\n): Promise<LinkItem[]> {\n\tif (aLinkItems.length !== 0) {\n\t\tthis.payload = mdcLink.getPayload() as LinkDelegatePayload;\n\t\tconst payloadResolved = SimpleLinkDelegate.calculatePayloadWithDynamicSemanticObjectsResolved(mdcLink);\n\t\tconst oView = CommonUtils.getTargetView(mdcLink);\n\t\tconst oAppComponent = CommonUtils.getAppComponent(oView);\n\t\tconst primaryActionIsActive = (await FieldHelper.checkPrimaryActions(payloadResolved, true, oAppComponent)) as {\n\t\t\ttitleLink: Partial<{ intent: string }>;\n\t\t\thasTitleLink: boolean;\n\t\t};\n\t\tconst bTitleHasLink: boolean = primaryActionIsActive.hasTitleLink;\n\t\tconst oShellServices = oAppComponent.getShellServices();\n\t\tif (!oShellServices.hasUShell()) {\n\t\t\tLog.error(\"QuickViewDelegate: Cannot retrieve the shell services\");\n\t\t\treturn Promise.reject();\n\t\t}\n\t\tconst oMetaModel = oView.getModel().getMetaModel();\n\t\tlet mLineContext = mdcLink.getBindingContext()!;\n\t\tconst oTargetInfo: { semanticObject: string; action: string; propertiesWithoutConflict?: string[]; linkContextPath?: string } = {\n\t\t\tsemanticObject: payloadResolved.semanticObjects[0],\n\t\t\taction: \"\"\n\t\t};\n\n\t\ttry {\n\t\t\tconst oNavigationService = oAppComponent.getNavigationService();\n\t\t\tconst oController = oView.getController();\n\t\t\tlet oSelectionVariant, mLineContextData;\n\t\t\tmLineContext = SimpleLinkDelegate._getLineContext(oView, mLineContext);\n\t\t\tconst sMetaPath = oMetaModel.getMetaPath(mLineContext?.getPath() || \"\");\n\t\t\tmLineContextData = mLineContext?.getObject();\n\t\t\tif (mLineContext) {\n\t\t\t\tconst propertyPath = this.payload?.dataFieldPropPath;\n\t\t\t\tconst pathsToRetain = [];\n\t\t\t\tSimpleLinkDelegate._checkImplicitSemanticObjectMapping(payloadResolved, propertyPath, mLineContext, oView);\n\t\t\t\t//We ensure that all the paths that are used in the semantic object mappings are retained to apply the mappings later on\n\t\t\t\tthis.payload.semanticObjectMappings.forEach((mappings: RegisteredSemanticObjectMapping) => {\n\t\t\t\t\tmappings.items.forEach((semanticMappingDef: { key: string; value: string }) => {\n\t\t\t\t\t\tpathsToRetain.push(semanticMappingDef.key);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tif (propertyPath) {\n\t\t\t\t\tpathsToRetain.push(propertyPath);\n\t\t\t\t}\n\t\t\t\tmLineContextData = oController._intentBasedNavigation.processSemanticAttributes(\n\t\t\t\t\tmLineContext,\n\t\t\t\t\tmLineContextData,\n\t\t\t\t\tpathsToRetain\n\t\t\t\t);\n\n\t\t\t\tmLineContextData = oController._intentBasedNavigation.removeSensitiveData(mLineContextData, sMetaPath, oMetaModel);\n\n\t\t\t\t//even if we retain the nav prop, this next line deltetes it\n\t\t\t\tmLineContextData = oController._intentBasedNavigation.prepareContextForExternalNavigation(mLineContextData, mLineContext);\n\t\t\t}\n\t\t\toSelectionVariant = oNavigationService.mixAttributesAndSelectionVariant(mLineContextData.semanticAttributes as object, {});\n\t\t\toTargetInfo.propertiesWithoutConflict = mLineContextData.propertiesWithoutConflict;\n\t\t\toTargetInfo.linkContextPath = mdcLink.getBindingContext()?.getPath();\n\t\t\t//calling this function before adaptNavigationContext to add filter context URL in selection variant\n\t\t\toSelectionVariant = SimpleLinkDelegate._setFilterContextUrlForSelectionVariant(oView, oSelectionVariant, oNavigationService);\n\n\t\t\t//TO modify the selection variant from the Extension API\n\t\t\toController.intentBasedNavigation.adaptNavigationContext(oSelectionVariant, oTargetInfo);\n\n\t\t\tSimpleLinkDelegate._removeTechnicalParameters(oSelectionVariant);\n\n\t\t\tconst oParams = oNavigationService.oNavHandler._getURLParametersFromSelectionVariant(oSelectionVariant);\n\t\t\tconst appStateKey = undefined;\n\n\t\t\tlet titleLinktoBeRemove: boolean;\n\t\t\taLinkItems = SimpleLinkDelegate._removeEmptyLinkItem(aLinkItems);\n\t\t\tfor (const index in aLinkItems) {\n\t\t\t\ttitleLinktoBeRemove = await SimpleLinkDelegate._getLinkItemWithNewParameter(\n\t\t\t\t\t{ shellServices: oShellServices, navigationService: oNavigationService },\n\t\t\t\t\tthis,\n\t\t\t\t\t{\n\t\t\t\t\t\tmdcLink: mdcLink,\n\t\t\t\t\t\tpayload: payloadResolved,\n\t\t\t\t\t\tlinkParametersFromSelectionVariant: oParams,\n\t\t\t\t\t\ttitleHasLink: bTitleHasLink,\n\t\t\t\t\t\tmdcLinkItem: aLinkItems[index]\n\t\t\t\t\t},\n\t\t\t\t\tappStateKey,\n\t\t\t\t\toSelectionVariant\n\t\t\t\t);\n\t\t\t\t// Do not remove the link if there is only one direct target application\n\t\t\t\tif (titleLinktoBeRemove === true && aLinkItems.length > 1) {\n\t\t\t\t\t(aLinkItems as (LinkItem | undefined)[])[index] = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn SimpleLinkDelegate._removeEmptyLinkItem(aLinkItems);\n\t\t} catch (oError) {\n\t\t\tLog.error(\"Error while getting the navigation service\", oError as string);\n\t\t\treturn [];\n\t\t}\n\t} else {\n\t\treturn aLinkItems;\n\t}\n};\nSimpleLinkDelegate.beforeNavigationCallback = async function (mdcLink: MdcLink, event: Event<{}, Link>): Promise<boolean> {\n\tconst source = event.getSource(),\n\t\thref = source.getHref(),\n\t\turlParsing = Factory.getService(\"URLParsing\"),\n\t\thash = href && urlParsing.parseShellHash(href);\n\n\tKeepAliveHelper.storeControlRefreshStrategyForHash(source, hash);\n\n\tconst view = CommonUtils.getTargetView(mdcLink);\n\tconst appComponent = CommonUtils.getAppComponent(view);\n\tconst navigationService = appComponent.getNavigationService();\n\n\tconst hashToNavigate = source.getHref();\n\tconst decomposedHash: DecomposedHash = urlParsing.parseShellHash(hashToNavigate);\n\n\tnavigationService.navigate(\n\t\tdecomposedHash && decomposedHash.semanticObject,\n\t\tdecomposedHash && decomposedHash.action,\n\t\tdecomposedHash && decomposedHash.params\n\t);\n\treturn Promise.resolve(false);\n};\nSimpleLinkDelegate._removeTechnicalParameters = function (oSelectionVariant: SelectionVariant): void {\n\toSelectionVariant.removeSelectOption(\"@odata.context\");\n\toSelectionVariant.removeSelectOption(\"@odata.metadataEtag\");\n\toSelectionVariant.removeSelectOption(\"SAP__Messages\");\n};\n\nSimpleLinkDelegate._getSemanticObjectCustomDataValue = function (\n\taLinkCustomData: CustomData[],\n\toSemanticObjectsResolved: Record<string, { value: string }>\n): void {\n\tlet sPropertyName: string, sCustomDataValue: string;\n\tfor (const element of aLinkCustomData) {\n\t\tsPropertyName = element.getKey();\n\t\tsCustomDataValue = element.getValue();\n\t\toSemanticObjectsResolved[sPropertyName] = { value: sCustomDataValue };\n\t}\n};\n\n/**\n * Check the semantic object name if it is dynamic or not.\n * @private\n * @param pathOrValue The semantic object path or name\n * @returns True if semantic object is dynamic\n */\nSimpleLinkDelegate._isDynamicPath = function (pathOrValue: string): boolean {\n\tconst expression = resolveBindingString(pathOrValue);\n\tif (expression._type === \"EmbeddedBinding\" || expression._type === \"EmbeddedExpressionBinding\") {\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n};\n\n/**\n * Update the payload with semantic object values from custom data of Link.\n * @private\n * @param newPayload The new updated payload.\n * @param semanticObjectName The semantic object name resolved.\n */\nSimpleLinkDelegate._updatePayloadWithResolvedSemanticObjectValue = function (\n\tnewPayload: LinkDelegatePayload,\n\tsemanticObjectName: string | undefined\n): void {\n\tswitch (typeof semanticObjectName) {\n\t\tcase \"string\":\n\t\t\tnewPayload.semanticObjectsResolved?.push(semanticObjectName);\n\t\t\tnewPayload.semanticObjects.push(semanticObjectName);\n\t\t\tbreak;\n\t\tcase \"object\":\n\t\t\tfor (const j in semanticObjectName as string[]) {\n\t\t\t\tnewPayload.semanticObjectsResolved?.push(semanticObjectName[j]);\n\t\t\t\tnewPayload.semanticObjects.push(semanticObjectName[j]);\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t}\n};\n\nSimpleLinkDelegate._createNewPayloadWithDynamicSemanticObjectsResolved = function (\n\tpayload: LinkDelegatePayload,\n\tsemanticObjectsResolved: Record<string, { value: string }>,\n\tnewPayload: LinkDelegatePayload\n): void {\n\tlet semanticObjectNameToResolve: string;\n\tconst fnFindQualifier = function (\n\t\tinternalQualifiers: Record<string, CompiledBindingToolkitExpression>,\n\t\tsemanticObject: string\n\t): string | undefined {\n\t\treturn Object.keys(internalQualifiers).find((key) => internalQualifiers[key] === semanticObject);\n\t};\n\tfor (const i in payload.semanticObjects) {\n\t\tsemanticObjectNameToResolve = payload.semanticObjects[i];\n\t\tif (SimpleLinkDelegate._isDynamicPath(semanticObjectNameToResolve)) {\n\t\t\tconst key = payload.qualifiers && fnFindQualifier(payload.qualifiers, semanticObjectNameToResolve);\n\t\t\tconst semanticObjectNameResolved = key && semanticObjectsResolved[key].value;\n\t\t\tSimpleLinkDelegate._updatePayloadWithResolvedSemanticObjectValue(newPayload, semanticObjectNameResolved);\n\t\t} else {\n\t\t\tnewPayload.semanticObjects.push(semanticObjectNameToResolve);\n\t\t}\n\t}\n};\n\n/**\n * Update the semantic object name from the resolved value for the mappings attributes.\n * @private\n * @param mdcPayload The payload given by the application.\n * @param mdcPayloadWithDynamicSemanticObjectsResolved The payload with the resolved value for the semantic object name.\n * @param newPayload The new updated payload.\n */\nSimpleLinkDelegate._updateSemanticObjectsForMappings = function (\n\tmdcPayload: LinkDelegatePayload,\n\tmdcPayloadWithDynamicSemanticObjectsResolved: LinkDelegatePayload,\n\tnewPayload: LinkDelegatePayload\n): void {\n\t// update the semantic object name from the resolved ones in the semantic object mappings.\n\tmdcPayloadWithDynamicSemanticObjectsResolved.semanticObjectMappings.forEach(function (\n\t\tsemanticObjectMapping: RegisteredSemanticObjectMapping\n\t) {\n\t\tif (semanticObjectMapping.semanticObject && SimpleLinkDelegate._isDynamicPath(semanticObjectMapping.semanticObject)) {\n\t\t\tsemanticObjectMapping.semanticObject =\n\t\t\t\tnewPayload.semanticObjects[mdcPayload.semanticObjects.indexOf(semanticObjectMapping.semanticObject)];\n\t\t}\n\t});\n};\n\n/**\n * Update the semantic object name from the resolved value for the unavailable actions.\n * @private\n * @param mdcPayload The payload given by the application.\n * @param mdcPayloadSemanticObjectUnavailableActions The unavailable actions given by the application.\n * @param mdcPayloadWithDynamicSemanticObjectsResolved The updated payload with the resolved value for the semantic object name for the unavailable actions.\n */\nSimpleLinkDelegate._updateSemanticObjectsUnavailableActions = function (\n\tmdcPayload: LinkDelegatePayload,\n\tmdcPayloadSemanticObjectUnavailableActions: RegisteredSemanticObjectUnavailableAction[],\n\tmdcPayloadWithDynamicSemanticObjectsResolved: LinkDelegatePayload\n): void {\n\tlet _Index: number;\n\tmdcPayloadSemanticObjectUnavailableActions.forEach(function (\n\t\tsemanticObjectUnavailableAction: RegisteredSemanticObjectUnavailableAction\n\t) {\n\t\t// Dynamic SemanticObject has an unavailable action\n\t\tif (\n\t\t\tsemanticObjectUnavailableAction?.semanticObject &&\n\t\t\tSimpleLinkDelegate._isDynamicPath(semanticObjectUnavailableAction.semanticObject)\n\t\t) {\n\t\t\t_Index = mdcPayload.semanticObjects.findIndex(function (semanticObject: string) {\n\t\t\t\treturn semanticObject === semanticObjectUnavailableAction.semanticObject;\n\t\t\t});\n\t\t\tif (_Index !== undefined) {\n\t\t\t\t// Get the SemanticObject name resolved to a value\n\t\t\t\tsemanticObjectUnavailableAction.semanticObject = mdcPayloadWithDynamicSemanticObjectsResolved.semanticObjects[_Index];\n\t\t\t}\n\t\t}\n\t});\n};\n\n/**\n * Remove empty semantic object mappings and if there is no semantic object name, link to it.\n * @private\n * @param mdcPayloadWithDynamicSemanticObjectsResolved The payload used to check the mappings of the semantic objects.\n */\nSimpleLinkDelegate._removeEmptySemanticObjectsMappings = function (\n\tmdcPayloadWithDynamicSemanticObjectsResolved: LinkDelegatePayload\n): void {\n\t// remove undefined Semantic Object Mapping\n\tfor (\n\t\tlet mappingsCount = 0;\n\t\tmappingsCount < mdcPayloadWithDynamicSemanticObjectsResolved.semanticObjectMappings.length;\n\t\tmappingsCount++\n\t) {\n\t\tif (\n\t\t\tmdcPayloadWithDynamicSemanticObjectsResolved.semanticObjectMappings[mappingsCount] &&\n\t\t\tmdcPayloadWithDynamicSemanticObjectsResolved.semanticObjectMappings[mappingsCount].semanticObject === undefined\n\t\t) {\n\t\t\tmdcPayloadWithDynamicSemanticObjectsResolved.semanticObjectMappings.splice(mappingsCount, 1);\n\t\t}\n\t}\n};\n\nSimpleLinkDelegate._setPayloadWithDynamicSemanticObjectsResolved = function (\n\tpayload: LinkDelegatePayload,\n\tnewPayload: LinkDelegatePayload\n): LinkDelegatePayload {\n\tlet oPayloadWithDynamicSemanticObjectsResolved: LinkDelegatePayload;\n\tif (newPayload.semanticObjectsResolved && newPayload.semanticObjectsResolved.length > 0) {\n\t\toPayloadWithDynamicSemanticObjectsResolved = {\n\t\t\tqualifiers: payload.qualifiers,\n\t\t\tentityType: payload.entityType,\n\t\t\tdataField: payload.dataField,\n\t\t\tcontact: payload.contact,\n\t\t\tnavigationPath: payload.navigationPath,\n\t\t\tpropertyPathLabel: payload.propertyPathLabel,\n\t\t\tsemanticObjectMappings: deepClone(payload.semanticObjectMappings),\n\t\t\tsemanticObjectUnavailableActions: [],\n\t\t\tsemanticObjects: newPayload.semanticObjects\n\t\t};\n\t\tSimpleLinkDelegate._updateSemanticObjectsForMappings(payload, oPayloadWithDynamicSemanticObjectsResolved, newPayload);\n\t\tconst _SemanticObjectUnavailableActions: RegisteredSemanticObjectUnavailableAction[] = deepClone(\n\t\t\tpayload.semanticObjectUnavailableActions\n\t\t);\n\t\tSimpleLinkDelegate._updateSemanticObjectsUnavailableActions(\n\t\t\tpayload,\n\t\t\t_SemanticObjectUnavailableActions,\n\t\t\toPayloadWithDynamicSemanticObjectsResolved\n\t\t);\n\t\toPayloadWithDynamicSemanticObjectsResolved.semanticObjectUnavailableActions = _SemanticObjectUnavailableActions;\n\t\tSimpleLinkDelegate._removeEmptySemanticObjectsMappings(oPayloadWithDynamicSemanticObjectsResolved);\n\t\treturn oPayloadWithDynamicSemanticObjectsResolved;\n\t} else {\n\t\treturn {} as LinkDelegatePayload;\n\t}\n};\n\nSimpleLinkDelegate._getPayloadWithDynamicSemanticObjectsResolved = function (\n\tpayload: LinkDelegatePayload,\n\tlinkCustomData: CustomData[] | undefined\n): LinkDelegatePayload | undefined {\n\tlet payloadWithDynamicSemanticObjectsResolved: LinkDelegatePayload;\n\tconst semanticObjectsResolved: Record<string, { value: string }> = {};\n\tconst newPayload: LinkDelegatePayload = {\n\t\tsemanticObjects: [],\n\t\tsemanticObjectsResolved: [],\n\t\tsemanticObjectMappings: [],\n\t\tsemanticObjectUnavailableActions: [],\n\t\tqualifiers: {}\n\t};\n\tif (payload.semanticObjects) {\n\t\t// sap.m.Link has custom data with Semantic Objects names resolved\n\t\tif (linkCustomData && linkCustomData.length > 0) {\n\t\t\tSimpleLinkDelegate._getSemanticObjectCustomDataValue(linkCustomData, semanticObjectsResolved);\n\t\t\tSimpleLinkDelegate._createNewPayloadWithDynamicSemanticObjectsResolved(payload, semanticObjectsResolved, newPayload);\n\t\t\tpayloadWithDynamicSemanticObjectsResolved = SimpleLinkDelegate._setPayloadWithDynamicSemanticObjectsResolved(\n\t\t\t\tpayload,\n\t\t\t\tnewPayload\n\t\t\t);\n\t\t\treturn payloadWithDynamicSemanticObjectsResolved;\n\t\t}\n\t} else {\n\t\treturn undefined;\n\t}\n};\n\nSimpleLinkDelegate._updatePayloadWithSemanticAttributes = function (\n\taSemanticObjects: string[],\n\toInfoLog: InfoLog,\n\toContextObject: Record<string, unknown>,\n\toResults: RegisteredSemanticAttributes,\n\tmSemanticObjectMappings?: Record<string, Record<string, unknown>>\n): void {\n\taSemanticObjects.forEach(function (sSemanticObject: string) {\n\t\tif (oInfoLog) {\n\t\t\toInfoLog.addContextObject(sSemanticObject, oContextObject);\n\t\t}\n\t\toResults[sSemanticObject] = {};\n\t\tfor (const sAttributeName in oContextObject) {\n\t\t\tlet oAttribute = null,\n\t\t\t\toTransformationAdditional = null;\n\t\t\tif (oInfoLog) {\n\t\t\t\toAttribute = oInfoLog.getSemanticObjectAttribute(sSemanticObject, sAttributeName);\n\t\t\t\tif (!oAttribute) {\n\t\t\t\t\toAttribute = oInfoLog.createAttributeStructure();\n\t\t\t\t\toInfoLog.addSemanticObjectAttribute(sSemanticObject, sAttributeName, oAttribute);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Ignore undefined and null values\n\t\t\tif (oContextObject[sAttributeName] === undefined || oContextObject[sAttributeName] === null) {\n\t\t\t\tif (oAttribute) {\n\t\t\t\t\toAttribute.transformations.push({\n\t\t\t\t\t\tvalue: undefined,\n\t\t\t\t\t\tdescription: \"\\u2139 Undefined and null values have been removed in SimpleLinkDelegate.\"\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t// Ignore plain objects (BCP 1770496639)\n\t\t\tif (isPlainObject(oContextObject[sAttributeName] as object)) {\n\t\t\t\tif (mSemanticObjectMappings && mSemanticObjectMappings[sSemanticObject]) {\n\t\t\t\t\tconst aKeys = Object.keys(mSemanticObjectMappings[sSemanticObject]);\n\t\t\t\t\tlet sNewAttributeNameMapped, sNewAttributeName, sValue, sKey;\n\t\t\t\t\tfor (const element of aKeys) {\n\t\t\t\t\t\tsKey = element;\n\t\t\t\t\t\tif (sKey.indexOf(sAttributeName) === 0) {\n\t\t\t\t\t\t\tsNewAttributeNameMapped = mSemanticObjectMappings[sSemanticObject][sKey] as string;\n\t\t\t\t\t\t\tsNewAttributeName = sKey.split(\"/\")[sKey.split(\"/\").length - 1];\n\t\t\t\t\t\t\tsValue = (oContextObject[sAttributeName] as Record<string, string>)[sNewAttributeName];\n\t\t\t\t\t\t\tif (sNewAttributeNameMapped && sNewAttributeName && sValue) {\n\t\t\t\t\t\t\t\toResults[sSemanticObject][sNewAttributeNameMapped] = sValue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (oAttribute) {\n\t\t\t\t\toAttribute.transformations.push({\n\t\t\t\t\t\tvalue: undefined,\n\t\t\t\t\t\tdescription: \"\\u2139 Plain objects has been removed in SimpleLinkDelegate.\"\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Map the attribute name only if 'semanticObjectMapping' is defined.\n\t\t\t// Note: under defined 'semanticObjectMapping' we also mean an empty annotation or an annotation with empty record\n\t\t\tconst sAttributeNameMapped: string =\n\t\t\t\tmSemanticObjectMappings &&\n\t\t\t\tmSemanticObjectMappings[sSemanticObject] &&\n\t\t\t\tmSemanticObjectMappings[sSemanticObject][sAttributeName]\n\t\t\t\t\t? (mSemanticObjectMappings[sSemanticObject][sAttributeName] as string)\n\t\t\t\t\t: sAttributeName;\n\n\t\t\tif (oAttribute && sAttributeName !== sAttributeNameMapped) {\n\t\t\t\toTransformationAdditional = {\n\t\t\t\t\tvalue: undefined,\n\t\t\t\t\tdescription: `\\u2139 The attribute ${sAttributeName} has been renamed to ${sAttributeNameMapped} in SimpleLinkDelegate.`,\n\t\t\t\t\treason: `\\ud83d\\udd34 A com.sap.vocabularies.Common.v1.SemanticObjectMapping annotation is defined for semantic object ${sSemanticObject} with source attribute ${sAttributeName} and target attribute ${sAttributeNameMapped}. You can modify the annotation if the mapping result is not what you expected.`\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// If more then one local property maps to the same target property (clash situation)\n\t\t\t// we take the value of the last property and write an error log\n\t\t\tif (oResults[sSemanticObject][sAttributeNameMapped]) {\n\t\t\t\tLog.error(\n\t\t\t\t\t`SimpleLinkDelegate: The attribute ${sAttributeName} can not be renamed to the attribute ${sAttributeNameMapped} due to a clash situation. This can lead to wrong navigation later on.`\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Copy the value replacing the attribute name by semantic object name\n\t\t\toResults[sSemanticObject][sAttributeNameMapped] = oContextObject[sAttributeName] as string;\n\n\t\t\tif (oAttribute) {\n\t\t\t\tif (oTransformationAdditional) {\n\t\t\t\t\toAttribute.transformations.push(oTransformationAdditional);\n\t\t\t\t\tconst aAttributeNew = oInfoLog.createAttributeStructure();\n\t\t\t\t\taAttributeNew.transformations.push({\n\t\t\t\t\t\tvalue: oContextObject[sAttributeName],\n\t\t\t\t\t\tdescription: `\\u2139 The attribute ${sAttributeNameMapped} with the value ${oContextObject[sAttributeName]} has been added due to a mapping rule regarding the attribute ${sAttributeName} in SimpleLinkDelegate.`\n\t\t\t\t\t});\n\t\t\t\t\toInfoLog.addSemanticObjectAttribute(sSemanticObject, sAttributeNameMapped, aAttributeNew);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n};\n\n/**\n * Calculate the payload with the semantic objects resolved.\n * @param link The corresponding Link\n * @returns The payload resolved with the value of the semantic object\n */\nSimpleLinkDelegate.calculatePayloadWithDynamicSemanticObjectsResolved = function (link: MdcLink): LinkDelegatePayload {\n\tconst payload = link?.getPayload() as LinkDelegatePayload;\n\tconst linkCustomData = link && this._fetchLinkCustomData(link);\n\tconst payloadResolved = SimpleLinkDelegate._getPayloadWithDynamicSemanticObjectsResolved(payload, linkCustomData);\n\treturn payloadResolved ? payloadResolved : payload;\n};\n\n/**\n * Checks which attributes of the ContextObject belong to which SemanticObject and maps them into a two dimensional array.\n * @private\n * @param oBindingContext The BindingContext of the SourceControl of the Link / of the Link itself if not set\n * @param oPayload The payload given by the application\n * @param oInfoLog The corresponding InfoLog of the Link\n * @param oLink The corresponding Link\n * @returns An object containing the computed payload and computed semantic attributes\n */\nSimpleLinkDelegate._calculateSemanticAttributes = function (\n\toBindingContext: Context,\n\toPayload: LinkDelegatePayload,\n\toInfoLog: InfoLog,\n\toLink: MdcLink\n): { payload: LinkDelegatePayload; results: Record<string, Record<string, string>> } {\n\tconst oContextObject = oBindingContext.getObject();\n\tconst oPayloadWithDynamicSemanticObjectsResolved = SimpleLinkDelegate.calculatePayloadWithDynamicSemanticObjectsResolved(oLink);\n\tconst aSemanticObjects = SimpleLinkDelegate._getSemanticObjects(oPayloadWithDynamicSemanticObjectsResolved);\n\n\tif (!aSemanticObjects.length) {\n\t\treturn { payload: oPayloadWithDynamicSemanticObjectsResolved, results: {} };\n\t}\n\tconst oResults = {};\n\tconst oView = CommonUtils.getTargetView(oLink);\n\tconst propertyPath = oPayloadWithDynamicSemanticObjectsResolved?.dataFieldPropPath;\n\n\tSimpleLinkDelegate._checkImplicitSemanticObjectMapping(\n\t\toPayloadWithDynamicSemanticObjectsResolved,\n\t\tpropertyPath,\n\t\toBindingContext,\n\t\toView\n\t);\n\tconst mSemanticObjectMappings = SimpleLinkDelegate._convertSemanticObjectMapping(\n\t\tSimpleLinkDelegate._getSemanticObjectMappings(oPayloadWithDynamicSemanticObjectsResolved)\n\t);\n\n\tSimpleLinkDelegate._updatePayloadWithSemanticAttributes(aSemanticObjects, oInfoLog, oContextObject, oResults, mSemanticObjectMappings);\n\treturn { payload: oPayloadWithDynamicSemanticObjectsResolved, results: oResults };\n};\n\n/**\n * Checks if the current hash corresponds to a primary action.\n * @param shellServices The shell services object.\n * @param navLinks An array of navigation links.\n * @param hash The parsed hash object.\n * @returns - Returns true if the hash corresponds to a primary action, otherwise false.\n */\nSimpleLinkDelegate.checkPrimaryActionForHash = function (\n\tshellServices: IShellServices,\n\tnavLinks: NavigationLink[],\n\thash: ParsedHash\n): boolean {\n\treturn navLinks.some((hashs) => {\n\t\tlet targetHash = shellServices.constructShellHash({\n\t\t\ttarget: {\n\t\t\t\tshellHash: hashs.intent\n\t\t\t}\n\t\t});\n\t\t// The sandbox adds a ?sap-app-origin-hint to the hash, so we need to remove it\n\t\tif (targetHash.includes(\"?\")) {\n\t\t\ttargetHash = targetHash.substring(0, targetHash.indexOf(\"?\"));\n\t\t}\n\t\treturn `${hash.semanticObject}-${hash.action}` === targetHash;\n\t});\n};\n\n/**\n * Retrieves the actual targets for the navigation of the link. This uses the UShell loaded by the {@link sap.ui.mdc.link.Factory} to retrieve\n * the navigation targets from the FLP service.\n * @private\n * @param sAppStateKey Key of the appstate (not used yet)\n * @param oSemanticAttributes The calculated by _calculateSemanticAttributes\n * @param oPayload The payload given by the application\n * @param oInfoLog The corresponding InfoLog of the Link\n * @param oLink The corresponding Link\n * @returns Resolving into availableAtions and ownNavigation containing an array of {@link sap.ui.mdc.link.LinkItem}\n */\nSimpleLinkDelegate._retrieveNavigationTargets = async function (\n\tsAppStateKey: string,\n\toSemanticAttributes: Record<string, Record<string, string>>,\n\toPayload: LinkDelegatePayload,\n\toInfoLog: InfoLog,\n\toLink?: MdcLink\n): Promise<LinkItem[]> {\n\tif (!oPayload.semanticObjects) {\n\t\treturn Promise.resolve([]);\n\t}\n\tconst aSemanticObjects = oPayload.semanticObjects;\n\tconst oNavigationTargets: {\n\t\townNavigation?: LinkItem;\n\t\tavailableActions: LinkItem[];\n\t} = {\n\t\townNavigation: undefined,\n\t\tavailableActions: []\n\t};\n\tlet iSuperiorActionLinksFound = 0;\n\treturn Library.load({ name: \"sap.ui.fl\" }).then(async () => {\n\t\treturn new Promise((resolve) => {\n\t\t\tsap.ui.require([\"sap/ui/fl/Utils\"], async (Utils: typeof flUtils) => {\n\t\t\t\tconst oAppComponent: AppComponent = Utils.getAppComponentForControl(oLink === undefined ? this.oControl : oLink);\n\t\t\t\tconst oShellServices = oAppComponent ? oAppComponent.getShellServices() : null;\n\t\t\t\tif (!oShellServices) {\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tresolve(oNavigationTargets.availableActions, oNavigationTargets.ownNavigation);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!oShellServices?.hasUShell()) {\n\t\t\t\t\tLog.error(\"SimpleLinkDelegate: Service 'CrossApplicationNavigation' or 'URLParsing' could not be obtained\");\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tresolve(oNavigationTargets.availableActions, oNavigationTargets.ownNavigation);\n\t\t\t\t}\n\t\t\t\tconst aParams: LinkFilter[] = aSemanticObjects.map(function (sSemanticObject): Omit<LinkFilter, \"ui5Component\"> {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tsemanticObject: sSemanticObject,\n\t\t\t\t\t\tparams: oSemanticAttributes ? oSemanticAttributes[sSemanticObject] : undefined,\n\t\t\t\t\t\tappStateKey: sAppStateKey,\n\t\t\t\t\t\tsortResultsBy: \"text\"\n\t\t\t\t\t};\n\t\t\t\t}) as LinkFilter[];\n\t\t\t\ttry {\n\t\t\t\t\tconst aLinks = await oShellServices.getLinks(aParams);\n\t\t\t\t\tlet bHasLinks = false;\n\t\t\t\t\tfor (const elements of aLinks) {\n\t\t\t\t\t\tif (elements.length > 0) {\n\t\t\t\t\t\t\tbHasLinks = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (bHasLinks) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!aLinks || !aLinks.length || !bHasLinks) {\n\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\tresolve(oNavigationTargets.availableActions, oNavigationTargets.ownNavigation);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst aSemanticObjectUnavailableActions: (typeof SemanticObjectUnavailableAction)[] =\n\t\t\t\t\t\tSimpleLinkDelegate._getSemanticObjectUnavailableActions(oPayload);\n\t\t\t\t\tconst oUnavailableActions =\n\t\t\t\t\t\tSimpleLinkDelegate._convertSemanticObjectUnavailableAction(aSemanticObjectUnavailableActions);\n\t\t\t\t\tlet sCurrentHash = FieldRuntime._fnFixHashQueryString(oAppComponent.getShellServices().getHash());\n\n\t\t\t\t\tif (sCurrentHash) {\n\t\t\t\t\t\t// BCP 1770315035: we have to set the end-point '?' of action in order to avoid matching of \"#SalesOrder-manage\" in \"#SalesOrder-manageFulfillment\"\n\t\t\t\t\t\tsCurrentHash += \"?\";\n\t\t\t\t\t}\n\n\t\t\t\t\tconst fnIsUnavailableAction = function (sSemanticObject: string, sAction: string): boolean {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t!!oUnavailableActions &&\n\t\t\t\t\t\t\t!!oUnavailableActions[sSemanticObject] &&\n\t\t\t\t\t\t\toUnavailableActions[sSemanticObject].includes(sAction)\n\t\t\t\t\t\t);\n\t\t\t\t\t};\n\t\t\t\t\tconst primaryIntents = (\n\t\t\t\t\t\tawait FieldHelper._getPrimaryIntents(oAppComponent, oPayload && oPayload.semanticObjects)\n\t\t\t\t\t).filter(Boolean);\n\t\t\t\t\tconst fnAddLink = function (_oLink: NavigationLink): void {\n\t\t\t\t\t\tconst oShellHash = oShellServices.parseShellHash(_oLink.intent);\n\t\t\t\t\t\tif (fnIsUnavailableAction(oShellHash.semanticObject, oShellHash.action)) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst sHref = `#${oShellServices.constructShellHash({ target: { shellHash: _oLink.intent } })}`;\n\n\t\t\t\t\t\tif (_oLink.intent && _oLink.intent.indexOf(sCurrentHash) === 0) {\n\t\t\t\t\t\t\t// Prevent current app from being listed\n\t\t\t\t\t\t\t// NOTE: If the navigation target exists in\n\t\t\t\t\t\t\t// multiple contexts (~XXXX in hash) they will all be skipped\n\t\t\t\t\t\t\toNavigationTargets.ownNavigation = new LinkItem({\n\t\t\t\t\t\t\t\thref: sHref,\n\t\t\t\t\t\t\t\ttext: _oLink.text\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst oLinkItem = new LinkItem({\n\t\t\t\t\t\t\t// As the retrieveNavigationTargets method can be called several time we can not create the LinkItem instance with the same id\n\t\t\t\t\t\t\tkey:\n\t\t\t\t\t\t\t\toShellHash.semanticObject && oShellHash.action\n\t\t\t\t\t\t\t\t\t? `${oShellHash.semanticObject}-${oShellHash.action}`\n\t\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t\ttext: _oLink.text,\n\t\t\t\t\t\t\tdescription: undefined,\n\t\t\t\t\t\t\thref: sHref,\n\t\t\t\t\t\t\t// target: not supported yet\n\t\t\t\t\t\t\ticon: undefined, //_oLink.icon,\n\t\t\t\t\t\t\tinitiallyVisible: _oLink.tags && _oLink.tags.includes(\"superiorAction\")\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (oLinkItem.getProperty(\"initiallyVisible\")) {\n\t\t\t\t\t\t\t// If the current link item is not a primary intent, add it to the list shown in the popover\n\t\t\t\t\t\t\tif (!SimpleLinkDelegate.checkPrimaryActionForHash(oShellServices, primaryIntents, oShellHash)) {\n\t\t\t\t\t\t\t\tiSuperiorActionLinksFound++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\toNavigationTargets.availableActions.push(oLinkItem);\n\n\t\t\t\t\t\tif (oInfoLog) {\n\t\t\t\t\t\t\toInfoLog.addSemanticObjectIntent(oShellHash.semanticObject, {\n\t\t\t\t\t\t\t\tintent: oLinkItem.getHref(),\n\t\t\t\t\t\t\t\ttext: oLinkItem.getText()\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tfor (let n = 0; n < aSemanticObjects.length; n++) {\n\t\t\t\t\t\taLinks[n].forEach(fnAddLink);\n\t\t\t\t\t}\n\t\t\t\t\tif (iSuperiorActionLinksFound === 0) {\n\t\t\t\t\t\tfor (let iLinkItemIndex = 0; iLinkItemIndex < oNavigationTargets.availableActions.length; iLinkItemIndex++) {\n\t\t\t\t\t\t\tif (iLinkItemIndex < this.getConstants().iLinksShownInPopup) {\n\t\t\t\t\t\t\t\toNavigationTargets.availableActions[iLinkItemIndex].setProperty(\"initiallyVisible\", true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tresolve(oNavigationTargets.availableActions, oNavigationTargets.ownNavigation);\n\t\t\t\t} catch (oError) {\n\t\t\t\t\tLog.error(\"SimpleLinkDelegate: '_retrieveNavigationTargets' failed executing getLinks method\");\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tresolve(oNavigationTargets.availableActions, oNavigationTargets.ownNavigation);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t});\n};\nSimpleLinkDelegate._getSemanticObjects = function (oPayload: LinkDelegatePayload): string[] {\n\treturn oPayload.semanticObjects ? oPayload.semanticObjects : [];\n};\nSimpleLinkDelegate._getSemanticObjectUnavailableActions = function (\n\toPayload: LinkDelegatePayload\n): (typeof SemanticObjectUnavailableAction)[] {\n\tconst aSemanticObjectUnavailableActions: (typeof SemanticObjectUnavailableAction)[] = [];\n\tif (oPayload.semanticObjectUnavailableActions) {\n\t\toPayload.semanticObjectUnavailableActions.forEach(function (\n\t\t\toSemanticObjectUnavailableAction: RegisteredSemanticObjectUnavailableAction\n\t\t) {\n\t\t\taSemanticObjectUnavailableActions.push(\n\t\t\t\tnew SemanticObjectUnavailableAction({\n\t\t\t\t\tsemanticObject: oSemanticObjectUnavailableAction.semanticObject,\n\t\t\t\t\tactions: oSemanticObjectUnavailableAction.actions\n\t\t\t\t})\n\t\t\t);\n\t\t});\n\t}\n\treturn aSemanticObjectUnavailableActions;\n};\n\n/**\n * This will return an array of {@link sap.ui.mdc.ushell.SemanticObjectMapping} depending on the given payload.\n * @private\n * @param oPayload The payload defined by the application\n * @returns An array of semantic object mappings.\n */\nSimpleLinkDelegate._getSemanticObjectMappings = function (oPayload: LinkDelegatePayload): SemanticObjectMapping[] {\n\tconst aSemanticObjectMappings: SemanticObjectMapping[] = [];\n\tlet aSemanticObjectMappingItems: (typeof SemanticObjectMappingItem)[] = [];\n\tif (oPayload.semanticObjectMappings) {\n\t\toPayload.semanticObjectMappings.forEach(function (oSemanticObjectMapping: RegisteredSemanticObjectMapping) {\n\t\t\taSemanticObjectMappingItems = [];\n\t\t\tif (oSemanticObjectMapping.items) {\n\t\t\t\toSemanticObjectMapping.items.forEach(function (oSemanticObjectMappingItem: { key: string; value: string }) {\n\t\t\t\t\taSemanticObjectMappingItems.push(\n\t\t\t\t\t\tnew SemanticObjectMappingItem({\n\t\t\t\t\t\t\tkey: oSemanticObjectMappingItem.key,\n\t\t\t\t\t\t\tvalue: oSemanticObjectMappingItem.value\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t\taSemanticObjectMappings.push(\n\t\t\t\tnew SemanticObjectMapping({\n\t\t\t\t\tsemanticObject: oSemanticObjectMapping.semanticObject,\n\t\t\t\t\titems: aSemanticObjectMappingItems\n\t\t\t\t})\n\t\t\t);\n\t\t});\n\t}\n\treturn aSemanticObjectMappings;\n};\n/**\n * Converts a given array of SemanticObjectMapping into a Map containing SemanticObjects as Keys and a Map of it's corresponding SemanticObjectMappings as values.\n * @private\n * @param aSemanticObjectMappings An array of SemanticObjectMappings.\n * @returns The converterd SemanticObjectMappings\n */\nSimpleLinkDelegate._convertSemanticObjectMapping = function (\n\taSemanticObjectMappings: SemanticObjectMapping[]\n): Record<string, Record<string, unknown>> | undefined {\n\tif (!aSemanticObjectMappings.length) {\n\t\treturn undefined;\n\t}\n\tconst mSemanticObjectMappings: Record<string, Record<string, unknown>> = {};\n\taSemanticObjectMappings.forEach((oSemanticObjectMapping) => {\n\t\tif (!oSemanticObjectMapping.getSemanticObject()) {\n\t\t\tthrow Error(\n\t\t\t\t`SimpleLinkDelegate: 'semanticObject' property with value '${oSemanticObjectMapping.getSemanticObject()}' is not valid`\n\t\t\t);\n\t\t}\n\t\tmSemanticObjectMappings[oSemanticObjectMapping.getSemanticObject()] = Object.fromEntries(\n\t\t\toSemanticObjectMapping.getItems().map((oItem) => [oItem.getKey(), oItem.getValue()])\n\t\t);\n\t});\n\treturn mSemanticObjectMappings;\n};\n/**\n * Converts a given array of SemanticObjectUnavailableActions into a map containing SemanticObjects as keys and a map of its corresponding SemanticObjectUnavailableActions as values.\n * @private\n * @param aSemanticObjectUnavailableActions The SemanticObjectUnavailableActions converted\n * @returns The map containing the converted SemanticObjectUnavailableActions\n */\nSimpleLinkDelegate._convertSemanticObjectUnavailableAction = function (\n\taSemanticObjectUnavailableActions: (typeof SemanticObjectUnavailableAction)[]\n): Record<string, string[]> | undefined {\n\tlet _SemanticObjectName: string;\n\tlet _SemanticObjectHasAlreadyUnavailableActions: string[];\n\tlet _UnavailableActions: string[] = [];\n\tif (!aSemanticObjectUnavailableActions.length) {\n\t\treturn undefined;\n\t}\n\tconst mSemanticObjectUnavailableActions: Record<string, string[]> = {};\n\taSemanticObjectUnavailableActions.forEach(function (oSemanticObjectUnavailableActions: typeof SemanticObjectUnavailableAction) {\n\t\t_SemanticObjectName = oSemanticObjectUnavailableActions.getSemanticObject();\n\t\tif (!_SemanticObjectName) {\n\t\t\tthrow Error(`SimpleLinkDelegate: 'semanticObject' property with value '${_SemanticObjectName}' is not valid`);\n\t\t}\n\t\t_UnavailableActions = oSemanticObjectUnavailableActions.getActions();\n\t\tif (mSemanticObjectUnavailableActions[_SemanticObjectName] === undefined) {\n\t\t\tmSemanticObjectUnavailableActions[_SemanticObjectName] = _UnavailableActions;\n\t\t} else {\n\t\t\t_SemanticObjectHasAlreadyUnavailableActions = mSemanticObjectUnavailableActions[_SemanticObjectName];\n\t\t\t_UnavailableActions.forEach(function (UnavailableAction: string) {\n\t\t\t\t_SemanticObjectHasAlreadyUnavailableActions.push(UnavailableAction);\n\t\t\t});\n\t\t\tmSemanticObjectUnavailableActions[_SemanticObjectName] = _SemanticObjectHasAlreadyUnavailableActions;\n\t\t}\n\t});\n\treturn mSemanticObjectUnavailableActions;\n};\n/**\n * Delegate method to fetch popover title and labelledBy control.\n * @param oLink\n * @param oPanel\n * @returns A title and a labelledBy control.\n */\nSimpleLinkDelegate.fetchPopoverTitle = async function (\n\toLink: MdcLink | undefined,\n\toPanel: Control\n): Promise<{ sTitle: string; oLabelledByControl: UI5Element | undefined }> {\n\tconst sTitle = \"\";\n\tif (!oLink || !oPanel) {\n\t\treturn { sTitle, oLabelledByControl: undefined };\n\t}\n\tconst oLabelledByControl = SimpleLinkDelegate?._getLabelledByControl(oPanel);\n\n\treturn Promise.resolve({ sTitle, oLabelledByControl });\n};\n\nexport default SimpleLinkDelegate;\n"],"mappings":"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","ignoreList":[],"file":"QuickViewDelegate-dbg.js"}
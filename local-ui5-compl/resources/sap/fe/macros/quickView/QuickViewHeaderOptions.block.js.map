{"version":3,"file":"QuickViewHeaderOptions.block.js","names":["QuickViewHeaderOptionsBlock","_dec","defineBuildingBlock","name","namespace","_dec2","blockAttribute","type","required","_dec3","_dec4","_dec5","_dec6","defineReference","_class","_class2","_RuntimeBuildingBlock","props","controlConfiguration","settings","_this","call","this","_initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","_descriptor4","_descriptor5","visible","convertedTypes","convertTypes","contextPath","getModel","contextObject","resolvePath","getPath","targetObject","target","isEntityType","entityType","headerInfo","annotations","UI","HeaderInfo","isDataField","contextObjectDataModelObjectPath","getInvolvedDataModelObjects","convertedDataField","MetaModelConverter","convertMetaModelContext","dataFieldValue","getDataModelObjectPathForValue","_exports","_inheritsLoose","_proto","prototype","setHeaderDisplayParametersForDataField","IconUrl","icon","fallbackIcon","undefined","title","getTextBinding","displayMode","getDisplayMode","description","Label","compileExpression","Value","$target","Common","setHeaderDisplayParametersForEntityType","iconExpression","ImageUrl","getExpressionFromAnnotation","TypeImageUrl","iconExpressionCompiled","IsNaturalPerson","valueOf","Title","headerTitle","createBindingContext","titleExpression","headerDescription","headerExpression","_type","modelName","path","getSemanticObjectsPrimaryActions","async","FieldHelper","checkPrimaryActions","semanticPayload","appComponent","primaryAction","getPrimaryAction","titleLink","setupTitle","getContent","avatar","isInitialized","_jsx","Avatar","class","src","displayShape","AvatarShape","Circle","Square","hLayout","HorizontalLayout","ref","horizontalLayout","children","VBox","Link","text","href","emphasized","level","coreLibrary","TitleLevel","H3","wrapping","Text","vLayout","_jsxs","VerticalLayout","current","addContent","RuntimeBuildingBlock","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sources":["./QuickViewHeaderOptions.block.tsx"],"sourcesContent":["import type { EntityType, Property, ServiceObject } from \"@sap-ux/vocabularies-types\";\nimport type * as Edm from \"@sap-ux/vocabularies-types/Edm\";\nimport type {\n\tDataField,\n\tDataFieldAbstractTypes,\n\tDataFieldForAction,\n\tDataFieldForIntentBasedNavigation,\n\tDataFieldTypes,\n\tDataFieldWithNavigationPath,\n\tDataFieldWithUrl,\n\tHeaderInfoType\n} from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport type { BindingToolkitExpression } from \"sap/fe/base/BindingToolkit\";\nimport { compileExpression, getExpressionFromAnnotation, type CompiledBindingToolkitExpression } from \"sap/fe/base/BindingToolkit\";\nimport type { PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport { defineReference } from \"sap/fe/base/ClassSupport\";\nimport type { Ref } from \"sap/fe/base/jsx-runtime/jsx\";\nimport { blockAttribute, defineBuildingBlock } from \"sap/fe/core/buildingBlocks/templating/BuildingBlockSupport\";\nimport type { TemplateProcessorSettings } from \"sap/fe/core/buildingBlocks/templating/BuildingBlockTemplateProcessor\";\nimport RuntimeBuildingBlock from \"sap/fe/core/buildingBlocks/templating/RuntimeBuildingBlock\";\nimport * as MetaModelConverter from \"sap/fe/core/converters/MetaModelConverter\";\nimport { convertTypes, getInvolvedDataModelObjects } from \"sap/fe/core/converters/MetaModelConverter\";\nimport { isDataField } from \"sap/fe/core/converters/annotations/DataField\";\nimport { isEntityType } from \"sap/fe/core/helpers/TypeGuards\";\nimport type { DataModelObjectPath } from \"sap/fe/core/templating/DataModelPathHelper\";\nimport { getDisplayMode } from \"sap/fe/core/templating/UIFormatters\";\nimport FieldHelper from \"sap/fe/macros/field/FieldHelper\";\nimport { getDataModelObjectPathForValue, getTextBinding } from \"sap/fe/macros/field/FieldTemplating\";\nimport type { LinkDelegatePayload } from \"sap/fe/macros/quickView/QuickViewDelegate\";\nimport Avatar from \"sap/m/Avatar\";\nimport AvatarShape from \"sap/m/AvatarShape\";\nimport Link from \"sap/m/Link\";\nimport Text from \"sap/m/Text\";\nimport Title from \"sap/m/Title\";\nimport VBox from \"sap/m/VBox\";\nimport coreLibrary from \"sap/ui/core/library\";\nimport HorizontalLayout from \"sap/ui/layout/HorizontalLayout\";\nimport VerticalLayout from \"sap/ui/layout/VerticalLayout\";\nimport type Context from \"sap/ui/model/Context\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\n\n@defineBuildingBlock({ name: \"QuickViewHeaderOptions\", namespace: \"sap.fe.macros\" })\nexport default class QuickViewHeaderOptionsBlock extends RuntimeBuildingBlock {\n\t@blockAttribute({ type: \"sap.ui.model.Context\", required: true })\n\tpublic contextPath!: Context;\n\n\t@blockAttribute({ type: \"object\", required: true })\n\tpublic semanticPayload!: LinkDelegatePayload;\n\n\t@blockAttribute({\n\t\ttype: \"string\"\n\t})\n\tid?: string;\n\n\t@blockAttribute({\n\t\ttype: \"string\"\n\t})\n\ttitleLink?: string;\n\n\t@defineReference()\n\thorizontalLayout!: Ref<HorizontalLayout>;\n\n\tvisible = true;\n\n\tprivate readonly settings: TemplateProcessorSettings;\n\n\tprivate readonly entityType?: EntityType;\n\n\tprivate readonly dataFieldValue?: DataModelObjectPath<Property>;\n\n\tprivate readonly convertedDataField?:\n\t\t| DataField\n\t\t| DataFieldForAction\n\t\t| DataFieldForIntentBasedNavigation\n\t\t| DataFieldWithUrl\n\t\t| DataFieldWithNavigationPath;\n\n\tprivate readonly headerInfo: HeaderInfoType | undefined;\n\n\tprivate icon: CompiledBindingToolkitExpression | Edm.String | undefined;\n\n\tprivate fallbackIcon: CompiledBindingToolkitExpression | undefined;\n\n\tprivate title: BindingToolkitExpression<string> | CompiledBindingToolkitExpression | undefined;\n\n\tprivate description: BindingToolkitExpression<string> | CompiledBindingToolkitExpression | Edm.String | undefined;\n\n\tpublic isInitialized?: Promise<void>;\n\n\tconstructor(\n\t\tprops: PropertiesOf<QuickViewHeaderOptionsBlock>,\n\t\tcontrolConfiguration: TemplateProcessorSettings,\n\t\tsettings: TemplateProcessorSettings\n\t) {\n\t\tsuper(props, controlConfiguration, settings);\n\t\tthis.settings = settings;\n\t\tconst convertedTypes = convertTypes(this.contextPath.getModel() as ODataMetaModel);\n\t\tconst contextObject = convertedTypes.resolvePath<ServiceObject>(this.contextPath.getPath());\n\t\tconst targetObject = contextObject.target;\n\t\tif (isEntityType(targetObject)) {\n\t\t\tthis.entityType = targetObject;\n\t\t\tthis.headerInfo = this.entityType?.annotations.UI?.HeaderInfo;\n\t\t} else if (isDataField(targetObject)) {\n\t\t\tconst contextObjectDataModelObjectPath = getInvolvedDataModelObjects<\n\t\t\t\tDataField | DataFieldForAction | DataFieldForIntentBasedNavigation | DataFieldWithUrl | DataFieldWithNavigationPath\n\t\t\t>(this.contextPath);\n\t\t\tthis.convertedDataField = MetaModelConverter.convertMetaModelContext(this.contextPath) as\n\t\t\t\t| DataField\n\t\t\t\t| DataFieldForAction\n\t\t\t\t| DataFieldForIntentBasedNavigation\n\t\t\t\t| DataFieldWithUrl\n\t\t\t\t| DataFieldWithNavigationPath;\n\t\t\tthis.dataFieldValue = getDataModelObjectPathForValue(contextObjectDataModelObjectPath);\n\t\t}\n\t}\n\n\tsetHeaderDisplayParametersForDataField(): void {\n\t\tif (this.dataFieldValue && this.convertedDataField) {\n\t\t\tif (this.convertedDataField?.IconUrl) {\n\t\t\t\tthis.icon = this.convertedDataField.IconUrl;\n\t\t\t\tthis.fallbackIcon = \"sap-icon://product\";\n\t\t\t} else {\n\t\t\t\tthis.icon = undefined;\n\t\t\t\tthis.fallbackIcon = undefined;\n\t\t\t}\n\t\t\tthis.title = getTextBinding(this.dataFieldValue, {\n\t\t\t\tdisplayMode: getDisplayMode(this.dataFieldValue)\n\t\t\t});\n\t\t\tthis.description = this.convertedDataField.Label\n\t\t\t\t? compileExpression(this.convertedDataField.Label)\n\t\t\t\t: compileExpression((this.convertedDataField as DataFieldTypes).Value?.$target?.annotations?.Common?.Label);\n\t\t}\n\t}\n\n\tsetHeaderDisplayParametersForEntityType(): void {\n\t\tif (this.entityType) {\n\t\t\tconst iconExpression = this.headerInfo?.ImageUrl\n\t\t\t\t? getExpressionFromAnnotation(this.headerInfo.ImageUrl)\n\t\t\t\t: getExpressionFromAnnotation(this.headerInfo?.TypeImageUrl);\n\t\t\tconst iconExpressionCompiled = compileExpression(iconExpression);\n\t\t\tthis.icon = iconExpressionCompiled === \"undefined\" ? undefined : iconExpressionCompiled;\n\t\t\tif (this.headerInfo?.TypeImageUrl) {\n\t\t\t\tthis.fallbackIcon = compileExpression(this.headerInfo.TypeImageUrl);\n\t\t\t} else if (this.entityType?.annotations.Common?.IsNaturalPerson?.valueOf() === true) {\n\t\t\t\tthis.fallbackIcon = \"sap-icon://person-placeholder\";\n\t\t\t} else {\n\t\t\t\tthis.fallbackIcon = \"sap-icon://product\";\n\t\t\t}\n\t\t\tif ((this.headerInfo?.Title as DataField)?.Value) {\n\t\t\t\tconst headerTitle = getInvolvedDataModelObjects<DataFieldAbstractTypes>(\n\t\t\t\t\tthis.contextPath.getModel().createBindingContext(\"@com.sap.vocabularies.UI.v1.HeaderInfo/Title/Value\", this.contextPath)\n\t\t\t\t);\n\t\t\t\tconst titleExpression = getTextBinding(headerTitle, {\n\t\t\t\t\tdisplayMode: getDisplayMode(headerTitle)\n\t\t\t\t});\n\t\t\t\tthis.title = titleExpression !== \"{}\" ? titleExpression : undefined;\n\t\t\t}\n\t\t\tconst headerDescription = getInvolvedDataModelObjects<DataFieldAbstractTypes>(\n\t\t\t\tthis.contextPath\n\t\t\t\t\t.getModel()\n\t\t\t\t\t.createBindingContext(\"@com.sap.vocabularies.UI.v1.HeaderInfo/Description/Value\", this.contextPath)\n\t\t\t);\n\t\t\tconst headerExpression =\n\t\t\t\theaderDescription.targetObject &&\n\t\t\t\tgetTextBinding(headerDescription, {\n\t\t\t\t\tdisplayMode: getDisplayMode(headerDescription)\n\t\t\t\t});\n\t\t\tthis.description =\n\t\t\t\theaderDescription.targetObject === undefined\n\t\t\t\t\t? compileExpression({ _type: \"PathInModel\", modelName: \"semantic\", path: \"propertyPathLabel\" })\n\t\t\t\t\t: headerExpression;\n\t\t}\n\t}\n\n\tasync getSemanticObjectsPrimaryActions(): Promise<void> {\n\t\tif (await FieldHelper.checkPrimaryActions(this.semanticPayload, false, this.settings.appComponent)) {\n\t\t\tconst primaryAction = FieldHelper.getPrimaryAction(this.semanticPayload);\n\t\t\tthis.titleLink = primaryAction;\n\t\t}\n\t\tthis.setupTitle();\n\t}\n\n\tgetContent(): VBox {\n\t\tlet avatar;\n\t\tthis.setHeaderDisplayParametersForDataField();\n\t\tthis.setHeaderDisplayParametersForEntityType();\n\t\tthis.isInitialized = this.getSemanticObjectsPrimaryActions();\n\t\tif (this.icon && this.fallbackIcon) {\n\t\t\tavatar = (\n\t\t\t\t<Avatar\n\t\t\t\t\tclass=\"sapMQuickViewThumbnail sapUiTinyMarginEnd\"\n\t\t\t\t\tsrc={this.icon}\n\t\t\t\t\tdisplayShape={\n\t\t\t\t\t\tthis.entityType?.annotations.Common?.IsNaturalPerson?.valueOf() === true ? AvatarShape.Circle : AvatarShape.Square\n\t\t\t\t\t}\n\t\t\t\t\tfallbackIcon={this.fallbackIcon}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t\tconst hLayout = (\n\t\t\t<HorizontalLayout class=\"sapUiSmallMarginBottom sapMQuickViewPage\" ref={this.horizontalLayout}>\n\t\t\t\t{avatar}\n\t\t\t</HorizontalLayout>\n\t\t);\n\t\treturn <VBox>{hLayout}</VBox>;\n\t}\n\n\tsetupTitle(): void {\n\t\tlet title;\n\t\tif (this.title) {\n\t\t\tif (this.titleLink) {\n\t\t\t\ttitle = <Link text={this.title} href={this.titleLink} emphasized=\"true\" />;\n\t\t\t} else {\n\t\t\t\ttitle = <Title text={this.title} level={coreLibrary.TitleLevel.H3} wrapping=\"true\" />;\n\t\t\t}\n\t\t}\n\t\tconst description = this.description ? <Text text={this.description} /> : undefined;\n\t\tconst vLayout = (\n\t\t\t<VerticalLayout>\n\t\t\t\t{title}\n\t\t\t\t{description}\n\t\t\t</VerticalLayout>\n\t\t);\n\t\tthis.horizontalLayout.current?.addContent(vLayout);\n\t}\n}\n"],"mappings":"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","ignoreList":[]}
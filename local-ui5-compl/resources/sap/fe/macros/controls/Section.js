/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2024 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/base/ClassSupport","sap/fe/base/HookSupport","sap/fe/core/CommonUtils","sap/fe/core/helpers/FPMHelper","sap/ui/core/Component","sap/uxap/ObjectPageSection"],function(e,t,i,n,o,s,l){"use strict";var c,r,a,u,g,f,S;var d=t.property;var h=t.defineUI5Class;function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,m(e,t)}function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}function T(e,t,i,n,o){var s={};return Object.keys(n).forEach(function(e){s[e]=n[e]}),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce(function(i,n){return n(e,t,i)||i},s),o&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(o):void 0,s.initializer=void 0),void 0===s.initializer?(Object.defineProperty(e,t,s),null):s}function C(e,t){throw Error("Decorating class property failed. Please ensure that transform-class-properties is enabled and runs after the decorators transform.")}let A=(c=h("sap.fe.macros.controls.Section",{designtime:"sap/uxap/designtime/ObjectPageSection.designtime"}),r=d({type:"string"}),a=d({type:"boolean"}),c(u=(g=function(t){function l(e,i){var n;n=t.call(this,e,i)||this;p(n,"onSectionLoaded",f,n);p(n,"useSingleTextAreaFieldAsNotes",S,n);n.registerDelegate();return n}b(l,t);var c=l.prototype;c.registerDelegate=function e(){const t={onAfterRendering:()=>{const e=n.getTargetView(this);if(this.useSingleTextAreaFieldAsNotes){this.checkAndAdjustSectionContentForTextArea()}this.checkAndAdjustForSingleContent(e)}};this.addEventDelegate(t)};c.setOnSectionLoaded=function e(t){const i=t.split(".");this._sectionLoadMethodName=i?.pop();this._sectionLoadModuleName=i?.join("/");this.setProperty("onSectionLoaded",t)};c.applySettings=function e(n,o){t.prototype.applySettings.call(this,n,o);const l=s.getOwnerComponentFor(this);const c=l.getRootController();if(c){i.initControllerExtensionHookHandlers(this,c)}return this};c.checkAndAdjustSectionContentForTextArea=function e(){const t=this.getVisibleSubSections();t.forEach(e=>{const t=this.getSingleContent([e]);if(t)this.adjustForSingleContent(t)})};c.checkAndAdjustForSingleContent=function t(i){if(i?.getViewData()?.sectionLayout==="Page"){const t=this.getSingleContent();if(t&&(t.isA("sap.fe.macros.controls.section.ISingleSectionContributor")||this.checkIfNotesReuseComponent(t))){this.adjustForSingleContent(t)}else if(this._sectionLoadModuleName&&this._sectionLoadMethodName){return o.loadModuleAndCallMethod(this._sectionLoadModuleName,this._sectionLoadMethodName,i,this)}else{e.debug("Section cannot be adjusted for single content : Interface 'ISingleSectionContributor' is not implemented")}}else{this.checkAndAdjustTabLayout()}};c.checkIfNotesReuseComponent=function e(t){if(t.isA("sap.m.VBox")&&t.getId().includes("NoteSection")){return true}return false};c.checkAndAdjustTabLayout=function e(){const t=this.getVisibleSubSections();if(t.length===1){this.adjustSectionContentWithTitle(t[0])}else{t.forEach(e=>{let t;const i=e.getBlocks();if(i.length===2&&i[1]?.isA("sap.fe.templates.ObjectPage.controls.SubSectionBlock")){this.adjustSectionContentWithTitle(e)}else if(i.length===1&&i[0]?.isA("sap.fe.templates.ObjectPage.controls.SubSectionBlock")){t=i[0].getAggregation("content");if(t.isA("sap.fe.macros.controls.section.ISingleSectionContributor")){this.adjustForSingleContent(t,{sectionFromReferenceFacet:true,SubSection:e})}else if(t?.isA("sap.ui.layout.DynamicSideContent")){t=t.getMainContent instanceof Function&&t?.getMainContent();if(t&&t.length===1){t=t[0];this.adjustForSingleContent(t,{sectionFromReferenceFacet:true,SubSection:e})}}}})}};c.adjustSectionContentWithTitle=function e(t){const i=t.getBlocks();let n;if(i.length===2&&i[1].isA("sap.fe.templates.ObjectPage.controls.SubSectionBlock")){n=i[1].getAggregation("content");if(n&&n.isA("sap.fe.macros.controls.section.ISingleSectionContributor")&&i[0].isA("sap.m.Title")){this.adjustForSingleContent(n,{sectionfromCollectionFacet:true,Title:i[0],SubSection:t})}else if(n&&n.isA("sap.ui.layout.DynamicSideContent")){n=n.getMainContent instanceof Function&&n?.getMainContent();if(n&&n.length===1){n=n[0];this.adjustForSingleContent(n,{sectionfromCollectionFacet:true,Title:i[0],SubSection:t})}}}};c.getSingleContent=function e(t){const i=t??this.getVisibleSubSections();if(i.length===1){const e=i[0].getBlocks();if(e.length===1&&e[0].isA("sap.fe.templates.ObjectPage.controls.SubSectionBlock")){return e[0].getAggregation("content")}else if(e.length===2&&e[0].isA("sap.ui.core.InvisibleText")&&e[1].isA("sap.fe.templates.ObjectPage.controls.SubSectionBlock"))return e[1].getAggregation("content")}};c.getVisibleSubSections=function e(){const t=this.getSubSections();return t.reduce((e,t)=>{if(t.getVisible()){e.push(t)}return e},[])};c.getSectionTitle=function e(){let t=this.getTitle();if(this.getVisibleSubSections().length===1){t=this.getVisibleSubSections()[0].getTitle()}return t};c.adjustForSingleContent=function e(t,i){const n=t;const o=n.getSectionContentRole&&n.getSectionContentRole();if(o==="provider"){const e=n.getDataFromProvider&&n.getDataFromProvider(this.useSingleTextAreaFieldAsNotes);if(e&&this.getTitle()===e.title){this.setTitle(e.title);this.setShowTitle(true);this.addStyleClass("sapUiTableOnObjectPageAdjustmentsForSection")}}else if(o==="consumer"){let e=this.getSectionTitle();if(i?.sectionfromCollectionFacet){e=i?.Title?.getText();i?.Title?.setVisible(false);i?.SubSection?.setShowTitle(false)}else if(i?.sectionFromReferenceFacet){e=i?.SubSection?.getTitle();i?.SubSection?.setShowTitle(false)}if(e===""&&i?.SubSection){e=(i?.SubSection).getTitle()}if(n.sendDataToConsumer){n.sendDataToConsumer({titleLevel:this.getTitleLevel(),title:e});this.setShowTitle(false);this.addStyleClass("sapUiTableOnObjectPageAdjustmentsForSection")}}else if(t?.isA("sap.m.Title")){const e=t;e.setText(this.getTitle());e.setTitleStyle("H4");e.setLevel(this.getTitleLevel());this.setShowTitle(false);this.addStyleClass("sapUiTableOnObjectPageAdjustmentsForSection")}else if(this.checkIfNotesReuseComponent(t)){const e=t.getItems();e.forEach(e=>{const t=e.getAggregation("headerToolbar");if(t){t?.getContent().forEach(e=>{if(e.isA("sap.m.Title")){const t=e;t.setText(this.getTitle());t.setTitleStyle("H4");t.setLevel(this.getTitleLevel())}})}});this.setShowTitle(false);this.addStyleClass("sapUiTableOnObjectPageAdjustmentsForSection")}};return l}(l),f=T(g.prototype,"onSectionLoaded",[r],{configurable:true,enumerable:true,writable:true,initializer:null}),S=T(g.prototype,"useSingleTextAreaFieldAsNotes",[a],{configurable:true,enumerable:true,writable:true,initializer:null}),g))||u);return A},false);
//# sourceMappingURL=Section.js.map
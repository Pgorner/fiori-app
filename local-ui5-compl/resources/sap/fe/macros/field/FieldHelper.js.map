{"version":3,"file":"FieldHelper.js","names":["ISOCurrency","Unit","FieldHelper","getActionParameterVisibility","oParam","oContext","oParamIf","$If","length","oNegParam","AnnotationHelper","value","$Path","undefined","propertyName","vProperty","oInterface","sPropertyName","context","getPath","includes","$PropertyPath","sPath","sContextPath","getObject","Value","fieldControl","sPropertyPath","oModel","getModel","oFieldControlContext","createBindingContext","oFieldControl","getProperty","hasOwnProperty","$EnumMember","valueHelpProperty","oPropertyContext","bInFilterField","oContent","sAnnoPath","oPropertyAnnotations","sAnnotation","sUnitOrCurrencyPath","valueHelpPropertyForFilterField","getIDForFieldValueHelp","sFlexId","sIdPrefix","sOriginalPropertyName","sProperty","generate","getValueHelpPropertyForFilterField","propertyContext","oProperty","sPropertyType","sVhIdPrefix","sValueHelpPropertyName","bHasValueListWithFixedValues","bUseSemanticDateRange","bSemanticDateRange","sPropertyLocationPath","CommonHelper","getLocationForPropertyPath","oFilterRestrictions","CommonUtils","getFilterRestrictionsByPath","FilterAllowedExpressions","computeFieldBaseDelegate","delegateName","retrieveTextFromValueList","name","payload","_getPrimaryIntents","async","appComponent","semanticObjectsList","promises","navigationService","getShellServices","forEach","semObject","push","getPrimaryIntent","Promise","all","then","semanticObjectPrimaryActions","catch","oError","Log","error","findPrimaryActionWithinIntents","primaryIntentsFromNavigationService","firstPrimaryActionIndex","findIndex","action","primaryIntentFound","semanticObjectWithPrimaryAction","semanticObjects","_checkIfSemanticObjectsHasPrimaryAction","_fnIsSemanticObjectActionUnavailable","payloadResolved","primaryIntent","_index","unavailableActionsIndex","semanticObjectUnavailableActions","actions","intent","split","indexOf","semanticPrimaryActions","this","currentHash","getHash","index","semanticObject","checkPrimaryActions","bGetTitleLink","aSemanticObjectsPrimaryActions","titleLink","hasTitleLink","_getTitleLinkWithParameters","semanticObjectModel","_linkIntent","getPrimaryAction","find","primaryAction","operators","sSettings","contextPath","propertyType","$Type","getOperatorsForGuidProperty","slice","isTableBoundToNavigation","lastIndexOf","isNavigationPath","navigationPath","substring","propertyPath","getOperatorsForProperty","ModelHelper","getEntitySetPath","toString","getOperatorsForDateProperty","getDataFieldDefault","oDataFieldContext","oDataFieldDefault","isDataFieldActionButtonVisible","oDataField","bIsBound","oActionContext","annotations","UI","Hidden","valueOf","getPressEventForDataFieldActionButton","oThis","sInvocationGrouping","InvocationGrouping","bIsNavigable","navigateAfterAction","entities","entitySetName","oParams","contexts","invocationGrouping","addSingleQuotes","model","label","Label","isNavigable","generateFunction","Action","objectToString","isNumericDataType","sDataFieldType","_sDataFieldType","aNumericDataTypes","isDateOrTimeDataType","aDateTimeDataTypes","isDateTimeDataType","aDateDataTypes","isDateDataType","isTimeDataType","getDataTypeForVisualization","oAnnotations","sType","sTextAnnotation","sTextArrangementAnnotation","getColumnAlignment","oTable","sEntityPath","collection","Inline","IconUrl","aSemanticKeys","bIsSemanticKey","every","oKey","getDataFieldAlignment","getPropertyAlignment","oFormatOptions","oComputedEditMode","sDefaultAlignment","sTextAlignment","textAlignMode","getAlignmentExpression","dataField","entityPath","formatOptions","computedEditMode","dataFieldPath","defaultAlignment","type","Target","$AnnotationPath","fieldGroup","i","Data","keys","isDataFieldActionButtonEnabled","sActionContextFormat","computeLabelText","endsWith","sDataFieldLabel","sDataFieldTargetTitle","sDataFieldTargetLabel","sDataFieldValueLabel","sDataFieldTargetValueLabel","buildExpressionForAlignItems","sVisualization","fieldVisualizationBindingExpression","constant","progressVisualizationBindingExpression","ratingVisualizationBindingExpression","compileExpression","ifElse","or","equal","IsEditable","hasValueHelpAnnotation","getAPDialogDisplayFormat","oAnnotation","$Name","oActionParameterAnnotations","oValueHelpAnnotation","getValueListPropertyName","oValueList","oValueListParameter","Parameters","oParameter","LocalDataProperty","ValueListProperty","sValueListPropertyName","computeDisplayMode","CollectionPath","requestValueListInfo","oValueListInfo","$model","getMetaModel","getActionParameterDialogValueHelp","oActionParameter","sSapUIName","sParamName","getValueHelpDelegate","isBound","entityTypePath","sapUIName","paramName","delegateConfiguration","ValueListHelper","getPropertyPath","UnboundAction","EntityTypePath","Property","qualifiers","valueHelpQualifier","isActionParameterDialog","getValueHelpDelegateForNonComputedVisibleKeyField","_getEntitySetFromMultiLevel","sSourceEntity","iStart","iDiff","aNavParts","filter","Boolean","sPart","getPathForIconSource","getFilenameExpr","sFilename","sNoFilenameText","calculateMBfromByte","iByte","toFixed","getDownloadUrl","getMarginClass","compactSemanticKey","getRequired","immutableKey","target","requiredProperties","targetRequiredExpression","isRequiredExpression","targetObject","isFieldPartOfForm","dataFieldCollection","dataFieldObjectPath","connectedDataFieldKey","KeyHelper","generateKeyFromDataField","isFieldFound","field","key","requiresIContext"],"sources":["./FieldHelper.ts"],"sourcesContent":["import type { Property } from \"@sap-ux/vocabularies-types\";\nimport type { OperationAvailable } from \"@sap-ux/vocabularies-types/vocabularies/Core\";\nimport type { OperationGroupingType } from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport {\n\tUIAnnotationTypes,\n\ttype DataField,\n\ttype DataFieldAbstractTypes,\n\ttype DataFieldForAction,\n\ttype DataFieldForAnnotation,\n\ttype DataFieldTypes,\n\ttype DataPointType,\n\ttype DataPointTypeTypes\n} from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport Log from \"sap/base/Log\";\nimport type { BindingToolkitExpression, CompiledBindingToolkitExpression } from \"sap/fe/base/BindingToolkit\";\nimport { compileExpression, constant, equal, ifElse, or } from \"sap/fe/base/BindingToolkit\";\nimport type AppComponent from \"sap/fe/core/AppComponent\";\nimport CommonUtils from \"sap/fe/core/CommonUtils\";\nimport type { MetaModelPropertyAnnotations } from \"sap/fe/core/converters/MetaModelConverter\";\nimport type { FormElement } from \"sap/fe/core/converters/controls/Common/Form\";\nimport { KeyHelper } from \"sap/fe/core/converters/helpers/Key\";\nimport { UI } from \"sap/fe/core/helpers/BindingHelper\";\nimport ModelHelper from \"sap/fe/core/helpers/ModelHelper\";\nimport { generate } from \"sap/fe/core/helpers/StableIdHelper\";\nimport type { DataModelObjectPath } from \"sap/fe/core/templating/DataModelPathHelper\";\nimport { isRequiredExpression } from \"sap/fe/core/templating/FieldControlHelper\";\nimport type { ComputedAnnotationInterface } from \"sap/fe/core/templating/UIFormatters\";\nimport { getAlignmentExpression } from \"sap/fe/core/templating/UIFormatters\";\nimport CommonHelper from \"sap/fe/macros/CommonHelper\";\nimport type { FieldBlockProperties } from \"sap/fe/macros/internal/field/FieldStructureHelper\";\nimport type { ValueHelpPayload } from \"sap/fe/macros/internal/valuehelp/ValueListHelper\";\nimport ValueListHelper from \"sap/fe/macros/internal/valuehelp/ValueListHelper\";\nimport type { LinkDelegatePayload, RegisteredPrimaryIntent, RegisteredPrimaryIntents } from \"sap/fe/macros/quickView/QuickViewDelegate\";\nimport type BaseContext from \"sap/ui/model/Context\";\nimport AnnotationHelper from \"sap/ui/model/odata/v4/AnnotationHelper\";\nimport type Context from \"sap/ui/model/odata/v4/Context\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\nimport type { Link as NavigationLink } from \"sap/ushell/services/Navigation\";\nimport type { MetaModelEnum, MetaModelProperty, MetaModelType } from \"../../../../../../../types/metamodel_types\";\n\nconst ISOCurrency = \"@Org.OData.Measures.V1.ISOCurrency\",\n\tUnit = \"@Org.OData.Measures.V1.Unit\";\n\nconst FieldHelper = {\n\tgetActionParameterVisibility: function (oParam: unknown, oContext: ComputedAnnotationInterface): string | undefined {\n\t\t// To use the UI.Hidden annotation for controlling visibility the value needs to be negated\n\t\tif (typeof oParam === \"object\") {\n\t\t\tconst oParamIf = oParam as { $If?: unknown[] };\n\t\t\tif (oParamIf && oParamIf.$If && oParamIf.$If.length === 3) {\n\t\t\t\t// In case the UI.Hidden contains a dynamic expression we do this\n\t\t\t\t// by just switching the \"then\" and \"else\" part of the erpression\n\t\t\t\t// oParam.$If[0] <== Condition part\n\t\t\t\t// oParam.$If[1] <== Then part\n\t\t\t\t// oParam.$If[2] <== Else part\n\t\t\t\tconst oNegParam = { $If: [] } as { $If: unknown[] };\n\t\t\t\toNegParam.$If[0] = oParamIf.$If[0];\n\t\t\t\toNegParam.$If[1] = oParamIf.$If[2];\n\t\t\t\toNegParam.$If[2] = oParamIf.$If[1];\n\t\t\t\treturn AnnotationHelper.value(oNegParam, oContext);\n\t\t\t} else {\n\t\t\t\treturn \"{= !%{\" + (oParam as { $Path?: string }).$Path + \"} }\";\n\t\t\t}\n\t\t} else if (typeof oParam === \"boolean\") {\n\t\t\treturn AnnotationHelper.value(!oParam, oContext);\n\t\t} else {\n\t\t\treturn undefined;\n\t\t}\n\t},\n\n\t/**\n\t * Computed annotation that returns vProperty for a string and @sapui.name for an object.\n\t * @param vProperty The property\n\t * @param oInterface The interface instance\n\t * @returns The property name\n\t */\n\tpropertyName: function (\n\t\tvProperty: string | { $Path?: string } | { $PropertyPath?: string } | { Value: { $Path?: string } },\n\t\toInterface: ComputedAnnotationInterface\n\t): string {\n\t\tlet sPropertyName;\n\t\tif (typeof vProperty === \"string\") {\n\t\t\tif (oInterface.context.getPath().includes(\"$Path\") || oInterface.context.getPath().includes(\"$PropertyPath\")) {\n\t\t\t\t// We could end up with a pure string property (no $Path), and this is not a real property in that case\n\t\t\t\tsPropertyName = vProperty;\n\t\t\t}\n\t\t} else if ((vProperty as { $Path?: string }).$Path || (vProperty as { $PropertyPath?: string }).$PropertyPath) {\n\t\t\tconst sPath = (vProperty as { $Path?: string }).$Path ? \"/$Path\" : \"/$PropertyPath\";\n\t\t\tconst sContextPath = oInterface.context.getPath();\n\t\t\tsPropertyName = oInterface.context.getObject(`${sContextPath + sPath}/$@sapui.name`);\n\t\t} else if ((vProperty as { Value: { $Path?: string } }).Value && (vProperty as { Value: { $Path?: string } }).Value.$Path) {\n\t\t\tsPropertyName = (vProperty as { Value: { $Path?: string } }).Value.$Path;\n\t\t} else {\n\t\t\tsPropertyName = oInterface.context.getObject(\"@sapui.name\");\n\t\t}\n\n\t\treturn sPropertyName;\n\t},\n\n\tfieldControl: function (sPropertyPath: string, oInterface: ComputedAnnotationInterface): string | undefined {\n\t\t// editable header facet\n\t\tconst oModel = oInterface && oInterface.context.getModel();\n\t\tconst sPath = oInterface && oInterface.context.getPath();\n\t\tconst oFieldControlContext = oModel && oModel.createBindingContext(`${sPath}@com.sap.vocabularies.Common.v1.FieldControl`);\n\t\tconst oFieldControl = oFieldControlContext && oFieldControlContext.getProperty();\n\t\tif (oFieldControl) {\n\t\t\tif (oFieldControl.hasOwnProperty(\"$EnumMember\")) {\n\t\t\t\treturn oFieldControl.$EnumMember;\n\t\t\t} else if (oFieldControl.hasOwnProperty(\"$Path\")) {\n\t\t\t\treturn AnnotationHelper.value(oFieldControl, { context: oFieldControlContext });\n\t\t\t}\n\t\t} else {\n\t\t\treturn undefined;\n\t\t}\n\t},\n\n\t/**\n\t * Method to get the value help property from a DataField or a PropertyPath (in case a SelectionField is used)\n\t * Priority from where to get the property value of the field (examples are \"Name\" and \"Supplier\"):\n\t * 1. If oPropertyContext.getObject() has key '$Path', then we take the value at '$Path'.\n\t * 2. Else, value at oPropertyContext.getObject().\n\t * If there is an ISOCurrency or if there are Unit annotations for the field property,\n\t * then the Path at the ISOCurrency or Unit annotations of the field property is considered.\n\t * @param oPropertyContext The context from which value help property need to be extracted.\n\t * @param bInFilterField Whether or not we're in the filter field and should ignore\n\t * @returns The value help property path\n\t */\n\tvalueHelpProperty: function (oPropertyContext: BaseContext, bInFilterField?: boolean): string {\n\t\t/* For currency (and later Unit) we need to forward the value help to the annotated field */\n\t\tconst sContextPath = oPropertyContext.getPath();\n\t\tconst oContent = oPropertyContext.getObject() || {};\n\t\tlet sPath = oContent.$Path ? `${sContextPath}/$Path` : sContextPath;\n\t\tconst sAnnoPath = `${sPath}@`;\n\t\tconst oPropertyAnnotations = oPropertyContext.getObject(sAnnoPath);\n\t\tlet sAnnotation;\n\t\tif (oPropertyAnnotations) {\n\t\t\tsAnnotation =\n\t\t\t\t(oPropertyAnnotations.hasOwnProperty(ISOCurrency) && ISOCurrency) || (oPropertyAnnotations.hasOwnProperty(Unit) && Unit);\n\t\t\tif (sAnnotation && !bInFilterField) {\n\t\t\t\tconst sUnitOrCurrencyPath = `${sPath + sAnnotation}/$Path`;\n\t\t\t\t// we check that the currency or unit is a Property and not a fixed value\n\t\t\t\tif (oPropertyContext.getObject(sUnitOrCurrencyPath)) {\n\t\t\t\t\tsPath = sUnitOrCurrencyPath;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn sPath;\n\t},\n\n\t/**\n\t * Dedicated method to avoid looking for unit properties.\n\t * @param oPropertyContext\n\t * @returns The value help property path\n\t */\n\tvalueHelpPropertyForFilterField: function (oPropertyContext: BaseContext): string {\n\t\treturn FieldHelper.valueHelpProperty(oPropertyContext, true);\n\t},\n\n\t/**\n\t * Method to generate the ID for Value Help.\n\t * @param sFlexId Flex ID of the current object\n\t * @param sIdPrefix Prefix for the ValueHelp ID\n\t * @param sOriginalPropertyName Name of the property\n\t * @param sPropertyName Name of the ValueHelp Property\n\t * @returns The ID generated for the ValueHelp\n\t */\n\tgetIDForFieldValueHelp: function (\n\t\tsFlexId: string | null,\n\t\tsIdPrefix: string,\n\t\tsOriginalPropertyName: string,\n\t\tsPropertyName: string\n\t): string {\n\t\tif (sFlexId) {\n\t\t\treturn sFlexId;\n\t\t}\n\t\tlet sProperty = sPropertyName;\n\t\tif (sOriginalPropertyName !== sPropertyName) {\n\t\t\tsProperty = `${sOriginalPropertyName}::${sPropertyName}`;\n\t\t}\n\t\treturn generate([sIdPrefix, sProperty]);\n\t},\n\n\t/*\n\t * Method to get the valueHelp property of the FilterField.\n\t *\n\t * @function\n\t * @name getValueHelpPropertyForFilterField\n\t * @memberof sap.fe.macros.field.FieldHelper.js\n\t * @param propertyContext Property context for filter field\n\t * @param oProperty The object of the ValueHelp property\n\t * @param sPropertyType The $Type of the property\n\t * @param sVhIdPrefix The ID prefix of the value help\n\t * @param sPropertyName The name of the property\n\t * @param sValueHelpPropertyName The property name of the value help\n\t * @param bHasValueListWithFixedValues `true` if there is a value list with a fixed value annotation\n\t * @param bUseSemanticDateRange `true` if the semantic date range is set to 'true' in the manifest\n\t * @returns The field help property of the value help\n\t */\n\tgetValueHelpPropertyForFilterField: function (\n\t\tpropertyContext: BaseContext,\n\t\toProperty: MetaModelType<Property>,\n\t\tsPropertyType: string,\n\t\tsVhIdPrefix: string,\n\t\tsPropertyName: string,\n\t\tsValueHelpPropertyName: string,\n\t\tbHasValueListWithFixedValues: boolean,\n\t\tbUseSemanticDateRange: boolean | string\n\t): string | undefined {\n\t\tconst sProperty = FieldHelper.propertyName(\n\t\t\t\toProperty as unknown as string | { $Path?: string } | { $PropertyPath?: string } | { Value: { $Path?: string } },\n\t\t\t\t{ context: propertyContext }\n\t\t\t),\n\t\t\tbSemanticDateRange = bUseSemanticDateRange === \"true\" || bUseSemanticDateRange === true;\n\t\tconst oModel = propertyContext.getModel() as ODataMetaModel,\n\t\t\tsPropertyPath = propertyContext.getPath(),\n\t\t\tsPropertyLocationPath = CommonHelper.getLocationForPropertyPath(oModel, sPropertyPath),\n\t\t\toFilterRestrictions = CommonUtils.getFilterRestrictionsByPath(sPropertyLocationPath, oModel);\n\t\tif (\n\t\t\t((sPropertyType === \"Edm.DateTimeOffset\" || sPropertyType === \"Edm.Date\" || sPropertyType === \"Edm.TimeOfDay\") &&\n\t\t\t\tbSemanticDateRange &&\n\t\t\t\toFilterRestrictions &&\n\t\t\t\toFilterRestrictions.FilterAllowedExpressions &&\n\t\t\t\toFilterRestrictions.FilterAllowedExpressions[sProperty] &&\n\t\t\t\t(oFilterRestrictions.FilterAllowedExpressions[sProperty].includes(\"SingleRange\") ||\n\t\t\t\t\toFilterRestrictions.FilterAllowedExpressions[sProperty].includes(\"SingleValue\"))) ||\n\t\t\t(sPropertyType === \"Edm.Boolean\" && !bHasValueListWithFixedValues)\n\t\t) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn FieldHelper.getIDForFieldValueHelp(null, sVhIdPrefix || \"FilterFieldValueHelp\", sPropertyName, sValueHelpPropertyName);\n\t},\n\n\t/*\n\t * Method to compute the delegate with payload\n\t * @function\n\t * @param {object} delegateName - name of the delegate methode\n\t * @param {boolean} retrieveTextFromValueList - added to the payload of the delegate methode\n\t * @return {object} - returns the delegate with payload\n\t */\n\tcomputeFieldBaseDelegate: function (delegateName: string, retrieveTextFromValueList: boolean): object {\n\t\tif (retrieveTextFromValueList) {\n\t\t\treturn {\n\t\t\t\tname: delegateName,\n\t\t\t\tpayload: {\n\t\t\t\t\tretrieveTextFromValueList: retrieveTextFromValueList\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\treturn { name: delegateName };\n\t},\n\t_getPrimaryIntents: async function (appComponent: AppComponent, semanticObjectsList: string[]): Promise<NavigationLink[]> {\n\t\tconst promises: Promise<NavigationLink>[] = [];\n\t\tconst navigationService = appComponent.getShellServices();\n\t\tsemanticObjectsList.forEach(function (semObject) {\n\t\t\tpromises.push(navigationService.getPrimaryIntent(semObject));\n\t\t});\n\t\treturn Promise.all(promises)\n\t\t\t.then(function (semanticObjectPrimaryActions: NavigationLink[]) {\n\t\t\t\treturn semanticObjectPrimaryActions;\n\t\t\t})\n\t\t\t.catch(function (oError) {\n\t\t\t\tLog.error(\"Error fetching primary intents\", oError);\n\t\t\t\treturn [];\n\t\t\t});\n\t},\n\n\t/**\n\t * Finds the primary action within intents based on the provided parameters.\n\t * @param primaryIntentsFromNavigationService The registered primary intents from the navigation service.\n\t * @param payload The registered payload.\n\t * @returns\n\t *\n\t *\n\t *  An object containing information about the primary action within intents.\n\t */\n\tfindPrimaryActionWithinIntents: function (\n\t\tprimaryIntentsFromNavigationService: RegisteredPrimaryIntents,\n\t\tpayload: LinkDelegatePayload\n\t): {\n\t\tsemanticObjectWithPrimaryAction: string;\n\t\tprimaryIntentFound: RegisteredPrimaryIntent | undefined;\n\t} {\n\t\tconst firstPrimaryActionIndex = primaryIntentsFromNavigationService.findIndex((action: RegisteredPrimaryIntent) => !!action);\n\t\tconst primaryIntentFound = primaryIntentsFromNavigationService[firstPrimaryActionIndex];\n\n\t\tconst semanticObjectWithPrimaryAction = payload.semanticObjects[firstPrimaryActionIndex];\n\t\treturn {\n\t\t\tsemanticObjectWithPrimaryAction: semanticObjectWithPrimaryAction,\n\t\t\tprimaryIntentFound: primaryIntentFound\n\t\t};\n\t},\n\n\t_checkIfSemanticObjectsHasPrimaryAction: function (\n\t\tpayload: LinkDelegatePayload,\n\t\tprimaryIntentsFromNavigationService: RegisteredPrimaryIntents,\n\t\tappComponent: AppComponent\n\t): boolean {\n\t\tconst _fnIsSemanticObjectActionUnavailable = function (\n\t\t\tpayloadResolved: LinkDelegatePayload,\n\t\t\tprimaryIntent: RegisteredPrimaryIntent,\n\t\t\t_index: number\n\t\t): boolean {\n\t\t\tfor (const unavailableActionsIndex in payloadResolved.semanticObjectUnavailableActions[_index].actions) {\n\t\t\t\tif (\n\t\t\t\t\tprimaryIntent.intent\n\t\t\t\t\t\t.split(\"-\")[1]\n\t\t\t\t\t\t.indexOf(payloadResolved.semanticObjectUnavailableActions[_index].actions[unavailableActionsIndex]) === 0\n\t\t\t\t) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t};\n\t\tpayload.semanticPrimaryActions = primaryIntentsFromNavigationService;\n\t\tconst { semanticObjectWithPrimaryAction, primaryIntentFound } = this.findPrimaryActionWithinIntents(\n\t\t\tprimaryIntentsFromNavigationService,\n\t\t\tpayload\n\t\t);\n\t\tconst currentHash = appComponent.getShellServices().getHash();\n\t\t// Remove the intent parameters before checking with the current hash\n\t\tif (!!primaryIntentFound && primaryIntentFound.intent.split(\"?\")[0] !== currentHash) {\n\t\t\tfor (let index = 0; index < payload.semanticObjectUnavailableActions.length; index++) {\n\t\t\t\tif (payload.semanticObjectUnavailableActions[index].semanticObject === semanticObjectWithPrimaryAction) {\n\t\t\t\t\treturn _fnIsSemanticObjectActionUnavailable(payload, primaryIntentFound, index);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},\n\tcheckPrimaryActions: async function (\n\t\tpayload: LinkDelegatePayload,\n\t\tbGetTitleLink: boolean,\n\t\tappComponent: AppComponent\n\t): Promise<boolean | void | { titleLink: NavigationLink[]; hasTitleLink: boolean; payload: LinkDelegatePayload }> {\n\t\treturn this._getPrimaryIntents(appComponent, payload && payload.semanticObjects)\n\t\t\t.then((aSemanticObjectsPrimaryActions: NavigationLink[]) => {\n\t\t\t\treturn bGetTitleLink\n\t\t\t\t\t? {\n\t\t\t\t\t\t\ttitleLink: aSemanticObjectsPrimaryActions,\n\t\t\t\t\t\t\thasTitleLink: this._checkIfSemanticObjectsHasPrimaryAction(\n\t\t\t\t\t\t\t\tpayload,\n\t\t\t\t\t\t\t\taSemanticObjectsPrimaryActions,\n\t\t\t\t\t\t\t\tappComponent\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tpayload: payload\n\t\t\t\t\t  }\n\t\t\t\t\t: this._checkIfSemanticObjectsHasPrimaryAction(payload, aSemanticObjectsPrimaryActions, appComponent);\n\t\t\t})\n\t\t\t.catch(function (oError) {\n\t\t\t\tLog.error(\"Error in checkPrimaryActions\", oError);\n\t\t\t});\n\t},\n\t_getTitleLinkWithParameters: function (semanticObjectModel: LinkDelegatePayload, _linkIntent: string | undefined): string | undefined {\n\t\tif (semanticObjectModel && semanticObjectModel.titleLink) {\n\t\t\treturn semanticObjectModel.titleLink;\n\t\t} else {\n\t\t\treturn _linkIntent;\n\t\t}\n\t},\n\n\tgetPrimaryAction: function (payload: LinkDelegatePayload): string | undefined {\n\t\tconst primaryIntent = payload.semanticPrimaryActions?.find((primaryAction) => !!primaryAction);\n\t\treturn FieldHelper._getTitleLinkWithParameters(payload, primaryIntent?.intent);\n\t},\n\t/**\n\t * Method to fetch the filter restrictions. Filter restrictions can be annotated on an entity set or a navigation property.\n\t * Depending on the path to which the control is bound, we check for filter restrictions on the context path of the control,\n\t * or on the navigation property (if there is a navigation).\n\t * Eg. If the table is bound to '/EntitySet', for property path '/EntitySet/_Association/PropertyName', the filter restrictions\n\t * on '/EntitySet' win over filter restrictions on '/EntitySet/_Association'.\n\t * If the table is bound to '/EntitySet/_Association', the filter restrictions on '/EntitySet/_Association' win over filter\n\t * retrictions on '/AssociationEntitySet'.\n\t * @param oContext Property Context\n\t * @param oProperty Property object in the metadata\n\t * @param bUseSemanticDateRange Boolean Suggests if semantic date range should be used\n\t * @param sSettings Stringified object of the property settings\n\t * @param contextPath Path to which the parent control (the table or the filter bar) is bound\n\t * @returns String containing comma-separated list of operators for filtering\n\t */\n\toperators: function (\n\t\toContext: BaseContext,\n\t\toProperty: MetaModelProperty,\n\t\tbUseSemanticDateRange: boolean,\n\t\tsSettings: string,\n\t\tcontextPath: string\n\t): string | undefined {\n\t\t// this is used in FilterField.block\n\t\tif (!oProperty || !contextPath) {\n\t\t\treturn undefined;\n\t\t}\n\t\tlet operators: string[];\n\t\tconst sProperty = FieldHelper.propertyName(\n\t\t\toProperty as unknown as string | { $Path?: string } | { $PropertyPath?: string } | { Value: { $Path?: string } },\n\t\t\t{ context: oContext }\n\t\t);\n\t\tconst oModel = oContext.getModel() as ODataMetaModel,\n\t\t\tsPropertyPath = oContext.getPath(),\n\t\t\tsPropertyLocationPath = CommonHelper.getLocationForPropertyPath(oModel, sPropertyPath),\n\t\t\tpropertyType = oProperty.$Type;\n\n\t\tif (propertyType === \"Edm.Guid\") {\n\t\t\treturn CommonUtils.getOperatorsForGuidProperty();\n\t\t}\n\n\t\t// remove '/'\n\t\tcontextPath = contextPath.slice(0, -1);\n\t\tconst isTableBoundToNavigation: boolean = contextPath.lastIndexOf(\"/\") > 0;\n\t\tconst isNavigationPath: boolean =\n\t\t\t(isTableBoundToNavigation && contextPath !== sPropertyLocationPath) ||\n\t\t\t(!isTableBoundToNavigation && sPropertyLocationPath.lastIndexOf(\"/\") > 0);\n\t\tconst navigationPath: string =\n\t\t\t(isNavigationPath && sPropertyLocationPath.substring(sPropertyLocationPath.indexOf(contextPath) + contextPath.length + 1)) ||\n\t\t\t\"\";\n\t\tconst propertyPath: string = (isNavigationPath && navigationPath + \"/\" + sProperty) || sProperty;\n\n\t\tif (!isTableBoundToNavigation) {\n\t\t\tif (!isNavigationPath) {\n\t\t\t\t// /SalesOrderManage/ID\n\t\t\t\toperators = CommonHelper.getOperatorsForProperty(\n\t\t\t\t\tsProperty,\n\t\t\t\t\tsPropertyLocationPath,\n\t\t\t\t\toModel,\n\t\t\t\t\tpropertyType,\n\t\t\t\t\tbUseSemanticDateRange,\n\t\t\t\t\tsSettings\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\t// /SalesOrderManange/_Item/Material\n\t\t\t\t//let operators\n\t\t\t\toperators = CommonHelper.getOperatorsForProperty(\n\t\t\t\t\tpropertyPath,\n\t\t\t\t\tcontextPath,\n\t\t\t\t\toModel,\n\t\t\t\t\tpropertyType,\n\t\t\t\t\tbUseSemanticDateRange,\n\t\t\t\t\tsSettings\n\t\t\t\t);\n\t\t\t\tif (operators.length === 0) {\n\t\t\t\t\toperators = CommonHelper.getOperatorsForProperty(\n\t\t\t\t\t\tsProperty,\n\t\t\t\t\t\tsPropertyLocationPath,\n\t\t\t\t\t\toModel,\n\t\t\t\t\t\tpropertyType,\n\t\t\t\t\t\tbUseSemanticDateRange,\n\t\t\t\t\t\tsSettings\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (!isNavigationPath) {\n\t\t\t// /SalesOrderManage/_Item/Material\n\t\t\toperators = CommonHelper.getOperatorsForProperty(\n\t\t\t\tpropertyPath,\n\t\t\t\tcontextPath,\n\t\t\t\toModel,\n\t\t\t\tpropertyType,\n\t\t\t\tbUseSemanticDateRange,\n\t\t\t\tsSettings\n\t\t\t);\n\t\t\tif (operators.length === 0) {\n\t\t\t\toperators = CommonHelper.getOperatorsForProperty(\n\t\t\t\t\tsProperty,\n\t\t\t\t\tModelHelper.getEntitySetPath(contextPath),\n\t\t\t\t\toModel,\n\t\t\t\t\tpropertyType,\n\t\t\t\t\tbUseSemanticDateRange,\n\t\t\t\t\tsSettings\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn operators?.length > 0 ? operators.toString() : undefined;\n\t\t} else {\n\t\t\t// /SalesOrderManage/_Item/_Association/PropertyName\n\t\t\t// This is currently not supported for tables\n\t\t\toperators = CommonHelper.getOperatorsForProperty(\n\t\t\t\tpropertyPath,\n\t\t\t\tcontextPath,\n\t\t\t\toModel,\n\t\t\t\tpropertyType,\n\t\t\t\tbUseSemanticDateRange,\n\t\t\t\tsSettings\n\t\t\t);\n\t\t\tif (operators.length === 0) {\n\t\t\t\toperators = CommonHelper.getOperatorsForProperty(\n\t\t\t\t\tpropertyPath,\n\t\t\t\t\tModelHelper.getEntitySetPath(contextPath),\n\t\t\t\t\toModel,\n\t\t\t\t\tpropertyType,\n\t\t\t\t\tbUseSemanticDateRange,\n\t\t\t\t\tsSettings\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif ((!operators || operators.length === 0) && (propertyType === \"Edm.Date\" || propertyType === \"Edm.DateTimeOffset\")) {\n\t\t\toperators = CommonHelper.getOperatorsForDateProperty(propertyType);\n\t\t}\n\n\t\treturn operators.length > 0 ? operators.toString() : undefined;\n\t},\n\t/**\n\t * Return the path of the DaFieldDefault (if any). Otherwise, the DataField path is returned.\n\t * @param oDataFieldContext Context of the DataField\n\t * @returns Object path\n\t */\n\tgetDataFieldDefault: function (oDataFieldContext: BaseContext): string {\n\t\t// this is used in column.fragment\n\t\tconst oDataFieldDefault = (oDataFieldContext.getModel() as ODataMetaModel).getObject(\n\t\t\t`${oDataFieldContext.getPath()}@com.sap.vocabularies.UI.v1.DataFieldDefault`\n\t\t);\n\t\treturn oDataFieldDefault\n\t\t\t? `${oDataFieldContext.getPath()}@com.sap.vocabularies.UI.v1.DataFieldDefault`\n\t\t\t: oDataFieldContext.getPath();\n\t},\n\t/*\n\t * Method to get visible expression for DataFieldActionButton\n\t * @function\n\t * @name isDataFieldActionButtonVisible\n\t * @param {object} oThis - Current Object\n\t * @param {object} oDataField - DataPoint's Value\n\t * @param {boolean} bIsBound - DataPoint action bound\n\t * @param {object} oActionContext - ActionContext Value\n\t * @return {boolean} - returns boolean\n\t */\n\tisDataFieldActionButtonVisible: function (\n\t\toDataField: DataFieldAbstractTypes | DataPointTypeTypes,\n\t\tbIsBound: boolean | undefined,\n\t\toActionContext?: boolean\n\t): boolean {\n\t\treturn oDataField.annotations?.UI?.Hidden?.valueOf() !== true && (bIsBound !== true || oActionContext !== false);\n\t},\n\t/**\n\t * Method to get press event for DataFieldActionButton.\n\t * @param oThis Current Object\n\t * @param oDataField DataPoint's Value\n\t * @returns The binding expression for the DataFieldActionButton press event\n\t */\n\tgetPressEventForDataFieldActionButton: function (oThis: FieldBlockProperties, oDataField: MetaModelType<DataFieldForAction>): string {\n\t\tlet sInvocationGrouping = \"Isolated\";\n\t\tif (\n\t\t\toDataField.InvocationGrouping &&\n\t\t\t(oDataField.InvocationGrouping as unknown as MetaModelEnum<OperationGroupingType>).$EnumMember ===\n\t\t\t\t\"com.sap.vocabularies.UI.v1.OperationGroupingType/ChangeSet\"\n\t\t) {\n\t\t\tsInvocationGrouping = \"ChangeSet\";\n\t\t}\n\t\tlet bIsNavigable = oThis.navigateAfterAction as boolean | string;\n\t\tbIsNavigable = bIsNavigable === \"false\" ? false : true;\n\n\t\tconst entities: Array<string> = oThis?.contextPath?.getPath().split(\"/\");\n\t\tconst entitySetName: string = entities[entities.length - 1];\n\n\t\tconst oParams = {\n\t\t\tcontexts: \"${$source>/}.getBindingContext()\",\n\t\t\tinvocationGrouping: CommonHelper.addSingleQuotes(sInvocationGrouping),\n\t\t\tmodel: \"${$source>/}.getModel()\",\n\t\t\tlabel: CommonHelper.addSingleQuotes(oDataField.Label!, true),\n\t\t\tisNavigable: bIsNavigable,\n\t\t\tentitySetName: CommonHelper.addSingleQuotes(entitySetName)\n\t\t};\n\n\t\treturn CommonHelper.generateFunction(\n\t\t\t\".editFlow.invokeAction\",\n\t\t\tCommonHelper.addSingleQuotes(oDataField.Action!),\n\t\t\tCommonHelper.objectToString(oParams)\n\t\t);\n\t},\n\n\tisNumericDataType: function (sDataFieldType: string): boolean {\n\t\tconst _sDataFieldType = sDataFieldType;\n\t\tif (_sDataFieldType !== undefined) {\n\t\t\tconst aNumericDataTypes = [\n\t\t\t\t\"Edm.Int16\",\n\t\t\t\t\"Edm.Int32\",\n\t\t\t\t\"Edm.Int64\",\n\t\t\t\t\"Edm.Byte\",\n\t\t\t\t\"Edm.SByte\",\n\t\t\t\t\"Edm.Single\",\n\t\t\t\t\"Edm.Decimal\",\n\t\t\t\t\"Edm.Double\"\n\t\t\t];\n\t\t\treturn !aNumericDataTypes.includes(_sDataFieldType) ? false : true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t},\n\n\tisDateOrTimeDataType: function (sPropertyType: string): boolean {\n\t\tif (sPropertyType !== undefined) {\n\t\t\tconst aDateTimeDataTypes = [\"Edm.DateTimeOffset\", \"Edm.DateTime\", \"Edm.Date\", \"Edm.TimeOfDay\", \"Edm.Time\"];\n\t\t\treturn aDateTimeDataTypes.includes(sPropertyType);\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t},\n\tisDateTimeDataType: function (sPropertyType: string): boolean {\n\t\tif (sPropertyType !== undefined) {\n\t\t\tconst aDateDataTypes = [\"Edm.DateTimeOffset\", \"Edm.DateTime\"];\n\t\t\treturn aDateDataTypes.includes(sPropertyType);\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t},\n\tisDateDataType: function (sPropertyType: string): boolean {\n\t\treturn sPropertyType === \"Edm.Date\";\n\t},\n\tisTimeDataType: function (sPropertyType: string): boolean {\n\t\tif (sPropertyType !== undefined) {\n\t\t\tconst aDateDataTypes = [\"Edm.TimeOfDay\", \"Edm.Time\"];\n\t\t\treturn aDateDataTypes.includes(sPropertyType);\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t},\n\n\t/**\n\t * To display a text arrangement showing text and id, we need a string field on the UI.\n\t * @param oAnnotations All the annotations of a property\n\t * @param sType The property data type\n\t * @returns The type to be used on the UI for the alignment\n\t * @private\n\t */\n\tgetDataTypeForVisualization: function (oAnnotations: MetaModelPropertyAnnotations, sType: string): string {\n\t\tconst sTextAnnotation = \"@com.sap.vocabularies.Common.v1.Text\",\n\t\t\tsTextArrangementAnnotation = \"@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement\";\n\n\t\t/*\n\t\t  In case of TextSeparate, the returned is used for the filed itself only showing\n\t\t   the value of the original property, thus also the type of the property needs to be used.\n\t\t  In case of TextOnly, we consider it to be Edm.String according to the definition\n\t\t   in the vocabulary, even if it's not.\n\t\t  In other cases, we return Edm.String, as the value is build using a text template.\n\t\t */\n\t\treturn oAnnotations?.[sTextArrangementAnnotation]?.$EnumMember !== \"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate\" &&\n\t\t\t(oAnnotations?.[sTextAnnotation] as { $Path: string })?.$Path\n\t\t\t? \"Edm.String\"\n\t\t\t: sType;\n\t},\n\n\tgetColumnAlignment: function (\n\t\toDataField: MetaModelType<DataFieldAbstractTypes>,\n\t\toTable: { collection: BaseContext }\n\t): CompiledBindingToolkitExpression {\n\t\tconst sEntityPath = oTable.collection.getPath(),\n\t\t\toModel = oTable.collection.getModel();\n\t\tif (\n\t\t\t(oDataField[\"$Type\"] === \"com.sap.vocabularies.UI.v1.DataFieldForAction\" ||\n\t\t\t\toDataField[\"$Type\"] === \"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation\") &&\n\t\t\t(oDataField as MetaModelType<DataFieldForAction>).Inline &&\n\t\t\toDataField.IconUrl\n\t\t) {\n\t\t\treturn \"Center\";\n\t\t}\n\t\t// Columns containing a Semantic Key must be Begin aligned\n\t\tconst aSemanticKeys = oModel.getObject(`${sEntityPath}/@com.sap.vocabularies.Common.v1.SemanticKey`);\n\t\tif (oDataField[\"$Type\"] === \"com.sap.vocabularies.UI.v1.DataField\") {\n\t\t\tconst sPropertyPath = (oDataField as MetaModelType<DataField>).Value.$Path;\n\t\t\tconst bIsSemanticKey =\n\t\t\t\taSemanticKeys &&\n\t\t\t\t!aSemanticKeys.every(function (oKey: { $PropertyPath: string }): boolean {\n\t\t\t\t\treturn oKey.$PropertyPath !== sPropertyPath;\n\t\t\t\t});\n\t\t\tif (bIsSemanticKey) {\n\t\t\t\treturn \"Begin\";\n\t\t\t}\n\t\t}\n\t\treturn FieldHelper.getDataFieldAlignment(oDataField, oModel, sEntityPath);\n\t},\n\n\tgetPropertyAlignment: function (\n\t\tsType: string,\n\t\toFormatOptions?: { displayMode?: string; textAlignMode?: string },\n\t\toComputedEditMode?: BindingToolkitExpression<string>\n\t): CompiledBindingToolkitExpression {\n\t\tlet sDefaultAlignment: CompiledBindingToolkitExpression = \"Begin\";\n\t\tconst sTextAlignment = oFormatOptions ? oFormatOptions.textAlignMode : \"\";\n\t\tif (sTextAlignment === \"Form\") {\n\t\t\tif (this.isNumericDataType(sType)) {\n\t\t\t\tsDefaultAlignment = \"Begin\";\n\t\t\t\tif (oComputedEditMode) {\n\t\t\t\t\tsDefaultAlignment = getAlignmentExpression(oComputedEditMode, \"Begin\", \"End\");\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (this.isNumericDataType(sType) || this.isDateOrTimeDataType(sType)) {\n\t\t\tsDefaultAlignment = \"Right\";\n\t\t}\n\t\treturn sDefaultAlignment;\n\t},\n\n\t/**\n\t * Get alignment based on the dataField.\n\t * @param dataField The dataField being processed\n\t * @param model The OData model\n\t * @param entityPath The path to the entity\n\t * @param [formatOptions] The Object that defines the dataField's format options\n\t * @param formatOptions.displayMode Display format\n\t * @param formatOptions.textAlignMode Text alignment of the dataField\n\t * @param [computedEditMode] The computed Edit mode of the dataField\n\t * @returns The dataField alignment\n\t */\n\tgetDataFieldAlignment: function (\n\t\tdataField: MetaModelType<DataFieldAbstractTypes>,\n\t\tmodel: ODataMetaModel,\n\t\tentityPath: string,\n\t\tformatOptions?: { displayMode?: string; textAlignMode?: string },\n\t\tcomputedEditMode?: BindingToolkitExpression<string>\n\t): CompiledBindingToolkitExpression {\n\t\tlet dataFieldPath,\n\t\t\tdefaultAlignment: CompiledBindingToolkitExpression = \"Begin\",\n\t\t\ttype,\n\t\t\tannotations;\n\n\t\tif (dataField?.$Type === UIAnnotationTypes.DataFieldForAnnotation) {\n\t\t\tdataFieldPath = (dataField as MetaModelType<DataFieldForAnnotation>).Target?.$AnnotationPath;\n\t\t\tif (dataFieldPath && dataFieldPath.includes(\"com.sap.vocabularies.UI.v1.FieldGroup\")) {\n\t\t\t\tconst fieldGroup = model.getObject(`${entityPath}/${dataFieldPath}`);\n\n\t\t\t\tfor (let i = 0; i < fieldGroup.Data.length; i++) {\n\t\t\t\t\ttype = model.getObject(`${entityPath}/${dataFieldPath}/Data/${i.toString()}/Value/$Path/$Type`);\n\t\t\t\t\tannotations = model.getObject(`${entityPath}/${dataFieldPath}/Data/${i.toString()}/Value/$Path@`);\n\t\t\t\t\ttype = this.getDataTypeForVisualization(annotations, type);\n\t\t\t\t\tdefaultAlignment = this.getPropertyAlignment(type, formatOptions, computedEditMode);\n\n\t\t\t\t\tif (defaultAlignment === \"Begin\") {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn defaultAlignment;\n\t\t\t} else if (\n\t\t\t\tdataFieldPath &&\n\t\t\t\tdataFieldPath.includes(\"com.sap.vocabularies.UI.v1.DataPoint\") &&\n\t\t\t\t(model.getObject(`${entityPath}/${dataFieldPath}/Visualization/$EnumMember`) ===\n\t\t\t\t\t\"com.sap.vocabularies.UI.v1.VisualizationType/Rating\" ||\n\t\t\t\t\tmodel.getObject(`${entityPath}/${dataFieldPath}/Visualization/$EnumMember`) ===\n\t\t\t\t\t\t\"com.sap.vocabularies.UI.v1.VisualizationType/Progress\")\n\t\t\t) {\n\t\t\t\treturn defaultAlignment;\n\t\t\t} else {\n\t\t\t\ttype = model.getObject(`${entityPath}/${dataFieldPath}/$Type`);\n\t\t\t\tif (type === UIAnnotationTypes.DataPointType) {\n\t\t\t\t\ttype = model.getObject(`${entityPath}/${dataFieldPath}/Value/$Path/$Type`);\n\t\t\t\t\tannotations = model.getObject(`${entityPath}/${dataFieldPath}/Value/$Path@`);\n\t\t\t\t\ttype = this.getDataTypeForVisualization(annotations, type);\n\t\t\t\t}\n\t\t\t\tdefaultAlignment = this.getPropertyAlignment(type, formatOptions, computedEditMode);\n\t\t\t}\n\t\t} else {\n\t\t\tdataFieldPath = (dataField as MetaModelType<DataFieldTypes>).Value?.$Path;\n\t\t\ttype = model.getObject(`${entityPath}/${dataFieldPath}/$Type`);\n\t\t\tannotations = model.getObject(`${entityPath}/${dataFieldPath}@`);\n\t\t\ttype = this.getDataTypeForVisualization(annotations, type);\n\t\t\tconst keys = model.getObject(`${entityPath}/`)[\"$Key\"];\n\t\t\tif (keys && keys.indexOf(dataFieldPath) !== 0) {\n\t\t\t\tdefaultAlignment = this.getPropertyAlignment(type, formatOptions, computedEditMode);\n\t\t\t}\n\t\t}\n\t\treturn defaultAlignment;\n\t},\n\n\t/**\n\t * Method to get enabled expression for DataFieldActionButton.\n\t * @param oDataField DataPoint's Value\n\t * @param bIsBound DataPoint action bound\n\t * @param oActionContext ActionContext Value\n\t * @param sActionContextFormat Formatted value of ActionContext\n\t * @returns A boolean or string expression for enabled property\n\t */\n\tisDataFieldActionButtonEnabled: function (\n\t\toDataField: DataFieldForAction,\n\t\tbIsBound: boolean,\n\t\toActionContext: string | OperationAvailable | undefined | null,\n\t\tsActionContextFormat: string\n\t): string {\n\t\tif (bIsBound !== true) {\n\t\t\treturn \"true\";\n\t\t}\n\t\treturn (oActionContext === null ? \"{= !${#\" + oDataField.Action + \"} ? false : true }\" : oActionContext)\n\t\t\t? sActionContextFormat\n\t\t\t: \"true\";\n\t},\n\n\t/**\n\t * Method to compute the label for a DataField.\n\t * If the DataField's label is an empty string, it's not rendered even if a fallback exists.\n\t * @param {object} oDataField The DataField being processed\n\t * @param {object} oInterface The interface for context instance\n\t * @returns {string} The computed text for the DataField label.\n\t */\n\n\tcomputeLabelText: function (oDataField: MetaModelType<DataFieldTypes>, oInterface: ComputedAnnotationInterface): string | undefined {\n\t\tconst oModel = oInterface.context.getModel();\n\t\tlet sContextPath = oInterface.context.getPath();\n\t\tif (sContextPath.endsWith(\"/\")) {\n\t\t\tsContextPath = sContextPath.slice(0, sContextPath.lastIndexOf(\"/\"));\n\t\t}\n\t\tconst sDataFieldLabel = oModel.getObject(`${sContextPath}/Label`);\n\t\t//We do not show an additional label text for a button:\n\t\tif (\n\t\t\toDataField.$Type === \"com.sap.vocabularies.UI.v1.DataFieldForAction\" ||\n\t\t\toDataField.$Type === \"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation\"\n\t\t) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (sDataFieldLabel) {\n\t\t\treturn sDataFieldLabel;\n\t\t} else if (sDataFieldLabel === \"\") {\n\t\t\treturn \"\";\n\t\t}\n\t\tlet sDataFieldTargetTitle;\n\t\tif (oDataField.$Type === \"com.sap.vocabularies.UI.v1.DataFieldForAnnotation\") {\n\t\t\tif (\n\t\t\t\t(oDataField as MetaModelType<DataFieldForAnnotation>)?.Target?.$AnnotationPath.includes(\n\t\t\t\t\t\"@com.sap.vocabularies.UI.v1.DataPoint\"\n\t\t\t\t) ||\n\t\t\t\t(oDataField as MetaModelType<DataFieldForAnnotation>)?.Target?.$AnnotationPath.includes(\"@com.sap.vocabularies.UI.v1.Chart\")\n\t\t\t) {\n\t\t\t\tsDataFieldTargetTitle = oModel.getObject(`${sContextPath}/Target/$AnnotationPath@/Title`);\n\t\t\t}\n\t\t\tif (\n\t\t\t\t(oDataField as MetaModelType<DataFieldForAnnotation>)?.Target?.$AnnotationPath.includes(\n\t\t\t\t\t\"@com.sap.vocabularies.Communication.v1.Contact\"\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tsDataFieldTargetTitle = oModel.getObject(\n\t\t\t\t\t`${sContextPath}/Target/$AnnotationPath@/fn/$Path@com.sap.vocabularies.Common.v1.Label`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tif (sDataFieldTargetTitle) {\n\t\t\treturn sDataFieldTargetTitle;\n\t\t}\n\t\tlet sDataFieldTargetLabel;\n\t\tif (oDataField.$Type === \"com.sap.vocabularies.UI.v1.DataFieldForAnnotation\") {\n\t\t\tsDataFieldTargetLabel = oModel.getObject(`${sContextPath}/Target/$AnnotationPath@/Label`);\n\t\t}\n\t\tif (sDataFieldTargetLabel) {\n\t\t\treturn sDataFieldTargetLabel;\n\t\t}\n\n\t\tconst sDataFieldValueLabel = oModel.getObject(`${sContextPath}/Value/$Path@com.sap.vocabularies.Common.v1.Label`);\n\t\tif (sDataFieldValueLabel) {\n\t\t\treturn sDataFieldValueLabel;\n\t\t}\n\n\t\tlet sDataFieldTargetValueLabel;\n\t\tif (oDataField.$Type === \"com.sap.vocabularies.UI.v1.DataFieldForAnnotation\") {\n\t\t\tsDataFieldTargetValueLabel = oModel.getObject(\n\t\t\t\t`${sContextPath}/Target/$AnnotationPath/Value/$Path@com.sap.vocabularies.Common.v1.Label`\n\t\t\t);\n\t\t}\n\t\tif (sDataFieldTargetValueLabel) {\n\t\t\treturn sDataFieldTargetValueLabel;\n\t\t}\n\t\treturn \"\";\n\t},\n\t/**\n\t * Method to align the data fields with their label.\n\t * @param sVisualization\n\t * @returns Expression binding for alignItems property\n\t */\n\tbuildExpressionForAlignItems: function (sVisualization: string): CompiledBindingToolkitExpression {\n\t\tconst fieldVisualizationBindingExpression = constant(sVisualization);\n\t\tconst progressVisualizationBindingExpression = constant(\"com.sap.vocabularies.UI.v1.VisualizationType/Progress\");\n\t\tconst ratingVisualizationBindingExpression = constant(\"com.sap.vocabularies.UI.v1.VisualizationType/Rating\");\n\t\treturn compileExpression(\n\t\t\tifElse(\n\t\t\t\tor(\n\t\t\t\t\tequal(fieldVisualizationBindingExpression, progressVisualizationBindingExpression),\n\t\t\t\t\tequal(fieldVisualizationBindingExpression, ratingVisualizationBindingExpression)\n\t\t\t\t),\n\t\t\t\tconstant(\"Center\"),\n\t\t\t\tifElse(UI.IsEditable, constant(\"Center\"), constant(\"Stretch\"))\n\t\t\t)\n\t\t);\n\t},\n\n\t/**\n\t * Method to check ValueListReferences, ValueListMapping and ValueList inside ActionParameters for ValueHelp.\n\t * @param oPropertyAnnotations Action parameter object\n\t * @returns `true` if there is a ValueList* annotation defined\n\t */\n\thasValueHelpAnnotation: function (oPropertyAnnotations: MetaModelPropertyAnnotations): boolean {\n\t\tif (oPropertyAnnotations) {\n\t\t\treturn !!(\n\t\t\t\toPropertyAnnotations[\"@com.sap.vocabularies.Common.v1.ValueListReferences\"] ||\n\t\t\t\toPropertyAnnotations[\"@com.sap.vocabularies.Common.v1.ValueListMapping\"] ||\n\t\t\t\toPropertyAnnotations[\"@com.sap.vocabularies.Common.v1.ValueList\"]\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t},\n\t/**\n\t * Method to get display property for ActionParameter dialog.\n\t * @param oProperty The action parameter instance\n\t * @param oInterface The interface for the context instance\n\t * @returns The display format  for an action parameter Field\n\t */\n\tgetAPDialogDisplayFormat: async function (oProperty: MetaModelProperty, oInterface: ComputedAnnotationInterface): Promise<string> {\n\t\tlet oAnnotation;\n\t\tconst oModel = oInterface.context.getModel() as ODataMetaModel;\n\t\tconst sContextPath = oInterface.context.getPath();\n\t\tconst sPropertyName = oProperty.$Name || oInterface.context.getProperty(`${sContextPath}@sapui.name`);\n\t\tconst oActionParameterAnnotations = oModel.getObject(`${sContextPath}@`);\n\t\tconst oValueHelpAnnotation =\n\t\t\toActionParameterAnnotations[\"@com.sap.vocabularies.Common.v1.ValueList\"] ||\n\t\t\toActionParameterAnnotations[\"@com.sap.vocabularies.Common.v1.ValueListMapping\"] ||\n\t\t\toActionParameterAnnotations[\"@com.sap.vocabularies.Common.v1.ValueListReferences\"];\n\t\tconst getValueListPropertyName = function (oValueList: {\n\t\t\tParameters: { LocalDataProperty?: { $PropertyPath: string }; ValueListProperty: string }[];\n\t\t}): string | undefined {\n\t\t\tconst oValueListParameter = oValueList.Parameters.find(function (oParameter: {\n\t\t\t\tLocalDataProperty?: { $PropertyPath: string };\n\t\t\t}) {\n\t\t\t\treturn oParameter.LocalDataProperty && oParameter.LocalDataProperty.$PropertyPath === sPropertyName;\n\t\t\t});\n\t\t\treturn oValueListParameter && oValueListParameter.ValueListProperty;\n\t\t};\n\t\tlet sValueListPropertyName;\n\t\tif (\n\t\t\toActionParameterAnnotations[\"@com.sap.vocabularies.Common.v1.TextArrangement\"] ||\n\t\t\toActionParameterAnnotations[\"@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement\"]\n\t\t) {\n\t\t\treturn CommonUtils.computeDisplayMode(oActionParameterAnnotations, undefined);\n\t\t} else if (oValueHelpAnnotation) {\n\t\t\tif (oValueHelpAnnotation.CollectionPath) {\n\t\t\t\t// get the name of the corresponding property in value list collection\n\t\t\t\tsValueListPropertyName = getValueListPropertyName(oValueHelpAnnotation);\n\t\t\t\tif (!sValueListPropertyName) {\n\t\t\t\t\treturn \"Value\";\n\t\t\t\t}\n\t\t\t\t// get text for this property\n\t\t\t\toAnnotation = oModel.getObject(`/${oValueHelpAnnotation.CollectionPath}/${sValueListPropertyName}@`);\n\t\t\t\treturn oAnnotation && oAnnotation[\"@com.sap.vocabularies.Common.v1.Text\"]\n\t\t\t\t\t? CommonUtils.computeDisplayMode(oAnnotation, undefined)\n\t\t\t\t\t: \"Value\";\n\t\t\t} else {\n\t\t\t\treturn oModel.requestValueListInfo(sContextPath, true).then(function (oValueListInfo) {\n\t\t\t\t\t// get the name of the corresponding property in value list collection\n\t\t\t\t\tsValueListPropertyName = getValueListPropertyName(oValueListInfo[\"\"]);\n\t\t\t\t\tif (!sValueListPropertyName) {\n\t\t\t\t\t\treturn \"Value\";\n\t\t\t\t\t}\n\t\t\t\t\t// get text for this property\n\t\t\t\t\toAnnotation = oValueListInfo[\"\"].$model\n\t\t\t\t\t\t.getMetaModel()\n\t\t\t\t\t\t.getObject(`/${oValueListInfo[\"\"][\"CollectionPath\"]}/${sValueListPropertyName}@`);\n\t\t\t\t\treturn oAnnotation && oAnnotation[\"@com.sap.vocabularies.Common.v1.Text\"]\n\t\t\t\t\t\t? CommonUtils.computeDisplayMode(oAnnotation, undefined)\n\t\t\t\t\t\t: \"Value\";\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\treturn \"Value\";\n\t\t}\n\t},\n\t/*\n\t * Method to get display property for ActionParameter dialog ValueHelp.\n\t *\n\t * @function\n\t * @name getActionParameterDialogValueHelp\n\t * @param oActionParameter Action parameter object\n\t * @param sSapUIName Action sapui name\n\t * @param sParamName The parameter name\n\t * @returns The ID of the fieldHelp used by this action parameter\n\t */\n\tgetActionParameterDialogValueHelp: function (\n\t\toActionParameter: MetaModelPropertyAnnotations,\n\t\tsSapUIName: string,\n\t\tsParamName: string\n\t): string | undefined {\n\t\treturn this.hasValueHelpAnnotation(oActionParameter) ? generate([sSapUIName, sParamName]) : undefined;\n\t},\n\t/**\n\t * Method to get the delegate configuration for ActionParameter dialog.\n\t * @param isBound Action is bound\n\t * @param entityTypePath The EntityType Path\n\t * @param sapUIName The name of the Action\n\t * @param paramName The name of the ActionParameter\n\t * @returns The delegate configuration object as a string\n\t */\n\tgetValueHelpDelegate: function (isBound: boolean, entityTypePath: string, sapUIName: string, paramName: string): string {\n\t\tconst delegateConfiguration: { name: string; payload: ValueHelpPayload } = {\n\t\t\tname: CommonHelper.addSingleQuotes(\"sap/fe/macros/valuehelp/ValueHelpDelegate\"),\n\t\t\tpayload: {\n\t\t\t\tpropertyPath: CommonHelper.addSingleQuotes(\n\t\t\t\t\tValueListHelper.getPropertyPath({\n\t\t\t\t\t\tUnboundAction: !isBound,\n\t\t\t\t\t\tEntityTypePath: entityTypePath,\n\t\t\t\t\t\tAction: sapUIName,\n\t\t\t\t\t\tProperty: paramName\n\t\t\t\t\t})\n\t\t\t\t),\n\t\t\t\tqualifiers: {},\n\t\t\t\tvalueHelpQualifier: CommonHelper.addSingleQuotes(\"\"),\n\t\t\t\tisActionParameterDialog: true\n\t\t\t}\n\t\t};\n\t\treturn CommonHelper.objectToString(delegateConfiguration);\n\t},\n\t/**\n\t * Method to get the delegate configuration for NonComputedVisibleKeyField dialog.\n\t * @param propertyPath The current property path\n\t * @returns The delegate configuration object as a string\n\t */\n\tgetValueHelpDelegateForNonComputedVisibleKeyField: function (propertyPath: string): string {\n\t\tconst delegateConfiguration: { name: string; payload: ValueHelpPayload } = {\n\t\t\tname: CommonHelper.addSingleQuotes(\"sap/fe/macros/valuehelp/ValueHelpDelegate\"),\n\t\t\tpayload: {\n\t\t\t\tpropertyPath: CommonHelper.addSingleQuotes(propertyPath),\n\t\t\t\tqualifiers: {},\n\t\t\t\tvalueHelpQualifier: CommonHelper.addSingleQuotes(\"\")\n\t\t\t}\n\t\t};\n\t\treturn CommonHelper.objectToString(delegateConfiguration);\n\t},\n\n\t/**\n\t * Method to fetch entity from a path containing multiple associations.\n\t * @param oContext The context whose path is to be checked\n\t * @param sPath The path from which entity has to be fetched\n\t * @param sSourceEntity The entity path in which nav entity exists\n\t * @param iStart The start index : beginning parts of the path to be ignored\n\t * @param iDiff The diff index : end parts of the path to be ignored\n\t * @returns The path of the entity set\n\t */\n\t_getEntitySetFromMultiLevel: function (oContext: Context, sPath: string, sSourceEntity: string, iStart: number, iDiff: number): string {\n\t\tlet aNavParts = sPath.split(\"/\").filter(Boolean);\n\t\taNavParts = aNavParts.filter(function (sPart: string) {\n\t\t\treturn sPart !== \"$NavigationPropertyBinding\";\n\t\t});\n\t\tif (aNavParts.length > 0) {\n\t\t\tfor (let i = iStart; i < aNavParts.length - iDiff; i++) {\n\t\t\t\tsSourceEntity = \"/\" + oContext.getObject(`${sSourceEntity}/$NavigationPropertyBinding/${aNavParts[i]}`);\n\t\t\t}\n\t\t}\n\t\treturn sSourceEntity;\n\t},\n\n\tgetPathForIconSource: function (sPropertyPath?: string): string {\n\t\treturn \"{= FIELDRUNTIME.getIconForMimeType(%{\" + sPropertyPath + \"@odata.mediaContentType})}\";\n\t},\n\tgetFilenameExpr: function (sFilename: string | undefined, sNoFilenameText: string): string {\n\t\tif (sFilename) {\n\t\t\tif (sFilename.indexOf(\"{\") === 0) {\n\t\t\t\t// filename is referenced via path, i.e. @Core.ContentDisposition.Filename : path\n\t\t\t\treturn \"{= $\" + sFilename + \" ? $\" + sFilename + \" : $\" + sNoFilenameText + \"}\";\n\t\t\t}\n\t\t\t// static filename, i.e. @Core.ContentDisposition.Filename : 'someStaticName'\n\t\t\treturn sFilename;\n\t\t}\n\t\t// no @Core.ContentDisposition.Filename\n\t\treturn sNoFilenameText;\n\t},\n\n\tcalculateMBfromByte: function (iByte?: number): string | undefined {\n\t\treturn iByte ? (iByte / (1024 * 1024)).toFixed(6) : undefined;\n\t},\n\tgetDownloadUrl: function (propertyPath: string): string {\n\t\treturn propertyPath + \"{= ${internal>/stickySessionToken} ? ('?SAP-ContextId=' + ${internal>/stickySessionToken}) : '' }\";\n\t},\n\tgetMarginClass: function (compactSemanticKey: string | boolean | undefined): string | undefined {\n\t\treturn compactSemanticKey === \"true\" || compactSemanticKey === true ? \"sapMTableContentMargin\" : undefined;\n\t},\n\tgetRequired: function (\n\t\timmutableKey: string,\n\t\ttarget: DataModelObjectPath<Property | DataFieldAbstractTypes | DataPointType | undefined> | null,\n\t\trequiredProperties: string[]\n\t): CompiledBindingToolkitExpression {\n\t\tlet targetRequiredExpression: BindingToolkitExpression<boolean> = constant(false);\n\t\tif (target !== null) {\n\t\t\ttargetRequiredExpression = isRequiredExpression(target?.targetObject);\n\t\t}\n\t\treturn compileExpression(or(targetRequiredExpression, requiredProperties.includes(immutableKey)));\n\t},\n\n\t/**\n\t * The method checks if the field is already part of a form.\n\t * @param dataFieldCollection The list of the fields of the form\n\t * @param dataFieldObjectPath The data model object path of the field which needs to be checked in the form\n\t * @returns `true` if the field is already part of the form, `false` otherwise\n\t */\n\tisFieldPartOfForm: function (\n\t\tdataFieldCollection: FormElement[],\n\t\tdataFieldObjectPath: DataModelObjectPath<DataFieldAbstractTypes>\n\t): boolean {\n\t\t//generating key for the received data field\n\t\tconst connectedDataFieldKey = KeyHelper.generateKeyFromDataField(dataFieldObjectPath.targetObject!);\n\t\t// trying to find the generated key in already existing form elements\n\t\tconst isFieldFound = dataFieldCollection.find((field) => {\n\t\t\treturn field.key === connectedDataFieldKey;\n\t\t});\n\t\treturn isFieldFound ? true : false;\n\t}\n};\n(FieldHelper.fieldControl as { requiresIContext?: boolean }).requiresIContext = true;\n(FieldHelper.getAPDialogDisplayFormat as { requiresIContext?: boolean }).requiresIContext = true;\n(FieldHelper.computeLabelText as { requiresIContext?: boolean }).requiresIContext = true;\n(FieldHelper.getActionParameterVisibility as { requiresIContext?: boolean }).requiresIContext = true;\n\nexport default FieldHelper;\n"],"mappings":"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","ignoreList":[]}
{"version":3,"names":["getCollaborationBinding","field","binding","getBindingContext","getBinding","isA","oView","CommonUtils","getTargetView","FieldRuntime","uploadPromises","creatingInactiveRow","onDataFieldWithNavigationPath","source","controller","navPath","_routing","bindingContext","view","metaModel","getModel","getMetaModel","viewData","getViewData","draftRootPath","ModelHelper","getDraftRootPath","getPath","urlNavigation","getHashForNavigation","navigateFn","getAppComponent","getRouterProxy","navToHash","isStickySessionSupported","startsWith","sameOPNavigation","converterType","draft","processDataLossOrDraftDiscardConfirmation","Function","prototype","getController","NavigationType","ForwardNavigation","Log","error","isDraftIndicatorVisible","sPropertyPath","sSemanticKeyHasDraftIndicator","HasDraftEntity","IsActiveEntity","hideDraftInfo","undefined","onValidateFieldGroup","oEvent","oSourceField","getSource","oFEController","FieldRuntimeHelper","getExtensionController","_sideEffects","handleFieldGroupChange","handleChangeMultiValueField","oController","bIsTransient","isTransient","pValueResolved","getParameter","Promise","resolve","oSource","bValid","fieldValidity","getFieldStateOnChange","state","fieldAPI","getParent","customValueBinding","newValue","valueModel","model","setProperty","path","updateBindings","then","mParameters","valid","FieldAPI","handleChange","handleFieldChange","fetchRecommendations","catch","debug","valueResolvedAndPatchSent","setTimeout","editFlow","syncTask","prepareDeferredSideEffectsForField","bCollaborationEnabled","collaborativeDraft","isConnected","data","getBindingInfo","parts","filter","part","indexOf","map","retainAsyncMessages","updateCollaboration","hasPendingChanges","attachEventOnce","send","action","Activity","Change","content","releaseAsyncMessages","_sendCollaborationMessageForFileUploader","fileUploader","bindingPath","getProperty","fullPath","handleOpenUploader","event","Lock","handleCloseUploader","Unlock","_fnFixHashQueryString","sCurrentHash","includes","split","openExternalLink","openWindow","uploadStream","FEController","fileWrapper","uploadUrl","getUploadUrl","setUIBusy","setUploadUrl","setHeaderFields","uploadPromise","reject","getId","upload","MessageBox","getResourceModel","getText","handleUploadComplete","propertyFileName","propertyPath","status","Number","context","displayMessageForFailedUpload","newETag","etag","getValue","avatar","refreshAvatarCacheBusting","_callSideEffectsForStream","isCollaborationEnabled","notificationData","push","removeStream","deleteButton","oControl","getIconForMimeType","sMimeType","IconPool","retrieveTextFromValueList","sPropertyValue","sPropertyFullPath","sDisplayFormat","sTextProperty","oMetaModel","sPropertyName","CommonHelper","getObject","requestValueListInfo","mValueListInfo","oValueListInfo","Object","keys","oValueListModel","$model","oMetaModelValueList","oParamWithKey","Parameters","find","oParameter","LocalDataProperty","$PropertyPath","ValueListProperty","Error","oTextAnnotation","CollectionPath","$Path","oFilter","Filter","operator","value1","oListBinding","bindList","$select","requestContexts","aContexts","sDescription","Library","getResourceBundleFor","oError","errorObj","sMsg","message","handleTypeMissmatch","givenType","acceptedTypes","getMimeType","showTypeMismatchDialog","handleFileSizeExceed","showFileSizeExceedDialog","getMaximumFileSize","toFixed","showCollaborationEditUser","resourceModel","ResourceModelHelper","popover","Element","getElementById","ResponsivePopover","showHeader","placement","addStyleClass","addDependent","getBindings","activities","editingActivity","length","activity","key","getActivityKeyFromPath","destroyContent","addContent","Label","text","name","openBy","displayAggregateDetails","aggregatedPropertyPath","link","analyticalTable","FPMHelper","getMdcTable","rowContext","tableRowBinding","rowContextData","rowSpecificFilter","rowFilter","getFilter","allFilters","concat","getFilters","aggregation","getAggregation","unitOrCurrencyName","aggregate","unit","group","grandTotal","subtotals","tableItem","getDependents","clone","currencyOrQuantityEnabledLayout","HBox","renderType","justifyContent","items","aggregationParameters","search","oItemsBindingInfo","getResolvedPath","filters","parameters","$$aggregation","sorter","Sorter","isPopoverForGrandTotal","Util","createOrUpdateMultiUnitPopover","control","itemsBindingInfo","listItemContentTemplate","fnOnClose","removeDependent","detachEvent","destroy","attachEvent","ObjectPath","set"],"sourceRoot":".","sources":["FieldRuntime.ts"],"sourcesContent":["import Log from \"sap/base/Log\";\nimport ObjectPath from \"sap/base/util/ObjectPath\";\nimport CommonUtils from \"sap/fe/core/CommonUtils\";\nimport type PageController from \"sap/fe/core/PageController\";\nimport type { UserActivity } from \"sap/fe/core/controllerextensions/collaboration/CollaborationCommon\";\nimport { Activity, getActivityKeyFromPath } from \"sap/fe/core/controllerextensions/collaboration/CollaborationCommon\";\nimport draft from \"sap/fe/core/controllerextensions/editFlow/draft\";\nimport FPMHelper from \"sap/fe/core/helpers/FPMHelper\";\nimport ModelHelper from \"sap/fe/core/helpers/ModelHelper\";\nimport ResourceModelHelper, { getResourceModel } from \"sap/fe/core/helpers/ResourceModelHelper\";\nimport CommonHelper from \"sap/fe/macros/CommonHelper\";\nimport type FileWrapper from \"sap/fe/macros/controls/FileWrapper\";\nimport FieldAPI from \"sap/fe/macros/field/FieldAPI\";\nimport {\n\tdisplayMessageForFailedUpload,\n\tsetHeaderFields,\n\tshowFileSizeExceedDialog,\n\tshowTypeMismatchDialog\n} from \"sap/fe/macros/internal/helpers/Upload\";\nimport type Avatar from \"sap/m/Avatar\";\nimport type { CheckBox$SelectEvent } from \"sap/m/CheckBox\";\nimport type { $HBoxSettings } from \"sap/m/HBox\";\nimport HBox from \"sap/m/HBox\";\nimport type { InputBase$ChangeEvent } from \"sap/m/InputBase\";\nimport Label from \"sap/m/Label\";\nimport type Link from \"sap/m/Link\";\nimport MessageBox from \"sap/m/MessageBox\";\nimport ResponsivePopover from \"sap/m/ResponsivePopover\";\nimport { default as Util } from \"sap/m/table/Util\";\nimport type Event from \"sap/ui/base/Event\";\nimport type ManagedObject from \"sap/ui/base/ManagedObject\";\nimport type Control from \"sap/ui/core/Control\";\nimport type { Control$ValidateFieldGroupEvent } from \"sap/ui/core/Control\";\nimport Element from \"sap/ui/core/Element\";\nimport IconPool from \"sap/ui/core/IconPool\";\nimport Library from \"sap/ui/core/Lib\";\nimport type View from \"sap/ui/core/mvc/View\";\nimport type { default as Field, Field$ChangeEvent } from \"sap/ui/mdc/Field\";\nimport type CompositeBinding from \"sap/ui/model/CompositeBinding\";\nimport Filter from \"sap/ui/model/Filter\";\nimport Sorter from \"sap/ui/model/Sorter\";\nimport type JSONModel from \"sap/ui/model/json/JSONModel\";\nimport type Context from \"sap/ui/model/odata/v4/Context\";\nimport type ODataContextBinding from \"sap/ui/model/odata/v4/ODataContextBinding\";\nimport type ODataListBinding from \"sap/ui/model/odata/v4/ODataListBinding\";\nimport type FileUploader from \"sap/ui/unified/FileUploader\";\nimport type {\n\tFileUploader$ChangeEvent,\n\tFileUploader$FileSizeExceedEvent,\n\tFileUploader$TypeMissmatchEvent,\n\tFileUploader$UploadCompleteEvent\n} from \"sap/ui/unified/FileUploader\";\nimport openWindow from \"sap/ui/util/openWindow\";\nimport FieldRuntimeHelper from \"./FieldRuntimeHelper\";\n\n/**\n * Gets the binding used for collaboration notifications.\n * @param field\n * @returns The binding\n */\nfunction getCollaborationBinding(field: Control): ODataListBinding | ODataContextBinding {\n\tlet binding = (field.getBindingContext() as Context).getBinding();\n\n\tif (!binding.isA(\"sap.ui.model.odata.v4.ODataListBinding\")) {\n\t\tconst oView = CommonUtils.getTargetView(field);\n\t\tbinding = oView.getBindingContext().getBinding();\n\t}\n\n\treturn binding;\n}\n/**\n * Static class used by \"sap.ui.mdc.Field\" during runtime\n * @private\n * @experimental This module is only for internal/experimental use!\n */\nconst FieldRuntime = {\n\tuploadPromises: {} as Record<string, { resolve: Function; reject: Function }>,\n\tcreatingInactiveRow: false,\n\n\t/**\n\t * Triggers an internal navigation on the link pertaining to DataFieldWithNavigationPath.\n\t * @param source Source of the press event\n\t * @param controller Instance of the controller\n\t * @param navPath The navigation path\n\t */\n\tonDataFieldWithNavigationPath: async function (source: Control, controller: PageController, navPath: string): Promise<void> {\n\t\tif (controller._routing) {\n\t\t\tconst bindingContext = source.getBindingContext() as Context;\n\n\t\t\tconst view = CommonUtils.getTargetView(source),\n\t\t\t\tmetaModel = bindingContext.getModel().getMetaModel();\n\t\t\tconst viewData = view.getViewData();\n\n\t\t\tconst draftRootPath = ModelHelper.getDraftRootPath(bindingContext) ?? bindingContext.getPath();\n\t\t\tlet urlNavigation = await controller._routing.getHashForNavigation(bindingContext, navPath);\n\t\t\tconst navigateFn = (): void => {\n\t\t\t\tcontroller\n\t\t\t\t\t.getAppComponent()\n\t\t\t\t\t.getRouterProxy()\n\t\t\t\t\t.navToHash(\n\t\t\t\t\t\turlNavigation,\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t!ModelHelper.isStickySessionSupported(bindingContext.getModel().getMetaModel())\n\t\t\t\t\t);\n\t\t\t};\n\n\t\t\t// To know if we're navigating on the same OP Entity\n\t\t\tif (!urlNavigation?.startsWith(\"/\")) {\n\t\t\t\turlNavigation = `/${urlNavigation}`;\n\t\t\t}\n\t\t\tconst sameOPNavigation = urlNavigation.startsWith(draftRootPath);\n\n\t\t\t// Show draft loss confirmation dialog in case of Object page\n\t\t\tif (viewData.converterType === \"ObjectPage\" && !ModelHelper.isStickySessionSupported(metaModel) && !sameOPNavigation) {\n\t\t\t\tdraft.processDataLossOrDraftDiscardConfirmation(\n\t\t\t\t\tnavigateFn,\n\t\t\t\t\tFunction.prototype,\n\t\t\t\t\tbindingContext,\n\t\t\t\t\tview.getController(),\n\t\t\t\t\ttrue,\n\t\t\t\t\tdraft.NavigationType.ForwardNavigation\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tnavigateFn();\n\t\t\t}\n\t\t} else {\n\t\t\tLog.error(\n\t\t\t\t\"FieldRuntime: No routing listener controller extension found. Internal navigation aborted.\",\n\t\t\t\t\"sap.fe.macros.field.FieldRuntime\",\n\t\t\t\t\"onDataFieldWithNavigationPath\"\n\t\t\t);\n\t\t}\n\t},\n\tisDraftIndicatorVisible: function (\n\t\tsPropertyPath: string,\n\t\tsSemanticKeyHasDraftIndicator: string,\n\t\tHasDraftEntity?: boolean,\n\t\tIsActiveEntity?: boolean,\n\t\thideDraftInfo?: boolean\n\t): boolean {\n\t\tif (IsActiveEntity !== undefined && HasDraftEntity !== undefined && (!IsActiveEntity || HasDraftEntity) && !hideDraftInfo) {\n\t\t\treturn sPropertyPath === sSemanticKeyHasDraftIndicator;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t},\n\n\t/**\n\t * Handler for the validateFieldGroup event.\n\t * @param oEvent The event object passed by the validateFieldGroup event\n\t */\n\tonValidateFieldGroup: function (oEvent: Control$ValidateFieldGroupEvent): void {\n\t\tconst oSourceField = oEvent.getSource() as ManagedObject;\n\t\tconst view = CommonUtils.getTargetView(oSourceField),\n\t\t\tcontroller = view.getController();\n\n\t\tconst oFEController = FieldRuntimeHelper.getExtensionController(controller);\n\t\toFEController._sideEffects.handleFieldGroupChange(oEvent);\n\t},\n\n\t/**\n\t * Handler for the change event.\n\t * Store field group IDs of this field for requesting side effects when required.\n\t * We store them here to ensure there is a change in the value of the field.\n\t * @param oController The controller of the page containing the field\n\t * @param oEvent The event object passed by the change event\n\t */\n\t//This should be replaced by FieldAPI.handleChange. Currently it is still needed because a pending review of the change handler in MultiValueField\n\thandleChangeMultiValueField: function (oController: PageController, oEvent: Field$ChangeEvent & Event<{ isValid: boolean }>): void {\n\t\tconst oSourceField = oEvent.getSource() as Control,\n\t\t\tbIsTransient = oSourceField && (oSourceField.getBindingContext() as unknown as { isTransient: Function }).isTransient(),\n\t\t\tpValueResolved = oEvent.getParameter(\"promise\") || Promise.resolve(),\n\t\t\toSource = oEvent.getSource(),\n\t\t\tbValid = oEvent.getParameter(\"valid\"),\n\t\t\tfieldValidity = FieldRuntimeHelper.getFieldStateOnChange(oEvent).state[\"validity\"],\n\t\t\tfield = oEvent.getSource() as Control,\n\t\t\tfieldAPI = field.getParent()?.getParent() as FieldAPI | undefined,\n\t\t\tcustomValueBinding = fieldAPI?.customValueBinding;\n\n\t\tif (customValueBinding) {\n\t\t\tlet newValue;\n\t\t\tconst valueModel = field?.getModel(customValueBinding.model) as JSONModel | undefined;\n\t\t\tif (oSource.isA(\"sap.m.CheckBox\")) {\n\t\t\t\tnewValue = (oEvent as CheckBox$SelectEvent).getParameter(\"selected\");\n\t\t\t} else {\n\t\t\t\tnewValue = (oEvent as InputBase$ChangeEvent).getParameter(\"value\");\n\t\t\t}\n\t\t\tvalueModel?.setProperty(customValueBinding.path, newValue);\n\t\t\tvalueModel?.updateBindings(true);\n\t\t}\n\n\t\t// Use the FE Controller instead of the extensionAPI to access internal FE controllers\n\t\tconst oFEController = FieldRuntimeHelper.getExtensionController(oController);\n\n\t\t// TODO: currently we have undefined and true... and our creation row implementation relies on this.\n\t\t// I would move this logic to this place as it's hard to understand for field consumer\n\t\tpValueResolved\n\t\t\t.then(function () {\n\t\t\t\t// The event is gone. For now we'll just recreate it again\n\t\t\t\t(oEvent as { oSource?: Field }).oSource = oSource;\n\t\t\t\t(oEvent as { mParameters?: { valid?: boolean } }).mParameters = {\n\t\t\t\t\tvalid: bValid\n\t\t\t\t};\n\t\t\t\t(FieldAPI as unknown as { handleChange: Function }).handleChange(oEvent, oController);\n\t\t\t\tif (!bIsTransient) {\n\t\t\t\t\t// trigger side effects without registering deferred side effects\n\t\t\t\t\t// deferred side effects are already registered by prepareDeferredSideEffectsForField before pValueResolved is resolved.\n\t\t\t\t\toFEController._sideEffects.handleFieldChange(oEvent, !!fieldValidity, pValueResolved, true);\n\t\t\t\t}\n\t\t\t\t// Recommendations\n\t\t\t\tFieldRuntimeHelper.fetchRecommendations(field as Field, oController);\n\t\t\t\treturn;\n\t\t\t})\n\t\t\t.catch(function (/*oError: any*/) {\n\t\t\t\t// The event is gone. For now we'll just recreate it again\n\t\t\t\t(oEvent as { oSource?: Field }).oSource = oSource;\n\t\t\t\t(oEvent as { mParameters?: { valid?: boolean } }).mParameters = {\n\t\t\t\t\tvalid: false\n\t\t\t\t};\n\t\t\t\tLog.debug(\"Prerequisites on Field for the SideEffects and Recommendations have been rejected\");\n\t\t\t\t// as the UI might need to react on. We could provide a parameter to inform if validation\n\t\t\t\t// was successful?\n\t\t\t\t(FieldAPI as unknown as { handleChange: Function }).handleChange(oEvent, oController);\n\t\t\t});\n\n\t\t// For the EditFlow synchronization, we need to wait for the corresponding PATCH request to be sent, otherwise there could be e.g. action invoked in parallel with the PATCH request.\n\t\t// This is done with a 0-timeout, to allow for the 'patchSent' event to be sent by the binding (then the internal edit flow synchronization kicks in with EditFlow.handlePatchSent).\n\t\tconst valueResolvedAndPatchSent = pValueResolved.then(async () => {\n\t\t\treturn new Promise<void>((resolve) => {\n\t\t\t\tsetTimeout(resolve, 0);\n\t\t\t});\n\t\t});\n\t\toFEController.editFlow.syncTask(valueResolvedAndPatchSent);\n\n\t\t// if the context is transient, it means the request would fail anyway as the record does not exist in reality\n\t\t// TODO: should the request be made in future if the context is transient?\n\t\tif (bIsTransient) {\n\t\t\treturn;\n\t\t}\n\n\t\toFEController._sideEffects.prepareDeferredSideEffectsForField(oEvent, !!fieldValidity, pValueResolved);\n\t\t// Collaboration Draft Activity Sync\n\t\tconst bCollaborationEnabled = oController.collaborativeDraft.isConnected();\n\n\t\tif (bCollaborationEnabled && fieldValidity) {\n\t\t\tconst binding = getCollaborationBinding(field);\n\n\t\t\tconst data = [\n\t\t\t\t...((field.getBindingInfo(\"value\") || field.getBindingInfo(\"selected\"))?.parts || []),\n\t\t\t\t...(field.getBindingInfo(\"additionalValue\")?.parts || [])\n\t\t\t]\n\t\t\t\t.filter((part) => {\n\t\t\t\t\treturn part?.path !== undefined && part.path.indexOf(\"@@\") < 0; // Remove binding parts with @@ that make no sense for collaboration messages\n\t\t\t\t})\n\t\t\t\t.map(function (part: { path: string }) {\n\t\t\t\t\treturn `${field.getBindingContext()?.getPath()}/${part.path}`;\n\t\t\t\t});\n\n\t\t\t// From this point, we will always send a collaboration message (UNLOCK or CHANGE), so we retain\n\t\t\t// a potential UNLOCK that would be sent in handleFocusOut, to make sure it's sent after the CHANGE message\n\t\t\toController.collaborativeDraft.retainAsyncMessages(data);\n\n\t\t\tconst updateCollaboration = (): void => {\n\t\t\t\tif (binding.hasPendingChanges()) {\n\t\t\t\t\t// The value has been changed by the user --> wait until it's sent to the server before sending a notification to other users\n\t\t\t\t\tbinding.attachEventOnce(\"patchCompleted\", function () {\n\t\t\t\t\t\toController.collaborativeDraft.send({ action: Activity.Change, content: data });\n\t\t\t\t\t\toController.collaborativeDraft.releaseAsyncMessages(data);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\toController.collaborativeDraft.releaseAsyncMessages(data);\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (oSourceField.isA(\"sap.ui.mdc.Field\") || (oSourceField as Control).isA(\"sap.ui.mdc.MultiValueField\")) {\n\t\t\t\tpValueResolved\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tupdateCollaboration();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\tupdateCollaboration();\n\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tupdateCollaboration();\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Method to send collaboration messages from a FileUploader.\n\t * @param fileUploader\n\t * @param action\n\t */\n\t_sendCollaborationMessageForFileUploader(fileUploader: FileUploader, action: Activity): void {\n\t\tconst view = CommonUtils.getTargetView(fileUploader);\n\t\tconst collaborativeDraft = view.getController().collaborativeDraft;\n\t\tif (collaborativeDraft.isConnected()) {\n\t\t\tconst bindingPath = fileUploader.getParent()?.getProperty(\"propertyPath\");\n\t\t\tconst fullPath = `${fileUploader.getBindingContext()?.getPath()}/${bindingPath}`;\n\t\t\tcollaborativeDraft.send({ action, content: fullPath });\n\t\t}\n\t},\n\n\t/**\n\t * Handler when a FileUpload dialog is opened.\n\t * @param event\n\t */\n\thandleOpenUploader: function (event: Event<{}, FileUploader>): void {\n\t\tconst fileUploader = event.getSource();\n\t\tFieldRuntime._sendCollaborationMessageForFileUploader(fileUploader, Activity.Lock);\n\t},\n\n\t/**\n\t * Handler when a FileUpload dialog is closed.\n\t * @param event\n\t */\n\thandleCloseUploader: function (event: Event<{}, FileUploader>): void {\n\t\tconst fileUploader = event.getSource();\n\t\tFieldRuntime._sendCollaborationMessageForFileUploader(fileUploader, Activity.Unlock);\n\t},\n\n\t_fnFixHashQueryString: function (sCurrentHash: string): string {\n\t\tif (sCurrentHash?.includes(\"?\")) {\n\t\t\t// sCurrentHash can contain query string, cut it off!\n\t\t\tsCurrentHash = sCurrentHash.split(\"?\")[0];\n\t\t}\n\t\treturn sCurrentHash;\n\t},\n\topenExternalLink: function (event: Event<{}, Link>): void {\n\t\tconst source = event.getSource();\n\t\tif (source.data(\"url\") && source.getProperty(\"text\") !== \"\") {\n\t\t\t// This opens the link in the same tab as the link. It was done to be more consistent with other type of links.\n\t\t\topenWindow(source.data(\"url\"), \"_self\");\n\t\t}\n\t},\n\n\tuploadStream: function (controller: PageController, event: FileUploader$ChangeEvent): void {\n\t\tconst fileUploader = event.getSource(),\n\t\t\tFEController = FieldRuntimeHelper.getExtensionController(controller),\n\t\t\tfileWrapper = fileUploader.getParent() as unknown as FileWrapper,\n\t\t\tuploadUrl = fileWrapper.getUploadUrl();\n\n\t\tif (uploadUrl !== \"\") {\n\t\t\tfileWrapper.setUIBusy(true);\n\n\t\t\t// use uploadUrl from FileWrapper which returns a canonical URL\n\t\t\tfileUploader.setUploadUrl(uploadUrl);\n\n\t\t\tsetHeaderFields(fileUploader);\n\n\t\t\t// synchronize upload with other requests\n\t\t\tconst uploadPromise = new Promise((resolve: Function, reject: Function) => {\n\t\t\t\tthis.uploadPromises = this.uploadPromises || {};\n\t\t\t\tthis.uploadPromises[fileUploader.getId()] = {\n\t\t\t\t\tresolve: resolve,\n\t\t\t\t\treject: reject\n\t\t\t\t};\n\t\t\t\tfileUploader.upload();\n\t\t\t});\n\t\t\tFEController.editFlow.syncTask(uploadPromise);\n\t\t} else {\n\t\t\tMessageBox.error(getResourceModel(controller).getText(\"M_FIELD_FILEUPLOADER_ABORTED_TEXT\"));\n\t\t}\n\t},\n\n\thandleUploadComplete: function (\n\t\tevent: FileUploader$UploadCompleteEvent,\n\t\tpropertyFileName: { path: string } | undefined,\n\t\tpropertyPath: string,\n\t\tcontroller: PageController\n\t): void {\n\t\tconst status = Number(event.getParameter(\"status\")),\n\t\t\tfileUploader = event.getSource(),\n\t\t\tfileWrapper = fileUploader.getParent() as unknown as FileWrapper;\n\n\t\tfileWrapper.setUIBusy(false);\n\n\t\tconst context = fileUploader.getBindingContext() as Context | undefined | null;\n\t\tif (status === 0 || status >= 400) {\n\t\t\tconst error = (event.getParameter(\"responseRaw\") || event.getParameter(\"response\")) as string;\n\t\t\tdisplayMessageForFailedUpload(fileUploader, error);\n\t\t\tthis.uploadPromises[fileUploader.getId()].reject();\n\t\t} else {\n\t\t\tconst newETag = (event.getParameter(\"headers\") as Record<string, unknown>)?.etag;\n\n\t\t\tif (newETag) {\n\t\t\t\t// set new etag for filename update, but without sending patch request\n\t\t\t\tcontext?.setProperty(\"@odata.etag\", newETag, null as unknown as string);\n\t\t\t}\n\n\t\t\t// set filename for link text\n\t\t\tif (propertyFileName?.path) {\n\t\t\t\tcontext?.setProperty(propertyFileName.path, fileUploader.getValue());\n\t\t\t}\n\n\t\t\t// delete the avatar cache that not gets updated otherwise\n\t\t\tfileWrapper.avatar?.refreshAvatarCacheBusting();\n\n\t\t\tthis._callSideEffectsForStream(event as unknown as Field$ChangeEvent & Event<{ isValid: boolean }>, fileWrapper, controller);\n\n\t\t\tthis.uploadPromises[fileUploader.getId()].resolve();\n\t\t}\n\n\t\tdelete this.uploadPromises[fileUploader.getId()];\n\n\t\t// Collaboration Draft Activity Sync\n\t\tconst isCollaborationEnabled = controller.collaborativeDraft.isConnected();\n\t\tif (!isCollaborationEnabled || !context) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst notificationData = [`${context.getPath()}/${propertyPath}`];\n\t\tif (propertyFileName?.path) {\n\t\t\tnotificationData.push(`${context.getPath()}/${propertyFileName.path}`);\n\t\t}\n\n\t\tlet binding = context.getBinding();\n\t\tif (!binding.isA(\"sap.ui.model.odata.v4.ODataListBinding\")) {\n\t\t\tconst oView = CommonUtils.getTargetView(fileUploader);\n\t\t\tbinding = oView.getBindingContext().getBinding();\n\t\t}\n\t\tif (binding.hasPendingChanges()) {\n\t\t\tbinding.attachEventOnce(\"patchCompleted\", () => {\n\t\t\t\tcontroller.collaborativeDraft.send({ action: Activity.Change, content: notificationData });\n\t\t\t\tcontroller.collaborativeDraft.send({ action: Activity.Unlock, content: notificationData });\n\t\t\t});\n\t\t} else {\n\t\t\tcontroller.collaborativeDraft.send({ action: Activity.Change, content: notificationData });\n\t\t\tcontroller.collaborativeDraft.send({ action: Activity.Unlock, content: notificationData });\n\t\t}\n\t},\n\n\tremoveStream: function (\n\t\tevent: Field$ChangeEvent & Event<{ isValid: boolean }>,\n\t\tpropertyFileName: { path: string } | undefined,\n\t\tpropertyPath: string,\n\t\tcontroller: PageController\n\t): void {\n\t\tconst deleteButton = event.getSource();\n\t\tconst fileWrapper = deleteButton.getParent() as unknown as FileWrapper;\n\t\tconst context = fileWrapper.getBindingContext() as Context;\n\n\t\t// streams are removed by assigning the null value\n\t\tcontext.setProperty(propertyPath, null);\n\t\t// When setting the property to null, the uploadUrl (@@MODEL.format) is set to \"\" by the model\n\t\t//\twith that another upload is not possible before refreshing the page\n\t\t// (refreshing the page would recreate the URL)\n\t\t//\tThis is the workaround:\n\t\t//\tWe set the property to undefined only on the frontend which will recreate the uploadUrl\n\t\tcontext.setProperty(propertyPath, undefined, null as unknown as string);\n\n\t\tthis._callSideEffectsForStream(event, fileWrapper, controller);\n\n\t\t// Collaboration Draft Activity Sync\n\t\tconst bCollaborationEnabled = controller.collaborativeDraft.isConnected();\n\t\tif (bCollaborationEnabled) {\n\t\t\tlet binding = context.getBinding();\n\t\t\tif (!binding.isA(\"sap.ui.model.odata.v4.ODataListBinding\")) {\n\t\t\t\tconst oView = CommonUtils.getTargetView(deleteButton);\n\t\t\t\tbinding = oView.getBindingContext().getBinding();\n\t\t\t}\n\n\t\t\tconst data = [`${context.getPath()}/${propertyPath}`];\n\t\t\tif (propertyFileName?.path) {\n\t\t\t\tdata.push(`${context.getPath()}/${propertyFileName.path}`);\n\t\t\t}\n\t\t\tcontroller.collaborativeDraft.send({ action: Activity.Lock, content: data });\n\n\t\t\tbinding.attachEventOnce(\"patchCompleted\", function () {\n\t\t\t\tcontroller.collaborativeDraft.send({ action: Activity.Change, content: data });\n\t\t\t\tcontroller.collaborativeDraft.send({ action: Activity.Unlock, content: data });\n\t\t\t});\n\t\t}\n\t},\n\n\t_callSideEffectsForStream: function (\n\t\toEvent: Field$ChangeEvent & Event<{ isValid: boolean }>,\n\t\toControl: Control,\n\t\toController: PageController\n\t): void {\n\t\tconst oFEController = FieldRuntimeHelper.getExtensionController(oController);\n\t\tif (oControl && (oControl.getBindingContext() as unknown as { isTransient: Function }).isTransient()) {\n\t\t\treturn;\n\t\t}\n\t\tif (oControl) {\n\t\t\t(oEvent as unknown as { oSource: Control }).oSource = oControl;\n\t\t}\n\t\toFEController._sideEffects.handleFieldChange(oEvent, FieldRuntimeHelper.getFieldStateOnChange(oEvent).state[\"validity\"]);\n\t},\n\n\tgetIconForMimeType: function (sMimeType: string): string {\n\t\treturn IconPool.getIconForMimeType(sMimeType);\n\t},\n\n\t/**\n\t * Method to retrieve text from value list for DataField.\n\t * @param sPropertyValue The property value of the datafield\n\t * @param sPropertyFullPath The property full path's\n\t * @param sDisplayFormat The display format for the datafield\n\t * @returns The formatted value in corresponding display format.\n\t */\n\tretrieveTextFromValueList: async function (sPropertyValue: string, sPropertyFullPath: string, sDisplayFormat: string): Promise<string> {\n\t\tlet sTextProperty: string;\n\t\tlet oMetaModel;\n\t\tlet sPropertyName: string;\n\t\tif (sPropertyValue) {\n\t\t\toMetaModel = CommonHelper.getMetaModel();\n\t\t\tsPropertyName = oMetaModel.getObject(`${sPropertyFullPath}@sapui.name`);\n\t\t\treturn oMetaModel\n\t\t\t\t.requestValueListInfo(sPropertyFullPath, true)\n\t\t\t\t.then(function (mValueListInfo) {\n\t\t\t\t\t// take the \"\" one if exists, otherwise take the first one in the object TODO: to be discussed\n\t\t\t\t\tconst oValueListInfo = mValueListInfo[mValueListInfo[\"\"] ? \"\" : Object.keys(mValueListInfo)[0]];\n\t\t\t\t\tconst oValueListModel = oValueListInfo.$model;\n\t\t\t\t\tconst oMetaModelValueList = oValueListModel.getMetaModel();\n\t\t\t\t\tconst oParamWithKey = oValueListInfo.Parameters.find(function (oParameter: {\n\t\t\t\t\t\tLocalDataProperty?: { $PropertyPath: string };\n\t\t\t\t\t}) {\n\t\t\t\t\t\treturn oParameter.LocalDataProperty && oParameter.LocalDataProperty.$PropertyPath === sPropertyName;\n\t\t\t\t\t});\n\t\t\t\t\tif (oParamWithKey && !oParamWithKey.ValueListProperty) {\n\t\t\t\t\t\tthrow new Error(`Inconsistent value help annotation for ${sPropertyName}`);\n\t\t\t\t\t}\n\t\t\t\t\tconst oTextAnnotation = oMetaModelValueList.getObject(\n\t\t\t\t\t\t`/${oValueListInfo.CollectionPath}/${oParamWithKey.ValueListProperty}@com.sap.vocabularies.Common.v1.Text`\n\t\t\t\t\t);\n\n\t\t\t\t\tif (oTextAnnotation && oTextAnnotation.$Path) {\n\t\t\t\t\t\tsTextProperty = oTextAnnotation.$Path;\n\t\t\t\t\t\tconst oFilter = new Filter({\n\t\t\t\t\t\t\tpath: oParamWithKey.ValueListProperty,\n\t\t\t\t\t\t\toperator: \"EQ\",\n\t\t\t\t\t\t\tvalue1: sPropertyValue\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst oListBinding = oValueListModel.bindList(`/${oValueListInfo.CollectionPath}`, undefined, undefined, oFilter, {\n\t\t\t\t\t\t\t$select: sTextProperty\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn oListBinding.requestContexts(0, 2);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsDisplayFormat = \"Value\";\n\t\t\t\t\t\treturn sPropertyValue;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(function (aContexts: Context[]) {\n\t\t\t\t\tconst sDescription = sTextProperty ? aContexts[0]?.getObject()[sTextProperty] : \"\";\n\t\t\t\t\tswitch (sDisplayFormat) {\n\t\t\t\t\t\tcase \"Description\":\n\t\t\t\t\t\t\treturn sDescription;\n\t\t\t\t\t\tcase \"DescriptionValue\":\n\t\t\t\t\t\t\treturn Library.getResourceBundleFor(\"sap.fe.core\")!.getText(\"C_FORMAT_FOR_TEXT_ARRANGEMENT\", [\n\t\t\t\t\t\t\t\tsDescription,\n\t\t\t\t\t\t\t\tsPropertyValue\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\tcase \"ValueDescription\":\n\t\t\t\t\t\t\treturn Library.getResourceBundleFor(\"sap.fe.core\")!.getText(\"C_FORMAT_FOR_TEXT_ARRANGEMENT\", [\n\t\t\t\t\t\t\t\tsPropertyValue,\n\t\t\t\t\t\t\t\tsDescription\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\treturn sPropertyValue;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(function (oError: unknown) {\n\t\t\t\t\tconst errorObj = oError as { status: number; message: string };\n\t\t\t\t\tconst sMsg =\n\t\t\t\t\t\terrorObj.status && errorObj.status === 404\n\t\t\t\t\t\t\t? `Metadata not found (${errorObj.status}) for value help of property ${sPropertyFullPath}`\n\t\t\t\t\t\t\t: errorObj.message;\n\t\t\t\t\tLog.error(sMsg);\n\t\t\t\t});\n\t\t}\n\t\treturn sPropertyValue;\n\t},\n\n\thandleTypeMissmatch: function (event: FileUploader$TypeMissmatchEvent): void {\n\t\tconst fileUploader = event.getSource();\n\t\tconst givenType = event.getParameter(\"mimeType\");\n\t\tconst acceptedTypes = fileUploader.getMimeType();\n\t\tif (givenType) {\n\t\t\tshowTypeMismatchDialog(fileUploader, givenType, acceptedTypes);\n\t\t}\n\t},\n\n\thandleFileSizeExceed: function (event: FileUploader$FileSizeExceedEvent): void {\n\t\tconst fileUploader = event.getSource();\n\t\tshowFileSizeExceedDialog(fileUploader, fileUploader.getMaximumFileSize().toFixed(3));\n\t},\n\n\t/**\n\t * Event handler to create and show who is editing the field popover.\n\t * @param source The avatar which is next to the field locked\n\t * @param view Current view\n\t */\n\tshowCollaborationEditUser: function (source: Avatar, view: View): void {\n\t\tconst resourceModel = ResourceModelHelper.getResourceModel(view);\n\t\tlet popover = Element.getElementById(`manageCollaborationDraft--editUser`) as ResponsivePopover;\n\n\t\tif (!popover) {\n\t\t\tpopover = new ResponsivePopover(\"manageCollaborationDraft--editUser\", {\n\t\t\t\tshowHeader: false,\n\t\t\t\tplacement: \"Bottom\"\n\t\t\t});\n\t\t\tpopover.addStyleClass(\"sapUiContentPadding\");\n\t\t\tview.addDependent(popover);\n\t\t}\n\n\t\tconst bindingPath = (source.getBinding(\"initials\") as CompositeBinding | undefined)\n\t\t\t?.getBindings()\n\t\t\t.find((binding) => binding?.getPath()?.startsWith(\"/collaboration/activities\"))\n\t\t\t.getPath();\n\t\tconst activities = source.getBindingContext(\"internal\")?.getObject(bindingPath);\n\n\t\tlet editingActivity: UserActivity | undefined;\n\t\tif (activities && activities.length > 0) {\n\t\t\teditingActivity = activities.find((activity: UserActivity) => {\n\t\t\t\treturn activity.key === getActivityKeyFromPath(source.getBindingContext()!.getPath());\n\t\t\t});\n\t\t}\n\t\tpopover.destroyContent();\n\t\tpopover.addContent(\n\t\t\tnew Label({\n\t\t\t\ttext: resourceModel.getText(\"C_COLLABORATIONAVATAR_USER_EDIT_FIELD\", [`${editingActivity?.name}`])\n\t\t\t})\n\t\t);\n\t\tpopover.openBy(source);\n\t},\n\n\tdisplayAggregateDetails: async function (event: Event, aggregatedPropertyPath: string): Promise<void> {\n\t\tconst link = event.getSource<Link>();\n\t\tconst analyticalTable = FPMHelper.getMdcTable(link)!;\n\n\t\tconst rowContext = link.getBindingContext() as Context;\n\t\tconst tableRowBinding = rowContext.getBinding() as ODataListBinding;\n\n\t\t// Get the filters corresponding to the total row\n\t\tconst rowContextData = rowContext.getObject();\n\t\tconst rowSpecificFilter: Filter[] = [];\n\t\tconst rowFilter = rowContext.getFilter();\n\t\tif (rowFilter) {\n\t\t\trowSpecificFilter.push(rowFilter);\n\t\t}\n\n\t\t// Add the filters applied to the original table\n\t\tconst allFilters = rowSpecificFilter.concat(tableRowBinding.getFilters(\"Application\"), tableRowBinding.getFilters(\"Control\"));\n\n\t\t// Calculate $$aggregation parameters for the table in the popover (aggregate amount, group by currency/unit)\n\t\tconst aggregation = tableRowBinding.getAggregation() as {\n\t\t\tgroup: Record<string, object>;\n\t\t\taggregate: Record<string, { unit: string }>;\n\t\t\tsearch?: string;\n\t\t};\n\t\tconst unitOrCurrencyName = aggregation.aggregate[aggregatedPropertyPath].unit;\n\t\tconst group: Record<string, object> = {};\n\t\tgroup[unitOrCurrencyName] = {};\n\t\tconst aggregate: Record<string, object> = {};\n\t\taggregate[aggregatedPropertyPath] = { grandTotal: false, subtotals: false, unit: unitOrCurrencyName };\n\n\t\t// The item displayed in the table in the popover is a copy of the item displayed in the table\n\t\tconst tableItem = link.getDependents()[0].clone();\n\t\tconst currencyOrQuantityEnabledLayout = new HBox({\n\t\t\trenderType: \"Bare\",\n\t\t\tjustifyContent: \"End\",\n\t\t\titems: [tableItem]\n\t\t} as $HBoxSettings);\n\n\t\tconst aggregationParameters: {\n\t\t\tgroup: Record<string, object>;\n\t\t\taggregate: Record<string, object>;\n\t\t\tsearch?: string;\n\t\t} = { group, aggregate };\n\t\tif (aggregation.search) {\n\t\t\taggregationParameters.search = aggregation.search;\n\t\t}\n\n\t\tconst oItemsBindingInfo = {\n\t\t\tpath: tableRowBinding.getResolvedPath(),\n\t\t\tfilters: allFilters,\n\t\t\tparameters: {\n\t\t\t\t$$aggregation: aggregationParameters\n\t\t\t},\n\t\t\tsorter: new Sorter(unitOrCurrencyName, false) // Order by currency\n\t\t};\n\n\t\tconst isPopoverForGrandTotal = rowContextData[\"@$ui5.node.level\"] === 0;\n\t\tconst popover: ResponsivePopover = await Util.createOrUpdateMultiUnitPopover(`${analyticalTable.getId()}-multiUnitPopover`, {\n\t\t\tcontrol: analyticalTable,\n\t\t\tgrandTotal: isPopoverForGrandTotal,\n\t\t\titemsBindingInfo: oItemsBindingInfo,\n\t\t\tlistItemContentTemplate: currencyOrQuantityEnabledLayout\n\t\t});\n\t\tanalyticalTable.addDependent(popover);\n\n\t\tconst fnOnClose = (): void => {\n\t\t\tanalyticalTable.removeDependent(popover);\n\t\t\tpopover.detachEvent(\"afterClose\", fnOnClose);\n\t\t\tpopover.destroy();\n\t\t};\n\t\tpopover.attachEvent(\"afterClose\", fnOnClose);\n\t\tpopover.openBy(link);\n\t}\n};\n\nObjectPath.set(\"sap.fe.macros.field.FieldRuntime\", FieldRuntime);\n\nexport default FieldRuntime;\n"],"mappings":"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","ignoreList":[],"file":"FieldRuntime-dbg.js"}
{"version":3,"names":["DropPosition","TableHierarchy","_exports","_proto","prototype","setupMixin","_baseClass","_onCut","evt","forContextMenu","arguments","length","undefined","table","getSource","getParent","menu","internalContext","getBindingContext","selectedContexts","getSelectedContexts","Log","error","setProperty","MessageToast","show","ResourceModelHelper","getResourceModel","getText","getProperty","TableRuntime","clearSelection","fireSelectionChange","cutableContextsPath","_onDragEnterDocument","ui5Event","draggedContext","getParameter","getContent","getRowBinding","getBinding","preventDefault","targetContext","isAncestorOf","disabledBetween","disabledOn","tableDefinition","getTableDefinition","isMoveAllowedInfo","control","isMoveToPositionAllowed","customFunction","FPMHelper","getCustomFunction","moduleName","methodName","safeIsMoveAllowed","annotation","allowDropBetweenNodes","Math","abs","getIndex","getLength","changeSiblingForRootsSupported","isDropBetweenAllowedForDrag","allowedDropPosition","OnOrBetween","On","Between","setDropPosition","_onDragStartDocument","context","updatablePropertyPath","disableDrag","isRelative","isMovableInfo","isNodeMovable","_error","_onDropDocument","BusyLocker","lock","droppedOnContext","dropInfo","position","parentContext","contextBefore","contextAfter","getContextAfter","getContextBefore","Promise","all","dropContext","requestSideEffectsForChangeNextSiblingAction","getTranslatedText","message","unlock","_onCollapseExpandNode","_ui5Event","expand","promiseArray","map","singleContext","isExpanded","collapse","Number","MAX_SAFE_INTEGER","_onMoveUpDown","moveUp","movedContext","requestParent","contextMoved","movePromise","previousSibling","requestSibling","move","nextSibling","parent","newIndex","mdcTable","scrollToIndex","focusRow","entityPath","data","tableContext","model","getModel","metaModel","getMetaModel","targetObject","getContext","convertMetaModelContext","MetaModelConverter","entityType","targetType","actionName","annotations","Hierarchy","hierarchyQualifier","ChangeNextSiblingAction","appComponent","CommonUtils","getAppComponent","sideEffectsService","getSideEffectsService","sideEffects","getODataActionSideEffects","requestSideEffectsForODataAction","allowed","isAllowed","parentBefore","paramsBefore","getDropBetweenParameters","parentAfter","paramsAfter","contextIndex","Error","listBinding","getAllCurrentContexts","find","ctx","info","internalModelContext","isTableSorted","moveContext","params"],"sourceRoot":".","sources":["TableHierarchy.ts"],"sourcesContent":["import type { EntitySet, NavigationProperty } from \"@sap-ux/vocabularies-types\";\nimport Log from \"sap/base/Log\";\nimport { type IInterfaceWithMixin } from \"sap/fe/base/ClassSupport\";\nimport CommonUtils from \"sap/fe/core/CommonUtils\";\nimport BusyLocker from \"sap/fe/core/controllerextensions/BusyLocker\";\nimport * as MetaModelConverter from \"sap/fe/core/converters/MetaModelConverter\";\nimport FPMHelper from \"sap/fe/core/helpers/FPMHelper\";\nimport { type InternalModelContext } from \"sap/fe/core/helpers/ModelHelper\";\nimport ResourceModelHelper from \"sap/fe/core/helpers/ResourceModelHelper\";\nimport type Menu from \"sap/m/Menu\";\nimport MessageToast from \"sap/m/MessageToast\";\nimport type UI5Event from \"sap/ui/base/Event\";\nimport type Control from \"sap/ui/core/Control\";\nimport type UI5Element from \"sap/ui/core/Element\";\nimport type DragDropInfo from \"sap/ui/core/dnd/DragDropInfo\";\nimport type MDCTable from \"sap/ui/mdc/Table\";\nimport type Context from \"sap/ui/model/odata/v4/Context\";\nimport type ODataListBinding from \"sap/ui/model/odata/v4/ODataListBinding\";\nimport { type ITableBlock } from \"../TableAPI\";\nimport TableRuntime from \"../TableRuntime\";\n\nenum DropPosition {\n\tOn = \"On\",\n\tBetween = \"Between\",\n\tOnOrBetween = \"OnOrBetween\"\n}\n\ntype DropInformation =\n\t| { position: DropPosition.On; parentContext: Context | null }\n\t| { position: DropPosition.Between; contextBefore: Context | null; contextAfter: Context | null };\n\nexport default class TableHierarchy implements IInterfaceWithMixin {\n\tsetupMixin(_baseClass: Function): void {\n\t\t// This method is needed to implement interface IInterfaceWithMixin\n\t}\n\n\t/**\n\t * Handles the Cut operation.\n\t * @param evt The UI5 event\n\t * @param forContextMenu\n\t */\n\t_onCut(this: ITableBlock & TableHierarchy, evt: UI5Event<{}, UI5Element>, forContextMenu = false): void {\n\t\tlet table: MDCTable;\n\t\tif (!forContextMenu) {\n\t\t\ttable = evt.getSource().getParent() as MDCTable;\n\t\t} else {\n\t\t\tconst menu = evt.getSource().getParent() as Menu;\n\t\t\ttable = menu.getParent()?.getParent() as MDCTable;\n\t\t}\n\t\tconst internalContext = table.getBindingContext(\"internal\") as InternalModelContext;\n\t\tconst selectedContexts = this.getSelectedContexts();\n\t\tif (selectedContexts.length > 1) {\n\t\t\tLog.error(\"Multi cutting is not supported\");\n\t\t\treturn;\n\t\t}\n\n\t\tinternalContext.setProperty(\"pastableContexts\", selectedContexts);\n\t\tMessageToast.show(ResourceModelHelper.getResourceModel(table).getText(\"M_CUT_READY\"));\n\t\tif (!forContextMenu || internalContext.getProperty(\"numberOfSelectedContexts\") > 0) {\n\t\t\tTableRuntime.clearSelection(table);\n\t\t\ttable.fireSelectionChange();\n\t\t}\n\t\tconst cutableContextsPath = !forContextMenu ? \"cutableContexts\" : \"contextmenu/cutableContexts\";\n\t\tinternalContext.setProperty(cutableContextsPath, []);\n\t}\n\n\t/**\n\t * The dragged element enters a table row.\n\t * @param ui5Event UI5 event coming from the MDC drag and drop config\n\t */\n\t_onDragEnterDocument(\n\t\tthis: ITableBlock & TableHierarchy,\n\t\tui5Event: UI5Event<{ bindingContext: Context; dragSource: Context; dropPosition: \"Before\" | \"After\" | \"On\" }, DragDropInfo>\n\t): void {\n\t\tconst draggedContext = ui5Event.getParameter(\"dragSource\");\n\t\tif (this.getContent().getRowBinding() !== draggedContext.getBinding()) {\n\t\t\t// The drag is done on a different table -> not authorized\n\t\t\tui5Event.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tconst targetContext: Context | null = ui5Event.getParameter(\"bindingContext\");\n\t\tif (draggedContext.isAncestorOf(targetContext)) {\n\t\t\t// The ancestor is dropped on a descendant -> not authorized\n\t\t\tui5Event.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tlet disabledBetween = false;\n\t\tlet disabledOn = false;\n\t\tconst tableDefinition = this.getTableDefinition();\n\t\tconst isMoveAllowedInfo = tableDefinition.control.isMoveToPositionAllowed;\n\t\tconst customFunction = isMoveAllowedInfo\n\t\t\t? FPMHelper.getCustomFunction<(node: Context, parent: Context | null) => boolean>(\n\t\t\t\t\tisMoveAllowedInfo.moduleName,\n\t\t\t\t\tisMoveAllowedInfo.methodName,\n\t\t\t\t\tui5Event.getSource().getParent() as Control\n\t\t\t  )\n\t\t\t: undefined;\n\n\t\tif (targetContext === this.getContent().getBindingContext()) {\n\t\t\t// The drag is done on the table itself -> drop as root node)\n\t\t\tdisabledOn = !this.safeIsMoveAllowed(customFunction, draggedContext, null);\n\t\t\tdisabledBetween = true;\n\t\t} else {\n\t\t\tdisabledOn = !this.safeIsMoveAllowed(customFunction, draggedContext, targetContext);\n\t\t\tdisabledBetween = tableDefinition.annotation.allowDropBetweenNodes !== true;\n\n\t\t\tif (\n\t\t\t\tMath.abs(targetContext.getIndex()! - draggedContext.getIndex()!) === 1 &&\n\t\t\t\t!(targetContext.getIndex() === 0 && ui5Event.getParameter(\"dropPosition\") === \"Before\") &&\n\t\t\t\t!(\n\t\t\t\t\ttargetContext.getIndex() === this.getContent().getRowBinding().getLength() - 1 &&\n\t\t\t\t\tui5Event.getParameter(\"dropPosition\") === \"After\"\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\t//\n\t\t\t\tdisabledBetween = true;\n\t\t\t}\n\n\t\t\t// If the drop between node is allowed, we need to check if the target is a root node and if the table supports changeSiblingForRoots\n\t\t\tif (\n\t\t\t\t!disabledBetween &&\n\t\t\t\t!tableDefinition.annotation.changeSiblingForRootsSupported &&\n\t\t\t\ttargetContext.getProperty(\"@$ui5.node.level\") === 1\n\t\t\t) {\n\t\t\t\tdisabledBetween = true;\n\t\t\t}\n\n\t\t\t// Check custom logic for drop between if there's some, and if it's not already disabled at the table level\n\t\t\tif (customFunction && !disabledBetween) {\n\t\t\t\tdisabledBetween = !this.isDropBetweenAllowedForDrag(customFunction, draggedContext, targetContext);\n\t\t\t}\n\t\t}\n\n\t\tlet allowedDropPosition: DropPosition = DropPosition.OnOrBetween;\n\t\tif (disabledBetween && disabledOn) {\n\t\t\t//Set the element as non droppable\n\t\t\tui5Event.preventDefault();\n\t\t\treturn;\n\t\t}\n\t\tif (disabledBetween) {\n\t\t\tallowedDropPosition = DropPosition.On;\n\t\t} else if (disabledOn) {\n\t\t\tallowedDropPosition = DropPosition.Between;\n\t\t}\n\t\tui5Event.getSource().setDropPosition(allowedDropPosition);\n\t}\n\n\t/**\n\t * Starts the drag of the document.\n\t * @param ui5Event UI5 event coming from the MDC drag and drop config\n\t */\n\t_onDragStartDocument(this: ITableBlock & TableHierarchy, ui5Event: UI5Event<{ bindingContext: Context }, Control>): void {\n\t\tconst context = ui5Event.getParameter(\"bindingContext\");\n\t\tconst updatablePropertyPath = this.getTableDefinition().annotation.updatablePropertyPath;\n\n\t\t// Check if the context can be updated according to update restrictions\n\t\tlet disableDrag = !!updatablePropertyPath && !context.getProperty(updatablePropertyPath);\n\n\t\t// In case of a TreeTable in a ListReport with draft, check that the context has no associated draft\n\t\tif (!disableDrag && !(context.getBinding() as ODataListBinding).isRelative()) {\n\t\t\tdisableDrag = context.getProperty(\"HasDraftEntity\") === true;\n\t\t}\n\n\t\t// Apply custom logic if there's one\n\t\tconst isMovableInfo = this.getTableDefinition().control.isNodeMovable;\n\t\ttry {\n\t\t\tif (isMovableInfo && !disableDrag) {\n\t\t\t\tdisableDrag =\n\t\t\t\t\t(\n\t\t\t\t\t\tFPMHelper.getCustomFunction<(contexts: Context[]) => boolean>(\n\t\t\t\t\t\t\tisMovableInfo.moduleName,\n\t\t\t\t\t\t\tisMovableInfo.methodName,\n\t\t\t\t\t\t\tui5Event.getSource()\n\t\t\t\t\t\t) as Function\n\t\t\t\t\t)(context) === false;\n\t\t\t}\n\t\t} catch (_error) {\n\t\t\tdisableDrag = false;\n\t\t}\n\t\tif (disableDrag) {\n\t\t\t//Set the element as non draggable\n\t\t\tui5Event.preventDefault();\n\t\t}\n\t}\n\n\t/**\n\t * Drops the document.\n\t * @param ui5Event UI5 event coming from the MDC drag and drop config\n\t * @returns The Promise\n\t */\n\tasync _onDropDocument(\n\t\tthis: ITableBlock & TableHierarchy,\n\t\tui5Event: UI5Event<{\n\t\t\tbindingContext: Context;\n\t\t\tdragSource: Context;\n\t\t\tdropPosition: string;\n\t\t}>\n\t): Promise<void> {\n\t\tBusyLocker.lock(this.getContent());\n\n\t\ttry {\n\t\t\tconst droppedOnContext = ui5Event.getParameter(\"bindingContext\");\n\t\t\tlet dropInfo: DropInformation;\n\t\t\tif (droppedOnContext === this.getContent().getBindingContext()) {\n\t\t\t\t// The drop is done on the table itself -> drop as root node)\n\t\t\t\tdropInfo = { position: DropPosition.On, parentContext: null };\n\t\t\t} else if (ui5Event.getParameter(\"dropPosition\") === DropPosition.On) {\n\t\t\t\t// Drop on a node\n\t\t\t\tdropInfo = { position: DropPosition.On, parentContext: droppedOnContext };\n\t\t\t} else {\n\t\t\t\t// Drop between 2 nodes\n\t\t\t\tlet contextBefore: Context | null;\n\t\t\t\tlet contextAfter: Context | null;\n\t\t\t\tif (ui5Event.getParameter(\"dropPosition\") === \"After\") {\n\t\t\t\t\tcontextBefore = droppedOnContext;\n\t\t\t\t\tcontextAfter = this.getContextAfter(droppedOnContext);\n\t\t\t\t} else {\n\t\t\t\t\tcontextBefore = this.getContextBefore(droppedOnContext);\n\t\t\t\t\tcontextAfter = droppedOnContext;\n\t\t\t\t}\n\t\t\t\tdropInfo = { position: DropPosition.Between, contextAfter, contextBefore };\n\t\t\t}\n\n\t\t\tawait Promise.all([\n\t\t\t\tthis.dropContext(ui5Event.getParameter(\"dragSource\"), dropInfo),\n\t\t\t\tthis.requestSideEffectsForChangeNextSiblingAction()\n\t\t\t]);\n\t\t} catch (error) {\n\t\t\tMessageToast.show(this.getTranslatedText(\"M_TABLEDROP_FAILED\", [(error as Error).message ?? \"\"]));\n\t\t} finally {\n\t\t\tBusyLocker.unlock(this.getContent());\n\t\t}\n\t}\n\n\t/**\n\t * Handler for collapse/expand from the context menu.\n\t * @param this\n\t * @param _ui5Event\n\t * @param expand\n\t */\n\tasync _onCollapseExpandNode(this: ITableBlock & TableHierarchy, _ui5Event: UI5Event, expand: boolean): Promise<void> {\n\t\tconst selectedContexts = this.getSelectedContexts();\n\t\tif (expand) {\n\t\t\tconst promiseArray = selectedContexts.map(async (singleContext: Context) => {\n\t\t\t\t// Checking for false specifically; undefined means the node cannot expand/collapse\n\t\t\t\tif (singleContext.isExpanded() !== undefined) {\n\t\t\t\t\t// Temporary workaround due to model limitation.\n\t\t\t\t\t// We need to collapse a node before expanding it to ensure we expand it completely.\n\t\t\t\t\t// Will be changed once the model fixes the issue.\n\t\t\t\t\tif (singleContext.isExpanded() === true) {\n\t\t\t\t\t\tawait singleContext.collapse();\n\t\t\t\t\t}\n\t\t\t\t\treturn singleContext.expand(Number.MAX_SAFE_INTEGER);\n\t\t\t\t}\n\t\t\t});\n\t\t\tawait Promise.all(promiseArray);\n\t\t} else {\n\t\t\tawait Promise.all(\n\t\t\t\tselectedContexts.map(async (singleContext: Context) => {\n\t\t\t\t\tif (singleContext.isExpanded() === true) {\n\t\t\t\t\t\treturn singleContext.collapse(true);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Internal method to move a row up or down in a Tree table.\n\t * @param _ui5Event\n\t * @param moveUp True for move up, false for move down\n\t * @param forContextMenu\n\t */\n\tasync _onMoveUpDown(this: ITableBlock & TableHierarchy, _ui5Event: UI5Event, moveUp: boolean, forContextMenu = false): Promise<void> {\n\t\tconst selectedContexts = this.getSelectedContexts();\n\t\tif (selectedContexts.length !== 1) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Move the context up or down\n\t\tconst movedContext = selectedContexts[0];\n\t\tconst parentContext = await movedContext.requestParent();\n\t\tlet contextMoved = false;\n\t\tlet movePromise = null;\n\t\tif (moveUp) {\n\t\t\tconst previousSibling = await movedContext.requestSibling(-1);\n\t\t\tif (previousSibling) {\n\t\t\t\tmovePromise = movedContext.move({ nextSibling: previousSibling, parent: parentContext });\n\t\t\t\tcontextMoved = true;\n\t\t\t}\n\t\t} else {\n\t\t\tconst nextSibling = await movedContext.requestSibling(1);\n\t\t\tif (nextSibling) {\n\t\t\t\tmovePromise = nextSibling.move({ nextSibling: movedContext, parent: parentContext });\n\t\t\t\tcontextMoved = true;\n\t\t\t}\n\t\t}\n\n\t\tawait Promise.all([movePromise, this.requestSideEffectsForChangeNextSiblingAction()]);\n\n\t\t// Scroll to the new position\n\t\tconst newIndex = movedContext.getIndex();\n\t\tif (contextMoved && newIndex !== undefined && newIndex >= 0) {\n\t\t\tconst mdcTable = this.getContent();\n\t\t\tif (!forContextMenu) {\n\t\t\t\tmdcTable.scrollToIndex(newIndex);\n\t\t\t} else {\n\t\t\t\tmdcTable.focusRow(newIndex);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Requests the side effect for the ChangeNextSiblingAction.\n\t * @returns A Promise\n\t */\n\tasync requestSideEffectsForChangeNextSiblingAction(this: ITableBlock & TableHierarchy): Promise<void> {\n\t\tconst entityPath = this.getContent().data(\"metaPath\");\n\t\tconst tableContext = this.getContent().getBindingContext() as Context;\n\t\tconst model = tableContext.getModel(),\n\t\t\tmetaModel = model.getMetaModel();\n\n\t\tconst targetObject = metaModel.getContext(entityPath);\n\t\tconst convertMetaModelContext = MetaModelConverter.convertMetaModelContext(targetObject) as NavigationProperty | EntitySet;\n\t\tconst entityType = (convertMetaModelContext as NavigationProperty).targetType ?? (convertMetaModelContext as EntitySet).entityType;\n\t\tconst actionName = entityType.annotations.Hierarchy?.[\n\t\t\t`RecursiveHierarchyActions#${this.getTableDefinition().control.hierarchyQualifier ?? \"\"}`\n\t\t]?.ChangeNextSiblingAction as string | undefined;\n\n\t\tif (actionName) {\n\t\t\tconst appComponent = CommonUtils.getAppComponent(this.getContent());\n\t\t\tconst sideEffectsService = appComponent.getSideEffectsService();\n\t\t\tconst sideEffects = sideEffectsService.getODataActionSideEffects(actionName, tableContext);\n\t\t\tif (sideEffects) {\n\t\t\t\tawait sideEffectsService.requestSideEffectsForODataAction(sideEffects, tableContext);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Safely checks if moving a node is allowed.\n\t * @param customFunction\n\t * @param movedContext\n\t * @param parentContext\n\t * @returns True if allowed\n\t */\n\tprivate safeIsMoveAllowed(\n\t\tcustomFunction: ((context: Context, parent: Context | null) => boolean) | undefined,\n\t\tmovedContext: Context,\n\t\tparentContext: Context | null\n\t): boolean {\n\t\tif (!customFunction) {\n\t\t\treturn true;\n\t\t}\n\n\t\tlet allowed = true;\n\t\ttry {\n\t\t\tallowed = customFunction(movedContext, parentContext) === true;\n\t\t} catch (error) {\n\t\t\tLog.error(\"Cannot execute function related to isMoveToPositionAllowed\", error as string);\n\t\t\tallowed = true;\n\t\t}\n\n\t\treturn allowed;\n\t}\n\n\t/**\n\t * Checks is drop \"between\" is allowed by custom logic for a given targetContext.\n\t * @param customFunction\n\t * @param draggedContext\n\t * @param targetContext\n\t * @returns True if allowed\n\t */\n\tprivate isDropBetweenAllowedForDrag(\n\t\tcustomFunction: (context: Context, parent: Context | null) => boolean,\n\t\tdraggedContext: Context,\n\t\ttargetContext: Context\n\t): boolean {\n\t\tlet isAllowed = true;\n\n\t\t// Determine what to do if we drop before targetContext\n\t\tconst contextBefore = this.getContextBefore(targetContext);\n\t\tconst parentBefore = contextBefore === null ? null : contextBefore.getParent();\n\t\tconst paramsBefore = this.getDropBetweenParameters(contextBefore, parentBefore, targetContext, targetContext.getParent());\n\n\t\t// Determine what to do if we drop after targetContext\n\t\tconst contextAfter = this.getContextAfter(targetContext);\n\t\tconst parentAfter = contextAfter === null ? null : contextAfter.getParent();\n\t\tconst paramsAfter = this.getDropBetweenParameters(targetContext, targetContext.getParent(), contextAfter, parentAfter);\n\n\t\t// If paramsBefore or paramsAfter cannot be determined (because parents are not loaded), we allow drop between and do the real check in onDropDocument\n\t\tif (paramsBefore !== undefined && paramsAfter !== undefined) {\n\t\t\tif (paramsBefore.parent === paramsAfter.parent) {\n\t\t\t\t// Dropping before or after will move under the same parent --> we call the custom logic only once\n\t\t\t\tisAllowed = this.safeIsMoveAllowed(customFunction, draggedContext, paramsBefore.parent);\n\t\t\t} else {\n\t\t\t\t// As the MDC table cannot disable drop before and after separately, we disable drop between only if both drop before and after are forbidden\n\t\t\t\tisAllowed =\n\t\t\t\t\tthis.safeIsMoveAllowed(customFunction, draggedContext, paramsBefore.parent) ||\n\t\t\t\t\tthis.safeIsMoveAllowed(customFunction, draggedContext, paramsAfter.parent);\n\t\t\t}\n\t\t}\n\n\t\treturn isAllowed;\n\t}\n\n\t/**\n\t * Returns the context that is placed before a given context in a ListBinding.\n\t * @param context\n\t * @returns The context before, or null\n\t */\n\tprivate getContextBefore(context: Context): Context | null {\n\t\tconst contextIndex = context.getIndex();\n\t\tif (contextIndex === undefined) {\n\t\t\tthrow new Error(\"Unexpected error\");\n\t\t}\n\n\t\tconst listBinding = context.getBinding() as ODataListBinding;\n\t\treturn contextIndex === 0\n\t\t\t? null\n\t\t\t: listBinding.getAllCurrentContexts().find((ctx) => {\n\t\t\t\t\treturn ctx.getIndex() === contextIndex - 1;\n\t\t\t  }) ?? null;\n\t}\n\n\t/**\n\t * Returns the context that is placed after a given context in a ListBinding.\n\t * @param context\n\t * @returns The context after, or null\n\t */\n\tprivate getContextAfter(context: Context): Context | null {\n\t\tconst contextIndex = context.getIndex();\n\t\tif (contextIndex === undefined) {\n\t\t\tthrow new Error(\"Unexpected error\");\n\t\t}\n\n\t\tconst listBinding = context.getBinding() as ODataListBinding;\n\t\treturn (\n\t\t\tlistBinding.getAllCurrentContexts().find((ctx) => {\n\t\t\t\treturn ctx.getIndex() === contextIndex + 1;\n\t\t\t}) ?? null\n\t\t);\n\t}\n\n\t/**\n\t * Returns information to perform a drop between 2 nodes: the new parent and the next sibling.\n\t * @param contextBefore Context after which the drop is done\n\t * @param parentBefore Parent of contextBefore (undefined if not known)\n\t * @param contextAfter Context before which the drop is done\n\t * @param parentAfter Parent of contextAfter (undefined if not known)\n\t * @returns The new parent and the next sibling, or undefined if it cannot be determined\n\t */\n\tprivate getDropBetweenParameters(\n\t\tcontextBefore: Context | null,\n\t\tparentBefore: Context | null | undefined,\n\t\tcontextAfter: Context | null,\n\t\tparentAfter: Context | null | undefined\n\t): { parent: Context | null; nextSibling?: Context | null } | undefined {\n\t\tif (contextBefore === null) {\n\t\t\t// Drop before first node --> move as first root node\n\t\t\treturn { parent: null, nextSibling: contextAfter };\n\t\t} else if (contextAfter === null) {\n\t\t\t// Drop after last node --> move as next sibling of the last node\n\t\t\treturn parentBefore !== undefined ? { parent: parentBefore, nextSibling: null } : undefined;\n\t\t} else if (parentAfter === contextBefore) {\n\t\t\t// Drop between a parent and its first child --> move as first child of the parent\n\t\t\treturn { parent: contextBefore, nextSibling: contextAfter };\n\t\t} else if (parentBefore === undefined || parentAfter === undefined) {\n\t\t\t// If one of the parent is not known, we don't know what to do\n\t\t\treturn undefined;\n\t\t} else if (parentBefore === parentAfter) {\n\t\t\t// Drop between 2 siblings\n\t\t\treturn { parent: parentBefore, nextSibling: contextAfter };\n\t\t} else {\n\t\t\t// NodeX\n\t\t\t//  ....\n\t\t\t//     |-- contextBefore\n\t\t\t// contextAfter\n\t\t\t// --> Move as the next sibling of contextBefore\n\t\t\treturn { parent: parentBefore, nextSibling: null };\n\t\t}\n\t}\n\n\t/**\n\t * Internal method to drop a context on or between 2 nodes.\n\t * @param context\n\t * @param info\n\t * @returns The move Promise\n\t */\n\tprivate async dropContext(this: ITableBlock & TableHierarchy, context: Context, info: DropInformation): Promise<void> {\n\t\tconst isMoveAllowedInfo = this.getTableDefinition().control.isMoveToPositionAllowed;\n\t\tconst customFunction = isMoveAllowedInfo\n\t\t\t? FPMHelper.getCustomFunction<(node: Context, parent: Context | null) => boolean>(\n\t\t\t\t\tisMoveAllowedInfo.moduleName,\n\t\t\t\t\tisMoveAllowedInfo.methodName,\n\t\t\t\t\tthis.getContent()\n\t\t\t  )\n\t\t\t: undefined;\n\t\tconst internalModelContext = this.getContent().getBindingContext(\"internal\") as InternalModelContext;\n\t\tconst isTableSorted = internalModelContext.getProperty(\"isSorted\") === true;\n\n\t\tconst moveContext = async (parent: Context | null, nextSibling?: Context | null): Promise<void> => {\n\t\t\t// We check if the move is allowed by custom logic (if any), as this check might\n\t\t\t// not have been done in onDragEnterDocument if the parent was not loaded yet.\n\t\t\tif (this.safeIsMoveAllowed(customFunction, context, parent)) {\n\t\t\t\t// If the table is sorted, we ignore the sibling as the position shall be determined by the server\n\t\t\t\treturn context.move({ parent, nextSibling: isTableSorted ? undefined : nextSibling });\n\t\t\t} else {\n\t\t\t\tMessageToast.show(this.getTranslatedText(\"M_TABLE_DROP_NOT_ALLOWED\"));\n\t\t\t}\n\t\t};\n\n\t\tif (info.position === DropPosition.On) {\n\t\t\t// Drop on a node\n\t\t\treturn moveContext(info.parentContext);\n\t\t} else {\n\t\t\t// Drop between 2 nodes\n\t\t\tconst [parentBefore, parentAfter] = await Promise.all([\n\t\t\t\tinfo.contextBefore?.requestParent() ?? null,\n\t\t\t\tinfo.contextAfter?.requestParent() ?? null\n\t\t\t]);\n\t\t\tconst params = this.getDropBetweenParameters(info.contextBefore, parentBefore, info.contextAfter, parentAfter)!;\n\t\t\treturn moveContext(params.parent, params.nextSibling);\n\t\t}\n\t}\n}\n"],"mappings":";;;;;;;;MAqBKA,YAAY,0BAAZA,YAAY;IAAZA,YAAY;IAAZA,YAAY;IAAZA,YAAY;IAAA,OAAZA,YAAY;EAAA,EAAZA,YAAY;EAAA,IAUIC,cAAc;IAAA,SAAAA,eAAA;IAAAC,QAAA,GAAAD,cAAA;IAAA,IAAAE,MAAA,GAAAF,cAAA,CAAAG,SAAA;IAAAD,MAAA,CAClCE,UAAU,GAAV,SAAAA,UAAUA,CAACC,UAAoB,EAAQ;MACtC;IAAA;;IAGD;AACD;AACA;AACA;AACA,OAJC;IAAAH,MAAA,CAKAI,MAAM,GAAN,SAAAA,MAAMA,CAAqCC,GAA6B,EAAgC;MAAA,IAA9BC,cAAc,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,KAAK;MAC/F,IAAIG,KAAe;MACnB,IAAI,CAACJ,cAAc,EAAE;QACpBI,KAAK,GAAGL,GAAG,CAACM,SAAS,CAAC,CAAC,CAACC,SAAS,CAAC,CAAa;MAChD,CAAC,MAAM;QACN,MAAMC,IAAI,GAAGR,GAAG,CAACM,SAAS,CAAC,CAAC,CAACC,SAAS,CAAC,CAAS;QAChDF,KAAK,GAAGG,IAAI,CAACD,SAAS,CAAC,CAAC,EAAEA,SAAS,CAAC,CAAa;MAClD;MACA,MAAME,eAAe,GAAGJ,KAAK,CAACK,iBAAiB,CAAC,UAAU,CAAyB;MACnF,MAAMC,gBAAgB,GAAG,IAAI,CAACC,mBAAmB,CAAC,CAAC;MACnD,IAAID,gBAAgB,CAACR,MAAM,GAAG,CAAC,EAAE;QAChCU,GAAG,CAACC,KAAK,CAAC,gCAAgC,CAAC;QAC3C;MACD;MAEAL,eAAe,CAACM,WAAW,CAAC,kBAAkB,EAAEJ,gBAAgB,CAAC;MACjEK,YAAY,CAACC,IAAI,CAACC,mBAAmB,CAACC,gBAAgB,CAACd,KAAK,CAAC,CAACe,OAAO,CAAC,aAAa,CAAC,CAAC;MACrF,IAAI,CAACnB,cAAc,IAAIQ,eAAe,CAACY,WAAW,CAAC,0BAA0B,CAAC,GAAG,CAAC,EAAE;QACnFC,YAAY,CAACC,cAAc,CAAClB,KAAK,CAAC;QAClCA,KAAK,CAACmB,mBAAmB,CAAC,CAAC;MAC5B;MACA,MAAMC,mBAAmB,GAAG,CAACxB,cAAc,GAAG,iBAAiB,GAAG,6BAA6B;MAC/FQ,eAAe,CAACM,WAAW,CAACU,mBAAmB,EAAE,EAAE,CAAC;IACrD;;IAEA;AACD;AACA;AACA,OAHC;IAAA9B,MAAA,CAIA+B,oBAAoB,GAApB,SAAAA,oBAAoBA,CAEnBC,QAA2H,EACpH;MACP,MAAMC,cAAc,GAAGD,QAAQ,CAACE,YAAY,CAAC,YAAY,CAAC;MAC1D,IAAI,IAAI,CAACC,UAAU,CAAC,CAAC,CAACC,aAAa,CAAC,CAAC,KAAKH,cAAc,CAACI,UAAU,CAAC,CAAC,EAAE;QACtE;QACAL,QAAQ,CAACM,cAAc,CAAC,CAAC;QACzB;MACD;MAEA,MAAMC,aAA6B,GAAGP,QAAQ,CAACE,YAAY,CAAC,gBAAgB,CAAC;MAC7E,IAAID,cAAc,CAACO,YAAY,CAACD,aAAa,CAAC,EAAE;QAC/C;QACAP,QAAQ,CAACM,cAAc,CAAC,CAAC;QACzB;MACD;MAEA,IAAIG,eAAe,GAAG,KAAK;MAC3B,IAAIC,UAAU,GAAG,KAAK;MACtB,MAAMC,eAAe,GAAG,IAAI,CAACC,kBAAkB,CAAC,CAAC;MACjD,MAAMC,iBAAiB,GAAGF,eAAe,CAACG,OAAO,CAACC,uBAAuB;MACzE,MAAMC,cAAc,GAAGH,iBAAiB,GACrCI,SAAS,CAACC,iBAAiB,CAC3BL,iBAAiB,CAACM,UAAU,EAC5BN,iBAAiB,CAACO,UAAU,EAC5BpB,QAAQ,CAACrB,SAAS,CAAC,CAAC,CAACC,SAAS,CAAC,CAC/B,CAAC,GACDH,SAAS;MAEZ,IAAI8B,aAAa,KAAK,IAAI,CAACJ,UAAU,CAAC,CAAC,CAACpB,iBAAiB,CAAC,CAAC,EAAE;QAC5D;QACA2B,UAAU,GAAG,CAAC,IAAI,CAACW,iBAAiB,CAACL,cAAc,EAAEf,cAAc,EAAE,IAAI,CAAC;QAC1EQ,eAAe,GAAG,IAAI;MACvB,CAAC,MAAM;QACNC,UAAU,GAAG,CAAC,IAAI,CAACW,iBAAiB,CAACL,cAAc,EAAEf,cAAc,EAAEM,aAAa,CAAC;QACnFE,eAAe,GAAGE,eAAe,CAACW,UAAU,CAACC,qBAAqB,KAAK,IAAI;QAE3E,IACCC,IAAI,CAACC,GAAG,CAAClB,aAAa,CAACmB,QAAQ,CAAC,CAAC,GAAIzB,cAAc,CAACyB,QAAQ,CAAC,CAAE,CAAC,KAAK,CAAC,IACtE,EAAEnB,aAAa,CAACmB,QAAQ,CAAC,CAAC,KAAK,CAAC,IAAI1B,QAAQ,CAACE,YAAY,CAAC,cAAc,CAAC,KAAK,QAAQ,CAAC,IACvF,EACCK,aAAa,CAACmB,QAAQ,CAAC,CAAC,KAAK,IAAI,CAACvB,UAAU,CAAC,CAAC,CAACC,aAAa,CAAC,CAAC,CAACuB,SAAS,CAAC,CAAC,GAAG,CAAC,IAC9E3B,QAAQ,CAACE,YAAY,CAAC,cAAc,CAAC,KAAK,OAAO,CACjD,EACA;UACD;UACAO,eAAe,GAAG,IAAI;QACvB;;QAEA;QACA,IACC,CAACA,eAAe,IAChB,CAACE,eAAe,CAACW,UAAU,CAACM,8BAA8B,IAC1DrB,aAAa,CAACb,WAAW,CAAC,kBAAkB,CAAC,KAAK,CAAC,EAClD;UACDe,eAAe,GAAG,IAAI;QACvB;;QAEA;QACA,IAAIO,cAAc,IAAI,CAACP,eAAe,EAAE;UACvCA,eAAe,GAAG,CAAC,IAAI,CAACoB,2BAA2B,CAACb,cAAc,EAAEf,cAAc,EAAEM,aAAa,CAAC;QACnG;MACD;MAEA,IAAIuB,mBAAiC,GAAGjE,YAAY,CAACkE,WAAW;MAChE,IAAItB,eAAe,IAAIC,UAAU,EAAE;QAClC;QACAV,QAAQ,CAACM,cAAc,CAAC,CAAC;QACzB;MACD;MACA,IAAIG,eAAe,EAAE;QACpBqB,mBAAmB,GAAGjE,YAAY,CAACmE,EAAE;MACtC,CAAC,MAAM,IAAItB,UAAU,EAAE;QACtBoB,mBAAmB,GAAGjE,YAAY,CAACoE,OAAO;MAC3C;MACAjC,QAAQ,CAACrB,SAAS,CAAC,CAAC,CAACuD,eAAe,CAACJ,mBAAmB,CAAC;IAC1D;;IAEA;AACD;AACA;AACA,OAHC;IAAA9D,MAAA,CAIAmE,oBAAoB,GAApB,SAAAA,oBAAoBA,CAAqCnC,QAAwD,EAAQ;MACxH,MAAMoC,OAAO,GAAGpC,QAAQ,CAACE,YAAY,CAAC,gBAAgB,CAAC;MACvD,MAAMmC,qBAAqB,GAAG,IAAI,CAACzB,kBAAkB,CAAC,CAAC,CAACU,UAAU,CAACe,qBAAqB;;MAExF;MACA,IAAIC,WAAW,GAAG,CAAC,CAACD,qBAAqB,IAAI,CAACD,OAAO,CAAC1C,WAAW,CAAC2C,qBAAqB,CAAC;;MAExF;MACA,IAAI,CAACC,WAAW,IAAI,CAAEF,OAAO,CAAC/B,UAAU,CAAC,CAAC,CAAsBkC,UAAU,CAAC,CAAC,EAAE;QAC7ED,WAAW,GAAGF,OAAO,CAAC1C,WAAW,CAAC,gBAAgB,CAAC,KAAK,IAAI;MAC7D;;MAEA;MACA,MAAM8C,aAAa,GAAG,IAAI,CAAC5B,kBAAkB,CAAC,CAAC,CAACE,OAAO,CAAC2B,aAAa;MACrE,IAAI;QACH,IAAID,aAAa,IAAI,CAACF,WAAW,EAAE;UAClCA,WAAW,GAETrB,SAAS,CAACC,iBAAiB,CAC1BsB,aAAa,CAACrB,UAAU,EACxBqB,aAAa,CAACpB,UAAU,EACxBpB,QAAQ,CAACrB,SAAS,CAAC,CACpB,CAAC,CACAyD,OAAO,CAAC,KAAK,KAAK;QACtB;MACD,CAAC,CAAC,OAAOM,MAAM,EAAE;QAChBJ,WAAW,GAAG,KAAK;MACpB;MACA,IAAIA,WAAW,EAAE;QAChB;QACAtC,QAAQ,CAACM,cAAc,CAAC,CAAC;MAC1B;IACD;;IAEA;AACD;AACA;AACA;AACA,OAJC;IAAAtC,MAAA,CAKM2E,eAAe,GAArB,eAAMA,eAAeA,CAEpB3C,QAIE,EACc;MAChB4C,UAAU,CAACC,IAAI,CAAC,IAAI,CAAC1C,UAAU,CAAC,CAAC,CAAC;MAElC,IAAI;QACH,MAAM2C,gBAAgB,GAAG9C,QAAQ,CAACE,YAAY,CAAC,gBAAgB,CAAC;QAChE,IAAI6C,QAAyB;QAC7B,IAAID,gBAAgB,KAAK,IAAI,CAAC3C,UAAU,CAAC,CAAC,CAACpB,iBAAiB,CAAC,CAAC,EAAE;UAC/D;UACAgE,QAAQ,GAAG;YAAEC,QAAQ,EAAEnF,YAAY,CAACmE,EAAE;YAAEiB,aAAa,EAAE;UAAK,CAAC;QAC9D,CAAC,MAAM,IAAIjD,QAAQ,CAACE,YAAY,CAAC,cAAc,CAAC,KAAKrC,YAAY,CAACmE,EAAE,EAAE;UACrE;UACAe,QAAQ,GAAG;YAAEC,QAAQ,EAAEnF,YAAY,CAACmE,EAAE;YAAEiB,aAAa,EAAEH;UAAiB,CAAC;QAC1E,CAAC,MAAM;UACN;UACA,IAAII,aAA6B;UACjC,IAAIC,YAA4B;UAChC,IAAInD,QAAQ,CAACE,YAAY,CAAC,cAAc,CAAC,KAAK,OAAO,EAAE;YACtDgD,aAAa,GAAGJ,gBAAgB;YAChCK,YAAY,GAAG,IAAI,CAACC,eAAe,CAACN,gBAAgB,CAAC;UACtD,CAAC,MAAM;YACNI,aAAa,GAAG,IAAI,CAACG,gBAAgB,CAACP,gBAAgB,CAAC;YACvDK,YAAY,GAAGL,gBAAgB;UAChC;UACAC,QAAQ,GAAG;YAAEC,QAAQ,EAAEnF,YAAY,CAACoE,OAAO;YAAEkB,YAAY;YAAED;UAAc,CAAC;QAC3E;QAEA,MAAMI,OAAO,CAACC,GAAG,CAAC,CACjB,IAAI,CAACC,WAAW,CAACxD,QAAQ,CAACE,YAAY,CAAC,YAAY,CAAC,EAAE6C,QAAQ,CAAC,EAC/D,IAAI,CAACU,4CAA4C,CAAC,CAAC,CACnD,CAAC;MACH,CAAC,CAAC,OAAOtE,KAAK,EAAE;QACfE,YAAY,CAACC,IAAI,CAAC,IAAI,CAACoE,iBAAiB,CAAC,oBAAoB,EAAE,CAAEvE,KAAK,CAAWwE,OAAO,IAAI,EAAE,CAAC,CAAC,CAAC;MAClG,CAAC,SAAS;QACTf,UAAU,CAACgB,MAAM,CAAC,IAAI,CAACzD,UAAU,CAAC,CAAC,CAAC;MACrC;IACD;;IAEA;AACD;AACA;AACA;AACA;AACA,OALC;IAAAnC,MAAA,CAMM6F,qBAAqB,GAA3B,eAAMA,qBAAqBA,CAAqCC,SAAmB,EAAEC,MAAe,EAAiB;MACpH,MAAM/E,gBAAgB,GAAG,IAAI,CAACC,mBAAmB,CAAC,CAAC;MACnD,IAAI8E,MAAM,EAAE;QACX,MAAMC,YAAY,GAAGhF,gBAAgB,CAACiF,GAAG,CAAC,MAAOC,aAAsB,IAAK;UAC3E;UACA,IAAIA,aAAa,CAACC,UAAU,CAAC,CAAC,KAAK1F,SAAS,EAAE;YAC7C;YACA;YACA;YACA,IAAIyF,aAAa,CAACC,UAAU,CAAC,CAAC,KAAK,IAAI,EAAE;cACxC,MAAMD,aAAa,CAACE,QAAQ,CAAC,CAAC;YAC/B;YACA,OAAOF,aAAa,CAACH,MAAM,CAACM,MAAM,CAACC,gBAAgB,CAAC;UACrD;QACD,CAAC,CAAC;QACF,MAAMhB,OAAO,CAACC,GAAG,CAACS,YAAY,CAAC;MAChC,CAAC,MAAM;QACN,MAAMV,OAAO,CAACC,GAAG,CAChBvE,gBAAgB,CAACiF,GAAG,CAAC,MAAOC,aAAsB,IAAK;UACtD,IAAIA,aAAa,CAACC,UAAU,CAAC,CAAC,KAAK,IAAI,EAAE;YACxC,OAAOD,aAAa,CAACE,QAAQ,CAAC,IAAI,CAAC;UACpC;QACD,CAAC,CACF,CAAC;MACF;IACD;;IAEA;AACD;AACA;AACA;AACA;AACA,OALC;IAAApG,MAAA,CAMMuG,aAAa,GAAnB,eAAMA,aAAaA,CAAqCT,SAAmB,EAAEU,MAAe,EAAyC;MAAA,IAAvClG,cAAc,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,KAAK;MACnH,MAAMS,gBAAgB,GAAG,IAAI,CAACC,mBAAmB,CAAC,CAAC;MACnD,IAAID,gBAAgB,CAACR,MAAM,KAAK,CAAC,EAAE;QAClC;MACD;;MAEA;MACA,MAAMiG,YAAY,GAAGzF,gBAAgB,CAAC,CAAC,CAAC;MACxC,MAAMiE,aAAa,GAAG,MAAMwB,YAAY,CAACC,aAAa,CAAC,CAAC;MACxD,IAAIC,YAAY,GAAG,KAAK;MACxB,IAAIC,WAAW,GAAG,IAAI;MACtB,IAAIJ,MAAM,EAAE;QACX,MAAMK,eAAe,GAAG,MAAMJ,YAAY,CAACK,cAAc,CAAC,CAAC,CAAC,CAAC;QAC7D,IAAID,eAAe,EAAE;UACpBD,WAAW,GAAGH,YAAY,CAACM,IAAI,CAAC;YAAEC,WAAW,EAAEH,eAAe;YAAEI,MAAM,EAAEhC;UAAc,CAAC,CAAC;UACxF0B,YAAY,GAAG,IAAI;QACpB;MACD,CAAC,MAAM;QACN,MAAMK,WAAW,GAAG,MAAMP,YAAY,CAACK,cAAc,CAAC,CAAC,CAAC;QACxD,IAAIE,WAAW,EAAE;UAChBJ,WAAW,GAAGI,WAAW,CAACD,IAAI,CAAC;YAAEC,WAAW,EAAEP,YAAY;YAAEQ,MAAM,EAAEhC;UAAc,CAAC,CAAC;UACpF0B,YAAY,GAAG,IAAI;QACpB;MACD;MAEA,MAAMrB,OAAO,CAACC,GAAG,CAAC,CAACqB,WAAW,EAAE,IAAI,CAACnB,4CAA4C,CAAC,CAAC,CAAC,CAAC;;MAErF;MACA,MAAMyB,QAAQ,GAAGT,YAAY,CAAC/C,QAAQ,CAAC,CAAC;MACxC,IAAIiD,YAAY,IAAIO,QAAQ,KAAKzG,SAAS,IAAIyG,QAAQ,IAAI,CAAC,EAAE;QAC5D,MAAMC,QAAQ,GAAG,IAAI,CAAChF,UAAU,CAAC,CAAC;QAClC,IAAI,CAAC7B,cAAc,EAAE;UACpB6G,QAAQ,CAACC,aAAa,CAACF,QAAQ,CAAC;QACjC,CAAC,MAAM;UACNC,QAAQ,CAACE,QAAQ,CAACH,QAAQ,CAAC;QAC5B;MACD;IACD;;IAEA;AACD;AACA;AACA,OAHC;IAAAlH,MAAA,CAIMyF,4CAA4C,GAAlD,eAAMA,4CAA4CA,CAAA,EAAoD;MACrG,MAAM6B,UAAU,GAAG,IAAI,CAACnF,UAAU,CAAC,CAAC,CAACoF,IAAI,CAAC,UAAU,CAAC;MACrD,MAAMC,YAAY,GAAG,IAAI,CAACrF,UAAU,CAAC,CAAC,CAACpB,iBAAiB,CAAC,CAAY;MACrE,MAAM0G,KAAK,GAAGD,YAAY,CAACE,QAAQ,CAAC,CAAC;QACpCC,SAAS,GAAGF,KAAK,CAACG,YAAY,CAAC,CAAC;MAEjC,MAAMC,YAAY,GAAGF,SAAS,CAACG,UAAU,CAACR,UAAU,CAAC;MACrD,MAAMS,uBAAuB,GAAGC,kBAAkB,CAACD,uBAAuB,CAACF,YAAY,CAAmC;MAC1H,MAAMI,UAAU,GAAIF,uBAAuB,CAAwBG,UAAU,IAAKH,uBAAuB,CAAeE,UAAU;MAClI,MAAME,UAAU,GAAGF,UAAU,CAACG,WAAW,CAACC,SAAS,GAClD,6BAA6B,IAAI,CAACzF,kBAAkB,CAAC,CAAC,CAACE,OAAO,CAACwF,kBAAkB,IAAI,EAAE,EAAE,CACzF,EAAEC,uBAA6C;MAEhD,IAAIJ,UAAU,EAAE;QACf,MAAMK,YAAY,GAAGC,WAAW,CAACC,eAAe,CAAC,IAAI,CAACvG,UAAU,CAAC,CAAC,CAAC;QACnE,MAAMwG,kBAAkB,GAAGH,YAAY,CAACI,qBAAqB,CAAC,CAAC;QAC/D,MAAMC,WAAW,GAAGF,kBAAkB,CAACG,yBAAyB,CAACX,UAAU,EAAEX,YAAY,CAAC;QAC1F,IAAIqB,WAAW,EAAE;UAChB,MAAMF,kBAAkB,CAACI,gCAAgC,CAACF,WAAW,EAAErB,YAAY,CAAC;QACrF;MACD;IACD;;IAEA;AACD;AACA;AACA;AACA;AACA;AACA,OANC;IAAAxH,MAAA,CAOQqD,iBAAiB,GAAzB,SAAQA,iBAAiBA,CACxBL,cAAmF,EACnFyD,YAAqB,EACrBxB,aAA6B,EACnB;MACV,IAAI,CAACjC,cAAc,EAAE;QACpB,OAAO,IAAI;MACZ;MAEA,IAAIgG,OAAO,GAAG,IAAI;MAClB,IAAI;QACHA,OAAO,GAAGhG,cAAc,CAACyD,YAAY,EAAExB,aAAa,CAAC,KAAK,IAAI;MAC/D,CAAC,CAAC,OAAO9D,KAAK,EAAE;QACfD,GAAG,CAACC,KAAK,CAAC,4DAA4D,EAAEA,KAAe,CAAC;QACxF6H,OAAO,GAAG,IAAI;MACf;MAEA,OAAOA,OAAO;IACf;;IAEA;AACD;AACA;AACA;AACA;AACA;AACA,OANC;IAAAhJ,MAAA,CAOQ6D,2BAA2B,GAAnC,SAAQA,2BAA2BA,CAClCb,cAAqE,EACrEf,cAAuB,EACvBM,aAAsB,EACZ;MACV,IAAI0G,SAAS,GAAG,IAAI;;MAEpB;MACA,MAAM/D,aAAa,GAAG,IAAI,CAACG,gBAAgB,CAAC9C,aAAa,CAAC;MAC1D,MAAM2G,YAAY,GAAGhE,aAAa,KAAK,IAAI,GAAG,IAAI,GAAGA,aAAa,CAACtE,SAAS,CAAC,CAAC;MAC9E,MAAMuI,YAAY,GAAG,IAAI,CAACC,wBAAwB,CAAClE,aAAa,EAAEgE,YAAY,EAAE3G,aAAa,EAAEA,aAAa,CAAC3B,SAAS,CAAC,CAAC,CAAC;;MAEzH;MACA,MAAMuE,YAAY,GAAG,IAAI,CAACC,eAAe,CAAC7C,aAAa,CAAC;MACxD,MAAM8G,WAAW,GAAGlE,YAAY,KAAK,IAAI,GAAG,IAAI,GAAGA,YAAY,CAACvE,SAAS,CAAC,CAAC;MAC3E,MAAM0I,WAAW,GAAG,IAAI,CAACF,wBAAwB,CAAC7G,aAAa,EAAEA,aAAa,CAAC3B,SAAS,CAAC,CAAC,EAAEuE,YAAY,EAAEkE,WAAW,CAAC;;MAEtH;MACA,IAAIF,YAAY,KAAK1I,SAAS,IAAI6I,WAAW,KAAK7I,SAAS,EAAE;QAC5D,IAAI0I,YAAY,CAAClC,MAAM,KAAKqC,WAAW,CAACrC,MAAM,EAAE;UAC/C;UACAgC,SAAS,GAAG,IAAI,CAAC5F,iBAAiB,CAACL,cAAc,EAAEf,cAAc,EAAEkH,YAAY,CAAClC,MAAM,CAAC;QACxF,CAAC,MAAM;UACN;UACAgC,SAAS,GACR,IAAI,CAAC5F,iBAAiB,CAACL,cAAc,EAAEf,cAAc,EAAEkH,YAAY,CAAClC,MAAM,CAAC,IAC3E,IAAI,CAAC5D,iBAAiB,CAACL,cAAc,EAAEf,cAAc,EAAEqH,WAAW,CAACrC,MAAM,CAAC;QAC5E;MACD;MAEA,OAAOgC,SAAS;IACjB;;IAEA;AACD;AACA;AACA;AACA,OAJC;IAAAjJ,MAAA,CAKQqF,gBAAgB,GAAxB,SAAQA,gBAAgBA,CAACjB,OAAgB,EAAkB;MAC1D,MAAMmF,YAAY,GAAGnF,OAAO,CAACV,QAAQ,CAAC,CAAC;MACvC,IAAI6F,YAAY,KAAK9I,SAAS,EAAE;QAC/B,MAAM,IAAI+I,KAAK,CAAC,kBAAkB,CAAC;MACpC;MAEA,MAAMC,WAAW,GAAGrF,OAAO,CAAC/B,UAAU,CAAC,CAAqB;MAC5D,OAAOkH,YAAY,KAAK,CAAC,GACtB,IAAI,GACJE,WAAW,CAACC,qBAAqB,CAAC,CAAC,CAACC,IAAI,CAAEC,GAAG,IAAK;QAClD,OAAOA,GAAG,CAAClG,QAAQ,CAAC,CAAC,KAAK6F,YAAY,GAAG,CAAC;MAC1C,CAAC,CAAC,IAAI,IAAI;IACd;;IAEA;AACD;AACA;AACA;AACA,OAJC;IAAAvJ,MAAA,CAKQoF,eAAe,GAAvB,SAAQA,eAAeA,CAAChB,OAAgB,EAAkB;MACzD,MAAMmF,YAAY,GAAGnF,OAAO,CAACV,QAAQ,CAAC,CAAC;MACvC,IAAI6F,YAAY,KAAK9I,SAAS,EAAE;QAC/B,MAAM,IAAI+I,KAAK,CAAC,kBAAkB,CAAC;MACpC;MAEA,MAAMC,WAAW,GAAGrF,OAAO,CAAC/B,UAAU,CAAC,CAAqB;MAC5D,OACCoH,WAAW,CAACC,qBAAqB,CAAC,CAAC,CAACC,IAAI,CAAEC,GAAG,IAAK;QACjD,OAAOA,GAAG,CAAClG,QAAQ,CAAC,CAAC,KAAK6F,YAAY,GAAG,CAAC;MAC3C,CAAC,CAAC,IAAI,IAAI;IAEZ;;IAEA;AACD;AACA;AACA;AACA;AACA;AACA;AACA,OAPC;IAAAvJ,MAAA,CAQQoJ,wBAAwB,GAAhC,SAAQA,wBAAwBA,CAC/BlE,aAA6B,EAC7BgE,YAAwC,EACxC/D,YAA4B,EAC5BkE,WAAuC,EACgC;MACvE,IAAInE,aAAa,KAAK,IAAI,EAAE;QAC3B;QACA,OAAO;UAAE+B,MAAM,EAAE,IAAI;UAAED,WAAW,EAAE7B;QAAa,CAAC;MACnD,CAAC,MAAM,IAAIA,YAAY,KAAK,IAAI,EAAE;QACjC;QACA,OAAO+D,YAAY,KAAKzI,SAAS,GAAG;UAAEwG,MAAM,EAAEiC,YAAY;UAAElC,WAAW,EAAE;QAAK,CAAC,GAAGvG,SAAS;MAC5F,CAAC,MAAM,IAAI4I,WAAW,KAAKnE,aAAa,EAAE;QACzC;QACA,OAAO;UAAE+B,MAAM,EAAE/B,aAAa;UAAE8B,WAAW,EAAE7B;QAAa,CAAC;MAC5D,CAAC,MAAM,IAAI+D,YAAY,KAAKzI,SAAS,IAAI4I,WAAW,KAAK5I,SAAS,EAAE;QACnE;QACA,OAAOA,SAAS;MACjB,CAAC,MAAM,IAAIyI,YAAY,KAAKG,WAAW,EAAE;QACxC;QACA,OAAO;UAAEpC,MAAM,EAAEiC,YAAY;UAAElC,WAAW,EAAE7B;QAAa,CAAC;MAC3D,CAAC,MAAM;QACN;QACA;QACA;QACA;QACA;QACA,OAAO;UAAE8B,MAAM,EAAEiC,YAAY;UAAElC,WAAW,EAAE;QAAK,CAAC;MACnD;IACD;;IAEA;AACD;AACA;AACA;AACA;AACA,OALC;IAAAhH,MAAA,CAMcwF,WAAW,GAAzB,eAAcA,WAAWA,CAAqCpB,OAAgB,EAAEyF,IAAqB,EAAiB;MACrH,MAAMhH,iBAAiB,GAAG,IAAI,CAACD,kBAAkB,CAAC,CAAC,CAACE,OAAO,CAACC,uBAAuB;MACnF,MAAMC,cAAc,GAAGH,iBAAiB,GACrCI,SAAS,CAACC,iBAAiB,CAC3BL,iBAAiB,CAACM,UAAU,EAC5BN,iBAAiB,CAACO,UAAU,EAC5B,IAAI,CAACjB,UAAU,CAAC,CAChB,CAAC,GACD1B,SAAS;MACZ,MAAMqJ,oBAAoB,GAAG,IAAI,CAAC3H,UAAU,CAAC,CAAC,CAACpB,iBAAiB,CAAC,UAAU,CAAyB;MACpG,MAAMgJ,aAAa,GAAGD,oBAAoB,CAACpI,WAAW,CAAC,UAAU,CAAC,KAAK,IAAI;MAE3E,MAAMsI,WAAW,GAAG,MAAAA,CAAO/C,MAAsB,EAAED,WAA4B,KAAoB;QAClG;QACA;QACA,IAAI,IAAI,CAAC3D,iBAAiB,CAACL,cAAc,EAAEoB,OAAO,EAAE6C,MAAM,CAAC,EAAE;UAC5D;UACA,OAAO7C,OAAO,CAAC2C,IAAI,CAAC;YAAEE,MAAM;YAAED,WAAW,EAAE+C,aAAa,GAAGtJ,SAAS,GAAGuG;UAAY,CAAC,CAAC;QACtF,CAAC,MAAM;UACN3F,YAAY,CAACC,IAAI,CAAC,IAAI,CAACoE,iBAAiB,CAAC,0BAA0B,CAAC,CAAC;QACtE;MACD,CAAC;MAED,IAAImE,IAAI,CAAC7E,QAAQ,KAAKnF,YAAY,CAACmE,EAAE,EAAE;QACtC;QACA,OAAOgG,WAAW,CAACH,IAAI,CAAC5E,aAAa,CAAC;MACvC,CAAC,MAAM;QACN;QACA,MAAM,CAACiE,YAAY,EAAEG,WAAW,CAAC,GAAG,MAAM/D,OAAO,CAACC,GAAG,CAAC,CACrDsE,IAAI,CAAC3E,aAAa,EAAEwB,aAAa,CAAC,CAAC,IAAI,IAAI,EAC3CmD,IAAI,CAAC1E,YAAY,EAAEuB,aAAa,CAAC,CAAC,IAAI,IAAI,CAC1C,CAAC;QACF,MAAMuD,MAAM,GAAG,IAAI,CAACb,wBAAwB,CAACS,IAAI,CAAC3E,aAAa,EAAEgE,YAAY,EAAEW,IAAI,CAAC1E,YAAY,EAAEkE,WAAW,CAAE;QAC/G,OAAOW,WAAW,CAACC,MAAM,CAAChD,MAAM,EAAEgD,MAAM,CAACjD,WAAW,CAAC;MACtD;IACD,CAAC;IAAA,OAAAlH,cAAA;EAAA;EAAAC,QAAA,GAAAD,cAAA;EAAA,OAAAC,QAAA;AAAA","ignoreList":[],"file":"TableHierarchy-dbg.js"}
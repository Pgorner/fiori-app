/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2024 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/macros/CommonHelper","sap/fe/macros/DelegateUtil","sap/ui/model/ListBinding","sap/ui/model/json/JSONModel"],function(e,t,o,a){"use strict";const n={createLayout:async function(o){const n=o.modifier,i=o.appComponent?.getMetaModel(),r=o.element;let s=await t.getCustomDataWithModifier(r,"entitySet",n);if(!s){s=await t.getCustomDataWithModifier(r,"navigationPath",n)}const c=s.startsWith("/")?`${s}`:`/${s}`;const l=o.parentSelector?o.modifier.bySelector(o.parentSelector,o.appComponent,o.view):undefined;const d=l?await t.getCustomDataWithModifier(l,"navigationPath",n):"";const m=d?`${c}/${d}`:c;const p=i?.getMetaContext(m);const u=i?.createBindingContext(`${m}/${o.bindingPath}`);const f=o.element?.getId()||o.element?.id;const g={sPropertyName:o.bindingPath,sBindingPath:m,sValueHelpType:"FormVH",oControl:r,metaPath:u?.getPath(),oMetaModel:i,oModifier:n};async function h(e){const r=new a({id:f,idPrefix:o.fieldSelector?.id}),s={bindingContexts:{entitySet:p,contextPath:p,property:u,this:r.createBindingContext("/")},models:{this:r,entitySet:i,contextPath:i,metaModel:i,property:i}};return t.templateControlFragment(e,s,{},n)}async function v(s,c,l){const d=await t.getCustomDataWithModifier(r,"onChange",n);const m=await t.getCustomDataWithModifier(r,"displayMode",n);const f=new a({_flexId:o.fieldSelector?.id,onChange:e.removeEscapeCharacters(d),displayMode:e.removeEscapeCharacters(m),navigationPath:l});const g={bindingContexts:{entitySet:p,dataField:u,this:f.createBindingContext("/")},models:{this:f,entitySet:i,metaModel:i,dataField:i},appComponent:o.appComponent};return t.templateControlFragment(s,g,{view:c},n)}const y=await t.isValueHelpRequired(g);const C=await t.doesValueHelpExist(g);let P;if(y&&!C){P=await h("sap.fe.macros.form.ValueHelpWrapper")}const b=await v("sap.fe.macros.form.FormElementFlexibility",o.view,d);return{control:b,valueHelp:P}},getPropertyInfo:async function(e){function t(e){if(e&&e.$Type){if(e.$Type.toLowerCase().indexOf("edm")!==0){return true}}return false}function a(e,t){return t.some(function(t){return e.startsWith(t)})}function n(e,n,i,r,s,c,l){const d={name:e,bindingPath:e,entityType:r};const m=i["@com.sap.vocabularies.UI.v1.DataFieldDefault"];const p=m&&m.Label||i["@com.sap.vocabularies.Common.v1.Label"];d.label=p||"[LABEL_MISSING: "+e+"]";const u=i["@com.sap.vocabularies.UI.v1.Hidden"];d.hideFromReveal=u;if(u&&u.$Path){d.hideFromReveal=s.getBindingContext()?.getProperty(u.$Path)}if(!d.hideFromReveal){d.hideFromReveal=i["@com.sap.vocabularies.UI.v1.AdaptationHidden"]}let f;if(!d.hideFromReveal){f=i["@com.sap.vocabularies.Common.v1.FieldControl"];if(f){d.hideFromReveal=f.$EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Hidden"}}f=i["@com.sap.vocabularies.Common.v1.FieldControl"];const g=f&&f.$Path;if(g&&!d.hideFromReveal){const e=s.getBinding(c)instanceof o;if(!e){const e=s.getBindingContext()?.getProperty(g);d.hideFromReveal=e===0}}if(m&&(m.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"||m.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"||m.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithAction"||m.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation")){d.unsupported=true}if(a(e,l)||t(n)){d.unsupported=true}return d}function i(e,t,o,a,i){const r=[];let s="";const c=[];let l;for(s in e){l=e[s];if(l.$kind==="NavigationProperty"){c.push(s)}}for(s in e){l=e[s];if(l.$kind==="Property"){const e=o.getObject("/"+t+"/"+s+"@");const d=n(s,l,e,t,a,i,c);r.push(d)}}return r}function r(e,t){if(t.path){return t.path}const o=e.getBindingContext();if(o){if(e.data("navigationPath")){return o.getPath()+"/"+e.data("navigationPath")}return o.getPath()}}async function s(e,t,o){const a=e.getModel(o.modelName);if(a){if(a.isA("sap.ui.model.odata.v4.ODataModel")){const n=a.getMetaModel();const s=r(e,o);if(s){const o=n.getMetaContext(s);const a=o.getObject();const r=o.getObject(a.$Type);return i(r,a.$Type,n,e,t)}}}return Promise.resolve([])}return Promise.resolve().then(async function(){return s(e.element,e.aggregationName,e.payload)})}};return n},false);
//# sourceMappingURL=FormDelegate.js.map
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2024 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/base/BindingToolkit","sap/fe/core/formatters/ValueFormatter","sap/fe/core/helpers/TypeGuards","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/PropertyHelper","sap/fe/core/templating/UIFormatters","sap/ui/core/Lib","sap/ui/model/odata/v4/AnnotationHelper"],function(e,t,n,r,a,o,s,i){"use strict";var c={};var u=o.getDisplayMode;var l=o.getBindingWithUnitOrCurrency;var g=o.getBindingWithTimezone;var f=o.getBindingForTimezone;var m=o.getBindingForDateFormat;var p=a.hasStaticPercentUnit;var d=r.getRelativePaths;var O=r.enhanceDataModelPath;var T=n.isProperty;var I=e.unresolvableExpression;var b=e.pathInModel;var _=e.isPathInModelExpression;var E=e.getExpressionFromAnnotation;var D=e.formatWithTypeInformation;var v=e.formatResult;var P=e.compileExpression;var y=e.EDM_TYPE_MAPPING;const A=["Edm.Single","Edm.Double","Edm.Decimal"];const M=(e,t)=>e?.TargetValue?E(e.TargetValue,t):I;const N=s.getResourceBundleFor("sap.fe.macros");const h=e=>{const n=e?.targetObject?.Value||"";const r=d(e);const a=E(n,r);const o=M(e.targetObject,r);if(a&&o){let s=e.targetObject?.Value;if(!T(s)){s=s.$target}const i=s.annotations?.Measures?.Unit||s.annotations?.Measures?.ISOCurrency;if(!i){return N.getText("T_COMMON_PROGRESS_INDICATOR_DISPLAY_VALUE_NO_UOM",[P(a),P(o)])}if(p(n?.$target)){return`${P(a)} %`}const c=i.$target?D(i.$target,E(i,r)):E(i,r);const u=s.annotations?.Measures?.ISOCurrency?true:false;let l;if(u){l=b("/##@@requestCurrencyCodes")}else{l=b("/##@@requestUnitsOfMeasure")}l.targetType="any";l.mode="OneTime";return P(v([a,o,c,u,l],t.formatProgressIndicatorText))}return undefined};c.buildExpressionForProgressIndicatorDisplayValue=h;const x=(e,t)=>{if(t){return C(i.value(t,{context:e}))}};const C=e=>{if(e){const t=e>1?N.getText("T_ANNOTATION_HELPER_RATING_INDICATOR_SUBTITLE_LABEL_PLURAL"):N.getText("T_ANNOTATION_HELPER_RATING_INDICATOR_SUBTITLE_LABEL");return N.getText("T_ANNOTATION_HELPER_RATING_INDICATOR_SUBTITLE",[String(e),t])}};const S=(e,t)=>{let n;if(t&&t.SampleSize){n=x(e,t.SampleSize)}else if(t&&t.Description){const r=i.value(t.Description,{context:e});n="${path:"+r+"}"}return n};S.requiresIContext=true;c.getHeaderRatingIndicatorText=S;const j=e=>{const t=d(e);if(e?.targetObject?.annotations?.Common?.Text){const n=E(e?.targetObject.annotations?.Common?.Text,t);if(_(n)){n.parameters={$$noPatch:true}}return n}return undefined};const F=(e,t)=>{if(t){if(!e.formatOptions){e.formatOptions={}}e.formatOptions=Object.assign(e.formatOptions,{preserveDecimals:false,maxFractionDigits:t})}return e};const R=(e,t,n,r)=>{let a;const o=!t?.path?.includes("/")?d(e):[];a=E(t,o);const s=e?.targetObject;if(s&&n&&_(a)){D(s,a);a.type=y[n]?.type;if(A.includes(n)){a=F(a,r)}}return a};c.getValueFormatted=R;const V=(e,n,r)=>{const a=e.targetObject;const o=a?.Value||"";const s=o?.$target?.type;let i;if(A.includes(s)&&a?.ValueFormat){if(a.ValueFormat.NumberOfFractionalDigits){i=a.ValueFormat.NumberOfFractionalDigits}}const c=O(e,o.path);const l=c?j(c):undefined;const p=R(c,o,s,i);const d=l?n?.displayMode||u(c):"Value";let T;switch(d){case"Description":T=l;break;case"ValueDescription":T=v([p,l],t.formatWithBrackets);break;case"DescriptionValue":T=v([l,p],t.formatWithBrackets);break;default:if(c.targetObject?.annotations?.Common?.Timezone&&c.targetObject.type==="Edm.DateTimeOffset"){T=g(c,p)}else if(c.targetObject?.annotations?.Common?.IsTimezone){T=f(c,p)}else if(c.targetObject?.annotations?.UI?.DateTimeStyle||n?.dateTimePattern){T=m(c,p,n)}else{T=B(c,p,r||n?.measureDisplayMode==="Hidden")}}return P(T)};c.buildFieldBindingExpression=V;const B=(e,t,n)=>{if(e.targetObject?.annotations?.Measures?.Unit||e.targetObject?.annotations?.Measures?.ISOCurrency){if(n&&p(e.targetObject)){return t}return l(e,t,undefined,n?{showMeasure:false}:undefined)}return t};c._computeBindingWithUnitOrCurrency=B;const L=e=>{const n=e?.targetObject?.Value||"";const r=d(e);const a=E(n,r);const o=M(e.targetObject,r);const s=n.$target;const i=s.annotations?.Measures?.Unit||s.annotations?.Measures?.ISOCurrency;if(i){const e=E(i,r);return P(v([a,o,e],t.computePercentage))}return P(v([a,o,""],t.computePercentage))};c.buildExpressionForProgressIndicatorPercentValue=L;return c},false);
//# sourceMappingURL=DataPointTemplating.js.map
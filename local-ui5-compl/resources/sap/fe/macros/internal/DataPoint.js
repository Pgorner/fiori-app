/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2024 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/base/BindingToolkit","sap/fe/base/ClassSupport","sap/fe/core/buildingBlocks/BuildingBlock","sap/fe/core/helpers/StableIdHelper","sap/fe/core/helpers/TypeGuards","sap/fe/core/templating/CriticalityFormatters","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/PropertyHelper","sap/fe/core/templating/SemanticObjectHelper","sap/fe/core/templating/UIFormatters","sap/fe/macros/controls/ConditionalWrapper","sap/fe/macros/field/FieldTemplating","sap/fe/macros/internal/helpers/DataPointTemplating","sap/fe/macros/quickView/QuickView","sap/m/ObjectNumber","sap/m/ObjectStatus","sap/m/ProgressIndicator","sap/m/RatingIndicator","../field/FieldRuntimeHelper","./DataPointFormatOptions","sap/fe/base/jsx-runtime/jsx"],function(t,e,i,a,r,n,s,o,l,u,c,d,h,p,f,b,g,m,O,P,v,y){"use strict";var j,V,x,M,z,D,I,F,w,T,S,N,E;var k={};var B=p.getValueFormatted;var C=p.buildFieldBindingExpression;var A=p.buildExpressionForProgressIndicatorPercentValue;var L=p.buildExpressionForProgressIndicatorDisplayValue;var Q=h.isUsedInNavigationWithQuickViewFacets;var R=h.getVisibleExpression;var U=u.getPropertyWithSemanticObject;var W=l.hasUnit;var H=l.hasCurrency;var _=o.getRelativePaths;var q=o.enhanceDataModelPath;var G=s.buildExpressionForCriticalityIcon;var $=s.buildExpressionForCriticalityColor;var J=n.isProperty;var K=r.generate;var X=i.property;var Y=i.defineUI5Class;var Z=i.association;var tt=i.aggregation;var et=e.getExpressionFromAnnotation;var it=e.compileExpression;function at(t,e,i,a){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(a):void 0})}function rt(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,nt(t,e)}function nt(t,e){return nt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},nt(t,e)}function st(t,e,i,a,r){var n={};return Object.keys(a).forEach(function(t){n[t]=a[t]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce(function(i,a){return a(t,e,i)||i},n),r&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(r):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(t,e,n),null):n}function ot(t,e){throw Error("Decorating class property failed. Please ensure that transform-class-properties is enabled and runs after the decorators transform.")}let lt=(j=Y("sap.fe.macros.internal.DataPoint"),V=Z({type:"string"}),x=X({type:"string",required:true}),M=X({type:"string"}),z=tt({type:"sap.fe.macros.internal.DataPointFormatOptions",multiple:false,defaultClass:v}),D=X({type:"string"}),j(I=(F=function(e){function i(t,i){var a;a=e.call(this,t,i)||this;at(a,"idPrefix",w,a);at(a,"metaPath",T,a);at(a,"contextPath",S,a);at(a,"formatOptions",N,a);at(a,"value",E,a);a.hasQuickView=false;return a}k=i;rt(i,e);var a=i.prototype;a.onMetadataAvailable=function t(){this.getTemplatingObjects();this.content=this.createContent()};a.getTemplatingObjects=function t(){const e=this.getDataModelObjectForMetaPath(this.metaPath,this.contextPath);if(!e){return}let i;this.visible=R(e);if(e?.targetObject?.Value?.path){i=q(e,e.targetObject.Value.path)}this.dataModelPath=e;this.valueDataModelPath=i};a.getDataPointVisualization=function t(e){if(e.targetObject?.Visualization==="UI.VisualizationType/Rating"){this.visualization="Rating";return}if(e.targetObject?.Visualization==="UI.VisualizationType/Progress"){this.visualization="Progress";return}const i=this.valueDataModelPath&&this.valueDataModelPath.targetObject;this.hasQuickView=(i&&Q(e,i))??false;if(this.valueDataModelPath&&U(this.valueDataModelPath)){this.hasQuickView=true}if(this.hasQuickView!==true){if(J(i)&&(W(i)||H(i))){this.visualization="ObjectNumber";return}}this.visualization="ObjectStatus"};a.getEnabled=function t(){if(this.content?.isA("sap.m.ObjectStatus")){return this.content.getActive()}else{return true}};a.setEnabled=function t(e){if(this.content?.isA("sap.m.ObjectStatus")){this.content.setProperty("active",e)}else{throw"setEnabled isn't implemented for this field type"}return this};a.createRatingIndicator=function t(e){const i=e.targetObject;const a=this.getTargetValueBinding(e);const r=i?.Value||"";const n=r?.$target?.type;let s;if(n==="Edm.Decimal"&&i?.ValueFormat){if(i.ValueFormat.NumberOfFractionalDigits){s=i.ValueFormat.NumberOfFractionalDigits}}const o=B(this.valueDataModelPath,r,n,s);return y(O,{id:this.idPrefix?K([this.idPrefix,"RatingIndicator-Field-display"]):undefined,maxValue:a,value:this.value??it(o),tooltip:this.getTooltipValue(e),iconSize:this.formatOptions?.iconSize,class:this.formatOptions?.showLabels??false?"sapUiTinyMarginTopBottom":undefined,editable:"false",ariaLabelledBy:this.ariaLabelledBy})};a.createProgressIndicator=function t(e){const i=e.targetObject?$(e.targetObject,e):undefined;const a=L(e);const r=A(e);return y(m,{id:this.idPrefix?K([this.idPrefix,"ProgressIndicator-Field-display"]):undefined,displayValue:a,percentValue:r,state:i,tooltip:this.getTooltipValue(e),ariaLabelledBy:this.ariaLabelledBy})};a.createObjectNumber=function t(e){const i=e.targetObject?$(e.targetObject,e):undefined;const a=this.formatOptions?.showEmptyIndicator??false?"On":undefined;const r=C(e,this.formatOptions,true);const n=this.formatOptions?.measureDisplayMode==="Hidden"?undefined:it(c.getBindingForUnitOrCurrency(this.valueDataModelPath));return y(b,{id:this.idPrefix?K([this.idPrefix,"ObjectNumber-Field-display"]):undefined,state:i,number:this.value??r,unit:n,visible:this.visible,emphasized:"false",class:this.formatOptions?.dataPointStyle==="large"?"sapMObjectNumberLarge":undefined,tooltip:this.getTooltipValue(e),emptyIndicatorMode:a})};a.createObjectNumberWithEventualWrapper=function t(e){if(this?.formatOptions?.isAnalytics??false){return y(d,{condition:c.hasValidAnalyticalCurrencyOrUnit(this.valueDataModelPath),children:{contentTrue:this.createObjectNumber(e),contentFalse:y(b,{id:this.idPrefix?K([this.idPrefix,"ObjectNumber-Field-display-differentUnit"]):undefined,number:"*",visible:this.visible,emphasized:"false",class:this.formatOptions?.dataPointStyle==="large"?"sapMObjectNumberLarge":undefined,ariaLabelledBy:this.ariaLabelledBy})}})}else{return this.createObjectNumber(e)}};a.createDependents=function t(){if(this.hasQuickView){return new f(this.valueDataModelPath,this.metaPath,this.contextPath??"").createContent(true)}return undefined};a.createObjectStatus=function t(e){let i=e.targetObject?$(e.targetObject,e):undefined;if(i==="None"&&this.valueDataModelPath){i=this.hasQuickView?"Information":"None"}const a=this.formatOptions?.showEmptyIndicator??false?"On":undefined;const r=C(e,this.formatOptions,false);const n=this.formatOptions?.dataPointStyle==="large"||!e.targetObject?undefined:G(e.targetObject,e);return y(g,{id:this.idPrefix?K([this.idPrefix,"ObjectStatus-Field-display"]):undefined,class:this.formatOptions?.dataPointStyle==="large"?"sapMObjectStatusLarge sapMObjectStatusLongText":undefined,icon:n,tooltip:this.getTooltipValue(e),state:i,text:this.value??r,emptyIndicatorMode:a,active:this.hasQuickView,press:P.pressLink,ariaLabelledBy:this.ariaLabelledBy,children:{dependents:this.createDependents()}})};a.getTooltipValue=function t(e){return e.targetObject?.annotations?.Common?.QuickInfo?et(e.targetObject?.annotations?.Common?.QuickInfo,_(e)):undefined};a.getTargetValueBinding=function t(e){return e.targetObject?.TargetValue?et(e.targetObject?.TargetValue,_(e)):undefined};a.createContent=function t(){if(!this.dataModelPath){return undefined}this.getDataPointVisualization(this.dataModelPath);switch(this.visualization){case"Rating":{return this.createRatingIndicator(this.dataModelPath)}case"Progress":{return this.createProgressIndicator(this.dataModelPath)}case"ObjectNumber":{return this.createObjectNumberWithEventualWrapper(this.dataModelPath)}default:{return this.createObjectStatus(this.dataModelPath)}}};a.getValue=function t(){if(this.content?.isA("sap.m.ObjectStatus")){return this.content.getText()}else if(this.content?.isA("sap.m.ObjectNumber")){return this.content.getNumber()}else if(this.content?.isA("sap.m.ProgressIndicator")){return this.content.getDisplayValue()}else if(this.content?.isA("sap.m.RatingIndicator")){return this.content.getValue().toString()}else{this.getProperty("value")}};a.setValue=function e(i){this.setProperty("value",i);if(this.content?.isA("sap.m.ObjectStatus")){this.content.setText(i)}else if(this.content?.isA("sap.m.ObjectNumber")){this.content.setNumber(i)}else if(this.content?.isA("sap.m.ProgressIndicator")){t.error("setValue isn't implemented for this field type yet")}else if(this.content?.isA("sap.m.RatingIndicator")){this.content.setValue(i)}return this};return i}(a),w=st(F.prototype,"idPrefix",[V],{configurable:true,enumerable:true,writable:true,initializer:null}),T=st(F.prototype,"metaPath",[x],{configurable:true,enumerable:true,writable:true,initializer:null}),S=st(F.prototype,"contextPath",[M],{configurable:true,enumerable:true,writable:true,initializer:null}),N=st(F.prototype,"formatOptions",[z],{configurable:true,enumerable:true,writable:true,initializer:null}),E=st(F.prototype,"value",[D],{configurable:true,enumerable:true,writable:true,initializer:null}),F))||I);k=lt;return k},false);
//# sourceMappingURL=DataPoint.js.map
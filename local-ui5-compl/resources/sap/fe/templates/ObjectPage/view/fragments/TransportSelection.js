/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2024 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/base/BindingToolkit","sap/fe/base/ClassSupport","sap/fe/base/HookSupport","sap/fe/core/buildingBlocks/BuildingBlock","sap/fe/core/helpers/BindingHelper","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/FieldControlHelper","sap/fe/core/templating/UIFormatters","sap/fe/macros/field/FieldTemplating","sap/m/Link","sap/m/MessageStrip","sap/ui/core/message/MessageType","sap/fe/base/jsx-runtime/jsx"],function(e,t,i,r,n,a,o,s,l,p,c,u,f){"use strict";var d,g,T,h,b,v,y,E;var S={};var P=l.getTextBindingExpression;var O=s.getActionEnabledExpression;var m=o.isRequiredExpression;var x=a.getRelativePaths;var R=a.enhanceDataModelPath;var _=n.UI;var j=i.controllerExtensionHandler;var C=t.property;var A=t.defineUI5Class;var N=e.pathInModel;var I=e.not;var k=e.ifElse;var w=e.concat;var B=e.and;function L(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function M(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,z(e,t)}function z(e,t){return z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},z(e,t)}function q(e,t,i,r,n){var a={};return Object.keys(r).forEach(function(e){a[e]=r[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce(function(i,r){return r(e,t,i)||i},a),n&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(n):void 0,a.initializer=void 0),void 0===a.initializer?(Object.defineProperty(e,t,a),null):a}function D(e,t){throw Error("Decorating class property failed. Please ensure that transform-class-properties is enabled and runs after the decorators transform.")}let H=(d=A("sap.fe.templates.ObjectPage.view.fragments.TransportSelection"),g=C({type:"object"}),T=C({type:"boolean"}),h=j("editFlow","onBeforeSave"),d(b=(v=function(e){function t(t,i){var r;r=e.call(this,t,i)||this;L(r,"definition",y,r);L(r,"leadingControl",E,r);return r}S=t;M(t,e);var i=t.prototype;i.onMetadataAvailable=function t(i){e.prototype.onMetadataAvailable.call(this,i);this.definition=this.definition??i.getModel("_pageModel").getObject("/transportSelection");this.content=this.createContent()};i.selectTransport=async function e(){const t=this.getBindingContext();const i=this.messageStrip.getLink().getText();return this.getPageController()?.editFlow.invokeAction(this.definition.selectTransportAction,{contexts:t,label:i})};i.getTypeExpression=function e(){const t=x(this.transportPropertyObjectPath);const i=m(this.transportPropertyObjectPath.targetObject,t);return k(B(i,I(N(this.definition.transportRequestProperty))),u.Warning,u.Information)};i.getLinkTextExpression=function e(){return k(N(this.definition.transportRequestProperty),this.getTranslatedText("T_TRANSPORT_SELECTION_CHANGE_TRANSPORT"),this.getTranslatedText("T_TRANSPORT_SELECTION_SELECT_TRANSPORT"))};i.getStripText=function e(){const t=P(this.transportPropertyObjectPath,{});const i=this.getTranslatedText("T_TRANSPORT_SELECTION_NO_TRANSPORT_SELECTED");const r=w(`${this.getTranslatedText("T_TRANSPORT_SELECTION_SELECTED_TRANSPORT")}: `,t);return k(N(this.definition.transportRequestProperty),r,i)};i.getStripVisible=function e(){return k(this.actionEnabledExpression,_.IsEditable,false)};i.createContent=function e(){const t=this.getDataModelObjectPath();const i=t?.targetEntityType.actions[this.definition.selectTransportAction];if(t&&i){this.actionEnabledExpression=O(i,t?.convertedTypes,t);this.transportPropertyObjectPath=R(t,this.definition.transportRequestProperty);this.messageStrip=f(c,{text:this.getStripText(),type:this.getTypeExpression(),showIcon:"true",customIcon:"sap-icon://shipping-status",class:"sapUiSmallMarginTop",visible:this.getStripVisible(),children:{link:f(p,{press:this.selectTransport.bind(this),text:this.getLinkTextExpression()})}});return this.messageStrip}};i.validateTransportRequestBeforeSave=async function e(){if(this.messageStrip.getVisible()&&this.messageStrip.getType()===u.Warning&&this.leadingControl){return this.selectTransport()}return Promise.resolve()};return t}(r),y=q(v.prototype,"definition",[g],{configurable:true,enumerable:true,writable:true,initializer:null}),E=q(v.prototype,"leadingControl",[T],{configurable:true,enumerable:true,writable:true,initializer:null}),q(v.prototype,"validateTransportRequestBeforeSave",[h],Object.getOwnPropertyDescriptor(v.prototype,"validateTransportRequestBeforeSave"),v.prototype),v))||b);S=H;return S},false);
//# sourceMappingURL=TransportSelection.js.map
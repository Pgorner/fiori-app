/*
 * SAPUI5
    (c) Copyright 2009-2021 SAP SE. All rights reserved
  
 */
sap.ui.define("sap/sac/df/controls/MultiDimAnalysis",["sap/ui/core/Control","sap/ui/thirdparty/jquery","sap/m/FlexItemData","sap/m/HBox","sap/m/VBox","sap/m/OverflowToolbar","sap/m/OverflowToolbarButton","sap/m/OverflowToolbarToggleButton","sap/ui/model/json/JSONModel","sap/base/Log","sap/sac/df/DesignerPanel","sap/sac/df/controls/MultiDimVizRenderer","sap/sac/df/controls/MultiDimVizSettingsPanel","sap/sac/df/model/MultiDimModel","sap/sac/df/utils/MetaPathHelper","sap/f/SidePanel","sap/f/SidePanelItem"],function(e,jQuery,t,i,s,n,o,a,r,d,l,h,u,g,_,P,f){const p=e.extend("sap.sac.df.controls.MultiDimAnalysis",{metadata:{library:"sap.sac.df",properties:{metaPath:{type:"string"},height:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},width:{type:"sap.ui.core.CSSSize",defaultValue:"100%"}}},init:function(){this._oMainLayout=new s(this.getId()+"--MainLayout",{height:"100%"});this._initHeaderToolbar();this._initSidePanel()},renderer:{apiVersion:2,render:function e(t,i){d.info("DF: Start - MultiDimAnalysis - render");t.openStart("div",i).class("sapUiZenMultiDimAnalysis").style("height",i.getHeight()).style("width",i.getWidth()).style("position","relative").openEnd();t.renderControl(i._oMainLayout);t.close("div");d.info("DF: End - MultiDimAnalysis - render")}},onAfterRendering:function(){d.info("DF: Start - MultiDimAnalysis - onAfterRendering");const t=[this._oDesignerPanel.getId(),this._oVizSettingsPanel.getId()];t.forEach(function(e){let t=jQuery("#"+e).parent()[0];if(t){t.style.height="100%"}});if(e.prototype.onAfterRendering){e.prototype.onAfterRendering.apply(this,arguments)}d.info("DF: End - MultiDimAnalysis - onAfterRendering")},exit:function(){this._oAutoRefreshButton.destroy(true);this._oRefreshButton.destroy(true);this._oHeaderToolbar.destroy(true);this._oVizRenderer.destroy(true);this._oDesignerPanel.destroy(true);this._oBuilderSidePanelItem.destroy(true);this._oVizSettingsPanel.destroy(true);this._oVizSettingsPanelItem.destroy(true);this._oStyleSidePanelItem.destroy(true);this._oSidePanel.destroy(true);this._oMainLayout.destroy(true);e.prototype.exit.apply(this,arguments)},setMetaPath:function(e){this.setProperty("metaPath",e);let t=_.getMultiDimModelName(e);if(t){this._oSidePanel.setModel(this.getModel(t),t)}this._oVizRenderer.setMetaPath(e);this._oDesignerPanel.setMetaPath(e);this._oVizSettingsPanel.setMetaPath(e);this._oAutoRefreshButton.setEnabled(!!this._getDataProviderName()).setPressed(true);this._oRefreshButton.setEnabled(false)},_initHeaderToolbar:function(){this._oHeaderToolbar=new n(this.getId()+"--OverflowToolbar");this._oAutoRefreshButton=new a(this.getId()+"--AutoRefreshBtn",{icon:"sap-icon://synchronize",tooltip:"Auto Refresh",pressed:true,enabled:!!this._getDataProvider()});this._oAutoRefreshButton.attachPress(this._onAutoRefreshToggle.bind(this));this._oHeaderToolbar.addContent(this._oAutoRefreshButton);this._oRefreshButton=new o(this.getId()+"--RefreshBtn",{icon:"sap-icon://refresh",tooltip:"Refresh Data from Back-end",enabled:!!this._getDataProvider()&&!this._oAutoRefreshButton.getPressed()});this._oRefreshButton.attachPress(this._onRefreshPress.bind(this));this._oHeaderToolbar.addContent(this._oRefreshButton);this._oMainLayout.addItem(this._oHeaderToolbar)},_initSidePanel:function(){const e={growFactor:1};this._oSidePanel=new P(this.getId()+"--SidePanel",{sidePanelResizable:true,sidePanelMinWidth:"25rem",sidePanelWidth:"35rem",sidePanelMaxWidth:"60%",layoutData:new t(e)});this._oSidePanel.attachToggle(function(){this.invalidate()}.bind(this));this._oVizRenderer=new h(this.getId()+"--VizRenderer");this._oSidePanel.addMainContent(this._oVizRenderer);this._initInnerPanels();this._oMainLayout.addItem(this._oSidePanel)},_initInnerPanels:function(){const e={growFactor:1};this._oDesignerPanel=new l(this.getId()+"--DesignerPanel");this._oDesignerPanel.setLayoutData(new t(e));this._oBuilderSidePanelItem=new f(this.getId()+"--BuilderSidePanelItem",{icon:"sap-icon://fpa/customise",text:"Builder"});this._oBuilderSidePanelItem.addContent(this._oDesignerPanel);this._oSidePanel.addItem(this._oBuilderSidePanelItem);this._oVizSettingsPanel=new u(this.getId()+"--VizSettingsPanel");this._oVizSettingsPanel.setLayoutData(new t(e));this._oVizSettingsPanelItem=new f(this.getId()+"--VizSettingsSidePanelItem",{icon:"sap-icon://provision",text:"Manage visualizations"});this._oVizSettingsPanelItem.addContent(this._oVizSettingsPanel);this._oSidePanel.addItem(this._oVizSettingsPanelItem);this._oStyleSidePanelItem=new f(this.getId()+"--FormattingSidePanelItem",{icon:"sap-icon://fpa/designer",text:"Formatting (WIP)"});this._oSidePanel.addItem(this._oStyleSidePanelItem)},_getMultiDimModel:function(){var e=_.getMultiDimModelName(this.getMetaPath());return e?this.getModel(e):null},_getDataProvider:function(){const e=this._getDataProviderName();return e&&this._getMultiDimModel()?.getDataProvider(e)},_getDataProviderName:function(){return _.getDataProviderName(this.getMetaPath())},_onAutoRefreshToggle:function(e){const t=this._getDataProvider();if(t){const t=e.getParameter("pressed");this._oRefreshButton.setEnabled(!t);this.invalidate()}else{e.preventDefault()}},_onRefreshPress:function(){this._oVizRenderer.refresh();this._oDesignerPanel.refresh();this._oVizSettingsPanel.refresh()}});return p});
//# sourceMappingURL=MultiDimAnalysis.js.map
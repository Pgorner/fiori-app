{"version":3,"file":"AppManager-dbg-dbg.js","names":["sap","ui","define","Log","Formatting","ResourceBundle","VersionInfo","BaseObject","ODataModelV2","Config","Container","___CardSkeleton","___Constants","__DataFormatUtils","__HttpHelper","_interopRequireDefault","obj","__esModule","default","_catch","body","recover","result","e","then","CardSkeleton","_iteratorSymbol","Symbol","iterator","_settle","pact","state","value","s","_Pact","v","o","bind","observer","prototype","onFulfilled","onRejected","callback","_this","_isSettledPact","thenable","_forTo","array","check","i","reject","_cycle","length","DEFAULT_BG_COLOR","_forOf","target","step","next","done","return","_fixup","TypeError","values","push","FALLBACK_ICON","FEATURE_TOGGLES","FEATURE_TOGGLE_SRVC_URL","MYHOME_PAGE_ID","MYHOME_SPACE_ID","MYINSIGHT_SECTION_ID","RECOMMENDATION_SRVC_URL","RECOMMENDED_CARD_LIMIT","DataFormatUtils","HttpHelper","CONSTANTS","MUST_INCLUDE_RECOMMEDED_APPS","_parseSBParameters","oParam","oParsedParams","JSON","parse","oError","error","Error","message","String","undefined","_getTileProperties","vizConfigFLP","oTileProperties","_instantiationData","chip","configuration","oConfig","tileConfiguration","oTileConfig","TILE_PROPERTIES","_getAppId","sAppId","semanticObject","action","semanticAction","_getTargetUrl","sTargetURL","evaluationId","_isSmartBusinessTile","oVisualization","vizType","startsWith","_getAppTitleSubTitle","oApp","oAppTileInfo","bags","sb_tileProperties","texts","title","subtitle","description","_linkDuplicateVizs","aVizs","forEach","oDuplicateViz","filter","oViz","appId","visualization","id","persConfig","sectionIndex","duplicateApps","_isGUIVisualization","parameters","_isMustIncludeRecommendation","recViz","fioriId","includes","_isVisualizationAlreadyAdded","favoriteVisualizations","some","favViz","AppManager","aRequestQueue","bInsightsSectionPresent","vizDataModified","constructor","getInstance","Instance","_fetchRequestFromQueue","bForceRefresh","Promise","resolve","getServiceAsync","oSpaceContentService","oPageLoadPromise","oRequestedPage","find","oRequest","pageId","getPage","pageLoadPromise","_fetchDynamicVizs","fetchFavVizs","aFavApps","oDynApp","isCount","isSmartBusinessTile","_getSections","arguments","_this2","oPage","aSections","sections","iRecentAppSectionIndex","findIndex","oSection","_temp2","_temp","_oMoveAppsPromise","moveSection","_fetchMyHomeVizs","_this3","iSectionIndex","visualizations","iVisualizationIndex","vizConfig","oVizInfo","oldAppId","targetURL","url","leanURL","getLeanURL","BGColor","key","isFav","isSection","icon","icons","indicatorDataSource","path","contentProviderId","sectionTitle","sectionId","visualizationIndex","isDefaultSection","isPresetSection","preset","_copyDynamicVizs","_this4","aDynamicVizs","all","map","oDynViz","addVisualization","vizId","bPreventGrouping","_this5","aMyHomeVizs","aVisibleFavVizs","_filterDuplicateVizs","_addGroupInformation","fetchInsightApps","sSectionTitle","_this6","_temp5","fnFetchInsightsApps","_temp4","insightsSectionIndex","_temp3","last","addSection","sectionProperties","visualizationId","spaceContentService","removeVisualizations","_ref","vizIds","_this7","_temp7","targetSection","_temp6","deleteVisualization","updateVisualizations","_ref2","sourceSectionIndex","sourceVisualizationIndex","oVisualizationData","updateVisualization","createInsightSection","_exit","_this8","_temp9","_result","_temp8","iMyInsightSectionIndex","_this8$addSection","visible","mProperties","getSectionVisualizations","forceRefresh","_this9","aApps","apps","addBookMark","bookmark","moveConfig","_this10","oBookmarkService","getContentNodes","aContentNodes","oMyHomeSpace","contentNode","children","addBookmark","createBookMarkData","moveVisualization","getVisualization","_this11","sectionVisualizations","sectionVisualization","_this12","targetSectionIndex","targetVisualizationIndex","aVisibleFavoriteVizs","bReturnDuplicateVizs","iVizIndex","iFirstIndex","oTempApp","aFavoriteVizs","aRecentVizs","oExistingSection","index","badge","toString","oPagesService","iPageIndex","getPageIndex","_getFeatureToggles","sFeatureToggleUrl","FEATURE_TOGGLE_KEYS","Object","keys","toggleFilter","sToggleKey","join","GetJSON","_HttpHelper$GetJSON","oResponse","isFeatureEnabled","sToggleId","_this13","aFeatureToggles","oToggle","oFeatureToggle","ToggleId","State","_getRecommenedFioriIds","_this14","RECOMMENDATION","recommendationEnabled","_exit2","_temp11","_result3","recommendedFioriIds","_temp10","_HttpHelper$GetJSON2","response","app_id","_Promise$resolve","_getCatalogApps","SearchableContent","getApps","includeAppsWithoutVisualizations","_isListReport","page","component","name","isAddCardToInsightsHidden","settings","tableSettings","addCardtoInsightsHidden","_checkValidManifests","manifest","hasRequiredDataSource","dataSources","mainService","pages","Array","isArray","_getOdataModel","oManifest","datasource","annotationUrls","annotations","sname","uri","urls","oDataModel","annotationURI","loadAnnotationsJoined","attachMetadataLoaded","attachMetadataFailed","_getEntitySet","entitySet","_hasMandatoryProperties","oEntitySet","aProperties","oProperty","_getParametersisedEntitySetParams","oMetaModel","sEntitySet","bInfoParams","oResult","entitySetName","navPropertyName","getODataEntitySet","oEntityType","getODataEntityType","entityType","aNavigationProperties","navigationProperty","oNavProperty","oNavigationEntitySet","getODataAssociationEnd","oNavigationEntityType","type","getODataAssociationSetEnd","propertyRef","navProp","property","navProperty","aSubNavigationProperties","bBackAssociationPresent","oSubNavigationProperty","sSubNavigationEntityType","_getColumnDetail","oLineItemContext","oColumnObject","Value","Path","getODataProperty","Bool","sColumnKeyDescription","sColumnValue","sNavigation","aSemKeyAnnotation","bIsPropertySemanticKey","oAnnotation","PropertyPath","concat","sTextArragement","_setColumnTextValue","identifier","importance","sTextArrangementType","EnumMember","split","_getManifestCardData","lineItem","oParentApp","mainServiceUri","serviceUrl","aColumns","oColumn","oItem","aColumnSorted","sortCollectionByImportance","column","splice","cardTitle","subTitle","columns","loadI18n","manifestUrl","_this15","_temp13","_RBManifestMap","absoluteUrl","i18nBundleUrl","URL","href","_temp12","create","bundleUrl","async","terminologies","oResourceBundle","getI18nValueOrDefaultString","sValue","oRB","sPath","substring","getText","_getAttributeValue","oAttribute","oAttributeValue","oDateFormatOptions","stringify","pattern","getDatePattern","_getManifest","oInput","cardSkeletonCopy","oCard","Date","now","header","oContent","content","item","attributes","data","request","actions","ibnTarget","parentAppId","cardType","versions","ui5","versionInfo","version","buildTimestamp","_getCardMainfest","aAppIds","_this16","_getInboundApps","_ref3","aInbounds","aCatalog","load","_VersionInfo$load","aAppUrls","signature","defaultValue","oCatalog","resolutionResult","applicationDependencies","aManifestPromises","fetch","json","_response$json","aManifest","validManifests","manifestObj","odataPromises","model","getMetaModel","aMetaModel","cardPromises","_exit3","_temp15","_result5","cardInput","oLineItem","parameterDetails","paramEntitySet","ui5ComponentName","_temp14","i18n","i18nResourceBundle","_this16$_getManifest","cards","card","_removeDuplicateCards","aCards","oCardDict","aResult","sCardTitle","descriptorContent","getRecommenedCards","_this17","aManifests","aRecManifests","slice","aRecommendedCards","rec","getRecommendedVisualizations","_this18","_temp18","_recommendedVisualizations","_temp17","_temp16","finalRecommendations","mustIncludeRecommendations","_getVisualizationsByFioriIds","_ref4","recommendedVisualizations","service","_oAdapter","_aInbounds","fioriIds","_this19","visitedVisualizations","Map","_ref5","inbounds","catalogApps","authorizedApps","inbound","app","matchingVizualizations","catalogApp","guiVisualizations","matchingVizualization","nonGuiVisualizations","recommendedVisualization","has","set"],"sources":["AppManager.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\n\nimport Log from \"sap/base/Log\";\nimport Formatting from \"sap/base/i18n/Formatting\";\nimport ResourceBundle from \"sap/base/i18n/ResourceBundle\";\nimport VersionInfo from \"sap/ui/VersionInfo\";\nimport BaseObject from \"sap/ui/base/Object\";\nimport Model from \"sap/ui/model/Model\";\nimport ODataMetaModel, { EntitySet, EntityType, Property } from \"sap/ui/model/odata/ODataMetaModel\";\nimport ODataModelV2 from \"sap/ui/model/odata/v2/ODataModel\";\nimport Config from \"sap/ushell/Config\";\nimport Container from \"sap/ushell/Container\";\nimport Bookmark from \"sap/ushell/services/BookmarkV2\";\nimport ClientSideTargetResolution from \"sap/ushell/services/ClientSideTargetResolution\";\nimport SearchableContent, { AppData } from \"sap/ushell/services/SearchableContent\";\nimport SpaceContent from \"sap/ushell/services/SpaceContent\";\nimport { ICustomVisualization, IParseSBParameters, ISection, ISectionAndVisualization, IVisualization } from \"../interface/AppsInterface\";\nimport { ICard, ICardManifest } from \"../interface/CardsInterface\";\nimport { IPage } from \"../interface/PageSpaceInterface\";\nimport { CardSkeleton } from \"./CardSkeleton\";\nimport {\n\tDEFAULT_BG_COLOR,\n\tFALLBACK_ICON,\n\tFEATURE_TOGGLES,\n\tFEATURE_TOGGLE_SRVC_URL,\n\tMYHOME_PAGE_ID,\n\tMYHOME_SPACE_ID,\n\tMYINSIGHT_SECTION_ID,\n\tRECOMMENDATION_SRVC_URL,\n\tRECOMMENDED_CARD_LIMIT\n} from \"./Constants\";\nimport DataFormatUtils from \"./DataFormatUtils\";\nimport HttpHelper from \"./HttpHelper\";\n\nconst CONSTANTS = {\n\tMUST_INCLUDE_RECOMMEDED_APPS: [\"F0862\", \"F1823\"] //My Inbox and Manage Timesheet apps\n};\n\ninterface IFeatureToggles {\n\tRECOMMENDATION: string;\n\tTASK_ACTIONS: string;\n}\n\ninterface IGenericApp {\n\tcomponent?: {\n\t\tname?: string;\n\t\tsettings?: {\n\t\t\ttableSettings?: {\n\t\t\t\taddCardtoInsightsHidden?: boolean;\n\t\t\t};\n\t\t};\n\t};\n\tentitySet?: IEntitySet;\n}\n\nexport interface IEntitySet extends EntitySet {\n\t\"Org.OData.Capabilities.V1.FilterRestrictions\"?: {\n\t\tRequiredProperties?: Array<unknown>;\n\t};\n}\n\ninterface IEntityType extends EntityType {\n\t\"com.sap.vocabularies.UI.v1.LineItem\": Array<ILineItemContext>;\n\t\"sap:semantics\": string;\n\t\"com.sap.vocabularies.Common.v1.SemanticKey\": Array<{\n\t\tPropertyPath: string;\n\t}>;\n\t\"com.sap.vocabularies.UI.v1.TextArrangement\": {\n\t\tEnumMember: string;\n\t};\n\t\"com.sap.vocabularies.Common.v1.Label\": {\n\t\tString: string;\n\t};\n\tproperty: Property[];\n}\n\ninterface ILineItemContext {\n\tValue: {\n\t\tPath: string;\n\t};\n\t\"com.sap.vocabularies.UI.v1.Importance\": string;\n\t\"com.sap.vocabularies.UI.v1.Hidden\": {\n\t\tBool: boolean;\n\t};\n}\n\ninterface IManifestCardData {\n\tcardTitle?: string;\n\tsubTitle: string;\n\turl: string;\n\tsemanticObject: string;\n\taction: string;\n\tid?: string;\n\tcolumns: Array<unknown>;\n}\n\nconst _parseSBParameters = (oParam: object | string | undefined): IParseSBParameters | undefined => {\n\tlet oParsedParams: IParseSBParameters | undefined = {};\n\tif (oParam) {\n\t\tif (typeof oParam === \"object\") {\n\t\t\toParsedParams = oParam;\n\t\t} else {\n\t\t\ttry {\n\t\t\t\toParsedParams = JSON.parse(oParam) as object;\n\t\t\t} catch (oError) {\n\t\t\t\tLog.error(oError instanceof Error ? oError.message : String(oError));\n\t\t\t\toParsedParams = undefined;\n\t\t\t}\n\t\t}\n\t}\n\treturn oParsedParams;\n};\n\nconst _getTileProperties = (vizConfigFLP?: IVisualization): IParseSBParameters | undefined => {\n\tlet oTileProperties: IParseSBParameters | undefined = {};\n\tif (vizConfigFLP?._instantiationData?.chip?.configuration) {\n\t\tconst oConfig: IParseSBParameters | undefined = _parseSBParameters(vizConfigFLP._instantiationData.chip.configuration);\n\t\tif (oConfig?.tileConfiguration) {\n\t\t\tconst oTileConfig: IParseSBParameters | undefined = _parseSBParameters(oConfig.tileConfiguration);\n\t\t\tif (oTileConfig) {\n\t\t\t\toTileProperties = _parseSBParameters(oTileConfig.TILE_PROPERTIES);\n\t\t\t}\n\t\t}\n\t}\n\treturn oTileProperties;\n};\n\nconst _getAppId = (vizConfigFLP: IVisualization | undefined): string => {\n\tlet sAppId = \"\";\n\tlet oTileProperties: IParseSBParameters | undefined = {};\n\tif (vizConfigFLP?.target?.semanticObject && vizConfigFLP?.target?.action) {\n\t\tsAppId = `#${vizConfigFLP.target.semanticObject}-${vizConfigFLP.target.action}`;\n\t} else if (vizConfigFLP?._instantiationData?.chip?.configuration) {\n\t\toTileProperties = _getTileProperties(vizConfigFLP);\n\t\tif (oTileProperties?.semanticObject && oTileProperties?.semanticAction) {\n\t\t\tsAppId = `#${oTileProperties?.semanticObject}-${oTileProperties?.semanticAction}`;\n\t\t}\n\t}\n\treturn sAppId;\n};\n\nconst _getTargetUrl = (vizConfigFLP: IVisualization | undefined) => {\n\tlet sTargetURL = _getAppId(vizConfigFLP) || \"\";\n\tconst oTileProperties = _getTileProperties(vizConfigFLP);\n\tif (oTileProperties?.evaluationId) {\n\t\tsTargetURL += \"?EvaluationId=\" + oTileProperties.evaluationId;\n\t}\n\treturn sTargetURL;\n};\n\nconst _isSmartBusinessTile = (oVisualization: IVisualization): boolean => {\n\treturn oVisualization.vizType?.startsWith(\"X-SAP-UI2-CHIP:SSB\");\n};\n\n// get App Title in case of value not present at root level\nconst _getAppTitleSubTitle = (oApp: IVisualization, vizConfigFLP: IVisualization): { title: string; subtitle: string } => {\n\tconst oAppTileInfo = vizConfigFLP?._instantiationData?.chip?.bags?.sb_tileProperties?.texts;\n\treturn {\n\t\ttitle: oApp.title ? oApp.title : oAppTileInfo?.title || \"\",\n\t\tsubtitle: oApp.subtitle ? oApp.subtitle : oAppTileInfo?.description || \"\"\n\t};\n};\n\n/**\n * Link Duplicate Visualizations to a single visualization\n *\n * @param {object[]} aVizs - array of visualizations\n * @returns {object[]} arry of visualizations after linking duplicate visualizations\n * @private\n */\nconst _linkDuplicateVizs = (aVizs: ICustomVisualization[]) => {\n\taVizs.forEach((oDuplicateViz) => {\n\t\taVizs\n\t\t\t.filter(\n\t\t\t\t(oViz) =>\n\t\t\t\t\toViz.appId === oDuplicateViz.appId &&\n\t\t\t\t\toViz?.visualization?.id !== oDuplicateViz?.visualization?.id &&\n\t\t\t\t\toViz.persConfig?.sectionIndex === oDuplicateViz.persConfig?.sectionIndex\n\t\t\t)\n\t\t\t.forEach((oViz) => {\n\t\t\t\toViz?.persConfig?.duplicateApps?.push(oDuplicateViz);\n\t\t\t});\n\t});\n\n\treturn aVizs;\n};\n\nconst _isGUIVisualization = (visualization: AppData) => {\n\treturn visualization?.target?.parameters?.[\"sap-ui-tech-hint\"]?.value?.value === \"GUI\";\n};\n\nconst _isMustIncludeRecommendation = (recViz: ICustomVisualization) => {\n\treturn recViz.fioriId && CONSTANTS.MUST_INCLUDE_RECOMMEDED_APPS.includes(recViz.fioriId);\n};\n\nconst _isVisualizationAlreadyAdded = (visualization: ICustomVisualization, favoriteVisualizations: ICustomVisualization[]) => {\n\treturn !favoriteVisualizations.some(\n\t\t(favViz) =>\n\t\t\tfavViz.visualization?.target?.semanticObject === visualization.visualization?.target?.semanticObject &&\n\t\t\tfavViz.visualization?.target?.action === visualization.visualization?.target?.action\n\t);\n};\n\n/**\n *\n * @class Provides the AppManager Class used for fetch and process user apps.\n *\n * @extends sap.ui.BaseObject\n *\n * @author SAP SE\n * @version 0.0.1\n * @since 1.121.0\n *\n * @private\n * @experimental Since 1.121\n * @hidden\n *\n * @alias sap.cux.home.util.AppManager\n */\nexport default class AppManager extends BaseObject {\n\tprivate aRequestQueue: { pageId: string; pageLoadPromise: Promise<IPage> }[] = [];\n\tprivate _oMoveAppsPromise!: Promise<void>;\n\tprivate bInsightsSectionPresent: boolean = false;\n\tpublic insightsSectionIndex!: number;\n\tstatic Instance: AppManager;\n\tprivate recommendedFioriIds!: string[];\n\tprivate versionInfo!: {\n\t\tversion: string;\n\t\tbuildTimestamp: string;\n\t};\n\tprivate _RBManifestMap!: Record<string, ResourceBundle>;\n\tprivate _recommendedVisualizations!: ICustomVisualization[];\n\tprivate vizDataModified: boolean = false;\n\n\tprivate constructor() {\n\t\tsuper();\n\t}\n\n\tstatic getInstance() {\n\t\tif (!AppManager.Instance) {\n\t\t\tAppManager.Instance = new AppManager();\n\t\t}\n\t\treturn AppManager.Instance;\n\t}\n\t/**\n\t * Returns page load promise from the request queue if it exists, adds it to the queue if it doesn't\n\t *\n\t * @param {string} sPageId - page id\n\t * @param {boolean} bForceRefresh - force reload of data if true\n\t * @returns {Promise} - returns a promise which resolves with the requested page data\n\t * @private\n\t */\n\tprivate async _fetchRequestFromQueue(bForceRefresh: boolean): Promise<IPage> {\n\t\tconst oSpaceContentService = await Container.getServiceAsync<SpaceContent>(\"SpaceContent\");\n\t\tlet oPageLoadPromise: Promise<IPage>;\n\t\tthis.aRequestQueue = this.aRequestQueue || [];\n\n\t\t//Check if request already exists in the queue, if not add it\n\t\tconst oRequestedPage = this.aRequestQueue.find((oRequest) => oRequest.pageId === MYHOME_PAGE_ID);\n\t\tif (!oRequestedPage || bForceRefresh === true || this.vizDataModified === true) {\n\t\t\tthis.vizDataModified = false;\n\t\t\toPageLoadPromise = oSpaceContentService.getPage(MYHOME_PAGE_ID);\n\t\t\tif (oRequestedPage) {\n\t\t\t\toRequestedPage.pageLoadPromise = oPageLoadPromise;\n\t\t\t} else {\n\t\t\t\tthis.aRequestQueue.push({\n\t\t\t\t\tpageId: MYHOME_PAGE_ID,\n\t\t\t\t\tpageLoadPromise: oPageLoadPromise\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\toPageLoadPromise = oRequestedPage.pageLoadPromise;\n\t\t}\n\n\t\treturn oPageLoadPromise;\n\t}\n\t/**\n\t * Returns all dynamic visualizations present in MyHome page\n\t *\n\t * @param {boolean} bForceRefresh - force reload of visualizations data\n\t * @returns {Promise} - resolves to array of all dynamic visualizations in MyHome page\n\t * @private\n\t */\n\tprivate _fetchDynamicVizs(bForceRefresh: boolean) {\n\t\treturn this.fetchFavVizs(bForceRefresh, true).then((aFavApps: ICustomVisualization[]) =>\n\t\t\taFavApps.filter((oDynApp) => oDynApp.isCount || oDynApp.isSmartBusinessTile)\n\t\t);\n\t}\n\t/**\n\t * Returns all the sections that are available in the MyHome page\n\t *\n\t * @param {boolean} bForceRefresh - force reload of visualizations data\n\t * @returns {Promise} - resolves to array of all sections available in MyHome page\n\t * @private\n\t */\n\tpublic async _getSections(bForceRefresh: boolean = false): Promise<ISection[]> {\n\t\tconst oPage: IPage = await this._fetchRequestFromQueue(bForceRefresh);\n\t\tconst aSections = (oPage && oPage.sections) || [],\n\t\t\tiRecentAppSectionIndex: number = aSections.findIndex((oSection) => oSection.default);\n\t\tif (iRecentAppSectionIndex > 0) {\n\t\t\tif (this._oMoveAppsPromise !== undefined) {\n\t\t\t\tthis._oMoveAppsPromise = this.moveSection(iRecentAppSectionIndex, 0);\n\t\t\t\tawait this._oMoveAppsPromise;\n\t\t\t}\n\t\t\treturn this._getSections(true);\n\t\t} else {\n\t\t\treturn aSections;\n\t\t}\n\t}\n\t/**\n\t * Models and returns all visualizations available in MyHome page\n\t *\n\t * @param {bool} bForceRefresh - force reload of visualizations data\n\t * @returns {Promise} - resolves to array of all apps available in MyHome page\n\t * @private\n\t */\n\tprivate async _fetchMyHomeVizs(bForceRefresh: boolean): Promise<ICustomVisualization[]> {\n\t\tconst aVizs: ICustomVisualization[] = [];\n\t\tconst aSections = await this._getSections(bForceRefresh);\n\t\taSections.forEach((oSection: ISection, iSectionIndex: number) => {\n\t\t\toSection?.visualizations?.forEach((oVisualization: IVisualization, iVisualizationIndex: number) => {\n\t\t\t\tconst vizConfig = oVisualization.vizConfig,\n\t\t\t\t\toVizInfo = vizConfig?.[\"sap.app\"] || ({ title: \"?\" } as IVisualization),\n\t\t\t\t\toViz = {} as ICustomVisualization;\n\n\t\t\t\toViz.oldAppId = _getAppId(vizConfig?.[\"sap.flp\"]);\n\t\t\t\toViz.appId = oVisualization?.targetURL; // Using targetURL as unique identifier as in certian scenario vizConfig can be empty.\n\t\t\t\toViz.url = oVisualization?.targetURL;\n\t\t\t\tif (!oViz.url && _isSmartBusinessTile(oVisualization)) {\n\t\t\t\t\toViz.url = _getTargetUrl(vizConfig?.[\"sap.flp\"]);\n\t\t\t\t}\n\t\t\t\toViz.leanURL = DataFormatUtils.getLeanURL(oViz.url);\n\t\t\t\toViz.title = oVisualization?.title || _getAppTitleSubTitle(oVizInfo, oVisualization)?.title;\n\t\t\t\toViz.subtitle = oVisualization.subtitle || _getAppTitleSubTitle(oVizInfo, oVisualization).subtitle;\n\t\t\t\toViz.BGColor = DEFAULT_BG_COLOR().key;\n\t\t\t\toViz.isFav = true;\n\t\t\t\toViz.isSection = false;\n\t\t\t\toViz.icon = vizConfig?.[\"sap.ui\"]?.icons?.icon || FALLBACK_ICON;\n\t\t\t\tif (oVisualization?.indicatorDataSource) {\n\t\t\t\t\toViz.isCount = true;\n\t\t\t\t\toViz.indicatorDataSource = oVisualization.indicatorDataSource.path;\n\t\t\t\t\toViz.contentProviderId = oVisualization.contentProviderId;\n\t\t\t\t}\n\t\t\t\toViz.isSmartBusinessTile = _isSmartBusinessTile(oVisualization);\n\t\t\t\t// Add FLP Personalization Config\n\t\t\t\toViz.persConfig = {\n\t\t\t\t\tpageId: MYHOME_PAGE_ID,\n\t\t\t\t\tsectionTitle: oSection.title,\n\t\t\t\t\tsectionId: oSection.id,\n\t\t\t\t\tsectionIndex: iSectionIndex,\n\t\t\t\t\tvisualizationIndex: iVisualizationIndex,\n\t\t\t\t\tisDefaultSection: oSection.default,\n\t\t\t\t\tisPresetSection: oSection.preset,\n\t\t\t\t\tduplicateApps: []\n\t\t\t\t};\n\t\t\t\toViz.visualization = oVisualization;\n\t\t\t\t// Title and Subtitle in visualization are required in Insights Dialog.\n\t\t\t\toViz.visualization.title = oViz.title;\n\t\t\t\toViz.visualization.subtitle = oViz.subtitle;\n\t\t\t\taVizs.push(oViz);\n\t\t\t});\n\t\t});\n\t\treturn aVizs;\n\t}\n\t/**\n\t * Copies all Dynamic visualizations to Insights section\n\t *\n\t * @returns {Promise} - resolves to void and copy all the visualizations\n\t * @private\n\t */\n\tprivate async _copyDynamicVizs() {\n\t\tconst aDynamicVizs: ICustomVisualization[] = await this._fetchDynamicVizs(true);\n\t\treturn Promise.all(\n\t\t\taDynamicVizs.map((oDynViz: ICustomVisualization) => {\n\t\t\t\treturn this.addVisualization(oDynViz.visualization!.vizId, MYINSIGHT_SECTION_ID);\n\t\t\t})\n\t\t);\n\t}\n\t/**\n\t * Returns a list of all favorite vizualizations in MyHome page\n\t *\n\t * @param {boolean} bForceRefresh - force reload of vizualizations data\n\t * @param {boolean} bPreventGrouping - prevent vizualizations grouping\n\t * @returns {Promise} - resolves to array of favourite vizualizations in MyHome page\n\t * @private\n\t */\n\tpublic async fetchFavVizs(bForceRefresh: boolean, bPreventGrouping?: boolean): Promise<ISectionAndVisualization[]> {\n\t\tconst aMyHomeVizs = await this._fetchMyHomeVizs(bForceRefresh);\n\t\tconst aVisibleFavVizs = aMyHomeVizs.filter(\n\t\t\t(oViz) => oViz.persConfig && oViz.persConfig.sectionId !== MYINSIGHT_SECTION_ID && oViz.url && oViz.title\n\t\t);\n\n\t\tif (bPreventGrouping) {\n\t\t\treturn this._filterDuplicateVizs(_linkDuplicateVizs(aVisibleFavVizs), false);\n\t\t} else {\n\t\t\treturn this._addGroupInformation(aVisibleFavVizs);\n\t\t}\n\t}\n\t/**\n\t * Returns all vizualizations present in the Insights Section\n\t *\n\t * @param {boolean} bForceRefresh - force reload insights vizualizations data\n\t * @param {string} sSectionTitle - optional, title of insights section to be used while creating insights section\n\t * @returns {Promise} - resolves to an array with all vizualizations in Insights section\n\t */\n\tpublic async fetchInsightApps(bForceRefresh: boolean, sSectionTitle: string) {\n\t\tconst fnFetchInsightsApps = async () => {\n\t\t\tconst aVizs = await this._fetchMyHomeVizs(bForceRefresh);\n\t\t\treturn aVizs.filter((oViz) => oViz.persConfig?.sectionId === MYINSIGHT_SECTION_ID && oViz.url && oViz.title);\n\t\t};\n\n\t\tif (!this.bInsightsSectionPresent) {\n\t\t\tconst aSections: ISection[] = await this._getSections(bForceRefresh);\n\t\t\tthis.insightsSectionIndex = aSections.findIndex(function (oSection) {\n\t\t\t\treturn oSection.id === MYINSIGHT_SECTION_ID;\n\t\t\t});\n\n\t\t\tif (\n\t\t\t\tthis.insightsSectionIndex === -1 &&\n\t\t\t\t(Config.last(\"/core/shell/enablePersonalization\") || Config.last(\"/core/catalog/enabled\")) && \n\t\t\t\tthis.bInsightsSectionPresent === false\n\t\t\t) {\n\t\t\t\tthis.bInsightsSectionPresent = true;\n\t\t\t\tawait this.addSection({\n\t\t\t\t\tsectionIndex: aSections?.length,\n\t\t\t\t\tsectionProperties: {\n\t\t\t\t\t\tid: MYINSIGHT_SECTION_ID,\n\t\t\t\t\t\ttitle: sSectionTitle\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tawait this._copyDynamicVizs();\n\t\t\t} else {\n\t\t\t\tthis.bInsightsSectionPresent = true;\n\t\t\t}\n\t\t}\n\n\t\treturn await fnFetchInsightsApps();\n\t}\n\n\t/**\n\t * Add visualization to a particular section\n\t *\n\t * @param {string} visualizationId - The id of the visualization to add.\n\t * @param {string} sectionId - The id of the section the visualization should be added to (optional parameter)\n\t * @returns {Promise} resolves to void after adding app to a section\n\t * @private\n\t */\n\tpublic async addVisualization(visualizationId: string, sectionId: string | undefined = undefined): Promise<void> {\n\t\tconst spaceContentService = await Container.getServiceAsync<SpaceContent>(\"SpaceContent\");\n\t\tawait spaceContentService.addVisualization(MYHOME_PAGE_ID, sectionId, visualizationId);\n\t}\n\n\t/**\n\t * @param {object} mProperties - map of properties\n\t * @param {string} mProperties.sectionId - section id from which visualizations should be removed\n\t * @param {object[]} mProperties.appIds - array of url of visualizations that has to be deleted\n\t * @param {boolean} mProperties.ignoreDuplicateApps - if true doesn't remove the duplicate apps, else removes the duplicate apps as well\n\t * @private\n\t * @returns {Promise} resolves after all visualizations are deleted\n\t */\n\tpublic async removeVisualizations({ sectionId, vizIds }: { sectionId: string; vizIds: string[] }) {\n\t\tconst spaceContentService = await Container.getServiceAsync<SpaceContent>(\"SpaceContent\");\n\t\tfor (const vizId of vizIds) {\n\t\t\ttry {\n\t\t\t\tconst sections = await this._getSections(true);\n\t\t\t\tconst sectionIndex = sections.findIndex((oSection) => oSection.id === sectionId);\n\t\t\t\tconst targetSection = sectionIndex > -1 ? sections[sectionIndex] : null;\n\t\t\t\tconst visualizationIndex = targetSection?.visualizations?.findIndex((oVisualization) => oVisualization.id === vizId) ?? -1;\n\t\t\t\tif (visualizationIndex > -1) {\n\t\t\t\t\tawait spaceContentService.deleteVisualization(MYHOME_PAGE_ID, sectionIndex, visualizationIndex);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tLog.error(error as string);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @param {object} mProperties - map of properties\n\t * @param {string} mProperties.pageId - page id from which visualizations should be updated\n\t * @param {object[]} mProperties.sourceSectionIndex - section index in which visualization that has to be updated\n\t * @param {boolean} mProperties.sourceVisualizationIndex - visualization index in the which should be updated\n\t * @param {boolean} mProperties.oVisualizationData - visualization data which will be updated for the vizualisation\n\t * @private\n\t * @returns {Promise} resolves to void\n\t */\n\tpublic async updateVisualizations({\n\t\tpageId,\n\t\tsourceSectionIndex,\n\t\tsourceVisualizationIndex,\n\t\toVisualizationData\n\t}: {\n\t\tpageId: string;\n\t\tsourceSectionIndex: number;\n\t\tsourceVisualizationIndex: number;\n\t\toVisualizationData: { displayFormatHint: string };\n\t}) {\n\t\tconst spaceContentService = await Container.getServiceAsync<SpaceContent>(\"SpaceContent\");\n\t\treturn spaceContentService.updateVisualization(pageId, sourceSectionIndex, sourceVisualizationIndex, oVisualizationData);\n\t}\n\n\t/**\n\t * Create Insight Section if not already present\n\t *\n\t * @param {string} sSectionTitle - optional, section title\n\t * @returns {Promise} - resolves to insight section created\n\t */\n\tpublic async createInsightSection(sSectionTitle: string) {\n\t\tif (!this.bInsightsSectionPresent) {\n\t\t\tconst aSections = await this._getSections();\n\t\t\tconst iMyInsightSectionIndex = aSections.findIndex(function (oSection) {\n\t\t\t\treturn oSection.id === MYINSIGHT_SECTION_ID;\n\t\t\t});\n\n\t\t\t//check if myinsight section exists, if not create one\n\t\t\tif (\n\t\t\t\tiMyInsightSectionIndex === -1 &&\n\t\t\t\t(Config.last(\"/core/shell/enablePersonalization\") || Config.last(\"/core/catalog/enabled\"))\n\t\t\t) {\n\t\t\t\treturn this.addSection({\n\t\t\t\t\tsectionIndex: aSections.length,\n\t\t\t\t\tsectionProperties: {\n\t\t\t\t\t\tid: MYINSIGHT_SECTION_ID,\n\t\t\t\t\t\ttitle: sSectionTitle,\n\t\t\t\t\t\tvisible: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * Adds a section\n\t *\n\t * @param {object} mProperties - map of properties\n\t * @param {string} mProperties.sectionIndex - section index\n\t * @param {object} mProperties.sectionProperties - section properties\n\t * @returns {Promise} resolves to void and creates the section\n\t * @private\n\t */\n\tpublic async addSection(mProperties: ISection) {\n\t\tconst { sectionIndex, sectionProperties } = mProperties;\n\t\tconst oSpaceContentService = await Container.getServiceAsync<SpaceContent>(\"SpaceContent\");\n\t\tawait oSpaceContentService.addSection(MYHOME_PAGE_ID, sectionIndex, {\n\t\t\t...sectionProperties,\n\t\t\tvisible: true\n\t\t});\n\t}\n\n\t/**\n\t * Returns visualizations for a given section\n\t * @param {string} sectionId - section id\n\t * @param {boolean} [forceRefresh=false] - force reload of data if true\n\t * @returns {Promise} resolves to array of visualizations\n\t * @private\n\t */\n\tpublic async getSectionVisualizations(sectionId?: string, forceRefresh = false): Promise<ICustomVisualization[]> {\n\t\tconst aApps: ISectionAndVisualization[] = await this.fetchFavVizs(forceRefresh);\n\t\tif (sectionId) {\n\t\t\treturn aApps.find((oViz) => oViz.isSection && oViz.id === sectionId)?.apps || [];\n\t\t} else {\n\t\t\treturn aApps.filter((oViz) => !oViz.isSection); //return recently added apps\n\t\t}\n\t}\n\n\t/**\n\t * Adds a bookmark.\n\t * @private\n\t * @param {Object} bookmark - The bookmark data object.\n\t * @returns {Promise<void>} - A Promise that resolves once the bookmark is added.\n\t */\n\tpublic async addBookMark(\n\t\tbookmark: IVisualization,\n\t\tmoveConfig?: {\n\t\t\tsourceSectionIndex: number;\n\t\t\tsourceVisualizationIndex: number;\n\t\t\ttargetSectionIndex: number;\n\t\t\ttargetVisualizationIndex: number;\n\t\t}\n\t) {\n\t\tconst oBookmarkService: Bookmark = await Container.getServiceAsync(\"BookmarkV2\");\n\t\tconst aContentNodes = await oBookmarkService.getContentNodes();\n\t\tconst oMyHomeSpace = aContentNodes.find((contentNode) => contentNode.id === MYHOME_SPACE_ID);\n\t\tconst contentNode = oMyHomeSpace?.children?.find((contentNode) => contentNode.id === MYHOME_PAGE_ID);\n\t\tawait oBookmarkService.addBookmark(DataFormatUtils.createBookMarkData(bookmark), contentNode);\n\t\tif (moveConfig) {\n\t\t\treturn this.moveVisualization(moveConfig);\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * Retrieves the visualization with the specified appId within the specified section.\n\t * @param {string} appId - appId of the visualization for.\n\t * @param {string} sectionId - The ID of the section containing the visualization.\n\t * @param {boolean} [forceRefresh=false] - Whether to force a refresh of the section's cache.\n\t * @returns {Promise<object|null>} A promise that resolves with the visualization object if found, or null if not found.\n\t * @private\n\t */\n\tpublic async getVisualization(appId: string, sectionId?: string, forceRefresh = false) {\n\t\tconst sectionVisualizations = await this.getSectionVisualizations(sectionId, forceRefresh);\n\t\treturn sectionVisualizations.find((sectionVisualization) => sectionVisualization.appId === appId);\n\t}\n\n\t/**\n\t * Moves a visualization from source section to target section.\n\t * @param {object} moveConfig - Configuration object containing details for moving the visualization.\n\t * @param {number} moveConfig.sourceSectionIndex - Index of the source section.\n\t * @param {number} moveConfig.sourceVisualizationIndex - Index of the visualization within the source section.\n\t * @param {number} moveConfig.targetSectionIndex - Index of the target section.\n\t * @param {number} moveConfig.targetVisualizationIndex - Index at which the visualization will be placed within the target section.\n\t * @returns {Promise<void>} A promise that resolves to void after the move operation.\n\t * @private\n\t */\n\tpublic async moveVisualization(moveConfig: {\n\t\tsourceSectionIndex: number;\n\t\tsourceVisualizationIndex: number;\n\t\ttargetSectionIndex: number;\n\t\ttargetVisualizationIndex: number;\n\t}) {\n\t\tconst spaceContentService = await Container.getServiceAsync<SpaceContent>(\"SpaceContent\");\n\t\tthis.vizDataModified = true;\n\t\treturn spaceContentService.moveVisualization(\n\t\t\tMYHOME_PAGE_ID,\n\t\t\tmoveConfig.sourceSectionIndex,\n\t\t\tmoveConfig.sourceVisualizationIndex,\n\t\t\tmoveConfig.targetSectionIndex,\n\t\t\tmoveConfig.targetVisualizationIndex\n\t\t);\n\t}\n\n\t/**\n\t * Filters out duplicate visualizations from a list of all visualizations\n\t *\n\t * @param {object[]} aVisibleFavoriteVizs - array containing list of all visualizations\n\t * @param {boolean} bReturnDuplicateVizs - flag when set to true, returns only the duplicate apps\n\t * @returns {object[]} filtered array of vizualisations\n\t * @private\n\t */\n\tpublic _filterDuplicateVizs(aVisibleFavoriteVizs: ICustomVisualization[], bReturnDuplicateVizs: boolean) {\n\t\treturn aVisibleFavoriteVizs.filter((oViz, iVizIndex, aVizs) => {\n\t\t\tconst iFirstIndex = aVizs.findIndex((oTempApp) => oTempApp.appId === oViz.appId);\n\t\t\treturn bReturnDuplicateVizs ? iFirstIndex !== iVizIndex : iFirstIndex === iVizIndex;\n\t\t});\n\t}\n\n\t/**\n\t * Add Grouping Information to visualizations list, and return concatenated list.\n\t *\n\t * @param {object[]} aFavoriteVizs - list of all favorite visualizations\n\t * @returns {object[]} - concatenated list contaning grouping information as well\n\t * @private\n\t */\n\tprivate _addGroupInformation(aFavoriteVizs: ICustomVisualization[]) {\n\t\tconst aRecentVizs: ICustomVisualization[] = [],\n\t\t\taSections: ISection[] = [];\n\t\tlet oExistingSection: ISection | undefined;\n\n\t\t_linkDuplicateVizs(aFavoriteVizs).forEach((oViz) => {\n\t\t\tif (oViz.persConfig?.isDefaultSection) {\n\t\t\t\taRecentVizs.push(oViz);\n\t\t\t} else {\n\t\t\t\toExistingSection = aSections.find((oSection) => oSection.isSection && oSection.id === oViz.persConfig?.sectionId);\n\n\t\t\t\tif (!oExistingSection) {\n\t\t\t\t\taSections.push({\n\t\t\t\t\t\tid: oViz.persConfig?.sectionId,\n\t\t\t\t\t\tindex: oViz.persConfig?.sectionIndex,\n\t\t\t\t\t\ttitle: oViz.persConfig?.sectionTitle || \"\",\n\t\t\t\t\t\tbadge: \"1\",\n\t\t\t\t\t\tBGColor: DEFAULT_BG_COLOR().key,\n\t\t\t\t\t\ticon: \"sap-icon://folder-full\",\n\t\t\t\t\t\tisSection: true,\n\t\t\t\t\t\tisPresetSection: oViz.persConfig?.isPresetSection,\n\t\t\t\t\t\tapps: [oViz]\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\toExistingSection.apps?.push(oViz);\n\t\t\t\t\toExistingSection.badge = oExistingSection.apps?.length.toString();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t//filter out duplicate apps only from recent apps list\n\t\treturn [...aSections, ...this._filterDuplicateVizs(aRecentVizs, false)];\n\t}\n\n\t/**\n\t * Move a section within a page\n\t *\n\t * @param {number} sourceSectionIndex - source index (previous index of the section in the page before move)\n\t * @param {number} targetSectionIndex - target index (desired index of the section in the page after move)\n\t * @returns {Promise} resolves to void  and moves the section to desired index within the page\n\t * @private\n\t */\n\tpublic async moveSection(sourceSectionIndex: number, targetSectionIndex: number): Promise<void> {\n\t\treturn Container.getServiceAsync(\"Pages\").then(function (oPagesService: {\n\t\t\tgetPageIndex: (id: string) => number;\n\t\t\tmoveSection: (index: number, sourceIndex: number, targetIndex: number) => void;\n\t\t}) {\n\t\t\tconst iPageIndex: number = oPagesService.getPageIndex(MYHOME_PAGE_ID);\n\t\t\treturn oPagesService.moveSection(iPageIndex, sourceSectionIndex, targetSectionIndex);\n\t\t} as () => void);\n\t}\n\n\t/**\n\t * Returns array of all feature toggles\n\t *\n\t * @returns {object[]} - returns array of all feature toggles.\n\t */\n\tprivate async _getFeatureToggles() {\n\t\tlet sFeatureToggleUrl = FEATURE_TOGGLE_SRVC_URL + \"?$filter=\";\n\t\tconst FEATURE_TOGGLE_KEYS = Object.keys(FEATURE_TOGGLES);\n\t\tconst toggleFilter = FEATURE_TOGGLE_KEYS.map((sToggleKey) => {\n\t\t\treturn \"ToggleId eq '\" + FEATURE_TOGGLES[sToggleKey as keyof IFeatureToggles] + \"'\";\n\t\t}).join(\" or \");\n\t\tsFeatureToggleUrl = sFeatureToggleUrl + \"(\" + toggleFilter + \")\";\n\t\tconst oResponse = (await HttpHelper.GetJSON(sFeatureToggleUrl)) as {\n\t\t\terror: { message: string };\n\t\t\tvalue: Array<{ ToggleId: string; State: string }>;\n\t\t};\n\t\tif (oResponse?.error) {\n\t\t\tthrow new Error(oResponse.error.message);\n\t\t}\n\t\treturn oResponse?.value || [];\n\t}\n\n\t/**\n\t * Checks if feature is enabled or not.\n\t *\n\t * @param {string} sToggleId - feature toggle id\n\t * @returns {boolean} - returns true if feature is enabled.\n\t */\n\tpublic async isFeatureEnabled(sToggleId: string) {\n\t\ttry {\n\t\t\tconst aFeatureToggles = await this._getFeatureToggles();\n\t\t\tconst oToggle = aFeatureToggles.find((oFeatureToggle) => {\n\t\t\t\treturn oFeatureToggle.ToggleId === sToggleId;\n\t\t\t});\n\t\t\treturn oToggle && oToggle.State === \"\" ? false : true;\n\t\t} catch (error) {\n\t\t\tLog.error(\"Unable to load feature toggles: \" + (error as Error).message);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t/**\n\t * Fetch Recommended Fiori IDs\n\t *\n\t * @returns {Promise} resolves to array of recommended fiori ids\n\t * @private\n\t */\n\tprivate async _getRecommenedFioriIds(bForceRefresh: boolean = false): Promise<string[]> {\n\t\tconst recommendationEnabled = await this.isFeatureEnabled(FEATURE_TOGGLES.RECOMMENDATION);\n\t\tif (!recommendationEnabled) {\n\t\t\treturn Promise.resolve([]);\n\t\t}\n\t\tif (!this.recommendedFioriIds || bForceRefresh) {\n\t\t\ttry {\n\t\t\t\tconst response = (await HttpHelper.GetJSON(RECOMMENDATION_SRVC_URL)) as {\n\t\t\t\t\terror: { message: string };\n\t\t\t\t\tvalue: Array<{ app_id: string }>;\n\t\t\t\t};\n\t\t\t\tthis.recommendedFioriIds =\n\t\t\t\t\tresponse?.value?.map((oApp) => {\n\t\t\t\t\t\treturn oApp.app_id;\n\t\t\t\t\t}) || [];\n\t\t\t} catch (error) {\n\t\t\t\tLog.error(\"Unable to load feature toggles: \" + (error as Error).message);\n\t\t\t\treturn Promise.resolve([]);\n\t\t\t}\n\t\t}\n\t\treturn this.recommendedFioriIds;\n\t}\n\n\t/**\n\t * Fetch Catalog Apps\n\t *\n\t * @returns {Promise} resolves to array of Catalog Apps\n\t * @private\n\t */\n\tpublic async _getCatalogApps() {\n\t\ttry {\n\t\t\tconst SearchableContent = await Container.getServiceAsync<SearchableContent>(\"SearchableContent\");\n\t\t\treturn SearchableContent.getApps({ includeAppsWithoutVisualizations: false });\n\t\t} catch (error) {\n\t\t\tLog.error(\"Error while fetching catalog apps: \" + (error as Error).message);\n\t\t\treturn [];\n\t\t}\n\t}\n\n\t/**\n\t * Check If Page is List Report\n\t *\n\t * @param {object} page - page object\n\t * @returns {boolean} returns boolean\n\t * @private\n\t */\n\tprivate _isListReport(page?: IGenericApp) {\n\t\treturn page?.component?.name === \"sap.suite.ui.generic.template.ListReport\";\n\t}\n\n\t/**\n\t * Checks whether page settings contains addCardtoInsightsHidden\n\t * @param {object} page - page object\n\t * @returns {boolean} returns boolean\n\t * @private\n\t */\n\t// checks whether page settings contains addCardtoInsightsHidden\n\tprivate isAddCardToInsightsHidden(page?: IGenericApp) {\n\t\treturn page?.component?.settings?.tableSettings?.addCardtoInsightsHidden;\n\t}\n\n\t/**\n\t * check Valid Manifests\n\t *\n\t * @returns {boolean} returns boolean\n\t * @private\n\t */\n\n\tprivate _checkValidManifests(manifest: ICardManifest) {\n\t\tconst hasRequiredDataSource = manifest[\"sap.ui.generic.app\"] && manifest[\"sap.app\"]?.dataSources?.mainService;\n\t\tif (!hasRequiredDataSource) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst pages = manifest[\"sap.ui.generic.app\"]?.pages as Array<IGenericApp> | Record<string, IGenericApp>;\n\t\t// if its not list report component or if listreport page settings has\n\t\t// isAddCardToInsightsHidden as true, then do not recommend the card\n\t\tif (Array.isArray(pages)) {\n\t\t\treturn this._isListReport(pages[0]) && !this.isAddCardToInsightsHidden(pages[0]);\n\t\t} else if (Object.keys(pages).length) {\n\t\t\treturn Object.keys(pages).some((key: string) => {\n\t\t\t\tif ((pages as Record<string, unknown>)[key]) {\n\t\t\t\t\treturn this._isListReport(pages[key]) && !this.isAddCardToInsightsHidden(pages[key]);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Get OData Model\n\t *\n\t * @param {object} manifest - manifest object\n\t * @returns {object} returns OData Model\n\t * @private\n\t */\n\tprivate _getOdataModel(oManifest: ICardManifest) {\n\t\treturn new Promise(function (resolve) {\n\t\t\tconst datasource = oManifest?.[\"sap.app\"]?.dataSources;\n\t\t\tconst mainService = datasource?.mainService;\n\t\t\tconst annotationUrls = mainService?.settings?.annotations\n\t\t\t\t.map((sname) => {\n\t\t\t\t\tif (datasource && datasource[sname]) {\n\t\t\t\t\t\treturn datasource[sname]?.uri;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.filter((urls) => urls !== undefined);\n\t\t\tconst oDataModel = new ODataModelV2(mainService?.uri as string, {\n\t\t\t\tannotationURI: annotationUrls as string[],\n\t\t\t\tloadAnnotationsJoined: true\n\t\t\t});\n\t\t\toDataModel.attachMetadataLoaded(() => {\n\t\t\t\tresolve(oDataModel);\n\t\t\t});\n\t\t\toDataModel.attachMetadataFailed(() => {\n\t\t\t\tresolve(oDataModel);\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Get Entity Set\n\t *\n\t * @param {object} manifest - manifest object\n\t * @returns {string} returns entity set\n\t * @private\n\t */\n\tprivate _getEntitySet(manifest: ICardManifest) {\n\t\tconst pages = manifest[\"sap.ui.generic.app\"]?.pages;\n\t\tif (Array.isArray(pages)) {\n\t\t\treturn pages[0].entitySet;\n\t\t} else if (pages) {\n\t\t\tfor (const key in pages as Record<string, IGenericApp>) {\n\t\t\t\tconst oApp = pages[key] as IGenericApp;\n\t\t\t\tif (oApp.component && oApp.component?.name === \"sap.suite.ui.generic.template.ListReport\") {\n\t\t\t\t\treturn oApp.entitySet;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\t/**\n\t * function returns true if the passed entityset / properties have mandatory properties\n\t *\n\t * @param {EntitySet} oEntitySet - Entity set\n\t * @param {Array} aProperties - Additional Properties\n\t * @returns {boolean} returns boolean\n\t * @private\n\t */\n\tprivate _hasMandatoryProperties(oEntitySet: IEntitySet, aProperties?: Property[]) {\n\t\t// if entityset has required properties in filter restrictions return true\n\t\tif (oEntitySet?.[\"Org.OData.Capabilities.V1.FilterRestrictions\"]?.[\"RequiredProperties\"]?.length) {\n\t\t\treturn true;\n\t\t} else if (aProperties?.length) {\n\t\t\t// iterate through all properties and return true if any property is mandatory or sap:rquired-in-filter is true\n\t\t\treturn aProperties.some((oProperty: Record<string, string> | Property) => {\n\t\t\t\treturn (\n\t\t\t\t\tObject.keys(oProperty).length &&\n\t\t\t\t\t((oProperty as Record<string, string>)[\"sap:parameter\"] === \"mandatory\" ||\n\t\t\t\t\t\t(oProperty as Record<string, string>)[\"sap:required-in-filter\"] === \"true\")\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Get Parametersised Entity Set Params\n\t *\n\t * @param {ODataMetaModel} oMetaModel - Meta Model\n\t * @param {string} sEntitySet - Entity Set\n\t * @param {boolean} bIsParamEntitySet - Is Param Entity Set\n\t * @returns {object} returns entity set params\n\t * @private\n\t */\n\tprivate _getParametersisedEntitySetParams(oMetaModel: ODataMetaModel, sEntitySet: string, bInfoParams: boolean) {\n\t\tif (!oMetaModel) {\n\t\t\tthrow new Error(\"OData Model needs to be passed as an argument\");\n\t\t}\n\n\t\tconst oResult: { entitySetName: string | undefined | null; parameters: Array<object | string>; navPropertyName: string | null } = {\n\t\t\tentitySetName: null,\n\t\t\tparameters: [],\n\t\t\tnavPropertyName: null\n\t\t};\n\n\t\tconst oEntitySet = oMetaModel.getODataEntitySet(sEntitySet) as IEntitySet;\n\t\tconst oEntityType = oMetaModel.getODataEntityType(oEntitySet.entityType) as IEntityType;\n\t\tconst aNavigationProperties = oEntityType.navigationProperty;\n\n\t\tif (!aNavigationProperties) {\n\t\t\treturn oResult;\n\t\t}\n\t\t// filter the parameter entityset for extracting it's key and it's entityset name\n\t\taNavigationProperties.forEach(function (oNavProperty) {\n\t\t\tconst oNavigationEntitySet = oMetaModel.getODataAssociationEnd(oEntityType, oNavProperty.name);\n\t\t\tconst oNavigationEntityType = oNavigationEntitySet && (oMetaModel.getODataEntityType(oNavigationEntitySet.type) as IEntityType);\n\t\t\tif (oNavigationEntityType?.[\"sap:semantics\"] !== \"parameters\" || !oNavigationEntityType.key) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\toResult.entitySetName = oMetaModel.getODataAssociationSetEnd(oEntityType, oNavProperty.name)?.entitySet as string;\n\t\t\tfor (let value of oNavigationEntityType.key.propertyRef) {\n\t\t\t\tif (bInfoParams) {\n\t\t\t\t\tconst navProp = oNavigationEntityType.property;\n\t\t\t\t\tfor (let navProperty of navProp) {\n\t\t\t\t\t\tif (navProperty.name === value.name) {\n\t\t\t\t\t\t\toResult.parameters.push(navProperty);\n\t\t\t\t\t\t\toResult.entitySetName = oMetaModel.getODataAssociationSetEnd(oEntityType, oNavProperty.name)?.entitySet;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\toResult.parameters.push(value.name);\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst aSubNavigationProperties = oNavigationEntityType.navigationProperty;\n\t\t\t// Parameter entityset must have association back to main entityset.\n\t\t\tconst bBackAssociationPresent = aSubNavigationProperties?.some(function (oSubNavigationProperty) {\n\t\t\t\tconst sSubNavigationEntityType = oMetaModel.getODataAssociationEnd(\n\t\t\t\t\toNavigationEntityType as EntityType,\n\t\t\t\t\toSubNavigationProperty.name\n\t\t\t\t)?.type;\n\t\t\t\t//if entityset.entitytype is same as subnavigation entitytype then it's a back association\n\t\t\t\toResult.navPropertyName = sSubNavigationEntityType === oEntitySet.entityType ? oSubNavigationProperty.name : null;\n\t\t\t\treturn oResult.navPropertyName;\n\t\t\t});\n\t\t\treturn bBackAssociationPresent && oResult.navPropertyName && oResult.entitySetName;\n\t\t});\n\t\treturn oResult;\n\t}\n\n\t/**\n\t * Get Column Detail\n\t *\n\t * @param {object} oEntityType - entity type object\n\t * @param {object} oMetaModel - meta model object\n\t * @param {object} oColumn - column object\n\t * @returns {object} returns column detail\n\t * @private\n\t */\n\tprivate _getColumnDetail(oEntityType: IEntityType, oMetaModel: ODataMetaModel, oLineItemContext: ILineItemContext) {\n\t\tlet oProperty,\n\t\t\toColumnObject: Record<string, unknown> = {};\n\t\ttype oDataProprty = Record<\n\t\t\tstring,\n\t\t\t{ Bool?: boolean; Path?: string; \"com.sap.vocabularies.UI.v1.TextArrangement\"?: { EnumMember: string } }\n\t\t>;\n\t\tif (oLineItemContext.Value?.Path) {\n\t\t\toProperty = oMetaModel.getODataProperty(oEntityType, oLineItemContext.Value.Path) as oDataProprty | Property;\n\t\t}\n\t\tif (\n\t\t\t!oProperty ||\n\t\t\t(oProperty as oDataProprty)[\"com.sap.vocabularies.UI.v1.Hidden\"]?.Bool ||\n\t\t\toLineItemContext[\"com.sap.vocabularies.UI.v1.Hidden\"]?.Bool\n\t\t) {\n\t\t\treturn oColumnObject;\n\t\t}\n\t\t// if there is field control path binding then ignore the column\n\t\tif ((oProperty as oDataProprty)[\"com.sap.vocabularies.Common.v1.FieldControl\"]?.Path) {\n\t\t\treturn undefined;\n\t\t}\n\t\tlet sColumnKeyDescription = (oProperty as oDataProprty)[\"com.sap.vocabularies.Common.v1.Text\"]?.Path || \"\";\n\t\tsColumnKeyDescription = \"{\" + sColumnKeyDescription + \"}\";\n\t\tlet sColumnValue = \"{\" + (oProperty.name as string) + \"}\";\n\t\tlet sNavigation = \"\"; //need to improve\n\t\tconst aSemKeyAnnotation = oEntityType[\"com.sap.vocabularies.Common.v1.SemanticKey\"];\n\t\tconst bIsPropertySemanticKey =\n\t\t\t!!aSemKeyAnnotation &&\n\t\t\taSemKeyAnnotation.some(function (oAnnotation) {\n\t\t\t\treturn oAnnotation.PropertyPath === (oProperty as oDataProprty).name;\n\t\t\t});\n\n\t\tif ((oProperty as oDataProprty)[\"Org.OData.Measures.V1.ISOCurrency\"]?.Path) {\n\t\t\tsColumnValue = sColumnValue.concat(\n\t\t\t\t\" \" + \"{\" + sNavigation + (oProperty as oDataProprty)[\"Org.OData.Measures.V1.ISOCurrency\"].Path + \"}\"\n\t\t\t);\n\t\t}\n\t\tif ((oProperty as oDataProprty)[\"Org.OData.Measures.V1.Unit\"]?.Path) {\n\t\t\tsColumnValue = sColumnValue.concat(\n\t\t\t\t\" \" + \"{\" + sNavigation + (oProperty as oDataProprty)[\"Org.OData.Measures.V1.Unit\"].Path + \"}\"\n\t\t\t);\n\t\t}\n\n\t\tif ((oProperty as oDataProprty)[\"com.sap.vocabularies.Common.v1.Text\"]?.Path) {\n\t\t\tlet sTextArragement = (oProperty as oDataProprty)[\"com.sap.vocabularies.Common.v1.Text\"][\n\t\t\t\t\"com.sap.vocabularies.UI.v1.TextArrangement\"\n\t\t\t];\n\t\t\tif (!sTextArragement) {\n\t\t\t\tsTextArragement = oEntityType[\"com.sap.vocabularies.UI.v1.TextArrangement\"];\n\t\t\t}\n\n\t\t\tthis._setColumnTextValue(sTextArragement, oColumnObject, sColumnKeyDescription, sColumnValue);\n\t\t} else {\n\t\t\toColumnObject[\"value\"] = sColumnValue;\n\t\t\tif (bIsPropertySemanticKey) {\n\t\t\t\toColumnObject.identifier = bIsPropertySemanticKey;\n\t\t\t}\n\t\t}\n\t\toColumnObject.path = (oProperty as oDataProprty)[\"com.sap.vocabularies.Common.v1.Text\"]\n\t\t\t? (oProperty as oDataProprty)[\"com.sap.vocabularies.Common.v1.Text\"].Path\n\t\t\t: oProperty.name;\n\t\toColumnObject.importance = oLineItemContext[\"com.sap.vocabularies.UI.v1.Importance\"];\n\t\toColumnObject.type = oProperty.type;\n\t\treturn oColumnObject;\n\t}\n\n\t/**\n\t * Sets display text format of column\n\t *\n\t * @private\n\t * @param {{EnumMember: string} | undefined} sTextArragement - sTextArragement object\n\t * @param {Record<string, unknown>} oColumnObject - Object containing column details\n\t * @param {string} sColumnKeyDescription - Description field to include in text value\n\t * @param {string} sColumnValue - The value to include in Text value\n\t */\n\tprivate _setColumnTextValue(\n\t\tsTextArragement: { EnumMember: string } | undefined,\n\t\toColumnObject: Record<string, unknown>,\n\t\tsColumnKeyDescription: string,\n\t\tsColumnValue: string\n\t) {\n\t\tconst sTextArrangementType = sTextArragement?.EnumMember.split(\"/\")[1];\n\n\t\tif (sTextArrangementType === \"TextOnly\") {\n\t\t\toColumnObject[\"value\"] = \"{= $\" + sColumnKeyDescription + \" === '' ? '' : $\" + sColumnKeyDescription + \"}\";\n\t\t} else if (sTextArrangementType === \"TextLast\") {\n\t\t\toColumnObject[\"value\"] =\n\t\t\t\t\"{= $\" +\n\t\t\t\tsColumnValue +\n\t\t\t\t\" === '' ? '' : $\" +\n\t\t\t\tsColumnValue +\n\t\t\t\t\"}\" +\n\t\t\t\t\"{= $\" +\n\t\t\t\tsColumnKeyDescription +\n\t\t\t\t\" === '' ? '' : ' (' + ($\" +\n\t\t\t\tsColumnKeyDescription +\n\t\t\t\t\") + ')'}\";\n\t\t} else if (sTextArrangementType === \"TextSeparate\") {\n\t\t\toColumnObject[\"value\"] = \"{= $\" + sColumnValue + \" === '' ? '' : $\" + sColumnValue + \"}\";\n\t\t} else {\n\t\t\t// Default case\n\t\t\toColumnObject[\"value\"] =\n\t\t\t\t\"{= $\" +\n\t\t\t\tsColumnKeyDescription +\n\t\t\t\t\" === '' ? '' : $\" +\n\t\t\t\tsColumnKeyDescription +\n\t\t\t\t\"}\" +\n\t\t\t\t\"{= $\" +\n\t\t\t\tsColumnValue +\n\t\t\t\t\" === '' ? '' : ' (' + ($\" +\n\t\t\t\tsColumnValue +\n\t\t\t\t\") + ')'}\";\n\t\t}\n\t}\n\n\t/**\n\t * Get Manifest Card Data\n\t *\n\t * @param {object} manifest - manifest object\n\t * @param {object} entityType - entity type object\n\t * @param {object} lineItem - line item object\n\t * @param {string} entitySet - entity set\n\t * @param {object} parentApp - parent app object\n\t * @param {object} metaModel - meta model object\n\t * @returns {object} returns card data\n\t * @private\n\t */\n\tprivate _getManifestCardData(\n\t\tmanifest: ICardManifest,\n\t\toEntityType: IEntityType,\n\t\tlineItem: Array<ILineItemContext>,\n\t\tentitySet: IEntitySet | string,\n\t\toParentApp: unknown,\n\t\toMetaModel: ODataMetaModel\n\t): IManifestCardData {\n\t\tconst mainServiceUri = manifest?.[\"sap.app\"]?.dataSources.mainService.uri;\n\t\tconst serviceUrl =\n\t\t\tmainServiceUri?.[mainServiceUri.length - 1] === \"/\"\n\t\t\t\t? mainServiceUri + (entitySet as string)\n\t\t\t\t: mainServiceUri + \"/\" + (entitySet as string);\n\n\t\t//get the column details for each of the lineitem columns\n\t\tconst aColumns = lineItem\n\t\t\t?.map((oColumn) => {\n\t\t\t\treturn this._getColumnDetail(oEntityType, oMetaModel, oColumn);\n\t\t\t})\n\t\t\t.filter(function (oItem) {\n\t\t\t\t// if no column or if path of column is complex path then filter it out\n\t\t\t\treturn oItem !== undefined && (oItem as { path: string }).path.split(\"/\").length <= 1;\n\t\t\t});\n\t\t//sort  the column based on their importance and then splice the first 4 columns\n\t\tconst aColumnSorted = DataFormatUtils.sortCollectionByImportance(aColumns)\n\t\t\t.map((column) => {\n\t\t\t\ttype prop = { path: string; type: string; value: string };\n\t\t\t\treturn { path: (column as prop).path, type: (column as prop).type, value: (column as prop).value };\n\t\t\t})\n\t\t\t.splice(0, 4);\n\t\treturn {\n\t\t\tcardTitle: manifest?.[\"sap.app\"]?.title,\n\t\t\tsubTitle: oEntityType[\"com.sap.vocabularies.Common.v1.Label\"]\n\t\t\t\t? \"Top 5 \" + oEntityType[\"com.sap.vocabularies.Common.v1.Label\"].String\n\t\t\t\t: \"\",\n\t\t\turl: serviceUrl + \"?$top=5&skip=0\",\n\t\t\tsemanticObject: (oParentApp as { semanticObject: string }).semanticObject,\n\t\t\taction: (oParentApp as { action: string }).action,\n\t\t\tid: manifest?.[\"sap.app\"]?.id,\n\t\t\tcolumns: aColumnSorted\n\t\t};\n\t}\n\n\t/**\n\t * Load I18n\n\t *\n\t * @param {object} manifest - manifest object\n\t * @param {string} manifestUrl - manifest url\n\t * @returns {object} returns resource bundle\n\t * @private\n\t */\n\tprivate async loadI18n(manifest: ICardManifest, manifestUrl: string) {\n\t\t// construct abslute url for properties file relative to manifest url\n\t\tconst i18nBundleUrl = manifest?.[\"sap.app\"]?.[\"i18n\"][\"bundleUrl\"] as string;\n\t\tconst absoluteUrl = new URL(i18nBundleUrl, manifestUrl).href;\n\t\tthis._RBManifestMap = this._RBManifestMap || {};\n\t\tif (!this._RBManifestMap[absoluteUrl]) {\n\t\t\tconst oResourceBundle = await ResourceBundle.create({\n\t\t\t\t// specify url of the base .properties file\n\t\t\t\tbundleUrl: absoluteUrl,\n\t\t\t\tasync: true,\n\t\t\t\tterminologies: manifest[\"sap.app\"]?.[\"i18n\"][\"terminologies\"]\n\t\t\t});\n\t\t\tthis._RBManifestMap[absoluteUrl] = oResourceBundle;\n\t\t}\n\t\treturn this._RBManifestMap[absoluteUrl];\n\t}\n\n\t/**\n\t * Get I18n Value Or Default String\n\t *\n\t * @param {string} sValue - value\n\t * @param {object} oResourceBundle - resource bundle object\n\t * @returns {string} returns string\n\t * @private\n\t */\n\tprivate getI18nValueOrDefaultString(sValue: string, oRB: ResourceBundle) {\n\t\tlet sPath = \"\";\n\t\tif (sValue && sValue.startsWith(\"{{\")) {\n\t\t\tsPath = sValue.substring(2, sValue.length - 2);\n\t\t} else if (sValue && sValue.startsWith(\"{\")) {\n\t\t\tsPath = sValue.substring(1, sValue.length - 1);\n\t\t}\n\t\treturn sPath ? oRB.getText(sPath) : sValue;\n\t}\n\n\t/**\n\t * Get Attribute Value\n\t *\n\t * @param {object} oColumn - column object\n\t * @returns {string} returns attribute value\n\t * @private\n\t */\n\tprivate _getAttributeValue(oAttribute: unknown) {\n\t\ttype attribute = { value: string; path: string; type: string };\n\t\tlet oAttributeValue = !(oAttribute as attribute).value.startsWith(\"{\")\n\t\t\t? \"{= extension.formatters.stringFormatter(${\" + (oAttribute as attribute).path + \"}) }\"\n\t\t\t: (oAttribute as attribute).value;\n\t\tif ((oAttribute as attribute).type === \"Edm.Date\" || (oAttribute as attribute).type === \"Edm.DateTime\") {\n\t\t\tconst oDateFormatOptions = JSON.stringify({\n\t\t\t\tpattern: Formatting.getDatePattern(\"short\")\n\t\t\t});\n\t\t\toAttributeValue =\n\t\t\t\t\"{=${\" +\n\t\t\t\t(oAttribute as attribute).path +\n\t\t\t\t\"}?format.dateTime(${\" +\n\t\t\t\t(oAttribute as attribute).path +\n\t\t\t\t\"}, \" +\n\t\t\t\toDateFormatOptions +\n\t\t\t\t\") : ''}\";\n\t\t}\n\t\treturn oAttributeValue;\n\t}\n\n\t/**\n\t * Get Manifest\n\t *\n\t * @param {object} cardInput - card input object\n\t * @returns {object} returns manifest\n\t * @private\n\t */\n\tprivate _getManifest(oInput: IManifestCardData) {\n\t\tconst cardSkeletonCopy = JSON.parse(JSON.stringify(CardSkeleton)) as ICardManifest;\n\t\tconst oApp = cardSkeletonCopy[\"sap.app\"];\n\t\tconst oCard = cardSkeletonCopy[\"sap.card\"];\n\t\tif (oApp) {\n\t\t\toApp.id = \"user.\" + oInput.id + \".\" + Date.now();\n\t\t\toApp.title = (oCard.header as { title: string }).title = oInput.cardTitle as string;\n\t\t\toApp.subTitle = (oCard.header as { subTitle: string }).subTitle = oInput.subTitle;\n\t\t}\n\t\tconst oContent = oCard.content;\n\t\toContent.item.title = this._getAttributeValue(oInput.columns[0]);\n\t\toContent.item.description = this._getAttributeValue(oInput.columns[1]);\n\t\toContent.item.attributes[0] = {\n\t\t\tvalue: this._getAttributeValue(oInput.columns[2]),\n\t\t\tvisible: \"{= !!${\" + (oInput.columns[2] as { path: string }).path + \"} }\"\n\t\t};\n\t\toContent.data.request.url = oInput.url;\n\n\t\toContent.item.actions = oCard.header.actions = [\n\t\t\t{\n\t\t\t\ttype: \"Navigation\",\n\t\t\t\tparameters: {\n\t\t\t\t\tibnTarget: {\n\t\t\t\t\t\tsemanticObject: oInput.semanticObject,\n\t\t\t\t\t\taction: oInput.action\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tcardSkeletonCopy[\"sap.insights\"] = {\n\t\t\tparentAppId: oInput.id as string,\n\t\t\tcardType: \"RT\",\n\t\t\tversions: {\n\t\t\t\tui5: this.versionInfo.version + \"-\" + this.versionInfo.buildTimestamp\n\t\t\t},\n\t\t\tvisible: true\n\t\t};\n\n\t\treturn cardSkeletonCopy;\n\t}\n\n\t/**\n\t * Fetch Card Mainfest\n\t *\n\t * @param {string[]} aAppIds - array of app ids\n\t * @returns {Promise} resolves to array of card manifest\n\t * @private\n\t */\n\tprivate async _getCardMainfest(aAppIds: string[]) {\n\t\tconst [aInbounds, aCatalog] = await Promise.all([this._getInboundApps(), this._getCatalogApps()]);\n\t\tthis.versionInfo = (await VersionInfo.load()) as { version: string; buildTimestamp: string };\n\n\t\tlet aAppUrls = aAppIds\n\t\t\t.map((appId) => {\n\t\t\t\tconst oApp = aInbounds.find((oItem) => {\n\t\t\t\t\treturn oItem?.signature?.parameters?.[\"sap-fiori-id\"]?.defaultValue?.value === appId;\n\t\t\t\t});\n\n\t\t\t\tif (oApp) {\n\t\t\t\t\tconst oViz = aCatalog.find((oCatalog) => {\n\t\t\t\t\t\treturn oApp.semanticObject === oCatalog.target?.semanticObject && oApp.action === oCatalog.target?.action;\n\t\t\t\t\t});\n\t\t\t\t\treturn (oViz && oApp?.resolutionResult?.applicationDependencies?.manifest) as string;\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t})\n\t\t\t.filter((url) => {\n\t\t\t\treturn url !== undefined;\n\t\t\t});\n\n\t\tconst aManifestPromises = aAppUrls.map(async (url) => {\n\t\t\tconst response = await fetch(String(url));\n\t\t\tconst manifest = (await response.json()) as ICardManifest;\n\t\t\treturn {\n\t\t\t\turl: response.url,\n\t\t\t\tmanifest: manifest\n\t\t\t};\n\t\t});\n\n\t\tconst aManifest = await Promise.all(aManifestPromises);\n\n\t\tconst validManifests = aManifest.filter((manifestObj) => {\n\t\t\treturn this._checkValidManifests(manifestObj.manifest);\n\t\t});\n\n\t\tconst odataPromises = validManifests.map((manifestObj) => {\n\t\t\treturn this._getOdataModel(manifestObj.manifest).then((model) => {\n\t\t\t\treturn (model as Model).getMetaModel();\n\t\t\t});\n\t\t});\n\n\t\tconst aMetaModel = await Promise.all(odataPromises);\n\t\tconst cardPromises = validManifests.map(async (manifestObj, index) => {\n\t\t\ttry {\n\t\t\t\tconst oMetaModel = aMetaModel[index] as ODataMetaModel;\n\t\t\t\tconst entitySet = this._getEntitySet(manifestObj.manifest);\n\t\t\t\tif (!entitySet) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\tconst oEntitySet = oMetaModel.getODataEntitySet(entitySet as string) as IEntitySet;\n\t\t\t\tconst oEntityType = oMetaModel.getODataEntityType(oEntitySet.entityType) as IEntityType;\n\t\t\t\tconst oLineItem = oEntityType[\"com.sap.vocabularies.UI.v1.LineItem\"];\n\t\t\t\tif (!oLineItem || this._hasMandatoryProperties(oEntitySet, oEntityType.property)) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\tconst parameterDetails = this._getParametersisedEntitySetParams(oMetaModel, entitySet as string, true);\n\t\t\t\tif (parameterDetails && parameterDetails.entitySetName && parameterDetails.parameters.length) {\n\t\t\t\t\tconst paramEntitySet = oMetaModel.getODataEntitySet(parameterDetails.entitySetName) as EntitySet;\n\t\t\t\t\tif (this._hasMandatoryProperties(paramEntitySet, parameterDetails.parameters as Property[])) {\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst oParentApp = aInbounds.find(function (oApp) {\n\t\t\t\t\treturn oApp.resolutionResult && oApp.resolutionResult.ui5ComponentName === manifestObj?.manifest?.[\"sap.app\"]?.id;\n\t\t\t\t});\n\t\t\t\tconst cardInput = this._getManifestCardData(\n\t\t\t\t\tmanifestObj.manifest,\n\t\t\t\t\toEntityType,\n\t\t\t\t\toLineItem,\n\t\t\t\t\tentitySet as IEntitySet,\n\t\t\t\t\toParentApp as unknown,\n\t\t\t\t\toMetaModel\n\t\t\t\t);\n\t\t\t\t// if less than 3 columns are present in the card, then do not recommend the card\n\t\t\t\tif (cardInput.columns.length < 3) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\tif (typeof manifestObj?.manifest?.[\"sap.app\"]?.i18n === \"object\") {\n\t\t\t\t\tconst i18nBundleUrl = manifestObj.manifest[\"sap.app\"].i18n.bundleUrl;\n\t\t\t\t\t//if manifest title is not resolved load the resource bundle of the parent app and get the text\n\t\t\t\t\tif (\n\t\t\t\t\t\ti18nBundleUrl &&\n\t\t\t\t\t\t(manifestObj.manifest[\"sap.app\"].title.startsWith(\"i18n>\") || manifestObj.manifest[\"sap.app\"].title.startsWith(\"{\"))\n\t\t\t\t\t) {\n\t\t\t\t\t\tconst i18nResourceBundle = await this.loadI18n(manifestObj.manifest, manifestObj.url);\n\t\t\t\t\t\tcardInput.cardTitle = this.getI18nValueOrDefaultString(cardInput.cardTitle as string, i18nResourceBundle);\n\t\t\t\t\t\treturn this._getManifest(cardInput);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this._getManifest(cardInput);\n\t\t\t} catch (error) {\n\t\t\t\tLog.error(error as string);\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t});\n\n\t\tconst cards = await Promise.all(cardPromises);\n\t\treturn cards.filter((card) => {\n\t\t\treturn card !== undefined;\n\t\t});\n\t}\n\n\t/**\n\t * Remove Duplicate Cards\n\t *\n\t * @param {object[]} aCards - array of cards\n\t * @returns {object[]} returns array of cards\n\t * @private\n\t */\n\tprivate _removeDuplicateCards(aCards: ICard[]) {\n\t\tconst oCardDict: Record<string, unknown> = {};\n\t\tconst aResult: ICard[] = [];\n\t\taCards.forEach((oCard) => {\n\t\t\tconst sCardTitle = oCard?.descriptorContent?.[\"sap.card\"]?.header?.title || \"\";\n\t\t\tif (!oCardDict[sCardTitle]) {\n\t\t\t\taResult.push(oCard);\n\t\t\t\toCardDict[sCardTitle] = true;\n\t\t\t}\n\t\t});\n\t\treturn aResult;\n\t}\n\n\t/**\n\t * Fetch Recommended Cards\n\t *\n\t * @returns {Promise} resolves to array of recommended cards\n\t * @private\n\t */\n\tpublic async getRecommenedCards() {\n\t\ttry {\n\t\t\tconst aAppIds = await this._getRecommenedFioriIds();\n\t\t\tconst aManifests = await this._getCardMainfest(aAppIds);\n\t\t\tconst aRecManifests = aManifests.slice(0, RECOMMENDED_CARD_LIMIT);\n\t\t\tconst aRecommendedCards = aRecManifests.map((manifest) => {\n\t\t\t\tlet id;\n\t\t\t\tif (manifest) {\n\t\t\t\t\tmanifest[\"sap.card\"].rec = true;\n\t\t\t\t\tid = manifest[\"sap.app\"]?.id as string;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tid,\n\t\t\t\t\tdescriptorContent: manifest\n\t\t\t\t};\n\t\t\t});\n\t\t\treturn this._removeDuplicateCards(aRecommendedCards as ICard[]);\n\t\t} catch (error) {\n\t\t\tLog.error(\"Error while fetching recommended cards: \" + (error as Error).message);\n\t\t\treturn [];\n\t\t}\n\t}\n\n\t/**\n\t * Retrieves a list of recommended visualizations for the user.\n\t *\n\t * The final list is composed of up to 10 recommendations, with must-include visualizations prioritized.\n\t * If no recommended visualizations are available or if an error occurs, it returns an empty array.\n\t *\n\t * @private\n\t * @async\n\t * @param {boolean} [forceRefresh=false] - If `true`, forces a refresh of the recommended visualizations\n\t *                                         regardless of whether they are cached.\n\t * @returns {Promise<ICustomVisualization[]>} A promise that resolves to an array of recommended visualizations.\n\t *                                            The array is limited to 10 visualizations, including must-include recommendations.\n\t */\n\tpublic async getRecommendedVisualizations(forceRefresh: boolean = false) {\n\t\tif (!this._recommendedVisualizations || forceRefresh) {\n\t\t\tconst recommendedFioriIds = await this._getRecommenedFioriIds(forceRefresh);\n\t\t\tif (recommendedFioriIds.length) {\n\t\t\t\tlet finalRecommendations: ICustomVisualization[] = [];\n\t\t\t\tlet mustIncludeRecommendations: ICustomVisualization[] = [];\n\t\t\t\tlet [recommendedVisualizations, favoriteVisualizations] = await Promise.all([\n\t\t\t\t\tthis._getVisualizationsByFioriIds(recommendedFioriIds),\n\t\t\t\t\tthis._fetchMyHomeVizs(forceRefresh)\n\t\t\t\t]);\n\t\t\t\t//filter out recommendations that are already added\n\t\t\t\trecommendedVisualizations = recommendedVisualizations.filter((recViz) =>\n\t\t\t\t\t_isVisualizationAlreadyAdded(recViz, favoriteVisualizations)\n\t\t\t\t);\n\t\t\t\trecommendedVisualizations.forEach((recViz) => {\n\t\t\t\t\tif (_isMustIncludeRecommendation(recViz)) {\n\t\t\t\t\t\tmustIncludeRecommendations.push(recViz);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfinalRecommendations.push(recViz);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t//return only 10 recommended apps along with 'MyInbox' and 'Manage My Timesheet' if user has access to these apps.\n\t\t\t\tthis._recommendedVisualizations = finalRecommendations\n\t\t\t\t\t.slice(0, 10 - mustIncludeRecommendations.length)\n\t\t\t\t\t.concat(mustIncludeRecommendations);\n\t\t\t} else {\n\t\t\t\tthis._recommendedVisualizations = [];\n\t\t\t}\n\t\t}\n\t\treturn this._recommendedVisualizations;\n\t}\n\n\t/**\n\t * Asynchronously retrieves the list of inbound applications from the SAP Fiori client-side target resolution service.\n\t *\n\t * @private\n\t * @async\n\t * @returns {Promise<Array>} A promise that resolves to an array of inbound applications.\n\t *                            If an error occurs or the inbound applications are not available, it resolves to an empty array.\n\t */\n\tprivate async _getInboundApps() {\n\t\ttry {\n\t\t\tconst service = await Container.getServiceAsync<ClientSideTargetResolution>(\"ClientSideTargetResolution\");\n\t\t\treturn service?._oAdapter?._aInbounds || [];\n\t\t} catch (error) {\n\t\t\tLog.error(\"Error while fetching inbound apps: \" + (error as Error).message);\n\t\t\treturn [];\n\t\t}\n\t}\n\n\t/**\n\t * Retrieves visualizations based on a list of Fiori IDs.\n\t *\n\t * This function processes the given Fiori IDs to find associated visualizations. It does so by fetching\n\t * inbound applications and catalog apps, then matching the Fiori IDs to filter out and gather relevant visualizations.\n\t * The function distinguishes between GUI and non-GUI visualizations, prioritizing non-GUI visualizations if both types are found.\n\t * It also ensures that each visualization is unique based on its URL and title, avoiding duplicates.\n\t *\n\t * @private\n\t * @async\n\t * @param {string[]} fioriIds - An array of Fiori IDs to search for visualizations.\n\t * @returns {Promise<ICustomVisualization[]>} A promise that resolves to an array of unique visualizations associated with the provided Fiori IDs.\n\t */\n\tprivate async _getVisualizationsByFioriIds(fioriIds: string[]) {\n\t\tconst visualizations: ICustomVisualization[] = [];\n\t\tconst visitedVisualizations: Map<string, boolean> = new Map<string, boolean>();\n\t\tconst [inbounds, catalogApps] = await Promise.all([this._getInboundApps(), this._getCatalogApps()]);\n\t\tfioriIds.forEach((fioriId) => {\n\t\t\t// get all inbounds with the fiori id\n\t\t\tconst authorizedApps = inbounds.filter(function (inbound) {\n\t\t\t\treturn inbound?.signature.parameters[\"sap-fiori-id\"]?.defaultValue?.value === fioriId;\n\t\t\t});\n\t\t\tauthorizedApps.forEach((app) => {\n\t\t\t\t//filter apps that matched semantic object action\n\t\t\t\tlet matchingVizualizations = catalogApps.filter((catalogApp) => {\n\t\t\t\t\treturn catalogApp?.target?.semanticObject === app.semanticObject && catalogApp.target.action === app.action;\n\t\t\t\t});\n\n\t\t\t\tconst guiVisualizations = matchingVizualizations.filter((matchingVizualization) =>\n\t\t\t\t\t_isGUIVisualization(matchingVizualization)\n\t\t\t\t);\n\t\t\t\tconst nonGuiVisualizations = matchingVizualizations.filter(\n\t\t\t\t\t(matchingVizualization) => !_isGUIVisualization(matchingVizualization)\n\t\t\t\t);\n\t\t\t\t//if both gui and non-gui visualizations exists, then consider only non-gui visualizations for recommendation.\n\t\t\t\tif (guiVisualizations.length > 0 && nonGuiVisualizations.length > 0) {\n\t\t\t\t\tmatchingVizualizations = [...nonGuiVisualizations];\n\t\t\t\t}\n\n\t\t\t\tmatchingVizualizations.forEach((matchingVizualization) => {\n\t\t\t\t\tlet visualization = matchingVizualization.visualizations[0];\n\t\t\t\t\tlet recommendedVisualization: ICustomVisualization = {\n\t\t\t\t\t\ttitle: visualization.title,\n\t\t\t\t\t\tsubtitle: visualization.subtitle,\n\t\t\t\t\t\ticon: visualization.icon,\n\t\t\t\t\t\turl: visualization.targetURL,\n\t\t\t\t\t\tvizId: visualization.vizId,\n\t\t\t\t\t\tfioriId: fioriId,\n\t\t\t\t\t\tvisualization: visualization\n\t\t\t\t\t};\n\t\t\t\t\t//if app with same url or title already recommended, then don't consider it.\n\t\t\t\t\tif (\n\t\t\t\t\t\t!visitedVisualizations.has(recommendedVisualization.url!) ||\n\t\t\t\t\t\t!visitedVisualizations.has(recommendedVisualization.title!)\n\t\t\t\t\t) {\n\t\t\t\t\t\tvisitedVisualizations.set(recommendedVisualization.url!, true);\n\t\t\t\t\t\tvisitedVisualizations.set(recommendedVisualization.title!, true);\n\t\t\t\t\t\tvisualizations.push(recommendedVisualization);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t\treturn visualizations;\n\t}\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AAHA;;AAAAA,GAAA,CAAAC,EAAA,CAAAC,MAAA,4RAAAC,GAAA,EAAAC,UAAA,EAAAC,cAAA,EAAAC,WAAA,EAAAC,UAAA,EAAAC,YAAA,EAAAC,MAAA,EAAAC,SAAA,EAAAC,eAAA,EAAAC,YAAA,EAAAC,iBAAA,EAAAC,YAAA;EAAA;;EAAA,SAAAC,uBAAAC,GAAA;IAAA,OAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,WAAAD,GAAA,CAAAE,OAAA,mBAAAF,GAAA,CAAAE,OAAA,GAAAF,GAAA;EAAA;EAkjBO,SAAAG,OAAgBC,IAAI,EAAEC,OAAO,EAAE;IACrC,IAAI;MACH,IAAIC,MAAM,GAAGF,IAAI,CAAC,CAAC;IACpB,CAAC,CAAC,OAAMG,CAAC,EAAE;MACV,OAAOF,OAAO,CAACE,CAAC,CAAC;IAClB;IACA,IAAID,MAAM,IAAIA,MAAM,CAACE,IAAI,EAAE;MAC1B,OAAOF,MAAM,CAACE,IAAI,CAAC,KAAK,CAAC,EAAEH,OAAO,CAAC;IACpC;IACA,OAAOC,MAAM;EACd;EAAC,MAtiBQG,YAAY,GAAAd,eAAA;EAAA,MA8IRe,eAAA,GAAkB,aAAc,OAAOC,MAAM,KAAK,WAAW,GAAIA,MAAM,CAACC,QAAQ,KAAKD,MAAM,CAACC,QAAQ,GAAGD,MAAM,CAAC,iBAAiB,CAAC,CAAC,GAAI,YAAY;EA7HvJ,SAASE,OAAOA,CAACC,IAAI,EAAEC,KAAK,EAAEC,KAAK,EAAE;IAC3C,IAAI,CAACF,IAAI,CAACG,CAAC,EAAE;MACZ,IAAID,KAAK,YAAYE,KAAK,EAAE;QAC3B,IAAIF,KAAK,CAACC,CAAC,EAAE;UACZ,IAAIF,KAAK,GAAG,CAAC,EAAE;YACdA,KAAK,GAAGC,KAAK,CAACC,CAAC;UAChB;UACAD,KAAK,GAAGA,KAAK,CAACG,CAAC;QAChB,CAAC,MAAM;UACNH,KAAK,CAACI,CAAC,GAAGP,OAAO,CAACQ,IAAI,CAAC,IAAI,EAAEP,IAAI,EAAEC,KAAK,CAAC;UACzC;QACD;MACD;MACA,IAAIC,KAAK,IAAIA,KAAK,CAACR,IAAI,EAAE;QACxBQ,KAAK,CAACR,IAAI,CAACK,OAAO,CAACQ,IAAI,CAAC,IAAI,EAAEP,IAAI,EAAEC,KAAK,CAAC,EAAEF,OAAO,CAACQ,IAAI,CAAC,IAAI,EAAEP,IAAI,EAAE,CAAC,CAAC,CAAC;QACxE;MACD;MACAA,IAAI,CAACG,CAAC,GAAGF,KAAK;MACdD,IAAI,CAACK,CAAC,GAAGH,KAAK;MACd,MAAMM,QAAQ,GAAGR,IAAI,CAACM,CAAC;MACvB,IAAIE,QAAQ,EAAE;QACbA,QAAQ,CAACR,IAAI,CAAC;MACf;IACD;EACD;EAAC,MA9DYI,KAAA,GAAQ,aAAc,YAAW;IAC7C,SAAAA,MAAA,EAAiB,CAAC;IAClBA,KAAA,CAAMK,SAAS,CAACf,IAAI,GAAG,UAASgB,WAAW,EAAEC,UAAU,EAAE;MACxD,MAAMnB,MAAM,GAAG,IAAAY,KAAA,CAAU,CAAC;MAC1B,MAAMH,KAAK,GAAG,IAAI,CAACE,CAAC;MACpB,IAAIF,KAAK,EAAE;QACV,MAAMW,QAAQ,GAAGX,KAAK,GAAG,CAAC,GAAGS,WAAW,GAAGC,UAAU;QACrD,IAAIC,QAAQ,EAAE;UACb,IAAI;YACHb,OAAA,CAAQP,MAAM,EAAE,CAAC,EAAEoB,QAAQ,CAAC,IAAI,CAACP,CAAC,CAAC,CAAC;UACrC,CAAC,CAAC,OAAOZ,CAAC,EAAE;YACXM,OAAA,CAAQP,MAAM,EAAE,CAAC,EAAEC,CAAC,CAAC;UACtB;UACA,OAAOD,MAAM;QACd,CAAC,MAAM;UACN,OAAO,IAAI;QACZ;MACD;MACA,IAAI,CAACc,CAAC,GAAG,UAASO,KAAK,EAAE;QACxB,IAAI;UACH,MAAMX,KAAK,GAAGW,KAAK,CAACR,CAAC;UACrB,IAAIQ,KAAK,CAACV,CAAC,GAAG,CAAC,EAAE;YAChBJ,OAAA,CAAQP,MAAM,EAAE,CAAC,EAAEkB,WAAW,GAAGA,WAAW,CAACR,KAAK,CAAC,GAAGA,KAAK,CAAC;UAC7D,CAAC,MAAM,IAAIS,UAAU,EAAE;YACtBZ,OAAA,CAAQP,MAAM,EAAE,CAAC,EAAEmB,UAAU,CAACT,KAAK,CAAC,CAAC;UACtC,CAAC,MAAM;YACNH,OAAA,CAAQP,MAAM,EAAE,CAAC,EAAEU,KAAK,CAAC;UAC1B;QACD,CAAC,CAAC,OAAOT,CAAC,EAAE;UACXM,OAAA,CAAQP,MAAM,EAAE,CAAC,EAAEC,CAAC,CAAC;QACtB;MACD,CAAC;MACD,OAAOD,MAAM;IACd,CAAC;IACD,OAAAY,KAAA;EACD,CAAC,CAAE,CAAC;EA6BG,SAASU,cAAcA,CAACC,QAAQ,EAAE;IACxC,OAAOA,QAAQ,YAAYX,KAAK,IAAIW,QAAQ,CAACZ,CAAC,GAAG,CAAC;EACnD;EA+CO,SAASa,MAAMA,CAACC,KAAK,EAAE3B,IAAI,EAAE4B,KAAK,EAAE;IAC1C,IAAIC,CAAC,GAAG,CAAC,CAAC;MAAEnB,IAAI;MAAEoB,MAAM;IACxB,SAASC,MAAMA,CAAC7B,MAAM,EAAE;MACvB,IAAI;QACH,OAAO,EAAE2B,CAAC,GAAGF,KAAK,CAACK,MAAM,KAAK,CAACJ,KAAK,IAAI,CAACA,KAAK,CAAC,CAAC,CAAC,EAAE;UAClD1B,MAAM,GAAGF,IAAI,CAAC6B,CAAC,CAAC;UAChB,IAAI3B,MAAM,IAAIA,MAAM,CAACE,IAAI,EAAE;YAC1B,IAAIoB,cAAc,CAACtB,MAAM,CAAC,EAAE;cAC3BA,MAAM,GAAGA,MAAM,CAACa,CAAC;YAClB,CAAC,MAAM;cACNb,MAAM,CAACE,IAAI,CAAC2B,MAAM,EAAED,MAAM,KAAKA,MAAM,GAAGrB,OAAO,CAACQ,IAAI,CAAC,IAAI,EAAEP,IAAI,GAAG,IAAII,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;cACnF;YACD;UACD;QACD;QACA,IAAIJ,IAAI,EAAE;UACTD,OAAO,CAACC,IAAI,EAAE,CAAC,EAAER,MAAM,CAAC;QACzB,CAAC,MAAM;UACNQ,IAAI,GAAGR,MAAM;QACd;MACD,CAAC,CAAC,OAAOC,CAAC,EAAE;QACXM,OAAO,CAACC,IAAI,KAAKA,IAAI,GAAG,IAAII,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,EAAEX,CAAC,CAAC;MAC5C;IACD;IACA4B,MAAM,CAAC,CAAC;IACR,OAAOrB,IAAI;EACZ;EAAC,MApHAuB,gBAAgB,GAAAzC,YAAA;EAgJV,SAAS0C,MAAMA,CAACC,MAAM,EAAEnC,IAAI,EAAE4B,KAAK,EAAE;IAC3C,IAAI,OAAOO,MAAM,CAAC7B,eAAe,CAAC,KAAK,UAAU,EAAE;MAClD,IAAIE,QAAQ,GAAG2B,MAAM,CAAC7B,eAAe,CAAC,CAAC,CAAC;QAAE8B,IAAI;QAAE1B,IAAI;QAAEoB,MAAM;MAC5D,SAASC,MAAMA,CAAC7B,MAAM,EAAE;QACvB,IAAI;UACH,OAAO,CAAC,CAACkC,IAAI,GAAG5B,QAAQ,CAAC6B,IAAI,CAAC,CAAC,EAAEC,IAAI,KAAK,CAACV,KAAK,IAAI,CAACA,KAAK,CAAC,CAAC,CAAC,EAAE;YAC9D1B,MAAM,GAAGF,IAAI,CAACoC,IAAI,CAACxB,KAAK,CAAC;YACzB,IAAIV,MAAM,IAAIA,MAAM,CAACE,IAAI,EAAE;cAC1B,IAAIoB,cAAc,CAACtB,MAAM,CAAC,EAAE;gBAC3BA,MAAM,GAAGA,MAAM,CAACa,CAAC;cAClB,CAAC,MAAM;gBACNb,MAAM,CAACE,IAAI,CAAC2B,MAAM,EAAED,MAAM,KAAKA,MAAM,GAAGrB,OAAO,CAACQ,IAAI,CAAC,IAAI,EAAEP,IAAI,GAAG,IAAII,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;gBACnF;cACD;YACD;UACD;UACA,IAAIJ,IAAI,EAAE;YACTD,OAAO,CAACC,IAAI,EAAE,CAAC,EAAER,MAAM,CAAC;UACzB,CAAC,MAAM;YACNQ,IAAI,GAAGR,MAAM;UACd;QACD,CAAC,CAAC,OAAOC,CAAC,EAAE;UACXM,OAAO,CAACC,IAAI,KAAKA,IAAI,GAAG,IAAII,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,EAAEX,CAAC,CAAC;QAC5C;MACD;MACA4B,MAAM,CAAC,CAAC;MACR,IAAIvB,QAAQ,CAAC+B,MAAM,EAAE;QACpB,IAAIC,MAAM,GAAG,SAAAA,CAAS5B,KAAK,EAAE;UAC5B,IAAI;YACH,IAAI,CAACwB,IAAI,CAACE,IAAI,EAAE;cACf9B,QAAQ,CAAC+B,MAAM,CAAC,CAAC;YAClB;UACD,CAAC,CAAC,OAAMpC,CAAC,EAAE,CACX;UACA,OAAOS,KAAK;QACb,CAAC;QACD,IAAIF,IAAI,IAAIA,IAAI,CAACN,IAAI,EAAE;UACtB,OAAOM,IAAI,CAACN,IAAI,CAACoC,MAAM,EAAE,UAASrC,CAAC,EAAE;YACpC,MAAMqC,MAAM,CAACrC,CAAC,CAAC;UAChB,CAAC,CAAC;QACH;QACAqC,MAAM,CAAC,CAAC;MACT;MACA,OAAO9B,IAAI;IACZ;IACA;IACA,IAAI,EAAE,QAAQ,IAAIyB,MAAM,CAAC,EAAE;MAC1B,MAAM,IAAIM,SAAS,CAAC,wBAAwB,CAAC;IAC9C;IACA;IACA,IAAIC,MAAM,GAAG,EAAE;IACf,KAAK,IAAIb,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGM,MAAM,CAACH,MAAM,EAAEH,CAAC,EAAE,EAAE;MACvCa,MAAM,CAACC,IAAI,CAACR,MAAM,CAACN,CAAC,CAAC,CAAC;IACvB;IACA,OAAOH,MAAM,CAACgB,MAAM,EAAE,UAASb,CAAC,EAAE;MAAE,OAAO7B,IAAI,CAAC0C,MAAM,CAACb,CAAC,CAAC,CAAC;IAAE,CAAC,EAAED,KAAK,CAAC;EACtE;EAAC,MAtMAgB,aAAa,GAAApD,YAAA;EAAA,MACbqD,eAAe,GAAArD,YAAA;EAAA,MACfsD,uBAAuB,GAAAtD,YAAA;EAAA,MACvBuD,cAAc,GAAAvD,YAAA;EAAA,MACdwD,eAAe,GAAAxD,YAAA;EAAA,MACfyD,oBAAoB,GAAAzD,YAAA;EAAA,MACpB0D,uBAAuB,GAAA1D,YAAA;EAAA,MACvB2D,sBAAsB,GAAA3D,YAAA;EAAA,MAEhB4D,eAAe,GAAAzD,sBAAA,CAAAF,iBAAA;EAAA,MACf4D,UAAU,GAAA1D,sBAAA,CAAAD,YAAA;EAEjB,MAAM4D,SAAS,GAAG;IACjBC,4BAA4B,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;EAClD,CAAC;EA4DD,MAAMC,kBAAkB,GAAIC,MAAmC,IAAqC;IACnG,IAAIC,aAA6C,GAAG,CAAC,CAAC;IACtD,IAAID,MAAM,EAAE;MACX,IAAI,OAAOA,MAAM,KAAK,QAAQ,EAAE;QAC/BC,aAAa,GAAGD,MAAM;MACvB,CAAC,MAAM;QACN,IAAI;UACHC,aAAa,GAAGC,IAAI,CAACC,KAAK,CAACH,MAAM,CAAW;QAC7C,CAAC,CAAC,OAAOI,MAAM,EAAE;UAChB9E,GAAG,CAAC+E,KAAK,CAACD,MAAM,YAAYE,KAAK,GAAGF,MAAM,CAACG,OAAO,GAAGC,MAAM,CAACJ,MAAM,CAAC,CAAC;UACpEH,aAAa,GAAGQ,SAAS;QAC1B;MACD;IACD;IACA,OAAOR,aAAa;EACrB,CAAC;EAED,MAAMS,kBAAkB,GAAIC,YAA6B,IAAqC;IAC7F,IAAIC,eAA+C,GAAG,CAAC,CAAC;IACxD,IAAID,YAAY,EAAEE,kBAAkB,EAAEC,IAAI,EAAEC,aAAa,EAAE;MAC1D,MAAMC,OAAuC,GAAGjB,kBAAkB,CAACY,YAAY,CAACE,kBAAkB,CAACC,IAAI,CAACC,aAAa,CAAC;MACtH,IAAIC,OAAO,EAAEC,iBAAiB,EAAE;QAC/B,MAAMC,WAA2C,GAAGnB,kBAAkB,CAACiB,OAAO,CAACC,iBAAiB,CAAC;QACjG,IAAIC,WAAW,EAAE;UAChBN,eAAe,GAAGb,kBAAkB,CAACmB,WAAW,CAACC,eAAe,CAAC;QAClE;MACD;IACD;IACA,OAAOP,eAAe;EACvB,CAAC;EAED,MAAMQ,SAAS,GAAIT,YAAwC,IAAa;IACvE,IAAIU,MAAM,GAAG,EAAE;IACf,IAAIT,eAA+C,GAAG,CAAC,CAAC;IACxD,IAAID,YAAY,EAAEjC,MAAM,EAAE4C,cAAc,IAAIX,YAAY,EAAEjC,MAAM,EAAE6C,MAAM,EAAE;MACzEF,MAAM,GAAG,IAAIV,YAAY,CAACjC,MAAM,CAAC4C,cAAc,IAAIX,YAAY,CAACjC,MAAM,CAAC6C,MAAM,EAAE;IAChF,CAAC,MAAM,IAAIZ,YAAY,EAAEE,kBAAkB,EAAEC,IAAI,EAAEC,aAAa,EAAE;MACjEH,eAAe,GAAGF,kBAAkB,CAACC,YAAY,CAAC;MAClD,IAAIC,eAAe,EAAEU,cAAc,IAAIV,eAAe,EAAEY,cAAc,EAAE;QACvEH,MAAM,GAAG,IAAIT,eAAe,EAAEU,cAAc,IAAIV,eAAe,EAAEY,cAAc,EAAE;MAClF;IACD;IACA,OAAOH,MAAM;EACd,CAAC;EAED,MAAMI,aAAa,GAAId,YAAwC,IAAK;IACnE,IAAIe,UAAU,GAAGN,SAAS,CAACT,YAAY,CAAC,IAAI,EAAE;IAC9C,MAAMC,eAAe,GAAGF,kBAAkB,CAACC,YAAY,CAAC;IACxD,IAAIC,eAAe,EAAEe,YAAY,EAAE;MAClCD,UAAU,IAAI,gBAAgB,GAAGd,eAAe,CAACe,YAAY;IAC9D;IACA,OAAOD,UAAU;EAClB,CAAC;EAED,MAAME,oBAAoB,GAAIC,cAA8B,IAAc;IACzE,OAAOA,cAAc,CAACC,OAAO,EAAEC,UAAU,CAAC,oBAAoB,CAAC;EAChE,CAAC;;EAED;EACA,MAAMC,oBAAoB,GAAGA,CAACC,IAAoB,EAAEtB,YAA4B,KAA0C;IACzH,MAAMuB,YAAY,GAAGvB,YAAY,EAAEE,kBAAkB,EAAEC,IAAI,EAAEqB,IAAI,EAAEC,iBAAiB,EAAEC,KAAK;IAC3F,OAAO;MACNC,KAAK,EAAEL,IAAI,CAACK,KAAK,GAAGL,IAAI,CAACK,KAAK,GAAGJ,YAAY,EAAEI,KAAK,IAAI,EAAE;MAC1DC,QAAQ,EAAEN,IAAI,CAACM,QAAQ,GAAGN,IAAI,CAACM,QAAQ,GAAGL,YAAY,EAAEM,WAAW,IAAI;IACxE,CAAC;EACF,CAAC;;EAED;AACA;AACA;AACA;AACA;AACA;AACA;EACA,MAAMC,kBAAkB,GAAIC,KAA6B,IAAK;IAC7DA,KAAK,CAACC,OAAO,CAAEC,aAAa,IAAK;MAChCF,KAAK,CACHG,MAAM,CACLC,IAAI,IACJA,IAAI,CAACC,KAAK,KAAKH,aAAa,CAACG,KAAK,IAClCD,IAAI,EAAEE,aAAa,EAAEC,EAAE,KAAKL,aAAa,EAAEI,aAAa,EAAEC,EAAE,IAC5DH,IAAI,CAACI,UAAU,EAAEC,YAAY,KAAKP,aAAa,CAACM,UAAU,EAAEC,YAC9D,CAAC,CACAR,OAAO,CAAEG,IAAI,IAAK;QAClBA,IAAI,EAAEI,UAAU,EAAEE,aAAa,EAAElE,IAAI,CAAC0D,aAAa,CAAC;MACrD,CAAC,CAAC;IACJ,CAAC,CAAC;IAEF,OAAOF,KAAK;EACb,CAAC;EAED,MAAMW,mBAAmB,GAAIL,aAAsB,IAAK;IACvD,OAAOA,aAAa,EAAEtE,MAAM,EAAE4E,UAAU,GAAG,kBAAkB,CAAC,EAAEnG,KAAK,EAAEA,KAAK,KAAK,KAAK;EACvF,CAAC;EAED,MAAMoG,4BAA4B,GAAIC,MAA4B,IAAK;IACtE,OAAOA,MAAM,CAACC,OAAO,IAAI5D,SAAS,CAACC,4BAA4B,CAAC4D,QAAQ,CAACF,MAAM,CAACC,OAAO,CAAC;EACzF,CAAC;EAED,MAAME,4BAA4B,GAAGA,CAACX,aAAmC,EAAEY,sBAA8C,KAAK;IAC7H,OAAO,CAACA,sBAAsB,CAACC,IAAI,CACjCC,MAAM,IACNA,MAAM,CAACd,aAAa,EAAEtE,MAAM,EAAE4C,cAAc,KAAK0B,aAAa,CAACA,aAAa,EAAEtE,MAAM,EAAE4C,cAAc,IACpGwC,MAAM,CAACd,aAAa,EAAEtE,MAAM,EAAE6C,MAAM,KAAKyB,aAAa,CAACA,aAAa,EAAEtE,MAAM,EAAE6C,MAChF,CAAC;EACF,CAAC;;EAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACe,MAAMwC,UAAU,SAASrI,UAAU,CAAC;IAC1CsI,aAAa,GAA0D,EAAE;IAEzEC,uBAAuB,GAAY,KAAK;IAUxCC,eAAe,GAAY,KAAK;IAEhCC,WAAWA,CAAA,EAAG;MACrB,KAAK,CAAC,CAAC;IACR;IAEA,OAAOC,WAAWA,CAAA,EAAG;MACpB,IAAI,CAACL,UAAU,CAACM,QAAQ,EAAE;QACzBN,UAAU,CAACM,QAAQ,GAAG,IAAIN,UAAU,CAAC,CAAC;MACvC;MACA,OAAOA,UAAU,CAACM,QAAQ;IAC3B;IACA;AACD;AACA;AACA;AACA;AACA;AACA;AACA;IACeC,sBAAsBA,CAACC,aAAsB;MAAA,IAAkB;QAAA,MAAAzG,KAAA,GAG5E,IAAI;QAAA,OAAA0G,OAAA,CAAAC,OAAA,CAF+B5I,SAAS,CAAC6I,eAAe,CAAe,cAAc,CAAC,EAAA/H,IAAA,WAApFgI,oBAAoB;UAC1B,IAAIC,gBAAgC;UACpC9G,KAAA,CAAKkG,aAAa,GAAGlG,KAAA,CAAKkG,aAAa,IAAI,EAAE;;UAE7C;UACA,MAAMa,cAAc,GAAG/G,KAAA,CAAKkG,aAAa,CAACc,IAAI,CAAEC,QAAQ,IAAKA,QAAQ,CAACC,MAAM,KAAK1F,cAAc,CAAC;UAChG,IAAI,CAACuF,cAAc,IAAIN,aAAa,KAAK,IAAI,IAAIzG,KAAA,CAAKoG,eAAe,KAAK,IAAI,EAAE;YAC/EpG,KAAA,CAAKoG,eAAe,GAAG,KAAK;YAC5BU,gBAAgB,GAAGD,oBAAoB,CAACM,OAAO,CAAC3F,cAAc,CAAC;YAC/D,IAAIuF,cAAc,EAAE;cACnBA,cAAc,CAACK,eAAe,GAAGN,gBAAgB;YAClD,CAAC,MAAM;cACN9G,KAAA,CAAKkG,aAAa,CAAC9E,IAAI,CAAC;gBACvB8F,MAAM,EAAE1F,cAAc;gBACtB4F,eAAe,EAAEN;cAClB,CAAC,CAAC;YACH;UACD,CAAC,MAAM;YACNA,gBAAgB,GAAGC,cAAc,CAACK,eAAe;UAClD;UAEA,OAAON,gBAAgB;QAAC;MACzB,CAAC,QAAAlI,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IACD;AACD;AACA;AACA;AACA;AACA;AACA;IACSyI,iBAAiBA,CAACZ,aAAsB,EAAE;MACjD,OAAO,IAAI,CAACa,YAAY,CAACb,aAAa,EAAE,IAAI,CAAC,CAAC5H,IAAI,CAAE0I,QAAgC,IACnFA,QAAQ,CAACxC,MAAM,CAAEyC,OAAO,IAAKA,OAAO,CAACC,OAAO,IAAID,OAAO,CAACE,mBAAmB,CAC5E,CAAC;IACF;IACA;AACD;AACA;AACA;AACA;AACA;AACA;IACcC,YAAYA,CAAA;MAAA,IAAClB,aAAsB,GAAAmB,SAAA,CAAAnH,MAAA,QAAAmH,SAAA,QAAAjF,SAAA,GAAAiF,SAAA,MAAG,KAAK;MAAA,IAAuB;QAAA,MAAAC,MAAA,GACnD,IAAI;QAAA,OAAAnB,OAAA,CAAAC,OAAA,CAAJkB,MAAA,CAAKrB,sBAAsB,CAACC,aAAa,CAAC,EAAA5H,IAAA,WAA/DiJ,KAAY;UAClB,MAAMC,SAAS,GAAID,KAAK,IAAIA,KAAK,CAACE,QAAQ,IAAK,EAAE;YAChDC,sBAA8B,GAAGF,SAAS,CAACG,SAAS,CAAEC,QAAQ,IAAKA,QAAQ,CAAC5J,OAAO,CAAC;UAAC,IAClF0J,sBAAsB,GAAG,CAAC;YAAA,SAAAG,OAAA;cAK7B,OAAOP,MAAA,CAAKF,YAAY,CAAC,IAAI,CAAC;YAAC;YAAA,MAAAU,KAAA;cAAA,IAJ3BR,MAAA,CAAKS,iBAAiB,KAAK3F,SAAS;gBACvCkF,MAAA,CAAKS,iBAAiB,GAAGT,MAAA,CAAKU,WAAW,CAACN,sBAAsB,EAAE,CAAC,CAAC;gBAAC,OAAAvB,OAAA,CAAAC,OAAA,CAC/DkB,MAAA,CAAKS,iBAAiB,EAAAzJ,IAAA;cAAA;YAAA;YAAA,OAAAwJ,KAAA,IAAAA,KAAA,CAAAxJ,IAAA,GAAAwJ,KAAA,CAAAxJ,IAAA,CAAAuJ,MAAA,IAAAA,MAAA,CAAAC,KAAA;UAAA;YAI7B,OAAON,SAAS;UAAC;QAAA;MAEnB,CAAC,QAAAnJ,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IACD;AACD;AACA;AACA;AACA;AACA;AACA;IACe4J,gBAAgBA,CAAC/B,aAAsB;MAAA,IAAmC;QAAA,MAAAgC,MAAA,GAE/D,IAAI;QAD5B,MAAM7D,KAA6B,GAAG,EAAE;QAAC,OAAA8B,OAAA,CAAAC,OAAA,CACjB8B,MAAA,CAAKd,YAAY,CAAClB,aAAa,CAAC,EAAA5H,IAAA,WAAlDkJ,SAAS;UACfA,SAAS,CAAClD,OAAO,CAAC,CAACsD,QAAkB,EAAEO,aAAqB,KAAK;YAChEP,QAAQ,EAAEQ,cAAc,EAAE9D,OAAO,CAAC,CAACd,cAA8B,EAAE6E,mBAA2B,KAAK;cAClG,MAAMC,SAAS,GAAG9E,cAAc,CAAC8E,SAAS;gBACzCC,QAAQ,GAAGD,SAAS,GAAG,SAAS,CAAC,IAAK;kBAAErE,KAAK,EAAE;gBAAI,CAAoB;gBACvEQ,IAAI,GAAG,CAAC,CAAyB;cAElCA,IAAI,CAAC+D,QAAQ,GAAGzF,SAAS,CAACuF,SAAS,GAAG,SAAS,CAAC,CAAC;cACjD7D,IAAI,CAACC,KAAK,GAAGlB,cAAc,EAAEiF,SAAS,CAAC,CAAC;cACxChE,IAAI,CAACiE,GAAG,GAAGlF,cAAc,EAAEiF,SAAS;cACpC,IAAI,CAAChE,IAAI,CAACiE,GAAG,IAAInF,oBAAoB,CAACC,cAAc,CAAC,EAAE;gBACtDiB,IAAI,CAACiE,GAAG,GAAGtF,aAAa,CAACkF,SAAS,GAAG,SAAS,CAAC,CAAC;cACjD;cACA7D,IAAI,CAACkE,OAAO,GAAGrH,eAAe,CAACsH,UAAU,CAACnE,IAAI,CAACiE,GAAG,CAAC;cACnDjE,IAAI,CAACR,KAAK,GAAGT,cAAc,EAAES,KAAK,IAAIN,oBAAoB,CAAC4E,QAAQ,EAAE/E,cAAc,CAAC,EAAES,KAAK;cAC3FQ,IAAI,CAACP,QAAQ,GAAGV,cAAc,CAACU,QAAQ,IAAIP,oBAAoB,CAAC4E,QAAQ,EAAE/E,cAAc,CAAC,CAACU,QAAQ;cAClGO,IAAI,CAACoE,OAAO,GAAG1I,gBAAgB,CAAC,CAAC,CAAC2I,GAAG;cACrCrE,IAAI,CAACsE,KAAK,GAAG,IAAI;cACjBtE,IAAI,CAACuE,SAAS,GAAG,KAAK;cACtBvE,IAAI,CAACwE,IAAI,GAAGX,SAAS,GAAG,QAAQ,CAAC,EAAEY,KAAK,EAAED,IAAI,IAAInI,aAAa;cAC/D,IAAI0C,cAAc,EAAE2F,mBAAmB,EAAE;gBACxC1E,IAAI,CAACyC,OAAO,GAAG,IAAI;gBACnBzC,IAAI,CAAC0E,mBAAmB,GAAG3F,cAAc,CAAC2F,mBAAmB,CAACC,IAAI;gBAClE3E,IAAI,CAAC4E,iBAAiB,GAAG7F,cAAc,CAAC6F,iBAAiB;cAC1D;cACA5E,IAAI,CAAC0C,mBAAmB,GAAG5D,oBAAoB,CAACC,cAAc,CAAC;cAC/D;cACAiB,IAAI,CAACI,UAAU,GAAG;gBACjB8B,MAAM,EAAE1F,cAAc;gBACtBqI,YAAY,EAAE1B,QAAQ,CAAC3D,KAAK;gBAC5BsF,SAAS,EAAE3B,QAAQ,CAAChD,EAAE;gBACtBE,YAAY,EAAEqD,aAAa;gBAC3BqB,kBAAkB,EAAEnB,mBAAmB;gBACvCoB,gBAAgB,EAAE7B,QAAQ,CAAC5J,OAAO;gBAClC0L,eAAe,EAAE9B,QAAQ,CAAC+B,MAAM;gBAChC5E,aAAa,EAAE;cAChB,CAAC;cACDN,IAAI,CAACE,aAAa,GAAGnB,cAAc;cACnC;cACAiB,IAAI,CAACE,aAAa,CAACV,KAAK,GAAGQ,IAAI,CAACR,KAAK;cACrCQ,IAAI,CAACE,aAAa,CAACT,QAAQ,GAAGO,IAAI,CAACP,QAAQ;cAC3CG,KAAK,CAACxD,IAAI,CAAC4D,IAAI,CAAC;YACjB,CAAC,CAAC;UACH,CAAC,CAAC;UACF,OAAOJ,KAAK;QAAC;MACd,CAAC,QAAAhG,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IACD;AACD;AACA;AACA;AACA;AACA;IACeuL,gBAAgBA,CAAA;MAAA,IAAG;QAAA,MAAAC,MAAA,GACmB,IAAI;QAAA,OAAA1D,OAAA,CAAAC,OAAA,CAAJyD,MAAA,CAAK/C,iBAAiB,CAAC,IAAI,CAAC,EAAAxI,IAAA,WAAzEwL,YAAoC;UAC1C,OAAO3D,OAAO,CAAC4D,GAAG,CACjBD,YAAY,CAACE,GAAG,CAAEC,OAA6B,IAAK;YACnD,OAAOJ,MAAA,CAAKK,gBAAgB,CAACD,OAAO,CAACtF,aAAa,CAAEwF,KAAK,EAAEhJ,oBAAoB,CAAC;UACjF,CAAC,CACF,CAAC;QAAC;MACH,CAAC,QAAA9C,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IACD;AACD;AACA;AACA;AACA;AACA;AACA;AACA;IACc0I,YAAYA,CAACb,aAAsB,EAAEkE,gBAA0B;MAAA,IAAuC;QAAA,MAAAC,MAAA,GACxF,IAAI;QAAA,OAAAlE,OAAA,CAAAC,OAAA,CAAJiE,MAAA,CAAKpC,gBAAgB,CAAC/B,aAAa,CAAC,EAAA5H,IAAA,WAAxDgM,WAAW;UACjB,MAAMC,eAAe,GAAGD,WAAW,CAAC9F,MAAM,CACxCC,IAAI,IAAKA,IAAI,CAACI,UAAU,IAAIJ,IAAI,CAACI,UAAU,CAAC0E,SAAS,KAAKpI,oBAAoB,IAAIsD,IAAI,CAACiE,GAAG,IAAIjE,IAAI,CAACR,KACrG,CAAC;UAAC,IAEEmG,gBAAgB;YACnB,OAAOC,MAAA,CAAKG,oBAAoB,CAACpG,kBAAkB,CAACmG,eAAe,CAAC,EAAE,KAAK,CAAC;UAAC;YAE7E,OAAOF,MAAA,CAAKI,oBAAoB,CAACF,eAAe,CAAC;UAAC;QAAA;MAEpD,CAAC,QAAAlM,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IACD;AACD;AACA;AACA;AACA;AACA;AACA;IACcqM,gBAAgBA,CAACxE,aAAsB,EAAEyE,aAAqB;MAAA,IAAE;QAAA,MAAAC,MAAA,GAEvD,IAAI;QAAA,SAAAC,OAAA;UAAA,OAAA1E,OAAA,CAAAC,OAAA,CA6BZ0E,mBAAmB,CAAC,CAAC;QAAA;QA9BlC,MAAMA,mBAAmB,YAAAA,CAAA;UAAA,IAAe;YAAA,OAAA3E,OAAA,CAAAC,OAAA,CACnBwE,MAAA,CAAK3C,gBAAgB,CAAC/B,aAAa,CAAC,EAAA5H,IAAA,WAAlD+F,KAAK;cACX,OAAOA,KAAK,CAACG,MAAM,CAAEC,IAAI,IAAKA,IAAI,CAACI,UAAU,EAAE0E,SAAS,KAAKpI,oBAAoB,IAAIsD,IAAI,CAACiE,GAAG,IAAIjE,IAAI,CAACR,KAAK,CAAC;YAAC;UAC9G,CAAC,QAAA5F,CAAA;YAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;UAAA;QAAA;QAAC,MAAA0M,MAAA;UAAA,IAEE,CAACH,MAAA,CAAKhF,uBAAuB;YAAA,OAAAO,OAAA,CAAAC,OAAA,CACIwE,MAAA,CAAKxD,YAAY,CAAClB,aAAa,CAAC,EAAA5H,IAAA,WAA9DkJ,SAAqB;cAC3BoD,MAAA,CAAKI,oBAAoB,GAAGxD,SAAS,CAACG,SAAS,CAAC,UAAUC,QAAQ,EAAE;gBACnE,OAAOA,QAAQ,CAAChD,EAAE,KAAKzD,oBAAoB;cAC5C,CAAC,CAAC;cAAC,MAAA8J,MAAA;gBAAA,IAGFL,MAAA,CAAKI,oBAAoB,KAAK,CAAC,CAAC,KAC/BzN,MAAM,CAAC2N,IAAI,CAAC,mCAAmC,CAAC,IAAI3N,MAAM,CAAC2N,IAAI,CAAC,uBAAuB,CAAC,CAAC,IAC1FN,MAAA,CAAKhF,uBAAuB,KAAK,KAAK;kBAEtCgF,MAAA,CAAKhF,uBAAuB,GAAG,IAAI;kBAAC,OAAAO,OAAA,CAAAC,OAAA,CAC9BwE,MAAA,CAAKO,UAAU,CAAC;oBACrBrG,YAAY,EAAE0C,SAAS,EAAEtH,MAAM;oBAC/BkL,iBAAiB,EAAE;sBAClBxG,EAAE,EAAEzD,oBAAoB;sBACxB8C,KAAK,EAAE0G;oBACR;kBACD,CAAC,CAAC,EAAArM,IAAA;oBAAA,OAAA6H,OAAA,CAAAC,OAAA,CACIwE,MAAA,CAAKhB,gBAAgB,CAAC,CAAC,EAAAtL,IAAA;kBAAA;gBAAA;kBAE7BsM,MAAA,CAAKhF,uBAAuB,GAAG,IAAI;gBAAC;cAAA;cAAA,IAAAqF,MAAA,IAAAA,MAAA,CAAA3M,IAAA,SAAA2M,MAAA,CAAA3M,IAAA;YAAA;UAAA;QAAA;QAAA,OAAA6H,OAAA,CAAAC,OAAA,CAAA2E,MAAA,IAAAA,MAAA,CAAAzM,IAAA,GAAAyM,MAAA,CAAAzM,IAAA,CAAAuM,MAAA,IAAAA,MAAA,CAAAE,MAAA;MAKvC,CAAC,QAAA1M,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;AACA;AACA;IACc6L,gBAAgBA,CAACmB,eAAuB;MAAA,IAAE9B,SAA6B,GAAAlC,SAAA,CAAAnH,MAAA,QAAAmH,SAAA,QAAAjF,SAAA,GAAAiF,SAAA,MAAGjF,SAAS;MAAA,IAAiB;QAAA,OAAA+D,OAAA,CAAAC,OAAA,CAC9E5I,SAAS,CAAC6I,eAAe,CAAe,cAAc,CAAC,EAAA/H,IAAA,WAAnFgN,mBAAmB;UAAA,OAAAnF,OAAA,CAAAC,OAAA,CACnBkF,mBAAmB,CAACpB,gBAAgB,CAACjJ,cAAc,EAAEsI,SAAS,EAAE8B,eAAe,CAAC,EAAA/M,IAAA;QAAA;MACvF,CAAC,QAAAD,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;AACA;AACA;IACckN,oBAAoBA,CAAAC,IAAA;MAAA,IAAC;QAAEjC,SAAS;QAAEkC;MAAgD,CAAC,GAAAD,IAAA;MAAA,IAAE;QAAA,MAAAE,MAAA,GAIxE,IAAI;QAAA,OAAAvF,OAAA,CAAAC,OAAA,CAHK5I,SAAS,CAAC6I,eAAe,CAAe,cAAc,CAAC,EAAA/H,IAAA,WAAnFgN,mBAAmB;UAAA,OAAAlL,MAAA,CACLqL,MAAM,YAAftB,KAAK,EAAY;YAAA,MAAAwB,MAAA,GAAA1N,MAAA,aACvB;cAAA,OAAAkI,OAAA,CAAAC,OAAA,CACoBsF,MAAA,CAAKtE,YAAY,CAAC,IAAI,CAAC,EAAA9I,IAAA,WAAxCmJ,QAAQ;gBACd,MAAM3C,YAAY,GAAG2C,QAAQ,CAACE,SAAS,CAAEC,QAAQ,IAAKA,QAAQ,CAAChD,EAAE,KAAK2E,SAAS,CAAC;gBAChF,MAAMqC,aAAa,GAAG9G,YAAY,GAAG,CAAC,CAAC,GAAG2C,QAAQ,CAAC3C,YAAY,CAAC,GAAG,IAAI;gBACvE,MAAM0E,kBAAkB,GAAGoC,aAAa,EAAExD,cAAc,EAAET,SAAS,CAAEnE,cAAc,IAAKA,cAAc,CAACoB,EAAE,KAAKuF,KAAK,CAAC,IAAI,CAAC,CAAC;gBAAC,MAAA0B,MAAA;kBAAA,IACvHrC,kBAAkB,GAAG,CAAC,CAAC;oBAAA,OAAArD,OAAA,CAAAC,OAAA,CACpBkF,mBAAmB,CAACQ,mBAAmB,CAAC7K,cAAc,EAAE6D,YAAY,EAAE0E,kBAAkB,CAAC,EAAAlL,IAAA;kBAAA;gBAAA;gBAAA,IAAAuN,MAAA,IAAAA,MAAA,CAAAvN,IAAA,SAAAuN,MAAA,CAAAvN,IAAA;cAAA;YAEjG,CAAC,YAAQ0D,KAAK,EAAE;cACf/E,GAAG,CAAC+E,KAAK,CAACA,KAAe,CAAC;YAC3B,CAAC;YAAA,IAAA2J,MAAA,IAAAA,MAAA,CAAArN,IAAA,SAAAqN,MAAA,CAAArN,IAAA;UACF,CAAC;QAAA;MACF,CAAC,QAAAD,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACc0N,oBAAoBA,CAAAC,KAAA;MAAA,IAAC;QACjCrF,MAAM;QACNsF,kBAAkB;QAClBC,wBAAwB;QACxBC;MAMD,CAAC,GAAAH,KAAA;MAAA,IAAE;QAAA,OAAA7F,OAAA,CAAAC,OAAA,CACgC5I,SAAS,CAAC6I,eAAe,CAAe,cAAc,CAAC,EAAA/H,IAAA,WAAnFgN,mBAAmB;UACzB,OAAOA,mBAAmB,CAACc,mBAAmB,CAACzF,MAAM,EAAEsF,kBAAkB,EAAEC,wBAAwB,EAAEC,kBAAkB,CAAC;QAAC;MAC1H,CAAC,QAAA9N,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;IACcgO,oBAAoBA,CAAC1B,aAAqB;MAAA,IAAE;QAAA,IAAA2B,KAAA;QAAA,MAAAC,MAAA,GACnD,IAAI;QAAA,SAAAC,OAAAC,OAAA;UAAA,OAAAH,KAAA,GAAAG,OAAA,GAsBFtG,OAAO,CAACC,OAAO,CAAC,CAAC;QAAA;QAAA,MAAAsG,MAAA;UAAA,IAtBpB,CAACH,MAAA,CAAK3G,uBAAuB;YAAA,OAAAO,OAAA,CAAAC,OAAA,CACRmG,MAAA,CAAKnF,YAAY,CAAC,CAAC,EAAA9I,IAAA,WAArCkJ,SAAS;cACf,MAAMmF,sBAAsB,GAAGnF,SAAS,CAACG,SAAS,CAAC,UAAUC,QAAQ,EAAE;gBACtE,OAAOA,QAAQ,CAAChD,EAAE,KAAKzD,oBAAoB;cAC5C,CAAC,CAAC;;cAEF;cAAA,IAECwL,sBAAsB,KAAK,CAAC,CAAC,KAC5BpP,MAAM,CAAC2N,IAAI,CAAC,mCAAmC,CAAC,IAAI3N,MAAM,CAAC2N,IAAI,CAAC,uBAAuB,CAAC,CAAC;gBAAA,MAAA0B,iBAAA,GAEnFL,MAAA,CAAKpB,UAAU,CAAC;kBACtBrG,YAAY,EAAE0C,SAAS,CAACtH,MAAM;kBAC9BkL,iBAAiB,EAAE;oBAClBxG,EAAE,EAAEzD,oBAAoB;oBACxB8C,KAAK,EAAE0G,aAAa;oBACpBkC,OAAO,EAAE;kBACV;gBACD,CAAC,CAAC;gBAAAP,KAAA;gBAAA,OAAAM,iBAAA;cAAA;YAAA;UAAA;QAAA;QAAA,OAAAzG,OAAA,CAAAC,OAAA,CAAAsG,MAAA,IAAAA,MAAA,CAAApO,IAAA,GAAAoO,MAAA,CAAApO,IAAA,CAAAkO,MAAA,IAAAA,MAAA,CAAAE,MAAA;MAKL,CAAC,QAAArO,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACc8M,UAAUA,CAAC2B,WAAqB;MAAA,IAAE;QAC9C,MAAM;UAAEhI,YAAY;UAAEsG;QAAkB,CAAC,GAAG0B,WAAW;QAAC,OAAA3G,OAAA,CAAAC,OAAA,CACrB5I,SAAS,CAAC6I,eAAe,CAAe,cAAc,CAAC,EAAA/H,IAAA,WAApFgI,oBAAoB;UAAA,OAAAH,OAAA,CAAAC,OAAA,CACpBE,oBAAoB,CAAC6E,UAAU,CAAClK,cAAc,EAAE6D,YAAY,EAAE;YACnE,GAAGsG,iBAAiB;YACpByB,OAAO,EAAE;UACV,CAAC,CAAC,EAAAvO,IAAA;QAAA;MACH,CAAC,QAAAD,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;AACA;IACc0O,wBAAwBA,CAACxD,SAAkB;MAAA,IAAEyD,YAAY,GAAA3F,SAAA,CAAAnH,MAAA,QAAAmH,SAAA,QAAAjF,SAAA,GAAAiF,SAAA,MAAG,KAAK;MAAA,IAAmC;QAAA,MAAA4F,MAAA,GAChE,IAAI;QAAA,OAAA9G,OAAA,CAAAC,OAAA,CAAJ6G,MAAA,CAAKlG,YAAY,CAACiG,YAAY,CAAC,EAAA1O,IAAA,WAAzE4O,KAAiC;UAAA,IACnC3D,SAAS;YACZ,OAAO2D,KAAK,CAACzG,IAAI,CAAEhC,IAAI,IAAKA,IAAI,CAACuE,SAAS,IAAIvE,IAAI,CAACG,EAAE,KAAK2E,SAAS,CAAC,EAAE4D,IAAI,IAAI,EAAE;UAAC;YAEjF,OAAOD,KAAK,CAAC1I,MAAM,CAAEC,IAAI,IAAK,CAACA,IAAI,CAACuE,SAAS,CAAC,CAAC,CAAC;UAAA;QAAA;MAElD,CAAC,QAAA3K,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;IACc+O,WAAWA,CACvBC,QAAwB,EACxBC,UAKC;MAAA,IACA;QAAA,MAAAC,OAAA,GAOO,IAAI;QAAA,OAAApH,OAAA,CAAAC,OAAA,CAN6B5I,SAAS,CAAC6I,eAAe,CAAC,YAAY,CAAC,EAAA/H,IAAA,WAA1EkP,gBAA0B;UAAA,OAAArH,OAAA,CAAAC,OAAA,CACJoH,gBAAgB,CAACC,eAAe,CAAC,CAAC,EAAAnP,IAAA,WAAxDoP,aAAa;YACnB,MAAMC,YAAY,GAAGD,aAAa,CAACjH,IAAI,CAAEmH,WAAW,IAAKA,WAAW,CAAChJ,EAAE,KAAK1D,eAAe,CAAC;YAC5F,MAAM0M,WAAW,GAAGD,YAAY,EAAEE,QAAQ,EAAEpH,IAAI,CAAEmH,WAAW,IAAKA,WAAW,CAAChJ,EAAE,KAAK3D,cAAc,CAAC;YAAC,OAAAkF,OAAA,CAAAC,OAAA,CAC/FoH,gBAAgB,CAACM,WAAW,CAACxM,eAAe,CAACyM,kBAAkB,CAACV,QAAQ,CAAC,EAAEO,WAAW,CAAC,EAAAtP,IAAA;cAAA,OACzFgP,UAAU,GACNC,OAAA,CAAKS,iBAAiB,CAACV,UAAU,CAAC,GAEnCnH,OAAO,CAACC,OAAO,CAAC,CAAC;YAAA;UAAA;QAAA;MACzB,CAAC,QAAA/H,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;AACA;AACA;IACc4P,gBAAgBA,CAACvJ,KAAa,EAAE6E,SAAkB;MAAA,IAAEyD,YAAY,GAAA3F,SAAA,CAAAnH,MAAA,QAAAmH,SAAA,QAAAjF,SAAA,GAAAiF,SAAA,MAAG,KAAK;MAAA,IAAE;QAAA,MAAA6G,OAAA,GAClD,IAAI;QAAA,OAAA/H,OAAA,CAAAC,OAAA,CAAJ8H,OAAA,CAAKnB,wBAAwB,CAACxD,SAAS,EAAEyD,YAAY,CAAC,EAAA1O,IAAA,WAApF6P,qBAAqB;UAC3B,OAAOA,qBAAqB,CAAC1H,IAAI,CAAE2H,oBAAoB,IAAKA,oBAAoB,CAAC1J,KAAK,KAAKA,KAAK,CAAC;QAAC;MACnG,CAAC,QAAArG,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACc2P,iBAAiBA,CAACV,UAK9B;MAAA,IAAE;QAAA,MAAAe,OAAA,GAEF,IAAI;QAAA,OAAAlI,OAAA,CAAAC,OAAA,CAD8B5I,SAAS,CAAC6I,eAAe,CAAe,cAAc,CAAC,EAAA/H,IAAA,WAAnFgN,mBAAmB;UACzB+C,OAAA,CAAKxI,eAAe,GAAG,IAAI;UAC3B,OAAOyF,mBAAmB,CAAC0C,iBAAiB,CAC3C/M,cAAc,EACdqM,UAAU,CAACrB,kBAAkB,EAC7BqB,UAAU,CAACpB,wBAAwB,EACnCoB,UAAU,CAACgB,kBAAkB,EAC7BhB,UAAU,CAACiB,wBACZ,CAAC;QAAC;MACH,CAAC,QAAAlQ,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;AACA;AACA;IACQmM,oBAAoBA,CAACgE,oBAA4C,EAAEC,oBAA6B,EAAE;MACxG,OAAOD,oBAAoB,CAAChK,MAAM,CAAC,CAACC,IAAI,EAAEiK,SAAS,EAAErK,KAAK,KAAK;QAC9D,MAAMsK,WAAW,GAAGtK,KAAK,CAACsD,SAAS,CAAEiH,QAAQ,IAAKA,QAAQ,CAAClK,KAAK,KAAKD,IAAI,CAACC,KAAK,CAAC;QAChF,OAAO+J,oBAAoB,GAAGE,WAAW,KAAKD,SAAS,GAAGC,WAAW,KAAKD,SAAS;MACpF,CAAC,CAAC;IACH;;IAEA;AACD;AACA;AACA;AACA;AACA;AACA;IACSjE,oBAAoBA,CAACoE,aAAqC,EAAE;MACnE,MAAMC,WAAmC,GAAG,EAAE;QAC7CtH,SAAqB,GAAG,EAAE;MAC3B,IAAIuH,gBAAsC;MAE1C3K,kBAAkB,CAACyK,aAAa,CAAC,CAACvK,OAAO,CAAEG,IAAI,IAAK;QACnD,IAAIA,IAAI,CAACI,UAAU,EAAE4E,gBAAgB,EAAE;UACtCqF,WAAW,CAACjO,IAAI,CAAC4D,IAAI,CAAC;QACvB,CAAC,MAAM;UACNsK,gBAAgB,GAAGvH,SAAS,CAACf,IAAI,CAAEmB,QAAQ,IAAKA,QAAQ,CAACoB,SAAS,IAAIpB,QAAQ,CAAChD,EAAE,KAAKH,IAAI,CAACI,UAAU,EAAE0E,SAAS,CAAC;UAEjH,IAAI,CAACwF,gBAAgB,EAAE;YACtBvH,SAAS,CAAC3G,IAAI,CAAC;cACd+D,EAAE,EAAEH,IAAI,CAACI,UAAU,EAAE0E,SAAS;cAC9ByF,KAAK,EAAEvK,IAAI,CAACI,UAAU,EAAEC,YAAY;cACpCb,KAAK,EAAEQ,IAAI,CAACI,UAAU,EAAEyE,YAAY,IAAI,EAAE;cAC1C2F,KAAK,EAAE,GAAG;cACVpG,OAAO,EAAE1I,gBAAgB,CAAC,CAAC,CAAC2I,GAAG;cAC/BG,IAAI,EAAE,wBAAwB;cAC9BD,SAAS,EAAE,IAAI;cACfU,eAAe,EAAEjF,IAAI,CAACI,UAAU,EAAE6E,eAAe;cACjDyD,IAAI,EAAE,CAAC1I,IAAI;YACZ,CAAC,CAAC;UACH,CAAC,MAAM;YACNsK,gBAAgB,CAAC5B,IAAI,EAAEtM,IAAI,CAAC4D,IAAI,CAAC;YACjCsK,gBAAgB,CAACE,KAAK,GAAGF,gBAAgB,CAAC5B,IAAI,EAAEjN,MAAM,CAACgP,QAAQ,CAAC,CAAC;UAClE;QACD;MACD,CAAC,CAAC;;MAEF;MACA,OAAO,CAAC,GAAG1H,SAAS,EAAE,GAAG,IAAI,CAACgD,oBAAoB,CAACsE,WAAW,EAAE,KAAK,CAAC,CAAC;IACxE;;IAEA;AACD;AACA;AACA;AACA;AACA;AACA;AACA;IACc9G,WAAWA,CAACiE,kBAA0B,EAAEqC,kBAA0B;MAAA,IAAiB;QAC/F,OAAAnI,OAAA,CAAAC,OAAA,CAAO5I,SAAS,CAAC6I,eAAe,CAAC,OAAO,CAAC,CAAC/H,IAAI,CAAC,UAAU6Q,aAGxD,EAAE;UACF,MAAMC,UAAkB,GAAGD,aAAa,CAACE,YAAY,CAACpO,cAAc,CAAC;UACrE,OAAOkO,aAAa,CAACnH,WAAW,CAACoH,UAAU,EAAEnD,kBAAkB,EAAEqC,kBAAkB,CAAC;QACrF,CAAe,CAAC;MACjB,CAAC,QAAAjQ,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;IACeiR,kBAAkBA,CAAA;MAAA,IAAG;QAClC,IAAIC,iBAAiB,GAAGvO,uBAAuB,GAAG,WAAW;QAC7D,MAAMwO,mBAAmB,GAAGC,MAAM,CAACC,IAAI,CAAC3O,eAAe,CAAC;QACxD,MAAM4O,YAAY,GAAGH,mBAAmB,CAACxF,GAAG,CAAE4F,UAAU,IAAK;UAC5D,OAAO,eAAe,GAAG7O,eAAe,CAAC6O,UAAU,CAA0B,GAAG,GAAG;QACpF,CAAC,CAAC,CAACC,IAAI,CAAC,MAAM,CAAC;QACfN,iBAAiB,GAAGA,iBAAiB,GAAG,GAAG,GAAGI,YAAY,GAAG,GAAG;QAAC,OAAAxJ,OAAA,CAAAC,OAAA,CACxC7E,UAAU,CAACuO,OAAO,CAACP,iBAAiB,CAAC,EAAAjR,IAAA,WAAAyR,mBAAA;UAA9D,MAAMC,SAAS,GAAAD,mBAGd;UACD,IAAIC,SAAS,EAAEhO,KAAK,EAAE;YACrB,MAAM,IAAIC,KAAK,CAAC+N,SAAS,CAAChO,KAAK,CAACE,OAAO,CAAC;UACzC;UACA,OAAO8N,SAAS,EAAElR,KAAK,IAAI,EAAE;QAAC;MAC/B,CAAC,QAAAT,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;IACc4R,gBAAgBA,CAACC,SAAiB;MAAA,IAAE;QAAA,MAAAC,OAAA,GAEjB,IAAI;QAAA,OAAAhK,OAAA,CAAAC,OAAA,CAAAnI,MAAA,aAD/B;UAAA,OAAAkI,OAAA,CAAAC,OAAA,CAC2B+J,OAAA,CAAKb,kBAAkB,CAAC,CAAC,EAAAhR,IAAA,WAAjD8R,eAAe;YACrB,MAAMC,OAAO,GAAGD,eAAe,CAAC3J,IAAI,CAAE6J,cAAc,IAAK;cACxD,OAAOA,cAAc,CAACC,QAAQ,KAAKL,SAAS;YAC7C,CAAC,CAAC;YACF,OAAOG,OAAO,IAAIA,OAAO,CAACG,KAAK,KAAK,EAAE,GAAG,KAAK,GAAG,IAAI;UAAC;QACvD,CAAC,YAAQxO,KAAK,EAAE;UACf/E,GAAG,CAAC+E,KAAK,CAAC,kCAAkC,GAAIA,KAAK,CAAWE,OAAO,CAAC;UACxE,OAAO,KAAK;QACb,CAAC;MACF,CAAC,QAAA7D,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;IACeoS,sBAAsBA,CAAA;MAAA,IAACvK,aAAsB,GAAAmB,SAAA,CAAAnH,MAAA,QAAAmH,SAAA,QAAAjF,SAAA,GAAAiF,SAAA,MAAG,KAAK;MAAA,IAAqB;QAAA,MAAAqJ,OAAA,GACnD,IAAI;QAAA,OAAAvK,OAAA,CAAAC,OAAA,CAAJsK,OAAA,CAAKT,gBAAgB,CAAClP,eAAe,CAAC4P,cAAc,CAAC,EAAArS,IAAA,WAAnFsS,qBAAqB;UAAA,IAAAC,MAAA;UAAA,SAAAC,QAAAC,QAAA;YAAA,OAAAF,MAAA,GAAAE,QAAA,GAmBpBL,OAAA,CAAKM,mBAAmB;UAAA;UAlB/B,IAAI,CAACJ,qBAAqB,EAAE;YAC3B,OAAOzK,OAAO,CAACC,OAAO,CAAC,EAAE,CAAC;UAC3B;UAAC,MAAA6K,OAAA;YAAA,IACG,CAACP,OAAA,CAAKM,mBAAmB,IAAI9K,aAAa;cAAA,OAAAjI,MAAA,aACzC;gBAAA,OAAAkI,OAAA,CAAAC,OAAA,CACqB7E,UAAU,CAACuO,OAAO,CAAC1O,uBAAuB,CAAC,EAAA9C,IAAA,WAAA4S,oBAAA;kBAAnE,MAAMC,QAAQ,GAAAD,oBAGb;kBACDR,OAAA,CAAKM,mBAAmB,GACvBG,QAAQ,EAAErS,KAAK,EAAEkL,GAAG,CAAEpG,IAAI,IAAK;oBAC9B,OAAOA,IAAI,CAACwN,MAAM;kBACnB,CAAC,CAAC,IAAI,EAAE;gBAAC;cACX,CAAC,YAAQpP,KAAK,EAAE;gBACf/E,GAAG,CAAC+E,KAAK,CAAC,kCAAkC,GAAIA,KAAK,CAAWE,OAAO,CAAC;gBAAC,MAAAmP,gBAAA,GAClElL,OAAO,CAACC,OAAO,CAAC,EAAE,CAAC;gBAAAyK,MAAA;gBAAA,OAAAQ,gBAAA;cAC3B,CAAC;YAAA;UAAA;UAAA,OAAAJ,OAAA,IAAAA,OAAA,CAAA3S,IAAA,GAAA2S,OAAA,CAAA3S,IAAA,CAAAwS,OAAA,IAAAA,OAAA,CAAAG,OAAA;QAAA;MAGH,CAAC,QAAA5S,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;IACciT,eAAeA,CAAA;MAAA,IAAG;QAAA,OAAAnL,OAAA,CAAAC,OAAA,CAAAnI,MAAA,aAC1B;UAAA,OAAAkI,OAAA,CAAAC,OAAA,CAC6B5I,SAAS,CAAC6I,eAAe,CAAoB,mBAAmB,CAAC,EAAA/H,IAAA,WAA3FiT,iBAAiB;YACvB,OAAOA,iBAAiB,CAACC,OAAO,CAAC;cAAEC,gCAAgC,EAAE;YAAM,CAAC,CAAC;UAAC;QAC/E,CAAC,YAAQzP,KAAK,EAAE;UACf/E,GAAG,CAAC+E,KAAK,CAAC,qCAAqC,GAAIA,KAAK,CAAWE,OAAO,CAAC;UAC3E,OAAO,EAAE;QACV,CAAC;MACF,CAAC,QAAA7D,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;AACA;IACSqT,aAAaA,CAACC,IAAkB,EAAE;MACzC,OAAOA,IAAI,EAAEC,SAAS,EAAEC,IAAI,KAAK,0CAA0C;IAC5E;;IAEA;AACD;AACA;AACA;AACA;AACA;IACC;IACQC,yBAAyBA,CAACH,IAAkB,EAAE;MACrD,OAAOA,IAAI,EAAEC,SAAS,EAAEG,QAAQ,EAAEC,aAAa,EAAEC,uBAAuB;IACzE;;IAEA;AACD;AACA;AACA;AACA;AACA;;IAESC,oBAAoBA,CAACC,QAAuB,EAAE;MACrD,MAAMC,qBAAqB,GAAGD,QAAQ,CAAC,oBAAoB,CAAC,IAAIA,QAAQ,CAAC,SAAS,CAAC,EAAEE,WAAW,EAAEC,WAAW;MAC7G,IAAI,CAACF,qBAAqB,EAAE;QAC3B,OAAO,KAAK;MACb;MAEA,MAAMG,KAAK,GAAGJ,QAAQ,CAAC,oBAAoB,CAAC,EAAEI,KAAyD;MACvG;MACA;MACA,IAAIC,KAAK,CAACC,OAAO,CAACF,KAAK,CAAC,EAAE;QACzB,OAAO,IAAI,CAACb,aAAa,CAACa,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAACT,yBAAyB,CAACS,KAAK,CAAC,CAAC,CAAC,CAAC;MACjF,CAAC,MAAM,IAAI9C,MAAM,CAACC,IAAI,CAAC6C,KAAK,CAAC,CAACrS,MAAM,EAAE;QACrC,OAAOuP,MAAM,CAACC,IAAI,CAAC6C,KAAK,CAAC,CAAC/M,IAAI,CAAEsD,GAAW,IAAK;UAC/C,IAAKyJ,KAAK,CAA6BzJ,GAAG,CAAC,EAAE;YAC5C,OAAO,IAAI,CAAC4I,aAAa,CAACa,KAAK,CAACzJ,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,CAACgJ,yBAAyB,CAACS,KAAK,CAACzJ,GAAG,CAAC,CAAC;UACrF;QACD,CAAC,CAAC;MACH;MACA,OAAO,KAAK;IACb;;IAEA;AACD;AACA;AACA;AACA;AACA;AACA;IACS4J,cAAcA,CAACC,SAAwB,EAAE;MAChD,OAAO,IAAIxM,OAAO,CAAC,UAAUC,OAAO,EAAE;QACrC,MAAMwM,UAAU,GAAGD,SAAS,GAAG,SAAS,CAAC,EAAEN,WAAW;QACtD,MAAMC,WAAW,GAAGM,UAAU,EAAEN,WAAW;QAC3C,MAAMO,cAAc,GAAGP,WAAW,EAAEP,QAAQ,EAAEe,WAAW,CACvD9I,GAAG,CAAE+I,KAAK,IAAK;UACf,IAAIH,UAAU,IAAIA,UAAU,CAACG,KAAK,CAAC,EAAE;YACpC,OAAOH,UAAU,CAACG,KAAK,CAAC,EAAEC,GAAG;UAC9B;QACD,CAAC,CAAC,CACDxO,MAAM,CAAEyO,IAAI,IAAKA,IAAI,KAAK7Q,SAAS,CAAC;QACtC,MAAM8Q,UAAU,GAAG,IAAI5V,YAAY,CAACgV,WAAW,EAAEU,GAAG,EAAY;UAC/DG,aAAa,EAAEN,cAA0B;UACzCO,qBAAqB,EAAE;QACxB,CAAC,CAAC;QACFF,UAAU,CAACG,oBAAoB,CAAC,MAAM;UACrCjN,OAAO,CAAC8M,UAAU,CAAC;QACpB,CAAC,CAAC;QACFA,UAAU,CAACI,oBAAoB,CAAC,MAAM;UACrClN,OAAO,CAAC8M,UAAU,CAAC;QACpB,CAAC,CAAC;MACH,CAAC,CAAC;IACH;;IAEA;AACD;AACA;AACA;AACA;AACA;AACA;IACSK,aAAaA,CAACpB,QAAuB,EAAE;MAC9C,MAAMI,KAAK,GAAGJ,QAAQ,CAAC,oBAAoB,CAAC,EAAEI,KAAK;MACnD,IAAIC,KAAK,CAACC,OAAO,CAACF,KAAK,CAAC,EAAE;QACzB,OAAOA,KAAK,CAAC,CAAC,CAAC,CAACiB,SAAS;MAC1B,CAAC,MAAM,IAAIjB,KAAK,EAAE;QACjB,KAAK,MAAMzJ,GAAG,IAAIyJ,KAAK,EAAiC;UACvD,MAAM3O,IAAI,GAAG2O,KAAK,CAACzJ,GAAG,CAAgB;UACtC,IAAIlF,IAAI,CAACgO,SAAS,IAAIhO,IAAI,CAACgO,SAAS,EAAEC,IAAI,KAAK,0CAA0C,EAAE;YAC1F,OAAOjO,IAAI,CAAC4P,SAAS;UACtB;QACD;MACD;MACA,OAAOpR,SAAS;IACjB;;IAEA;AACD;AACA;AACA;AACA;AACA;AACA;AACA;IACSqR,uBAAuBA,CAACC,UAAsB,EAAEC,WAAwB,EAAE;MACjF;MACA,IAAID,UAAU,GAAG,8CAA8C,CAAC,GAAG,oBAAoB,CAAC,EAAExT,MAAM,EAAE;QACjG,OAAO,IAAI;MACZ,CAAC,MAAM,IAAIyT,WAAW,EAAEzT,MAAM,EAAE;QAC/B;QACA,OAAOyT,WAAW,CAACnO,IAAI,CAAEoO,SAA4C,IAAK;UACzE,OACCnE,MAAM,CAACC,IAAI,CAACkE,SAAS,CAAC,CAAC1T,MAAM,KAC3B0T,SAAS,CAA4B,eAAe,CAAC,KAAK,WAAW,IACrEA,SAAS,CAA4B,wBAAwB,CAAC,KAAK,MAAM,CAAC;QAE9E,CAAC,CAAC;MACH;IACD;;IAEA;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACSC,iCAAiCA,CAACC,UAA0B,EAAEC,UAAkB,EAAEC,WAAoB,EAAE;MAC/G,IAAI,CAACF,UAAU,EAAE;QAChB,MAAM,IAAI7R,KAAK,CAAC,+CAA+C,CAAC;MACjE;MAEA,MAAMgS,OAAyH,GAAG;QACjIC,aAAa,EAAE,IAAI;QACnBjP,UAAU,EAAE,EAAE;QACdkP,eAAe,EAAE;MAClB,CAAC;MAED,MAAMT,UAAU,GAAGI,UAAU,CAACM,iBAAiB,CAACL,UAAU,CAAe;MACzE,MAAMM,WAAW,GAAGP,UAAU,CAACQ,kBAAkB,CAACZ,UAAU,CAACa,UAAU,CAAgB;MACvF,MAAMC,qBAAqB,GAAGH,WAAW,CAACI,kBAAkB;MAE5D,IAAI,CAACD,qBAAqB,EAAE;QAC3B,OAAOP,OAAO;MACf;MACA;MACAO,qBAAqB,CAAClQ,OAAO,CAAC,UAAUoQ,YAAY,EAAE;QACrD,MAAMC,oBAAoB,GAAGb,UAAU,CAACc,sBAAsB,CAACP,WAAW,EAAEK,YAAY,CAAC7C,IAAI,CAAC;QAC9F,MAAMgD,qBAAqB,GAAGF,oBAAoB,IAAKb,UAAU,CAACQ,kBAAkB,CAACK,oBAAoB,CAACG,IAAI,CAAiB;QAC/H,IAAID,qBAAqB,GAAG,eAAe,CAAC,KAAK,YAAY,IAAI,CAACA,qBAAqB,CAAC/L,GAAG,EAAE;UAC5F;QACD;QACAmL,OAAO,CAACC,aAAa,GAAGJ,UAAU,CAACiB,yBAAyB,CAACV,WAAW,EAAEK,YAAY,CAAC7C,IAAI,CAAC,EAAE2B,SAAmB;QACjH,KAAK,IAAI1U,KAAK,IAAI+V,qBAAqB,CAAC/L,GAAG,CAACkM,WAAW,EAAE;UACxD,IAAIhB,WAAW,EAAE;YAChB,MAAMiB,OAAO,GAAGJ,qBAAqB,CAACK,QAAQ;YAC9C,KAAK,IAAIC,WAAW,IAAIF,OAAO,EAAE;cAChC,IAAIE,WAAW,CAACtD,IAAI,KAAK/S,KAAK,CAAC+S,IAAI,EAAE;gBACpCoC,OAAO,CAAChP,UAAU,CAACpE,IAAI,CAACsU,WAAW,CAAC;gBACpClB,OAAO,CAACC,aAAa,GAAGJ,UAAU,CAACiB,yBAAyB,CAACV,WAAW,EAAEK,YAAY,CAAC7C,IAAI,CAAC,EAAE2B,SAAS;cACxG;YACD;UACD,CAAC,MAAM;YACNS,OAAO,CAAChP,UAAU,CAACpE,IAAI,CAAC/B,KAAK,CAAC+S,IAAI,CAAC;UACpC;QACD;QACA,MAAMuD,wBAAwB,GAAGP,qBAAqB,CAACJ,kBAAkB;QACzE;QACA,MAAMY,uBAAuB,GAAGD,wBAAwB,EAAE5P,IAAI,CAAC,UAAU8P,sBAAsB,EAAE;UAChG,MAAMC,wBAAwB,GAAGzB,UAAU,CAACc,sBAAsB,CACjEC,qBAAqB,EACrBS,sBAAsB,CAACzD,IACxB,CAAC,EAAEiD,IAAI;UACP;UACAb,OAAO,CAACE,eAAe,GAAGoB,wBAAwB,KAAK7B,UAAU,CAACa,UAAU,GAAGe,sBAAsB,CAACzD,IAAI,GAAG,IAAI;UACjH,OAAOoC,OAAO,CAACE,eAAe;QAC/B,CAAC,CAAC;QACF,OAAOkB,uBAAuB,IAAIpB,OAAO,CAACE,eAAe,IAAIF,OAAO,CAACC,aAAa;MACnF,CAAC,CAAC;MACF,OAAOD,OAAO;IACf;;IAEA;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACSuB,gBAAgBA,CAACnB,WAAwB,EAAEP,UAA0B,EAAE2B,gBAAkC,EAAE;MAClH,IAAI7B,SAAS;QACZ8B,aAAsC,GAAG,CAAC,CAAC;MAK5C,IAAID,gBAAgB,CAACE,KAAK,EAAEC,IAAI,EAAE;QACjChC,SAAS,GAAGE,UAAU,CAAC+B,gBAAgB,CAACxB,WAAW,EAAEoB,gBAAgB,CAACE,KAAK,CAACC,IAAI,CAA4B;MAC7G;MACA,IACC,CAAChC,SAAS,IACTA,SAAS,CAAkB,mCAAmC,CAAC,EAAEkC,IAAI,IACtEL,gBAAgB,CAAC,mCAAmC,CAAC,EAAEK,IAAI,EAC1D;QACD,OAAOJ,aAAa;MACrB;MACA;MACA,IAAK9B,SAAS,CAAkB,6CAA6C,CAAC,EAAEgC,IAAI,EAAE;QACrF,OAAOxT,SAAS;MACjB;MACA,IAAI2T,qBAAqB,GAAInC,SAAS,CAAkB,qCAAqC,CAAC,EAAEgC,IAAI,IAAI,EAAE;MAC1GG,qBAAqB,GAAG,GAAG,GAAGA,qBAAqB,GAAG,GAAG;MACzD,IAAIC,YAAY,GAAG,GAAG,GAAIpC,SAAS,CAAC/B,IAAe,GAAG,GAAG;MACzD,IAAIoE,WAAW,GAAG,EAAE,CAAC,CAAC;MACtB,MAAMC,iBAAiB,GAAG7B,WAAW,CAAC,4CAA4C,CAAC;MACnF,MAAM8B,sBAAsB,GAC3B,CAAC,CAACD,iBAAiB,IACnBA,iBAAiB,CAAC1Q,IAAI,CAAC,UAAU4Q,WAAW,EAAE;QAC7C,OAAOA,WAAW,CAACC,YAAY,KAAMzC,SAAS,CAAkB/B,IAAI;MACrE,CAAC,CAAC;MAEH,IAAK+B,SAAS,CAAkB,mCAAmC,CAAC,EAAEgC,IAAI,EAAE;QAC3EI,YAAY,GAAGA,YAAY,CAACM,MAAM,CACjC,GAAG,GAAG,GAAG,GAAGL,WAAW,GAAIrC,SAAS,CAAkB,mCAAmC,CAAC,CAACgC,IAAI,GAAG,GACnG,CAAC;MACF;MACA,IAAKhC,SAAS,CAAkB,4BAA4B,CAAC,EAAEgC,IAAI,EAAE;QACpEI,YAAY,GAAGA,YAAY,CAACM,MAAM,CACjC,GAAG,GAAG,GAAG,GAAGL,WAAW,GAAIrC,SAAS,CAAkB,4BAA4B,CAAC,CAACgC,IAAI,GAAG,GAC5F,CAAC;MACF;MAEA,IAAKhC,SAAS,CAAkB,qCAAqC,CAAC,EAAEgC,IAAI,EAAE;QAC7E,IAAIW,eAAe,GAAI3C,SAAS,CAAkB,qCAAqC,CAAC,CACvF,4CAA4C,CAC5C;QACD,IAAI,CAAC2C,eAAe,EAAE;UACrBA,eAAe,GAAGlC,WAAW,CAAC,4CAA4C,CAAC;QAC5E;QAEA,IAAI,CAACmC,mBAAmB,CAACD,eAAe,EAAEb,aAAa,EAAEK,qBAAqB,EAAEC,YAAY,CAAC;MAC9F,CAAC,MAAM;QACNN,aAAa,CAAC,OAAO,CAAC,GAAGM,YAAY;QACrC,IAAIG,sBAAsB,EAAE;UAC3BT,aAAa,CAACe,UAAU,GAAGN,sBAAsB;QAClD;MACD;MACAT,aAAa,CAACtM,IAAI,GAAIwK,SAAS,CAAkB,qCAAqC,CAAC,GACnFA,SAAS,CAAkB,qCAAqC,CAAC,CAACgC,IAAI,GACvEhC,SAAS,CAAC/B,IAAI;MACjB6D,aAAa,CAACgB,UAAU,GAAGjB,gBAAgB,CAAC,uCAAuC,CAAC;MACpFC,aAAa,CAACZ,IAAI,GAAGlB,SAAS,CAACkB,IAAI;MACnC,OAAOY,aAAa;IACrB;;IAEA;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACSc,mBAAmBA,CAC1BD,eAAmD,EACnDb,aAAsC,EACtCK,qBAA6B,EAC7BC,YAAoB,EACnB;MACD,MAAMW,oBAAoB,GAAGJ,eAAe,EAAEK,UAAU,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;MAEtE,IAAIF,oBAAoB,KAAK,UAAU,EAAE;QACxCjB,aAAa,CAAC,OAAO,CAAC,GAAG,MAAM,GAAGK,qBAAqB,GAAG,kBAAkB,GAAGA,qBAAqB,GAAG,GAAG;MAC3G,CAAC,MAAM,IAAIY,oBAAoB,KAAK,UAAU,EAAE;QAC/CjB,aAAa,CAAC,OAAO,CAAC,GACrB,MAAM,GACNM,YAAY,GACZ,kBAAkB,GAClBA,YAAY,GACZ,GAAG,GACH,MAAM,GACND,qBAAqB,GACrB,0BAA0B,GAC1BA,qBAAqB,GACrB,UAAU;MACZ,CAAC,MAAM,IAAIY,oBAAoB,KAAK,cAAc,EAAE;QACnDjB,aAAa,CAAC,OAAO,CAAC,GAAG,MAAM,GAAGM,YAAY,GAAG,kBAAkB,GAAGA,YAAY,GAAG,GAAG;MACzF,CAAC,MAAM;QACN;QACAN,aAAa,CAAC,OAAO,CAAC,GACrB,MAAM,GACNK,qBAAqB,GACrB,kBAAkB,GAClBA,qBAAqB,GACrB,GAAG,GACH,MAAM,GACNC,YAAY,GACZ,0BAA0B,GAC1BA,YAAY,GACZ,UAAU;MACZ;IACD;;IAEA;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACSc,oBAAoBA,CAC3B3E,QAAuB,EACvBkC,WAAwB,EACxB0C,QAAiC,EACjCvD,SAA8B,EAC9BwD,UAAmB,EACnBlD,UAA0B,EACN;MACpB,MAAMmD,cAAc,GAAG9E,QAAQ,GAAG,SAAS,CAAC,EAAEE,WAAW,CAACC,WAAW,CAACU,GAAG;MACzE,MAAMkE,UAAU,GACfD,cAAc,GAAGA,cAAc,CAAC/W,MAAM,GAAG,CAAC,CAAC,KAAK,GAAG,GAChD+W,cAAc,GAAIzD,SAAoB,GACtCyD,cAAc,GAAG,GAAG,GAAIzD,SAAoB;;MAEhD;MACA,MAAM2D,QAAQ,GAAGJ,QAAQ,EACtB/M,GAAG,CAAEoN,OAAO,IAAK;QAClB,OAAO,IAAI,CAAC5B,gBAAgB,CAACnB,WAAW,EAAEP,UAAU,EAAEsD,OAAO,CAAC;MAC/D,CAAC,CAAC,CACD5S,MAAM,CAAC,UAAU6S,KAAK,EAAE;QACxB;QACA,OAAOA,KAAK,KAAKjV,SAAS,IAAKiV,KAAK,CAAsBjO,IAAI,CAACyN,KAAK,CAAC,GAAG,CAAC,CAAC3W,MAAM,IAAI,CAAC;MACtF,CAAC,CAAC;MACH;MACA,MAAMoX,aAAa,GAAGhW,eAAe,CAACiW,0BAA0B,CAACJ,QAAQ,CAAC,CACxEnN,GAAG,CAAEwN,MAAM,IAAK;QAEhB,OAAO;UAAEpO,IAAI,EAAGoO,MAAM,CAAUpO,IAAI;UAAE0L,IAAI,EAAG0C,MAAM,CAAU1C,IAAI;UAAEhW,KAAK,EAAG0Y,MAAM,CAAU1Y;QAAM,CAAC;MACnG,CAAC,CAAC,CACD2Y,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC;MACd,OAAO;QACNC,SAAS,EAAEvF,QAAQ,GAAG,SAAS,CAAC,EAAElO,KAAK;QACvC0T,QAAQ,EAAEtD,WAAW,CAAC,sCAAsC,CAAC,GAC1D,QAAQ,GAAGA,WAAW,CAAC,sCAAsC,CAAC,CAAClS,MAAM,GACrE,EAAE;QACLuG,GAAG,EAAEwO,UAAU,GAAG,gBAAgB;QAClCjU,cAAc,EAAG+T,UAAU,CAAgC/T,cAAc;QACzEC,MAAM,EAAG8T,UAAU,CAAwB9T,MAAM;QACjD0B,EAAE,EAAEuN,QAAQ,GAAG,SAAS,CAAC,EAAEvN,EAAE;QAC7BgT,OAAO,EAAEN;MACV,CAAC;IACF;;IAEA;AACD;AACA;AACA;AACA;AACA;AACA;AACA;IACeO,QAAQA,CAAC1F,QAAuB,EAAE2F,WAAmB;MAAA,IAAE;QAAA,MAAAC,OAAA,GAIpE,IAAI;QAAA,SAAAC,QAAA;UAUJ,OAAOD,OAAA,CAAKE,cAAc,CAACC,WAAW,CAAC;QAAC;QAbxC;QACA,MAAMC,aAAa,GAAGhG,QAAQ,GAAG,SAAS,CAAC,GAAG,MAAM,CAAC,CAAC,WAAW,CAAW;QAC5E,MAAM+F,WAAW,GAAG,IAAIE,GAAG,CAACD,aAAa,EAAEL,WAAW,CAAC,CAACO,IAAI;QAC5DN,OAAA,CAAKE,cAAc,GAAGF,OAAA,CAAKE,cAAc,IAAI,CAAC,CAAC;QAAC,MAAAK,OAAA;UAAA,IAC5C,CAACP,OAAA,CAAKE,cAAc,CAACC,WAAW,CAAC;YAAA,OAAA/R,OAAA,CAAAC,OAAA,CACNjJ,cAAc,CAACob,MAAM,CAAC;cACnD;cACAC,SAAS,EAAEN,WAAW;cACtBO,KAAK,EAAE,IAAI;cACXC,aAAa,EAAEvG,QAAQ,CAAC,SAAS,CAAC,GAAG,MAAM,CAAC,CAAC,eAAe;YAC7D,CAAC,CAAC,EAAA7T,IAAA,WALIqa,eAAe;cAMrBZ,OAAA,CAAKE,cAAc,CAACC,WAAW,CAAC,GAAGS,eAAe;YAAC;UAAA;QAAA;QAAA,OAAAxS,OAAA,CAAAC,OAAA,CAAAkS,OAAA,IAAAA,OAAA,CAAAha,IAAA,GAAAga,OAAA,CAAAha,IAAA,CAAA0Z,OAAA,IAAAA,OAAA,CAAAM,OAAA;MAGrD,CAAC,QAAAja,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;AACA;AACA;IACSua,2BAA2BA,CAACC,MAAc,EAAEC,GAAmB,EAAE;MACxE,IAAIC,KAAK,GAAG,EAAE;MACd,IAAIF,MAAM,IAAIA,MAAM,CAACnV,UAAU,CAAC,IAAI,CAAC,EAAE;QACtCqV,KAAK,GAAGF,MAAM,CAACG,SAAS,CAAC,CAAC,EAAEH,MAAM,CAAC3Y,MAAM,GAAG,CAAC,CAAC;MAC/C,CAAC,MAAM,IAAI2Y,MAAM,IAAIA,MAAM,CAACnV,UAAU,CAAC,GAAG,CAAC,EAAE;QAC5CqV,KAAK,GAAGF,MAAM,CAACG,SAAS,CAAC,CAAC,EAAEH,MAAM,CAAC3Y,MAAM,GAAG,CAAC,CAAC;MAC/C;MACA,OAAO6Y,KAAK,GAAGD,GAAG,CAACG,OAAO,CAACF,KAAK,CAAC,GAAGF,MAAM;IAC3C;;IAEA;AACD;AACA;AACA;AACA;AACA;AACA;IACSK,kBAAkBA,CAACC,UAAmB,EAAE;MAE/C,IAAIC,eAAe,GAAG,CAAED,UAAU,CAAera,KAAK,CAAC4E,UAAU,CAAC,GAAG,CAAC,GACnE,4CAA4C,GAAIyV,UAAU,CAAe/P,IAAI,GAAG,MAAM,GACrF+P,UAAU,CAAera,KAAK;MAClC,IAAKqa,UAAU,CAAerE,IAAI,KAAK,UAAU,IAAKqE,UAAU,CAAerE,IAAI,KAAK,cAAc,EAAE;QACvG,MAAMuE,kBAAkB,GAAGxX,IAAI,CAACyX,SAAS,CAAC;UACzCC,OAAO,EAAErc,UAAU,CAACsc,cAAc,CAAC,OAAO;QAC3C,CAAC,CAAC;QACFJ,eAAe,GACd,MAAM,GACLD,UAAU,CAAe/P,IAAI,GAC9B,sBAAsB,GACrB+P,UAAU,CAAe/P,IAAI,GAC9B,KAAK,GACLiQ,kBAAkB,GAClB,SAAS;MACX;MACA,OAAOD,eAAe;IACvB;;IAEA;AACD;AACA;AACA;AACA;AACA;AACA;IACSK,YAAYA,CAACC,MAAyB,EAAE;MAC/C,MAAMC,gBAAgB,GAAG9X,IAAI,CAACC,KAAK,CAACD,IAAI,CAACyX,SAAS,CAAC/a,YAAY,CAAC,CAAkB;MAClF,MAAMqF,IAAI,GAAG+V,gBAAgB,CAAC,SAAS,CAAC;MACxC,MAAMC,KAAK,GAAGD,gBAAgB,CAAC,UAAU,CAAC;MAC1C,IAAI/V,IAAI,EAAE;QACTA,IAAI,CAACgB,EAAE,GAAG,OAAO,GAAG8U,MAAM,CAAC9U,EAAE,GAAG,GAAG,GAAGiV,IAAI,CAACC,GAAG,CAAC,CAAC;QAChDlW,IAAI,CAACK,KAAK,GAAI2V,KAAK,CAACG,MAAM,CAAuB9V,KAAK,GAAGyV,MAAM,CAAChC,SAAmB;QACnF9T,IAAI,CAAC+T,QAAQ,GAAIiC,KAAK,CAACG,MAAM,CAA0BpC,QAAQ,GAAG+B,MAAM,CAAC/B,QAAQ;MAClF;MACA,MAAMqC,QAAQ,GAAGJ,KAAK,CAACK,OAAO;MAC9BD,QAAQ,CAACE,IAAI,CAACjW,KAAK,GAAG,IAAI,CAACiV,kBAAkB,CAACQ,MAAM,CAAC9B,OAAO,CAAC,CAAC,CAAC,CAAC;MAChEoC,QAAQ,CAACE,IAAI,CAAC/V,WAAW,GAAG,IAAI,CAAC+U,kBAAkB,CAACQ,MAAM,CAAC9B,OAAO,CAAC,CAAC,CAAC,CAAC;MACtEoC,QAAQ,CAACE,IAAI,CAACC,UAAU,CAAC,CAAC,CAAC,GAAG;QAC7Brb,KAAK,EAAE,IAAI,CAACoa,kBAAkB,CAACQ,MAAM,CAAC9B,OAAO,CAAC,CAAC,CAAC,CAAC;QACjD/K,OAAO,EAAE,SAAS,GAAI6M,MAAM,CAAC9B,OAAO,CAAC,CAAC,CAAC,CAAsBxO,IAAI,GAAG;MACrE,CAAC;MACD4Q,QAAQ,CAACI,IAAI,CAACC,OAAO,CAAC3R,GAAG,GAAGgR,MAAM,CAAChR,GAAG;MAEtCsR,QAAQ,CAACE,IAAI,CAACI,OAAO,GAAGV,KAAK,CAACG,MAAM,CAACO,OAAO,GAAG,CAC9C;QACCxF,IAAI,EAAE,YAAY;QAClB7P,UAAU,EAAE;UACXsV,SAAS,EAAE;YACVtX,cAAc,EAAEyW,MAAM,CAACzW,cAAc;YACrCC,MAAM,EAAEwW,MAAM,CAACxW;UAChB;QACD;MACD,CAAC,CACD;MAEDyW,gBAAgB,CAAC,cAAc,CAAC,GAAG;QAClCa,WAAW,EAAEd,MAAM,CAAC9U,EAAY;QAChC6V,QAAQ,EAAE,IAAI;QACdC,QAAQ,EAAE;UACTC,GAAG,EAAE,IAAI,CAACC,WAAW,CAACC,OAAO,GAAG,GAAG,GAAG,IAAI,CAACD,WAAW,CAACE;QACxD,CAAC;QACDjO,OAAO,EAAE;MACV,CAAC;MAED,OAAO8M,gBAAgB;IACxB;;IAEA;AACD;AACA;AACA;AACA;AACA;AACA;IACeoB,gBAAgBA,CAACC,OAAiB;MAAA,IAAE;QAAA,MAAAC,OAAA,GACA,IAAI;QAAA,OAAA9U,OAAA,CAAAC,OAAA,CAAjBD,OAAO,CAAC4D,GAAG,CAAC,CAACkR,OAAA,CAAKC,eAAe,CAAC,CAAC,EAAED,OAAA,CAAK3J,eAAe,CAAC,CAAC,CAAC,CAAC,EAAAhT,IAAA,WAAA6c,KAAA;UAAA,IAA3F,CAACC,SAAS,EAAEC,QAAQ,CAAC,GAAAF,KAAA;UAAA,OAAAhV,OAAA,CAAAC,OAAA,CACDhJ,WAAW,CAACke,IAAI,CAAC,CAAC,EAAAhd,IAAA,WAAAid,iBAAA;YAA5CN,OAAA,CAAKL,WAAW,GAAAW,iBAA4E;YAE5F,IAAIC,QAAQ,GAAGR,OAAO,CACpBhR,GAAG,CAAEtF,KAAK,IAAK;cACf,MAAMd,IAAI,GAAGwX,SAAS,CAAC3U,IAAI,CAAE4Q,KAAK,IAAK;gBACtC,OAAOA,KAAK,EAAEoE,SAAS,EAAExW,UAAU,GAAG,cAAc,CAAC,EAAEyW,YAAY,EAAE5c,KAAK,KAAK4F,KAAK;cACrF,CAAC,CAAC;cAEF,IAAId,IAAI,EAAE;gBACT,MAAMa,IAAI,GAAG4W,QAAQ,CAAC5U,IAAI,CAAEkV,QAAQ,IAAK;kBACxC,OAAO/X,IAAI,CAACX,cAAc,KAAK0Y,QAAQ,CAACtb,MAAM,EAAE4C,cAAc,IAAIW,IAAI,CAACV,MAAM,KAAKyY,QAAQ,CAACtb,MAAM,EAAE6C,MAAM;gBAC1G,CAAC,CAAC;gBACF,OAAQuB,IAAI,IAAIb,IAAI,EAAEgY,gBAAgB,EAAEC,uBAAuB,EAAE1J,QAAQ;cAC1E;cACA,OAAO/P,SAAS;YACjB,CAAC,CAAC,CACDoC,MAAM,CAAEkE,GAAG,IAAK;cAChB,OAAOA,GAAG,KAAKtG,SAAS;YACzB,CAAC,CAAC;YAEH,MAAM0Z,iBAAiB,GAAGN,QAAQ,CAACxR,GAAG,WAAQtB,GAAG;cAAA,IAAK;gBAAA,OAAAvC,OAAA,CAAAC,OAAA,CAC9B2V,KAAK,CAAC5Z,MAAM,CAACuG,GAAG,CAAC,CAAC,EAAApK,IAAA,WAAnC6S,QAAQ;kBAAA,OAAAhL,OAAA,CAAAC,OAAA,CACU+K,QAAQ,CAAC6K,IAAI,CAAC,CAAC,EAAA1d,IAAA,WAAA2d,cAAA;oBAAvC,MAAM9J,QAAQ,GAAA8J,cAA2C;oBACzD,OAAO;sBACNvT,GAAG,EAAEyI,QAAQ,CAACzI,GAAG;sBACjByJ,QAAQ,EAAEA;oBACX,CAAC;kBAAC;gBAAA;cACH,CAAC,QAAA9T,CAAA;gBAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;cAAA;YAAA,EAAC;YAAC,OAAA8H,OAAA,CAAAC,OAAA,CAEqBD,OAAO,CAAC4D,GAAG,CAAC+R,iBAAiB,CAAC,EAAAxd,IAAA,WAAhD4d,SAAS;cAEf,MAAMC,cAAc,GAAGD,SAAS,CAAC1X,MAAM,CAAE4X,WAAW,IAAK;gBACxD,OAAOnB,OAAA,CAAK/I,oBAAoB,CAACkK,WAAW,CAACjK,QAAQ,CAAC;cACvD,CAAC,CAAC;cAEF,MAAMkK,aAAa,GAAGF,cAAc,CAACnS,GAAG,CAAEoS,WAAW,IAAK;gBACzD,OAAOnB,OAAA,CAAKvI,cAAc,CAAC0J,WAAW,CAACjK,QAAQ,CAAC,CAAC7T,IAAI,CAAEge,KAAK,IAAK;kBAChE,OAAQA,KAAK,CAAWC,YAAY,CAAC,CAAC;gBACvC,CAAC,CAAC;cACH,CAAC,CAAC;cAAC,OAAApW,OAAA,CAAAC,OAAA,CAEsBD,OAAO,CAAC4D,GAAG,CAACsS,aAAa,CAAC,EAAA/d,IAAA,WAA7Cke,UAAU;gBAChB,MAAMC,YAAY,GAAGN,cAAc,CAACnS,GAAG,WAAQoS,WAAW,EAAEpN,KAAK;kBAAA,IAAK;oBAAA,IAAA0N,MAAA;oBAAA,OAAAvW,OAAA,CAAAC,OAAA,CAAAnI,MAAA,aACjE;sBAAA,SAAA0e,QAAAC,QAAA;wBAAA,OAAAF,MAAA,GAAAE,QAAA,GA8CI3B,OAAA,CAAKxB,YAAY,CAACoD,SAAS,CAAC;sBAAA;sBA7CnC,MAAM/I,UAAU,GAAG0I,UAAU,CAACxN,KAAK,CAAmB;sBACtD,MAAMwE,SAAS,GAAGyH,OAAA,CAAK1H,aAAa,CAAC6I,WAAW,CAACjK,QAAQ,CAAC;sBAC1D,IAAI,CAACqB,SAAS,EAAE;wBACf,OAAOpR,SAAS;sBACjB;sBACA,MAAMsR,UAAU,GAAGI,UAAU,CAACM,iBAAiB,CAACZ,SAAmB,CAAe;sBAClF,MAAMa,WAAW,GAAGP,UAAU,CAACQ,kBAAkB,CAACZ,UAAU,CAACa,UAAU,CAAgB;sBACvF,MAAMuI,SAAS,GAAGzI,WAAW,CAAC,qCAAqC,CAAC;sBACpE,IAAI,CAACyI,SAAS,IAAI7B,OAAA,CAAKxH,uBAAuB,CAACC,UAAU,EAAEW,WAAW,CAACa,QAAQ,CAAC,EAAE;wBACjF,OAAO9S,SAAS;sBACjB;sBACA,MAAM2a,gBAAgB,GAAG9B,OAAA,CAAKpH,iCAAiC,CAACC,UAAU,EAAEN,SAAS,EAAY,IAAI,CAAC;sBACtG,IAAIuJ,gBAAgB,IAAIA,gBAAgB,CAAC7I,aAAa,IAAI6I,gBAAgB,CAAC9X,UAAU,CAAC/E,MAAM,EAAE;wBAC7F,MAAM8c,cAAc,GAAGlJ,UAAU,CAACM,iBAAiB,CAAC2I,gBAAgB,CAAC7I,aAAa,CAAc;wBAChG,IAAI+G,OAAA,CAAKxH,uBAAuB,CAACuJ,cAAc,EAAED,gBAAgB,CAAC9X,UAAwB,CAAC,EAAE;0BAC5F,OAAO7C,SAAS;wBACjB;sBACD;sBACA,MAAM4U,UAAU,GAAGoE,SAAS,CAAC3U,IAAI,CAAC,UAAU7C,IAAI,EAAE;wBACjD,OAAOA,IAAI,CAACgY,gBAAgB,IAAIhY,IAAI,CAACgY,gBAAgB,CAACqB,gBAAgB,KAAKb,WAAW,EAAEjK,QAAQ,GAAG,SAAS,CAAC,EAAEvN,EAAE;sBAClH,CAAC,CAAC;sBACF,MAAMiY,SAAS,GAAG5B,OAAA,CAAKnE,oBAAoB,CAC1CsF,WAAW,CAACjK,QAAQ,EACpBkC,WAAW,EACXyI,SAAS,EACTtJ,SAAS,EACTwD,UAAU,EACVlD,UACD,CAAC;sBACD;sBACA,IAAI+I,SAAS,CAACjF,OAAO,CAAC1X,MAAM,GAAG,CAAC,EAAE;wBACjC,OAAOkC,SAAS;sBACjB;sBAAC,MAAA8a,OAAA;wBAAA,IACG,OAAOd,WAAW,EAAEjK,QAAQ,GAAG,SAAS,CAAC,EAAEgL,IAAI,KAAK,QAAQ;0BAC/D,MAAMhF,aAAa,GAAGiE,WAAW,CAACjK,QAAQ,CAAC,SAAS,CAAC,CAACgL,IAAI,CAAC3E,SAAS;0BACpE;0BAAA;4BAAA,IAECL,aAAa,KACZiE,WAAW,CAACjK,QAAQ,CAAC,SAAS,CAAC,CAAClO,KAAK,CAACP,UAAU,CAAC,OAAO,CAAC,IAAI0Y,WAAW,CAACjK,QAAQ,CAAC,SAAS,CAAC,CAAClO,KAAK,CAACP,UAAU,CAAC,GAAG,CAAC,CAAC;8BAAA,OAAAyC,OAAA,CAAAC,OAAA,CAEnF6U,OAAA,CAAKpD,QAAQ,CAACuE,WAAW,CAACjK,QAAQ,EAAEiK,WAAW,CAAC1T,GAAG,CAAC,EAAApK,IAAA,WAA/E8e,kBAAkB;gCACxBP,SAAS,CAACnF,SAAS,GAAGuD,OAAA,CAAKrC,2BAA2B,CAACiE,SAAS,CAACnF,SAAS,EAAY0F,kBAAkB,CAAC;gCAAC,MAAAC,oBAAA,GACnGpC,OAAA,CAAKxB,YAAY,CAACoD,SAAS,CAAC;gCAAAH,MAAA;gCAAA,OAAAW,oBAAA;8BAAA;4BAAA;0BAAA;wBAAA;sBAAA;sBAAA,OAAAH,OAAA,IAAAA,OAAA,CAAA5e,IAAA,GAAA4e,OAAA,CAAA5e,IAAA,CAAAqe,OAAA,IAAAA,OAAA,CAAAO,OAAA;oBAItC,CAAC,YAAQlb,KAAK,EAAE;sBACf/E,GAAG,CAAC+E,KAAK,CAACA,KAAe,CAAC;sBAC1B,OAAOI,SAAS;oBACjB,CAAC;kBACF,CAAC,QAAA/D,CAAA;oBAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;kBAAA;gBAAA,EAAC;gBAAC,OAAA8H,OAAA,CAAAC,OAAA,CAEiBD,OAAO,CAAC4D,GAAG,CAAC0S,YAAY,CAAC,EAAAne,IAAA,WAAvCgf,KAAK;kBACX,OAAOA,KAAK,CAAC9Y,MAAM,CAAE+Y,IAAI,IAAK;oBAC7B,OAAOA,IAAI,KAAKnb,SAAS;kBAC1B,CAAC,CAAC;gBAAC;cAAA;YAAA;UAAA;QAAA;MACJ,CAAC,QAAA/D,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;AACA;IACSmf,qBAAqBA,CAACC,MAAe,EAAE;MAC9C,MAAMC,SAAkC,GAAG,CAAC,CAAC;MAC7C,MAAMC,OAAgB,GAAG,EAAE;MAC3BF,MAAM,CAACnZ,OAAO,CAAEsV,KAAK,IAAK;QACzB,MAAMgE,UAAU,GAAGhE,KAAK,EAAEiE,iBAAiB,GAAG,UAAU,CAAC,EAAE9D,MAAM,EAAE9V,KAAK,IAAI,EAAE;QAC9E,IAAI,CAACyZ,SAAS,CAACE,UAAU,CAAC,EAAE;UAC3BD,OAAO,CAAC9c,IAAI,CAAC+Y,KAAK,CAAC;UACnB8D,SAAS,CAACE,UAAU,CAAC,GAAG,IAAI;QAC7B;MACD,CAAC,CAAC;MACF,OAAOD,OAAO;IACf;;IAEA;AACD;AACA;AACA;AACA;AACA;IACcG,kBAAkBA,CAAA;MAAA,IAAG;QAAA,MAAAC,OAAA,GAEV,IAAI;QAAA,OAAA5X,OAAA,CAAAC,OAAA,CAAAnI,MAAA,aADvB;UAAA,OAAAkI,OAAA,CAAAC,OAAA,CACmB2X,OAAA,CAAKtN,sBAAsB,CAAC,CAAC,EAAAnS,IAAA,WAA7C0c,OAAO;YAAA,OAAA7U,OAAA,CAAAC,OAAA,CACY2X,OAAA,CAAKhD,gBAAgB,CAACC,OAAO,CAAC,EAAA1c,IAAA,WAAjD0f,UAAU;cAChB,MAAMC,aAAa,GAAGD,UAAU,CAACE,KAAK,CAAC,CAAC,EAAE7c,sBAAsB,CAAC;cACjE,MAAM8c,iBAAiB,GAAGF,aAAa,CAACjU,GAAG,CAAEmI,QAAQ,IAAK;gBACzD,IAAIvN,EAAE;gBACN,IAAIuN,QAAQ,EAAE;kBACbA,QAAQ,CAAC,UAAU,CAAC,CAACiM,GAAG,GAAG,IAAI;kBAC/BxZ,EAAE,GAAGuN,QAAQ,CAAC,SAAS,CAAC,EAAEvN,EAAY;gBACvC;gBACA,OAAO;kBACNA,EAAE;kBACFiZ,iBAAiB,EAAE1L;gBACpB,CAAC;cACF,CAAC,CAAC;cACF,OAAO4L,OAAA,CAAKP,qBAAqB,CAACW,iBAA4B,CAAC;YAAC;UAAA;QACjE,CAAC,YAAQnc,KAAK,EAAE;UACf/E,GAAG,CAAC+E,KAAK,CAAC,0CAA0C,GAAIA,KAAK,CAAWE,OAAO,CAAC;UAChF,OAAO,EAAE;QACV,CAAC;MACF,CAAC,QAAA7D,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACcggB,4BAA4BA,CAAA;MAAA,IAACrR,YAAqB,GAAA3F,SAAA,CAAAnH,MAAA,QAAAmH,SAAA,QAAAjF,SAAA,GAAAiF,SAAA,MAAG,KAAK;MAAA,IAAE;QAAA,MAAAiX,OAAA,GACnE,IAAI;QAAA,SAAAC,QAAA;UA4BT,OAAOD,OAAA,CAAKE,0BAA0B;QAAC;QAAA,MAAAC,OAAA;UAAA,IA5BnC,CAACH,OAAA,CAAKE,0BAA0B,IAAIxR,YAAY;YAAA,OAAA7G,OAAA,CAAAC,OAAA,CACjBkY,OAAA,CAAK7N,sBAAsB,CAACzD,YAAY,CAAC,EAAA1O,IAAA,WAArE0S,mBAAmB;cAAA,MAAA0N,OAAA;gBAAA,IACrB1N,mBAAmB,CAAC9Q,MAAM;kBAC7B,IAAIye,oBAA4C,GAAG,EAAE;kBACrD,IAAIC,0BAAkD,GAAG,EAAE;kBAAC,OAAAzY,OAAA,CAAAC,OAAA,CACID,OAAO,CAAC4D,GAAG,CAAC,CAC3EuU,OAAA,CAAKO,4BAA4B,CAAC7N,mBAAmB,CAAC,EACtDsN,OAAA,CAAKrW,gBAAgB,CAAC+E,YAAY,CAAC,CACnC,CAAC,EAAA1O,IAAA,WAAAwgB,KAAA;oBAAA,IAHE,CAACC,yBAAyB,EAAExZ,sBAAsB,CAAC,GAAAuZ,KAAA;oBAIvD;oBACAC,yBAAyB,GAAGA,yBAAyB,CAACva,MAAM,CAAEW,MAAM,IACnEG,4BAA4B,CAACH,MAAM,EAAEI,sBAAsB,CAC5D,CAAC;oBACDwZ,yBAAyB,CAACza,OAAO,CAAEa,MAAM,IAAK;sBAC7C,IAAID,4BAA4B,CAACC,MAAM,CAAC,EAAE;wBACzCyZ,0BAA0B,CAAC/d,IAAI,CAACsE,MAAM,CAAC;sBACxC,CAAC,MAAM;wBACNwZ,oBAAoB,CAAC9d,IAAI,CAACsE,MAAM,CAAC;sBAClC;oBACD,CAAC,CAAC;oBACF;oBACAmZ,OAAA,CAAKE,0BAA0B,GAAGG,oBAAoB,CACpDT,KAAK,CAAC,CAAC,EAAE,EAAE,GAAGU,0BAA0B,CAAC1e,MAAM,CAAC,CAChDoW,MAAM,CAACsI,0BAA0B,CAAC;kBAAC;gBAAA;kBAErCN,OAAA,CAAKE,0BAA0B,GAAG,EAAE;gBAAC;cAAA;cAAA,IAAAE,OAAA,IAAAA,OAAA,CAAApgB,IAAA,SAAAogB,OAAA,CAAApgB,IAAA;YAAA;UAAA;QAAA;QAAA,OAAA6H,OAAA,CAAAC,OAAA,CAAAqY,OAAA,IAAAA,OAAA,CAAAngB,IAAA,GAAAmgB,OAAA,CAAAngB,IAAA,CAAAigB,OAAA,IAAAA,OAAA,CAAAE,OAAA;MAIxC,CAAC,QAAApgB,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;AACA;AACA;IACe6c,eAAeA,CAAA;MAAA,IAAG;QAAA,OAAA/U,OAAA,CAAAC,OAAA,CAAAnI,MAAA,aAC3B;UAAA,OAAAkI,OAAA,CAAAC,OAAA,CACmB5I,SAAS,CAAC6I,eAAe,CAA6B,4BAA4B,CAAC,EAAA/H,IAAA,WAAnG0gB,OAAO;YACb,OAAOA,OAAO,EAAEC,SAAS,EAAEC,UAAU,IAAI,EAAE;UAAC;QAC7C,CAAC,YAAQld,KAAK,EAAE;UACf/E,GAAG,CAAC+E,KAAK,CAAC,qCAAqC,GAAIA,KAAK,CAAWE,OAAO,CAAC;UAC3E,OAAO,EAAE;QACV,CAAC;MACF,CAAC,QAAA7D,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;IAED;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACewgB,4BAA4BA,CAACM,QAAkB;MAAA,IAAE;QAAA,MAAAC,OAAA,GAGX,IAAI;QAFvD,MAAMhX,cAAsC,GAAG,EAAE;QACjD,MAAMiX,qBAA2C,GAAG,IAAIC,GAAG,CAAkB,CAAC;QAAC,OAAAnZ,OAAA,CAAAC,OAAA,CACzCD,OAAO,CAAC4D,GAAG,CAAC,CAACqV,OAAA,CAAKlE,eAAe,CAAC,CAAC,EAAEkE,OAAA,CAAK9N,eAAe,CAAC,CAAC,CAAC,CAAC,EAAAhT,IAAA,WAAAihB,KAAA;UAAA,IAA7F,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAAF,KAAA;UAC7BJ,QAAQ,CAAC7a,OAAO,CAAEc,OAAO,IAAK;YAC7B;YACA,MAAMsa,cAAc,GAAGF,QAAQ,CAAChb,MAAM,CAAC,UAAUmb,OAAO,EAAE;cACzD,OAAOA,OAAO,EAAElE,SAAS,CAACxW,UAAU,CAAC,cAAc,CAAC,EAAEyW,YAAY,EAAE5c,KAAK,KAAKsG,OAAO;YACtF,CAAC,CAAC;YACFsa,cAAc,CAACpb,OAAO,CAAEsb,GAAG,IAAK;cAC/B;cACA,IAAIC,sBAAsB,GAAGJ,WAAW,CAACjb,MAAM,CAAEsb,UAAU,IAAK;gBAC/D,OAAOA,UAAU,EAAEzf,MAAM,EAAE4C,cAAc,KAAK2c,GAAG,CAAC3c,cAAc,IAAI6c,UAAU,CAACzf,MAAM,CAAC6C,MAAM,KAAK0c,GAAG,CAAC1c,MAAM;cAC5G,CAAC,CAAC;cAEF,MAAM6c,iBAAiB,GAAGF,sBAAsB,CAACrb,MAAM,CAAEwb,qBAAqB,IAC7Ehb,mBAAmB,CAACgb,qBAAqB,CAC1C,CAAC;cACD,MAAMC,oBAAoB,GAAGJ,sBAAsB,CAACrb,MAAM,CACxDwb,qBAAqB,IAAK,CAAChb,mBAAmB,CAACgb,qBAAqB,CACtE,CAAC;cACD;cACA,IAAID,iBAAiB,CAAC7f,MAAM,GAAG,CAAC,IAAI+f,oBAAoB,CAAC/f,MAAM,GAAG,CAAC,EAAE;gBACpE2f,sBAAsB,GAAG,CAAC,GAAGI,oBAAoB,CAAC;cACnD;cAEAJ,sBAAsB,CAACvb,OAAO,CAAE0b,qBAAqB,IAAK;gBACzD,IAAIrb,aAAa,GAAGqb,qBAAqB,CAAC5X,cAAc,CAAC,CAAC,CAAC;gBAC3D,IAAI8X,wBAA8C,GAAG;kBACpDjc,KAAK,EAAEU,aAAa,CAACV,KAAK;kBAC1BC,QAAQ,EAAES,aAAa,CAACT,QAAQ;kBAChC+E,IAAI,EAAEtE,aAAa,CAACsE,IAAI;kBACxBP,GAAG,EAAE/D,aAAa,CAAC8D,SAAS;kBAC5B0B,KAAK,EAAExF,aAAa,CAACwF,KAAK;kBAC1B/E,OAAO,EAAEA,OAAO;kBAChBT,aAAa,EAAEA;gBAChB,CAAC;gBACD;gBACA,IACC,CAAC0a,qBAAqB,CAACc,GAAG,CAACD,wBAAwB,CAACxX,GAAI,CAAC,IACzD,CAAC2W,qBAAqB,CAACc,GAAG,CAACD,wBAAwB,CAACjc,KAAM,CAAC,EAC1D;kBACDob,qBAAqB,CAACe,GAAG,CAACF,wBAAwB,CAACxX,GAAG,EAAG,IAAI,CAAC;kBAC9D2W,qBAAqB,CAACe,GAAG,CAACF,wBAAwB,CAACjc,KAAK,EAAG,IAAI,CAAC;kBAChEmE,cAAc,CAACvH,IAAI,CAACqf,wBAAwB,CAAC;gBAC9C;cACD,CAAC,CAAC;YACH,CAAC,CAAC;UACH,CAAC,CAAC;UACF,OAAO9X,cAAc;QAAC;MACvB,CAAC,QAAA/J,CAAA;QAAA,OAAA8H,OAAA,CAAAnG,MAAA,CAAA3B,CAAA;MAAA;IAAA;EACF;EAAC,OAAAqH,UAAA;AAAA","ignoreList":[]}
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *  * (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
"use strict";sap.ui.define(["sap/m/Column","sap/m/ColumnListItem","sap/m/HBox","sap/m/ObjectIdentifier","sap/m/Table","sap/m/ToggleButton","sap/ui/core/CustomData","sap/ui/core/dnd/DragDropInfo","sap/ui/core/Element","sap/ui/core/Icon","./BaseSettingsPanel","./flexibility/Layout.flexibility","./utils/Constants"],function(e,t,n,s,i,a,o,l,r,c,d,g,u){"use strict";function p(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const m=p(d);const h=g["CHANGE_TYPES"];const y=u["KEYUSER_SETTINGS_PANELS_KEYS"];const I=m.extend("sap.cux.home.KeyUserLayoutSettingsPanel",{metadata:{library:"sap.cux.home"},init:function e(){m.prototype.init.call(this);this.setProperty("key",y.LAYOUT);this.setProperty("title",this._i18nBundle.getText("editModeTitle"));this.addAggregation("content",this.getContent());this.attachPanelNavigated(()=>{const e=this._getPanel();e.resetSections();void this.loadSections()})},getContent:function t(){if(!this.layoutTable){this.layoutTable=new i(this.getId()+"--idLayoutSettingsTable",{width:"calc(100% - 2rem)",items:[],columns:[new e(this.getId()+"--idSectionTitleColumn",{width:"100%"})],dragDropConfig:new l(this.getId()+"--idLayoutSettingsDragInfo",{sourceAggregation:"items",targetAggregation:"items",groupName:"LayoutSettingsItems",dropPosition:"On",drop:e=>{this.onDropLayoutSettings(e)}})}).addStyleClass("layoutSettingsTable sapContrastPlus sapUiSmallMarginBegin")}return this.layoutTable},loadSections:function e(){try{const e=this;const i=e._getPanel();return Promise.resolve(i._calculateSectionsState()).then(function(){e.orderedSections=i.getSections()||[];const l=e.getParent();e.layoutTable.removeAllItems();e.orderedSections.forEach(i=>{e.layoutTable.addItem(new t({type:e.getParent()?.hasDetailsPage?.(i.completeId)?"Navigation":"Inactive",cells:[new n({alignItems:"Center",items:[new c({src:"sap-icon://vertical-grip"}).addStyleClass("sapUiSmallMarginEnd"),new n({justifyContent:"SpaceBetween",alignItems:"Center",width:"100%",items:[new s({title:i.title,text:i.text,tooltip:i.title}),new a({tooltip:i.visible?e._i18nBundle.getText("hideBtn"):e._i18nBundle.getText("showBtn"),icon:"sap-icon://show",type:"Emphasized",enabled:!i.blocked,press:t=>e.createShowHideChangeFile(t,i),pressed:!i.visible,ariaLabelledBy:["selectLabel"]}).addStyleClass("sapUiTinyMarginEnd sapUiTinyMarginTop")]}).addStyleClass("sapUiTinyMarginBegin")],width:"100%"})],press:()=>l?.navigateToPage?.(l.getDetailsPage(i.completeId)),customData:new o({key:"sectionObject",value:i})})).addStyleClass("insightsListItem insightsListMargin")})})}catch(e){return Promise.reject(e)}},onDropLayoutSettings:function e(t){const n=this._getPanel();const s=n.getId();const i=t.getParameter?.("draggedControl")||t.draggedControl;const a=i.getParent()?.indexOfItem(i);const o=t.getParameter?.("droppedControl")||t.droppedControl;const l=i.getParent()?.indexOfItem(o);if(a!==l){const e=this.orderedSections;const t=i.data("sectionObject");const r=o.data("sectionObject");const c=this._getActualIndex(t.completeId);const d=this._getActualIndex(r.completeId);this._rearrangeLayoutElements(c,d);e.splice(a,1);e.splice(l,0,t);n.setSections(e);this.addKeyUserChanges({selectorControl:n,changeSpecificData:{changeType:h.MOVE,content:{movedElements:[{id:t.completeId,sourceIndex:c,targetIndex:d}],source:{id:s,aggregation:"items"},target:{id:s,aggregation:"items"}}}});void this.loadSections()}},_getActualIndex:function e(t){const n=this._getPanel();this._allLayoutElements=this._allLayoutElements||[...n.getItems()];const s=n.getProperty("expanded");const i=n._getCurrentExpandedElement();if(s&&i){if(!this._allLayoutElements.some(e=>e.getId()===i.targetContainer.getId())){this._allLayoutElements.splice(n.indexOfItem(i.targetContainer),0,i.targetContainer)}}return this._allLayoutElements.findIndex(e=>e.getId()===t)},_rearrangeLayoutElements:function e(t,n){const s=this._allLayoutElements.splice(t,1)[0];this._allLayoutElements.splice(n,0,s)},createShowHideChangeFile:function e(t,n){const s=!t.getParameter("pressed");const i=this.getKeyUserChanges();const a=s?h.UNHIDE:h.HIDE;const o=i.find(e=>e.selectorControl.getId()===n.completeId);if(o){o.changeSpecificData.changeType=a}else{this.addKeyUserChanges({selectorControl:r.getElementById(n.completeId),changeSpecificData:{changeType:a}})}}});return I});
//# sourceMappingURL=KeyUserLayoutSettingsPanel.js.map
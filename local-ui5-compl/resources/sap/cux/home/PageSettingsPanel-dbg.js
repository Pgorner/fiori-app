/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *  * (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
"use strict";sap.ui.define(["sap/m/CustomListItem","sap/m/HBox","sap/m/List","sap/m/Panel","sap/m/SearchField","sap/m/Text","sap/m/Title","sap/m/ToggleButton","sap/m/Toolbar","sap/m/ToolbarSpacer","sap/m/VBox","./BaseSettingsPanel","./utils/Constants","./utils/PageManager","./utils/PersonalisationUtils"],function(e,t,s,a,n,i,o,r,l,g,c,d,h,p,u){"use strict";function P(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const S=P(d);const f=h["PAGE_SELECTION_LIMIT"];const m=h["SETTINGS_PANELS_KEYS"];const _=P(p);const w=P(u);const x=S.extend("sap.cux.home.PageSettingsPanel",{constructor:function e(){S.prototype.constructor.apply(this,arguments);this._initialNavigation=true},init:function e(){S.prototype.init.call(this);this.setProperty("key",m.PAGES);this.setProperty("title",this._i18nBundle.getText("pages"));this.setProperty("icon","sap-icon://course-book");this.oWrapperVBox=new c(`${this.getId()}--pageSettingsWrapper`,{width:"100%"}).addStyleClass("sapUiNoPadding sapUiNoMarginEnd");this.addAggregation("content",this.oWrapperVBox);this.attachPanelNavigated(()=>{void this.onPanelNavigated()})},onPanelNavigated:function e(){try{const t=this;function s(){if(t.oSearchField?.getValue()){t.oSearchField.setValue("");t.sSearchQuery="";t._renderPages(t.aSpaces)}}const a=function(){if(t._initialNavigation){t._initialNavigation=false;return Promise.resolve(t._initializePanel()).then(function(){})}}();return Promise.resolve(a&&a.then?a.then(s):s(a))}catch(n){return Promise.reject(n)}},_initializePanel:function e(){try{const e=this;if(!e.PageManagerInstance){e.PageManagerInstance=_.getInstance(w.getPersContainerId(e._getPanel()),w.getOwnerComponent(e._getPanel()))}return Promise.resolve(e.PageManagerInstance.fetchAllAvailablePages()).then(function(t){e.aAllPages=t;return Promise.resolve(e.PageManagerInstance.getFavoritePages()).then(function(t){e.aFavPages=t;return Promise.resolve(e.PageManagerInstance.fetchAllAvailableSpaces()).then(function(t){e.aSpaces=t;e._showMessageStrip();e._showToolbar();e._showPagesList()})})})}catch(e){return Promise.reject(e)}},_showMessageStrip:function e(){const t=new c(`${this.getId()}--msgStripContainer`,{width:"100%"}).addStyleClass("sapUiNoPadding sapUiNoMarginEnd");this.oMessage=new i(`${this.getId()}--msgStripText`).addStyleClass("sapUiSmallMargin");this._seHeaderMessage();t.addItem(this.oMessage);this.oWrapperVBox.addItem(t)},_seHeaderMessage:function e(){this.oMessage.setText(this.aFavPages.length>=f?this._i18nBundle.getText("myInterestwarning"):this._i18nBundle.getText("myInterestinfo"))},_showToolbar:function e(){const t=new o(`${this.getId()}--pagesListTitle`,{text:this._i18nBundle.getText("pageGroupHeader"),titleStyle:"H5"}).addStyleClass("sapUiSmallMarginBottom");this.oSearchField=new n(`${this.getId()}--pagesListSearch`,{liveChange:e=>this._onPagesSearch(e),width:"13.75rem"}).addStyleClass("sapUiSmallMarginBottom");const s=new l(`${this.getId()}--pagesListToolbar`,{width:"calc(100% - 2rem)",height:"3rem",design:"Solid",content:[t,new g(`${this.getId()}--pagesHeaderToolbarSpacer`),this.oSearchField]}).addStyleClass("sapUiSmallMarginBegin pagesToolbarNoPadding");this.oWrapperVBox.addItem(s)},_showPagesList:function e(){this.oPagesListVBox=new c(`${this.getId()}--pagesListVBox`,{width:"calc(100% - 2rem)"}).addStyleClass("sapUiSmallMarginBegin");this._renderPages(this.aSpaces);this.oWrapperVBox.addItem(this.oPagesListVBox)},_createPagesList:function s(a){const n=new i({text:a.label});const o=new r({tooltip:a.selected?this._i18nBundle.getText("hideBtn"):this._i18nBundle.getText("showBtn"),icon:"sap-icon://show",type:"Emphasized",pressed:!a.selected,enabled:a.selected||this.aFavPages.length<f,press:e=>void this._pageSelectHandler(a.id,e)});const l=new t({justifyContent:"SpaceBetween",alignItems:"Center",items:[n,o]});const g=new e({content:[l]}).addStyleClass("pagesPanelItem");return g},_renderPages:function e(n){const o=this.oPagesListVBox.getParent()?.getParent();const r=o?.getDomRef()?.childNodes[1];const l=r?.scrollTop||0;this.oPagesListVBox.removeAllItems();if(!n.length){if(!this.oNoDataHBox){this.oNoDataHBox=new t(`${this.getId()}--noSpacePageHBox`,{height:"3rem",justifyContent:"Center",alignItems:"Center",items:[new i({text:this._i18nBundle.getText("noData")})]}).addStyleClass("pagesBottomBorder");this.oWrapperVBox.addItem(this.oNoDataHBox)}this.oNoDataHBox.setVisible(true)}else if(this.oNoDataHBox){this.oNoDataHBox.setVisible(false)}n.forEach(e=>{const t=[];e.children.forEach(e=>{e.selected=this.aFavPages.find(t=>t.pageId===e.id)?true:false;t.push(this._createPagesList(e))});const n=this._createHeaderToolbar(e);const i=new a("",{expandable:true,expanded:true,width:"auto",headerToolbar:n,content:new s({items:t})}).addStyleClass("pagesPanel");this.oPagesListVBox.addItem(i)});if(l>=0&&o){setTimeout(()=>{o.scrollTo(l)},0)}},_createHeaderToolbar:function e(t){const s=new o({wrapping:true,width:"16rem",text:t.label}).addStyleClass("dialogPanelTitle");const a=new l({design:"Solid",content:[s]});return a},_pageSelectHandler:function e(t,s){try{const e=this;const a=!s.getSource().getPressed();const n=e.aAllPages.find(e=>e.pageId===t);if(!n){return Promise.resolve(false)}if(a){e.aFavPages.push(n)}else{const s=e.aFavPages.findIndex(e=>e.pageId===t);e.aFavPages.splice(s,1)}e._seHeaderMessage();return Promise.resolve(e.PageManagerInstance.getFavPages(e.aFavPages,true)).then(function(){let t;if(e.sSearchQuery?.length){t=e._filterSpacesPages()}e._renderPages(t||e.aSpaces);void e._getPanel().getData()})}catch(e){return Promise.reject(e)}},_onPagesSearch:function e(t){this.sSearchQuery=t.getSource().getValue().toLowerCase();const s=this._filterSpacesPages();this._renderPages(s)},_filterSpacesPages:function e(){const t=[];this.aSpaces.forEach(e=>{const s=[];const a=e.label;e.children.forEach(e=>{if(e.label?.toLowerCase().includes(this.sSearchQuery)||a?.toLowerCase().includes(this.sSearchQuery)){s.push(e)}});if(s.length){t.push({...e,children:s})}});return t}});return x});
//# sourceMappingURL=PageSettingsPanel-dbg.js.map
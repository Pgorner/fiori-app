{"version":3,"file":"ODataUtils.js","names":["sap","ui","define","encodeURLParameters","sap_cards_ap_common_odata_ODataUtils","V2ODataModel","___ODataTypes","V2MetadataAnalyzer","V4MetadataAnalyzer","createContextParameter","PropertyInfoType","getLabelForEntitySet","getLabelForEntitySetV2","getPropertyInfoFromEntity","getPropertyInfoFromEntityV2","getNavigationPropertyInfoFromEntity","getNavigationPropertyInfoFromEntityV2","getMetaModelObjectForEntitySet","getMetaModelObjectForEntitySetForODataV2","getLabelForEntitySetV4","getPropertyInfoFromEntityV4","getNavigationPropertyInfoFromEntityV4","getMetaModelObjectForEntitySetForODataV4","isODataV4Model","oModel","isA","fetchDataAsyncV4","sUrl","sPath","queryParams","formattedUrl","endsWith","format","parameters","sFormattedUrl","Promise","resolve","fetch","then","response","json","data","catch","err","Error","e","reject","fetchDataAsyncV2","fnSuccess","oData","fnFailure","oError","read","success","error","urlParameters","fetchDataAsync","bODataV4","arguments","length","undefined","Object","keys","forEach","key","oAppModel","sEntitySet","withNavigation","resourceBundle","metaModel","getPropertyLabel","sProperty","propertyType","Property","propertyInfo","property","find","oProperty","name","label","getDataType","dataTypeMap","Boolean","Byte","SByte","Int16","Int32","Int64","Single","Double","Float","Decimal","Guid","String","Date","DateTime","DateTimeOffset","Time","Binary","Stream","TimeOfDay","Duration","type","startsWith","replace","createPathWithEntityContext","path","oDataV4","index","indexOf","entitySetName","substring","context","isPropertyTypeDate","dataType","__exports","__esModule"],"sources":["ODataUtils.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\nimport type ResourceBundle from \"sap/base/i18n/ResourceBundle\";\nimport encodeURLParameters from \"sap/base/security/encodeURLParameters\";\nimport { createContextParameter } from \"sap/cards/ap/common/odata/ODataUtils\";\nimport type ODataMetaModel from \"sap/ui/model/odata/ODataMetaModel\";\nimport V2ODataModel from \"sap/ui/model/odata/v2/ODataModel\";\nimport type { default as V4ODataMetaModel } from \"sap/ui/model/odata/v4/ODataMetaModel\";\nimport type { default as V4ODataModel } from \"sap/ui/model/odata/v4/ODataModel\";\nimport { PropertyInfo, PropertyInfoType } from \"./ODataTypes\";\nimport * as V2MetadataAnalyzer from \"./v2/MetadataAnalyzer\";\nimport * as V4MetadataAnalyzer from \"./v4/MetadataAnalyzer\";\nconst {\n\tgetLabelForEntitySet: getLabelForEntitySetV2,\n\tgetPropertyInfoFromEntity: getPropertyInfoFromEntityV2,\n\tgetNavigationPropertyInfoFromEntity: getNavigationPropertyInfoFromEntityV2,\n\tgetMetaModelObjectForEntitySet: getMetaModelObjectForEntitySetForODataV2\n} = V2MetadataAnalyzer;\n\nconst {\n\tgetLabelForEntitySet: getLabelForEntitySetV4,\n\tgetPropertyInfoFromEntity: getPropertyInfoFromEntityV4,\n\tgetNavigationPropertyInfoFromEntity: getNavigationPropertyInfoFromEntityV4,\n\tgetMetaModelObjectForEntitySet: getMetaModelObjectForEntitySetForODataV4\n} = V4MetadataAnalyzer;\n\nexport const isODataV4Model = function (oModel: V2ODataModel | V4ODataModel | undefined): boolean {\n\treturn (oModel && oModel.isA<V4ODataModel>(\"sap.ui.model.odata.v4.ODataModel\")) || false;\n};\n\nexport const fetchDataAsyncV4 = async function (sUrl: string, sPath: string, queryParams: Record<string, string>) {\n\tconst formattedUrl = sUrl.endsWith(\"/\") ? sUrl : `${sUrl}/`;\n\tqueryParams.format = \"json\";\n\tconst parameters = encodeURLParameters(queryParams);\n\tconst sFormattedUrl = `${formattedUrl}${sPath}?${parameters}`;\n\treturn fetch(sFormattedUrl)\n\t\t.then((response) => response.json())\n\t\t.then((data) => data)\n\t\t.catch((err) => {\n\t\t\tthrow new Error(err);\n\t\t});\n};\n\nconst fetchDataAsyncV2 = async function (sUrl: string, sPath: string, queryParams: Record<string, string>) {\n\tconst oModel = new V2ODataModel(sUrl);\n\treturn new Promise(function (resolve, reject) {\n\t\tconst fnSuccess = function (oData: object) {\n\t\t\tresolve(oData);\n\t\t};\n\t\tconst fnFailure = function (oError: Error) {\n\t\t\treject(oError);\n\t\t};\n\t\toModel.read(\"/\" + sPath, { success: fnSuccess, error: fnFailure, urlParameters: queryParams });\n\t});\n};\n\nexport const fetchDataAsync = async function (sUrl: string, sPath: string, bODataV4?: boolean, urlParameters: Record<string, string> = {}) {\n\tconst queryParams: Record<string, string> = {};\n\tObject.keys(urlParameters).forEach((key) => {\n\t\tif (urlParameters[key].length) {\n\t\t\tqueryParams[key] = urlParameters[key];\n\t\t}\n\t});\n\n\tif (bODataV4) {\n\t\treturn fetchDataAsyncV4(sUrl, sPath, queryParams);\n\t} else {\n\t\treturn fetchDataAsyncV2(sUrl, sPath, queryParams);\n\t}\n};\n\nexport const getLabelForEntitySet = function (oAppModel: V2ODataModel | V4ODataModel | undefined, sEntitySet: string) {\n\tif (!oAppModel) {\n\t\treturn \"\";\n\t}\n\tif (oAppModel.isA<V2ODataModel>(\"sap.ui.model.odata.v2.ODataModel\")) {\n\t\treturn getLabelForEntitySetV2(oAppModel, sEntitySet);\n\t} else {\n\t\treturn getLabelForEntitySetV4(oAppModel, sEntitySet);\n\t}\n};\n\nexport const getPropertyInfoFromEntity = function (\n\toAppModel: V2ODataModel | V4ODataModel | undefined,\n\tsEntitySet: string,\n\twithNavigation: boolean,\n\tresourceBundle?: ResourceBundle\n) {\n\tif (!oAppModel) {\n\t\treturn [];\n\t}\n\tif (oAppModel.isA<V2ODataModel>(\"sap.ui.model.odata.v2.ODataModel\")) {\n\t\treturn getPropertyInfoFromEntityV2(oAppModel, sEntitySet, withNavigation, resourceBundle);\n\t} else {\n\t\treturn getPropertyInfoFromEntityV4(oAppModel, sEntitySet, withNavigation, resourceBundle);\n\t}\n};\n\nexport const getNavigationPropertyInfoFromEntity = function (oAppModel: V2ODataModel | V4ODataModel | undefined, sEntitySet: string) {\n\tif (!oAppModel) {\n\t\treturn [];\n\t}\n\tif (oAppModel.isA<V2ODataModel>(\"sap.ui.model.odata.v2.ODataModel\")) {\n\t\treturn getNavigationPropertyInfoFromEntityV2(oAppModel, sEntitySet);\n\t} else {\n\t\treturn getNavigationPropertyInfoFromEntityV4(oAppModel, sEntitySet);\n\t}\n};\n\nexport const getMetaModelObjectForEntitySet = function (\n\tmetaModel: ODataMetaModel | V4ODataMetaModel,\n\tsEntitySet: string,\n\tisODataV4Model: boolean\n) {\n\tif (!isODataV4Model) {\n\t\treturn getMetaModelObjectForEntitySetForODataV2(metaModel as ODataMetaModel, sEntitySet);\n\t} else {\n\t\treturn getMetaModelObjectForEntitySetForODataV4(metaModel as V4ODataMetaModel, sEntitySet);\n\t}\n};\n\nexport function getPropertyLabel(\n\toModel: V2ODataModel | V4ODataModel | undefined,\n\tsEntitySet: string,\n\tsProperty: string,\n\tpropertyType: PropertyInfoType = PropertyInfoType.Property\n) {\n\tconst propertyInfo =\n\t\tpropertyType === PropertyInfoType.Property\n\t\t\t? getPropertyInfoFromEntity(oModel, sEntitySet, false)\n\t\t\t: getNavigationPropertyInfoFromEntity(oModel, sEntitySet);\n\n\tconst property = propertyInfo.find((oProperty) => oProperty.name === sProperty);\n\treturn propertyType === PropertyInfoType.Property ? (property as PropertyInfo)?.label || \"\" : property || \"\";\n}\n\n/**\n * Get the data type of the property mapped with supported data types by integration cards configuration parameters\n * @param propertyType\n */\nexport function getDataType(propertyType: string) {\n\tconst dataTypeMap: Record<string, string> = {\n\t\tBoolean: \"boolean\",\n\t\tByte: \"integer\",\n\t\tSByte: \"integer\",\n\t\tInt16: \"integer\",\n\t\tInt32: \"integer\",\n\t\tInt64: \"number\",\n\t\tSingle: \"number\",\n\t\tDouble: \"number\",\n\t\tFloat: \"number\",\n\t\tDecimal: \"number\",\n\t\tGuid: \"string\",\n\t\tString: \"string\",\n\t\tDate: \"date\",\n\t\tDateTime: \"datetime\",\n\t\tDateTimeOffset: \"datetime\",\n\t\tTime: \"datetime\",\n\t\tBinary: \"\",\n\t\tStream: \"\",\n\t\tTimeOfDay: \"\",\n\t\tDuration: \"\"\n\t};\n\n\tconst type = propertyType.startsWith(\"Edm.\") ? propertyType.replace(\"Edm.\", \"\") : propertyType;\n\treturn dataTypeMap[type] || \"string\";\n}\n\nexport const createPathWithEntityContext = async function (path: string, oAppModel: V2ODataModel | V4ODataModel, oDataV4: boolean) {\n\tconst index = path.indexOf(\"(\");\n\tconst entitySetName = path.substring(0, index);\n\tconst context = await createContextParameter(path, oAppModel, oDataV4);\n\n\treturn `${entitySetName}(${context})`;\n};\n\n/**\n * Checks if the given data type is of a date type.\n *\n * @param {string} dataType - The data type to check.\n * @returns {boolean} - Returns `true` if the data type is one of \"Edm.Date\", \"Edm.DateTimeOffset\", or \"Edm.TimeOfDay\"; otherwise, returns `false`.\n */\n\nexport function isPropertyTypeDate(dataType: string): boolean {\n\treturn [\"Edm.Date\", \"Edm.DateTime\", \"Edm.DateTimeOffset\", \"Edm.TimeOfDay\"].indexOf(dataType) > -1;\n}\n"],"mappings":"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","ignoreList":[]}
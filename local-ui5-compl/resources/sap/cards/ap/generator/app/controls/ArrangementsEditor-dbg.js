/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *  * (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
"use strict";sap.ui.define(["sap/m/Button","sap/m/ComboBox","sap/m/CustomListItem","sap/m/HBox","sap/m/List","sap/m/Text","sap/ui/core/Control","sap/ui/core/Element","sap/ui/core/ListItem","sap/ui/core/library","sap/ui/model/Sorter","sap/ui/model/json/JSONModel","../../config/TextArrangementOptions"],function(e,t,n,o,i,r,s,a,c,g,l,p,h){"use strict";const d=g["ValueState"];const u=h["TEXTARRANGEMENT_OPTIONS"];const m=s.extend("sap.cards.ap.generator.app.controls.ArrangementsEditor",{renderer:{apiVersion:2,render:function(e,t){e.openStart("div",t);e.openEnd();e.renderControl(t._list);e.renderControl(t._addButton);e.close("div")}},metadata:{properties:{mode:"string",selectionKeys:{type:"object",defaultValue:{}},navigationSelectionKeys:{type:"object",defaultValue:{}},items:{type:"object",defaultValue:{}}},aggregations:{_list:{type:"sap.m.List",multiple:false,visibility:"hidden"}},events:{change:{parameters:{value:{type:"int"}}},selectionChange:{parameters:{value:{type:"int"}}}}},constructor:function e(t){s.prototype.constructor.call(this,t)},init:function n(){const o=this;this._list=new i;this._propertyComboBox=new t({selectionChange:function(e){o.handleComboBoxEvents(e,o,false,true)},change:function(e){const t=e.getSource();const n=t.getBindingContext();const i=n?.getPath()||"";const r=o.getModel();const s=r.getProperty(i);const a=true;o.fireEvent("change",{value:o.getItems(),selectedItem:s,textArrangementChanged:a})}});this._separatorColon=new r({text:":"}).addStyleClass("sapUiTinyMarginTop");this._idNavigationComboBox=new t({visible:"{= !!${isNavigationForId} }",change:function(){o.fireEvent("change",{value:o.getItems()})},selectionChange:function(e){o.handleComboBoxEvents(e,o,true)}});this._uomComboBox=new t({change:function(e){const t=e.getSource();const n=t.getBindingContext();const i=n?.getPath()||"";const r=o.getModel();const s=r.getProperty(i);o.fireEvent("change",{value:o.getItems(),selectedItem:s})},selectionChange:function(e){o.handleComboBoxEvents(e,o)}});this._descriptionNavigationComboBox=new t({visible:"{= !!${isNavigationForDescription} }",change:function(){o.fireEvent("change",{value:o.getItems()})},selectionChange:function(e){o.handleComboBoxEvents(e,o,true)}});this._separatorColonText=new r({text:":"}).addStyleClass("sapUiTinyMarginTop");this._textArrangementComboBox=new t({change:function(){o.fireEvent("change",{type:"text",value:o.getItems()})},selectionChange:function(e){const t=e.getParameter("id");const n=a.getElementById(t);const i=n.getSelectedKey();const r=e.getSource();const s=r.getBindingContext();const c=s?.getPath()||"";const g=o.getModel();const l=g.getProperty(c);l.textArrangement=`${i}`;g.refresh()}});this._deleteButton=new e({icon:"sap-icon://delete",type:"Transparent",press:this._onDeleteButtonClicked.bind(this)});this._addButton=new e({icon:"sap-icon://add",type:"Transparent",press:this._onAddButtonClicked.bind(this)})},onAfterRendering:function e(){const t=JSON.parse(JSON.stringify(this.getSelectionKeys()));const n=this._setSelectionKeysMap.name??"";const o=this._setSelectionKeysMap.label;const i=this._setSelectionKeysMap.textArrangement??"";t.forEach(e=>{e.name=e[n];e.label=e[o];e.textArrangement=e[i]});const r=this._textArrangementComboBox.getModel("internal");const s=this.getModel("i18n");u.forEach(e=>{e.label=s.getObject(e.label)});r.setData(u,true);r.refresh()},setSelectionKeys:function e(t){const n=this;n.setAggregation("_list",n._list);this.setProperty("selectionKeys",t);this.setProperty("navigationSelectionKeys",t);this._setSelectionKeysMap=this.getBindingInfo("selectionKeys").parameters;const o=this.getBindingPath("selectionKeys")||"";const i=this.getBindingPath("navigationSelectionKeys")||"";this._propertyComboBox.bindAggregation("items",{path:this.getMode()!=="uom"?i:o,...this.getMode()!=="uom"&&{sorter:new l("category",true,true)},length:500,factory:function(){return new c({key:"{"+n._setSelectionKeysMap.name+"}",text:"{"+n._setSelectionKeysMap.label+"}"})}});this._uomComboBox.bindAggregation("items",{path:this.getMode()!=="uom"?i:o,...this.getMode()!=="uom"&&{sorter:new l("category",true,true)},length:500,factory:function(){return new c({key:"{"+n._setSelectionKeysMap.name+"}",text:"{"+n._setSelectionKeysMap.label+"}"})}});n._idNavigationComboBox.bindAggregation("items",{path:"navigationalPropertiesForId/",length:500,factory:function(){return new c({key:"{name}",text:"{labelWithValue}"})}});n._descriptionNavigationComboBox.bindAggregation("items",{path:"navigationalPropertiesForDescription/",length:500,factory:function(){return new c({key:"{name}",text:"{labelWithValue}"})}});this._textArrangementComboBox.setModel(this._getTextArrangementModel(),"internal");this._textArrangementComboBox.bindAggregation("items",{path:"internal>/",factory:function(){return new c({key:"{internal>name}",text:"{internal>label}"})}})},setItems:function e(t){this.setProperty("items",t,true);this._propertyComboBox.bindProperty("selectedKey",{path:"propertyKeyForId"});this._idNavigationComboBox.bindProperty("selectedKey",{path:"navigationKeyForId"});this._uomComboBox.bindProperty("selectedKey",{path:"propertyKeyForDescription"});this._descriptionNavigationComboBox.bindProperty("selectedKey",{path:"navigationKeyForDescription"});this._textArrangementComboBox.bindProperty("selectedKey",{path:"arrangementType"});const i=this.getBindingPath("items")??"";this._list.bindItems({path:i,template:new n({content:[new o({justifyContent:"SpaceAround",items:[this._propertyComboBox,this.getMode()!=="uom"&&this._idNavigationComboBox,this._separatorColon,this._uomComboBox,this.getMode()!=="uom"&&this._separatorColonText,this.getMode()!=="uom"&&this._descriptionNavigationComboBox,this.getMode()!=="uom"&&this._separatorColonText,this.getMode()!=="uom"&&this._textArrangementComboBox,this._deleteButton],width:"100%",alignItems:"Start",fitContainer:true})]})})},_getInternalModel:function e(){if(!this.getModel("internal")){const e=new p({});this.setModel(e,"internal")}return this.getModel("internal")},getItems:function e(){const t=this.getBindingPath("items")||"";return this.getModel().getProperty(t)},getSelectedItem:function e(){const t=this.getBindingPath("items")||"";return this.getModel().getProperty(t)},_getTextArrangementModel:function e(){return new p(u)},_onAddButtonClicked:function e(){const t=this.getModel();const n=this.getBindingPath("items")||"";if(t){let e=t.getProperty(n);if(!e){e=[]}e.push({});t.refresh()}},_onDeleteButtonClicked:function e(t){const n=t.getSource();const o=n.getBindingContext().getPath();const i=this.getBindingPath("items")||"";const r=this.getModel();const s=r.getProperty(i);s&&s.splice(o.slice(o.length-1),1);r.refresh();this.fireEvent("change",{value:this.getItems()})},handleComboBoxEvents:function e(t,n){let o=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;const r=t.getParameter("id");const s=a.getElementById(r);const c=s.getSelectedKey();const g=t.getSource();const l=g.getBindingContext();const p=l?.getPath()||"";const h=s.getValue();const d=n.getModel();const u=d.getProperty(p);const m=n.getModel("i18n");const y=d.getProperty("/configuration/navigationProperty")||[];const f=this.hasNavigationProperty(y,u.propertyKeyForDescription);u.name=this.getGroupName(u,o,i);let x="";if(u.navigationKeyForDescription){x=`/${u.navigationKeyForDescription}`}const C=f?`${u.propertyKeyForDescription}${x}`:u.propertyKeyForDescription;const b=u.name===C;if(!b){u.value=this.getGroupValue(u,o,i,c,y)}this.updateControlState(s,h,c,b,m,n);d.refresh();return u},getGroupName:function e(t,n,o){if(n){return t.navigationKeyForId?`${t.propertyKeyForId}/${t.navigationKeyForId}`:`${t.propertyKeyForId}`}if(o){return`${t.propertyKeyForId}`}return t.navigationKeyForId?`${t.propertyKeyForId}/${t.navigationKeyForId}`:`${t.propertyKeyForId}`},getGroupValue:function e(t,n,o,i,r){const{propertyKeyForId:s,propertyKeyForDescription:a,navigationKeyForDescription:c}=t;if(n){return c?`${a}/${c}`:a}if(o){const e=this.hasNavigationProperty(r,s);if(c){return e?`${s}`:`${a}/${c}`}return e?s:a}return a||i},updateControlState:function e(t,n,o,i,r,s){if(!o&&n){t.setValueState(d.Error);t.setValueStateText(r.getObject("INVALID_SELECTION"));s.errorFlag=true}else if(i){t.setValueState(d.Warning);t.setValueStateText(r.getObject("SAME_SELECTION"));s.errorFlag=true}else{t.setValueState(d.None);s.errorFlag=false}},hasNavigationProperty:function e(t,n){return t.length>0&&t.some(e=>e.name===n)}});return m});
//# sourceMappingURL=ArrangementsEditor-dbg.js.map
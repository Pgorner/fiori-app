{"version":3,"file":"CardGenerator-dbg.js","names":["sap","ui","define","Log","sap_cards_ap_common_services_RetrieveCard","MessageBox","VersionInfo","Fragment","CoreLib","ResourceModel","___app_CardGeneratorDialogController","___helpers_ApplicationInfo","___helpers_CardGeneratorModel","___helpers_IntegrationCardHelper","___odata_ODataUtils","_catch","body","recover","result","e","then","initializeAsync","oAppComponent","oResourceBundle","getResourceBundleFor","resourceModel","bundleUrl","oUrlInfo","url","bundle","applicationInfo","ApplicationInfo","createInstance","Promise","resolve","validateCardGeneration","bValidConfiguration","warningMsg","getObject","warning","actions","Action","OK","emphasizedAction","cardGeneratorDialog","load","id","name","controller","CardGeneratorDialogController","mCardManifest","library","sapCoreVersionInfo","_temp2","getCardGeneratorDialogModel","dialogModel","oDialog","mManifest","getManifest","cardTitle","title","cardSubtitle","description","sapAppId","oAppModel","getModel","Error","odataModel","serviceUrl","entitySet","entitySetWithObjectContext","fetchDetails","bODataV4","ODataModelVersion","V4","sServiceUrl","entitySetName","createPathWithEntityContext","path","mIntegrationCardManifest","updateExistingCardManifest","getProperty","createInitialManifest","subTitle","service","serviceModel","data","setModel","renderCardPreview","initialize","open","element","document","getElementById","style","backgroundColor","reject","catch","oError","error","_temp","getObjectPageCardManifestForPreview","cardType","CardTypes","INTEGRATION","includeActions","hideActions","isDesignMode","_getObjectPageCardMan","__exports","__esModule"],"sources":["CardGenerator.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\nimport Log from \"sap/base/Log\";\nimport { getObjectPageCardManifestForPreview } from \"sap/cards/ap/common/services/RetrieveCard\";\nimport type Dialog from \"sap/m/Dialog\";\nimport MessageBox from \"sap/m/MessageBox\";\nimport VersionInfo from \"sap/ui/VersionInfo\";\nimport Component from \"sap/ui/core/Component\";\nimport type Control from \"sap/ui/core/Control\";\nimport Fragment from \"sap/ui/core/Fragment\";\nimport CoreLib from \"sap/ui/core/Lib\";\nimport { CardManifest } from \"sap/ui/integration/widgets/Card\";\nimport ResourceModel from \"sap/ui/model/resource/ResourceModel\";\nimport { CardGeneratorDialogController } from \"./app/CardGeneratorDialogController\";\nimport { ApplicationInfo, ODataModelVersion } from \"./helpers/ApplicationInfo\";\nimport { getCardGeneratorDialogModel } from \"./helpers/CardGeneratorModel\";\nimport { createInitialManifest, renderCardPreview, updateExistingCardManifest } from \"./helpers/IntegrationCardHelper\";\nimport { createPathWithEntityContext } from \"./odata/ODataUtils\";\n\nenum CardTypes {\n\tINTEGRATION = \"integration\",\n\tADAPTIVE = \"adaptive\"\n}\n\nlet cardGeneratorDialog: Promise<Control | Control[]> | undefined;\n\nexport async function initializeAsync(oAppComponent: Component) {\n\tconst oResourceBundle = CoreLib.getResourceBundleFor(\"sap.cards.ap.generator.i18n\");\n\tconst resourceModel = new ResourceModel({\n\t\tbundleUrl: oResourceBundle.oUrlInfo.url,\n\t\tbundle: oResourceBundle //Reuse created bundle to stop extra network calls\n\t});\n\tconst applicationInfo = ApplicationInfo.createInstance(oAppComponent);\n\tconst bValidConfiguration = await applicationInfo.validateCardGeneration();\n\tif (!bValidConfiguration) {\n\t\tconst warningMsg: string = resourceModel.getObject(\"GENERATE_CARD_NOT_SUPPORTED\");\n\t\tMessageBox.warning(warningMsg, {\n\t\t\tactions: MessageBox.Action.OK,\n\t\t\temphasizedAction: MessageBox.Action.OK\n\t\t});\n\t\treturn;\n\t}\n\n\tif (!cardGeneratorDialog) {\n\t\tcardGeneratorDialog = Fragment.load({\n\t\t\tid: \"cardGeneratorDialog\",\n\t\t\tname: \"sap.cards.ap.generator.app.CardGeneratorDialog\",\n\t\t\tcontroller: CardGeneratorDialogController\n\t\t});\n\t}\n\n\tlet mCardManifest: CardManifest | undefined;\n\tconst sapCoreVersionInfo = await VersionInfo.load({\n\t\tlibrary: \"sap.ui.core\"\n\t});\n\ttry {\n\t\tmCardManifest = await getObjectPageCardManifestForPreview(oAppComponent, {\n\t\t\tcardType: CardTypes.INTEGRATION,\n\t\t\tincludeActions: false,\n\t\t\thideActions: false,\n\t\t\tisDesignMode: true\n\t\t});\n\t} catch (oError: unknown) {\n\t\tLog.error(\"Error while fetching the card manifest.\");\n\t}\n\tconst dialogModel = await getCardGeneratorDialogModel(oAppComponent, mCardManifest);\n\tcardGeneratorDialog\n\t\t.then(async function (oDialog: Dialog) {\n\t\t\tconst mManifest = oAppComponent.getManifest();\n\t\t\tconst cardTitle: string = mManifest[\"sap.app\"].title;\n\t\t\tconst cardSubtitle: string = mManifest[\"sap.app\"].description;\n\t\t\tconst sapAppId = mManifest[\"sap.app\"].id;\n\t\t\tconst oAppModel = oAppComponent.getModel();\n\t\t\tif (!oAppModel) {\n\t\t\t\tthrow new Error(\"No model found in the view\");\n\t\t\t}\n\n\t\t\tconst { odataModel, serviceUrl, entitySet, entitySetWithObjectContext } = applicationInfo.fetchDetails();\n\t\t\tconst bODataV4 = odataModel === ODataModelVersion.V4;\n\t\t\tconst sServiceUrl = serviceUrl;\n\t\t\tconst entitySetName = entitySet;\n\t\t\tconst path = await createPathWithEntityContext(entitySetWithObjectContext, oAppModel, bODataV4);\n\t\t\tconst mIntegrationCardManifest =\n\t\t\t\tupdateExistingCardManifest(mCardManifest, dialogModel.getProperty(\"/configuration/$data\")) ||\n\t\t\t\tcreateInitialManifest({\n\t\t\t\t\ttitle: cardTitle,\n\t\t\t\t\tsubTitle: cardSubtitle,\n\t\t\t\t\tservice: sServiceUrl,\n\t\t\t\t\tentitySet: path,\n\t\t\t\t\tserviceModel: oAppModel,\n\t\t\t\t\tsapAppId: sapAppId,\n\t\t\t\t\tsapCoreVersionInfo,\n\t\t\t\t\tentitySetName,\n\t\t\t\t\tdata: dialogModel.getProperty(\"/configuration/$data\")\n\t\t\t\t});\n\n\t\t\tif (!oDialog.getModel(\"i18n\")) {\n\t\t\t\toDialog.setModel(resourceModel, \"i18n\");\n\t\t\t}\n\t\t\trenderCardPreview(mIntegrationCardManifest);\n\t\t\toDialog.setModel(dialogModel);\n\t\t\tCardGeneratorDialogController.initialize(oAppComponent, oDialog, entitySetName);\n\t\t\toDialog.open();\n\t\t\tconst element = document.getElementById(\"cardGeneratorDialog--contentSplitter\");\n\t\t\tif (element) {\n\t\t\t\telement.style.backgroundColor = \"#f8f8f8\";\n\t\t\t}\n\t\t\treturn oDialog;\n\t\t})\n\t\t.catch(function (oError: Error) {\n\t\t\tLog.error(\"Error while loading or initializing the dialog:\", oError);\n\t\t});\n}\n"],"mappings":"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","ignoreList":[]}
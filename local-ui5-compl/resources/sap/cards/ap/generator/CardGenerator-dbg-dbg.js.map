{"version":3,"file":"CardGenerator-dbg-dbg.js","names":["sap","ui","define","Log","sap_cards_ap_common_services_RetrieveCard","MessageBox","VersionInfo","Fragment","CoreLib","ResourceModel","___app_CardGeneratorDialogController","___helpers_ApplicationInfo","___helpers_CardGeneratorModel","___helpers_IntegrationCardHelper","___odata_ODataUtils","_catch","body","recover","result","e","then","initializeAsync","oAppComponent","oResourceBundle","getResourceBundleFor","resourceModel","bundleUrl","oUrlInfo","url","bundle","applicationInfo","ApplicationInfo","createInstance","Promise","resolve","validateCardGeneration","bValidConfiguration","warningMsg","getObject","warning","actions","Action","OK","emphasizedAction","cardGeneratorDialog","load","id","name","controller","CardGeneratorDialogController","mCardManifest","library","sapCoreVersionInfo","_temp2","getCardGeneratorDialogModel","dialogModel","oDialog","mManifest","getManifest","cardTitle","title","cardSubtitle","description","sapAppId","oAppModel","getModel","Error","odataModel","serviceUrl","entitySet","entitySetWithObjectContext","fetchDetails","bODataV4","ODataModelVersion","V4","sServiceUrl","entitySetName","createPathWithEntityContext","path","mIntegrationCardManifest","updateExistingCardManifest","getProperty","createInitialManifest","subTitle","service","serviceModel","data","setModel","renderCardPreview","initialize","open","element","document","getElementById","style","backgroundColor","reject","catch","oError","error","_temp","getObjectPageCardManifestForPreview","cardType","CardTypes","INTEGRATION","includeActions","hideActions","isDesignMode","_getObjectPageCardMan","__exports","__esModule"],"sources":["CardGenerator.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\nimport Log from \"sap/base/Log\";\nimport { getObjectPageCardManifestForPreview } from \"sap/cards/ap/common/services/RetrieveCard\";\nimport type Dialog from \"sap/m/Dialog\";\nimport MessageBox from \"sap/m/MessageBox\";\nimport VersionInfo from \"sap/ui/VersionInfo\";\nimport Component from \"sap/ui/core/Component\";\nimport type Control from \"sap/ui/core/Control\";\nimport Fragment from \"sap/ui/core/Fragment\";\nimport CoreLib from \"sap/ui/core/Lib\";\nimport { CardManifest } from \"sap/ui/integration/widgets/Card\";\nimport ResourceModel from \"sap/ui/model/resource/ResourceModel\";\nimport { CardGeneratorDialogController } from \"./app/CardGeneratorDialogController\";\nimport { ApplicationInfo, ODataModelVersion } from \"./helpers/ApplicationInfo\";\nimport { getCardGeneratorDialogModel } from \"./helpers/CardGeneratorModel\";\nimport { createInitialManifest, renderCardPreview, updateExistingCardManifest } from \"./helpers/IntegrationCardHelper\";\nimport { createPathWithEntityContext } from \"./odata/ODataUtils\";\n\nenum CardTypes {\n\tINTEGRATION = \"integration\",\n\tADAPTIVE = \"adaptive\"\n}\n\nlet cardGeneratorDialog: Promise<Control | Control[]> | undefined;\n\nexport async function initializeAsync(oAppComponent: Component) {\n\tconst oResourceBundle = CoreLib.getResourceBundleFor(\"sap.cards.ap.generator.i18n\");\n\tconst resourceModel = new ResourceModel({\n\t\tbundleUrl: oResourceBundle.oUrlInfo.url,\n\t\tbundle: oResourceBundle //Reuse created bundle to stop extra network calls\n\t});\n\tconst applicationInfo = ApplicationInfo.createInstance(oAppComponent);\n\tconst bValidConfiguration = await applicationInfo.validateCardGeneration();\n\tif (!bValidConfiguration) {\n\t\tconst warningMsg: string = resourceModel.getObject(\"GENERATE_CARD_NOT_SUPPORTED\");\n\t\tMessageBox.warning(warningMsg, {\n\t\t\tactions: MessageBox.Action.OK,\n\t\t\temphasizedAction: MessageBox.Action.OK\n\t\t});\n\t\treturn;\n\t}\n\n\tif (!cardGeneratorDialog) {\n\t\tcardGeneratorDialog = Fragment.load({\n\t\t\tid: \"cardGeneratorDialog\",\n\t\t\tname: \"sap.cards.ap.generator.app.CardGeneratorDialog\",\n\t\t\tcontroller: CardGeneratorDialogController\n\t\t});\n\t}\n\n\tlet mCardManifest: CardManifest | undefined;\n\tconst sapCoreVersionInfo = await VersionInfo.load({\n\t\tlibrary: \"sap.ui.core\"\n\t});\n\ttry {\n\t\tmCardManifest = await getObjectPageCardManifestForPreview(oAppComponent, {\n\t\t\tcardType: CardTypes.INTEGRATION,\n\t\t\tincludeActions: false,\n\t\t\thideActions: false,\n\t\t\tisDesignMode: true\n\t\t});\n\t} catch (oError: unknown) {\n\t\tLog.error(\"Error while fetching the card manifest.\");\n\t}\n\tconst dialogModel = await getCardGeneratorDialogModel(oAppComponent, mCardManifest);\n\tcardGeneratorDialog\n\t\t.then(async function (oDialog: Dialog) {\n\t\t\tconst mManifest = oAppComponent.getManifest();\n\t\t\tconst cardTitle: string = mManifest[\"sap.app\"].title;\n\t\t\tconst cardSubtitle: string = mManifest[\"sap.app\"].description;\n\t\t\tconst sapAppId = mManifest[\"sap.app\"].id;\n\t\t\tconst oAppModel = oAppComponent.getModel();\n\t\t\tif (!oAppModel) {\n\t\t\t\tthrow new Error(\"No model found in the view\");\n\t\t\t}\n\n\t\t\tconst { odataModel, serviceUrl, entitySet, entitySetWithObjectContext } = applicationInfo.fetchDetails();\n\t\t\tconst bODataV4 = odataModel === ODataModelVersion.V4;\n\t\t\tconst sServiceUrl = serviceUrl;\n\t\t\tconst entitySetName = entitySet;\n\t\t\tconst path = await createPathWithEntityContext(entitySetWithObjectContext, oAppModel, bODataV4);\n\t\t\tconst mIntegrationCardManifest =\n\t\t\t\tupdateExistingCardManifest(mCardManifest, dialogModel.getProperty(\"/configuration/$data\")) ||\n\t\t\t\tcreateInitialManifest({\n\t\t\t\t\ttitle: cardTitle,\n\t\t\t\t\tsubTitle: cardSubtitle,\n\t\t\t\t\tservice: sServiceUrl,\n\t\t\t\t\tentitySet: path,\n\t\t\t\t\tserviceModel: oAppModel,\n\t\t\t\t\tsapAppId: sapAppId,\n\t\t\t\t\tsapCoreVersionInfo,\n\t\t\t\t\tentitySetName,\n\t\t\t\t\tdata: dialogModel.getProperty(\"/configuration/$data\")\n\t\t\t\t});\n\n\t\t\tif (!oDialog.getModel(\"i18n\")) {\n\t\t\t\toDialog.setModel(resourceModel, \"i18n\");\n\t\t\t}\n\t\t\trenderCardPreview(mIntegrationCardManifest);\n\t\t\toDialog.setModel(dialogModel);\n\t\t\tCardGeneratorDialogController.initialize(oAppComponent, oDialog, entitySetName);\n\t\t\toDialog.open();\n\t\t\tconst element = document.getElementById(\"cardGeneratorDialog--contentSplitter\");\n\t\t\tif (element) {\n\t\t\t\telement.style.backgroundColor = \"#f8f8f8\";\n\t\t\t}\n\t\t\treturn oDialog;\n\t\t})\n\t\t.catch(function (oError: Error) {\n\t\t\tLog.error(\"Error while loading or initializing the dialog:\", oError);\n\t\t});\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AAHA;;AAAAA,GAAA,CAAAC,EAAA,CAAAC,MAAA,mWAAAC,GAAA,EAAAC,yCAAA,EAAAC,UAAA,EAAAC,WAAA,EAAAC,QAAA,EAAAC,OAAA,EAAAC,aAAA,EAAAC,oCAAA,EAAAC,0BAAA,EAAAC,6BAAA,EAAAC,gCAAA,EAAAC,mBAAA;EAAA;;EAkjBO,SAAAC,OAAgBC,IAAI,EAAEC,OAAO,EAAE;IACrC,IAAI;MACH,IAAIC,MAAM,GAAGF,IAAI,CAAC,CAAC;IACpB,CAAC,CAAC,OAAMG,CAAC,EAAE;MACV,OAAOF,OAAO,CAACE,CAAC,CAAC;IAClB;IACA,IAAID,MAAM,IAAIA,MAAM,CAACE,IAAI,EAAE;MAC1B,OAAOF,MAAM,CAACE,IAAI,CAAC,KAAK,CAAC,EAAEH,OAAO,CAAC;IACpC;IACA,OAAOC,MAAM;EACd;EAAC,MAhiBqBG,eAAe,YAAAA,CAACC,aAAwB;IAAA,IAAE;MAC/D,MAAMC,eAAe,GAAGf,OAAO,CAACgB,oBAAoB,CAAC,6BAA6B,CAAC;MACnF,MAAMC,aAAa,GAAG,IAAIhB,aAAa,CAAC;QACvCiB,SAAS,EAAEH,eAAe,CAACI,QAAQ,CAACC,GAAG;QACvCC,MAAM,EAAEN,eAAe,CAAC;MACzB,CAAC,CAAC;MACF,MAAMO,eAAe,GAAGC,eAAe,CAACC,cAAc,CAACV,aAAa,CAAC;MAAC,OAAAW,OAAA,CAAAC,OAAA,CACpCJ,eAAe,CAACK,sBAAsB,CAAC,CAAC,EAAAf,IAAA,WAApEgB,mBAAmB;QACzB,IAAI,CAACA,mBAAmB,EAAE;UACzB,MAAMC,UAAkB,GAAGZ,aAAa,CAACa,SAAS,CAAC,6BAA6B,CAAC;UACjFjC,UAAU,CAACkC,OAAO,CAACF,UAAU,EAAE;YAC9BG,OAAO,EAAEnC,UAAU,CAACoC,MAAM,CAACC,EAAE;YAC7BC,gBAAgB,EAAEtC,UAAU,CAACoC,MAAM,CAACC;UACrC,CAAC,CAAC;UACF;QACD;QAEA,IAAI,CAACE,mBAAmB,EAAE;UACzBA,mBAAmB,GAAGrC,QAAQ,CAACsC,IAAI,CAAC;YACnCC,EAAE,EAAE,qBAAqB;YACzBC,IAAI,EAAE,gDAAgD;YACtDC,UAAU,EAAEC;UACb,CAAC,CAAC;QACH;QAEA,IAAIC,aAAuC;QAAC,OAAAjB,OAAA,CAAAC,OAAA,CACX5B,WAAW,CAACuC,IAAI,CAAC;UACjDM,OAAO,EAAE;QACV,CAAC,CAAC,EAAA/B,IAAA,WAFIgC,kBAAkB;UAAA,SAAAC,OAAA;YAAA,OAAApB,OAAA,CAAAC,OAAA,CAaEoB,2BAA2B,CAAChC,aAAa,EAAE4B,aAAa,CAAC,EAAA9B,IAAA,WAA7EmC,WAAW;cACjBX,mBAAmB,CACjBxB,IAAI,WAAiBoC,OAAe;gBAAA,IAAE;kBACtC,MAAMC,SAAS,GAAGnC,aAAa,CAACoC,WAAW,CAAC,CAAC;kBAC7C,MAAMC,SAAiB,GAAGF,SAAS,CAAC,SAAS,CAAC,CAACG,KAAK;kBACpD,MAAMC,YAAoB,GAAGJ,SAAS,CAAC,SAAS,CAAC,CAACK,WAAW;kBAC7D,MAAMC,QAAQ,GAAGN,SAAS,CAAC,SAAS,CAAC,CAACX,EAAE;kBACxC,MAAMkB,SAAS,GAAG1C,aAAa,CAAC2C,QAAQ,CAAC,CAAC;kBAC1C,IAAI,CAACD,SAAS,EAAE;oBACf,MAAM,IAAIE,KAAK,CAAC,4BAA4B,CAAC;kBAC9C;kBAEA,MAAM;oBAAEC,UAAU;oBAAEC,UAAU;oBAAEC,SAAS;oBAAEC;kBAA2B,CAAC,GAAGxC,eAAe,CAACyC,YAAY,CAAC,CAAC;kBACxG,MAAMC,QAAQ,GAAGL,UAAU,KAAKM,iBAAiB,CAACC,EAAE;kBACpD,MAAMC,WAAW,GAAGP,UAAU;kBAC9B,MAAMQ,aAAa,GAAGP,SAAS;kBAAC,OAAApC,OAAA,CAAAC,OAAA,CACb2C,2BAA2B,CAACP,0BAA0B,EAAEN,SAAS,EAAEQ,QAAQ,CAAC,EAAApD,IAAA,WAAzF0D,IAAI;oBACV,MAAMC,wBAAwB,GAC7BC,0BAA0B,CAAC9B,aAAa,EAAEK,WAAW,CAAC0B,WAAW,CAAC,sBAAsB,CAAC,CAAC,IAC1FC,qBAAqB,CAAC;sBACrBtB,KAAK,EAAED,SAAS;sBAChBwB,QAAQ,EAAEtB,YAAY;sBACtBuB,OAAO,EAAET,WAAW;sBACpBN,SAAS,EAAES,IAAI;sBACfO,YAAY,EAAErB,SAAS;sBACvBD,QAAQ,EAAEA,QAAQ;sBAClBX,kBAAkB;sBAClBwB,aAAa;sBACbU,IAAI,EAAE/B,WAAW,CAAC0B,WAAW,CAAC,sBAAsB;oBACrD,CAAC,CAAC;oBAEH,IAAI,CAACzB,OAAO,CAACS,QAAQ,CAAC,MAAM,CAAC,EAAE;sBAC9BT,OAAO,CAAC+B,QAAQ,CAAC9D,aAAa,EAAE,MAAM,CAAC;oBACxC;oBACA+D,iBAAiB,CAACT,wBAAwB,CAAC;oBAC3CvB,OAAO,CAAC+B,QAAQ,CAAChC,WAAW,CAAC;oBAC7BN,6BAA6B,CAACwC,UAAU,CAACnE,aAAa,EAAEkC,OAAO,EAAEoB,aAAa,CAAC;oBAC/EpB,OAAO,CAACkC,IAAI,CAAC,CAAC;oBACd,MAAMC,OAAO,GAAGC,QAAQ,CAACC,cAAc,CAAC,sCAAsC,CAAC;oBAC/E,IAAIF,OAAO,EAAE;sBACZA,OAAO,CAACG,KAAK,CAACC,eAAe,GAAG,SAAS;oBAC1C;oBACA,OAAOvC,OAAO;kBAAC;gBAChB,CAAC,QAAArC,CAAA;kBAAA,OAAAc,OAAA,CAAA+D,MAAA,CAAA7E,CAAA;gBAAA;cAAA,EAAC,CACD8E,KAAK,CAAC,UAAUC,MAAa,EAAE;gBAC/B/F,GAAG,CAACgG,KAAK,CAAC,iDAAiD,EAAED,MAAM,CAAC;cACrE,CAAC,CAAC;YAAC;UAAA;UAAA,MAAAE,KAAA,GAAArF,MAAA,aAxDA;YAAA,OAAAkB,OAAA,CAAAC,OAAA,CACmBmE,mCAAmC,CAAC/E,aAAa,EAAE;cACxEgF,QAAQ,EAAEC,SAAS,CAACC,WAAW;cAC/BC,cAAc,EAAE,KAAK;cACrBC,WAAW,EAAE,KAAK;cAClBC,YAAY,EAAE;YACf,CAAC,CAAC,EAAAvF,IAAA,WAAAwF,qBAAA;cALF1D,aAAa,GAAA0D,qBAKX;YAAC;UACJ,CAAC,cAAyB;YACzBzG,GAAG,CAACgG,KAAK,CAAC,yCAAyC,CAAC;UACrD,CAAC;UAAA,OAAAC,KAAA,IAAAA,KAAA,CAAAhF,IAAA,GAAAgF,KAAA,CAAAhF,IAAA,CAAAiC,MAAA,IAAAA,MAAA,CAAA+C,KAAA;QAAA;MAAA;IAgDF,CAAC,QAAAjF,CAAA;MAAA,OAAAc,OAAA,CAAA+D,MAAA,CAAA7E,CAAA;IAAA;EAAA;EAAA,MA7GQkF,mCAAmC,GAAAjG,yCAAA;EAAA,MAUnC6C,6BAA6B,GAAAvC,oCAAA;EAAA,MAC7BqB,eAAe,GAAApB,0BAAA;EAAA,MAAE8D,iBAAiB,GAAA9D,0BAAA;EAAA,MAClC2C,2BAA2B,GAAA1C,6BAAA;EAAA,MAC3BsE,qBAAqB,GAAArE,gCAAA;EAAA,MAAE2E,iBAAiB,GAAA3E,gCAAA;EAAA,MAAEmE,0BAA0B,GAAAnE,gCAAA;EAAA,MACpEgE,2BAA2B,GAAA/D,mBAAA;EAAA,IAE/ByF,SAAS,0BAATA,SAAS;IAATA,SAAS;IAATA,SAAS;IAAA,OAATA,SAAS;EAAA,EAATA,SAAS;EAKd,IAAI3D,mBAA6D;EAAC,IAAAiE,SAAA;IAAAC,UAAA;EAAA;EAAAD,SAAA,CAAAxF,eAAA,GAAAA,eAAA;EAAA,OAAAwF,SAAA;AAAA","ignoreList":[]}
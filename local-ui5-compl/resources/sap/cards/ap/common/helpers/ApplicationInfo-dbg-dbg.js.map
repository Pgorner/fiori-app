{"version":3,"file":"ApplicationInfo-dbg-dbg.js","names":["sap","ui","define","ResourceBundle","ODataModelVersion","fetchApplicationInfo","rootComponent","fetchOptions","isDesignMode","componentName","getManifest","id","model","getModel","hash","window","hasher","getHash","hashPartial","split","semanticObject","action","includes","path","startsWith","slice","index","indexOf","entitySet","substring","context","odataModel","isA","V4","V2","i18nModel","Promise","resolve","getResourceBundle","then","resourceBundle","_temp2","appModel","entitySetWithObjectContext","_temp","i18nBundleUrl","oUrlInfo","url","timeStamp","Date","now","create","async","_ResourceBundle$creat","e","reject","__exports","__esModule"],"sources":["ApplicationInfo.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\nimport ResourceBundle from \"sap/base/i18n/ResourceBundle\";\nimport Component from \"sap/ui/core/Component\";\nimport { default as V2ODataModel } from \"sap/ui/model/odata/v2/ODataModel\";\nimport { default as V4ODataModel } from \"sap/ui/model/odata/v4/ODataModel\";\nimport ResourceModel from \"sap/ui/model/resource/ResourceModel\";\n\nexport enum ODataModelVersion {\n\tV2 = \"V2\",\n\tV4 = \"V4\"\n}\n\ntype ODataModel = V2ODataModel | V4ODataModel;\n\nexport type ApplicationInfo = {\n\tappModel: ODataModel;\n\todataModel: ODataModelVersion;\n\tentitySet: string;\n\tcontext: string;\n\tentitySetWithObjectContext: string;\n\tcomponentName: string;\n\tresourceBundle: ResourceBundle;\n\tsemanticObject: string;\n\taction: string;\n};\n\ntype ResourceBundleWithURL = ResourceBundle & { oUrlInfo: { url: string } };\ntype FetchApplicationInfoOptions = {\n\tisDesignMode?: boolean;\n};\n\ntype ManifestContentSapCardsAP = {\n\tembeds: {\n\t\tObjectPage?: {\n\t\t\tdefault: string;\n\t\t\tmanifests: {\n\t\t\t\t[key: string]: Array<{\n\t\t\t\t\tlocalUri: string;\n\t\t\t\t\thideActions: boolean;\n\t\t\t\t}>;\n\t\t\t};\n\t\t};\n\t};\n};\n\nexport type AppManifest = {\n\t\"sap.app\": {\n\t\tid: string;\n\t};\n\t\"sap.ui5\": {};\n\t\"sap.ui\": {};\n\t\"sap.fe\"?: {};\n\t\"sap.platform.abap\"?: {\n\t\turi: string;\n\t};\n\t\"sap.cards.ap\"?: ManifestContentSapCardsAP;\n};\n\n/**\n * Fetches the details of the application\n *\n * @param {Component} rootComponent - The root component of the application\n * @param {FetchApplicationInfoOptions} fetchOptions\n * @returns {Promise<ApplicationInfo>} The application info\n */\nexport const fetchApplicationInfo = async function (\n\trootComponent: Component,\n\tfetchOptions?: FetchApplicationInfoOptions\n): Promise<ApplicationInfo> {\n\tconst isDesignMode = fetchOptions?.isDesignMode || false;\n\tconst componentName = (rootComponent.getManifest() as AppManifest)[\"sap.app\"].id;\n\tconst model = rootComponent.getModel() as ODataModel;\n\tconst hash = window.hasher.getHash();\n\tconst [hashPartial] = hash.split(\"&/\");\n\tconst [semanticObject, action] = hashPartial.includes(\"?\") ? hashPartial.split(\"?\")[0].split(\"-\") : hashPartial.split(\"-\");\n\n\tlet path = hash.split(\"&/\")[1] || \"\";\n\tpath = path.includes(\"/\") ? path.split(\"/\")[0] : path;\n\tpath = path.startsWith(\"/\") ? path.slice(1) : path;\n\n\tconst index = path.indexOf(\"(\");\n\tconst entitySet = index > -1 ? path.substring(0, index) : path;\n\tconst context = index > -1 ? path.substring(index + 1, path.indexOf(\")\")) : \"\";\n\tconst odataModel = model.isA<V4ODataModel>(\"sap.ui.model.odata.v4.ODataModel\") ? ODataModelVersion.V4 : ODataModelVersion.V2;\n\tconst i18nModel = (rootComponent.getModel(\"i18n\") || rootComponent.getModel(\"@i18n\")) as ResourceModel;\n\tlet resourceBundle = await i18nModel.getResourceBundle();\n\n\tif (isDesignMode) {\n\t\t/* Refreshing or destroying the i18nModel does not fetch the latest values because of caching.\n\t\tFor cache busting, we are appending a unique identifier to the i18nBundleUrl to fetch the latest i18n values everytime dialog is opened. */\n\t\tconst i18nBundleUrl = (resourceBundle as ResourceBundleWithURL)?.oUrlInfo?.url;\n\t\tconst timeStamp = Date.now();\n\n\t\tresourceBundle = await ResourceBundle.create({\n\t\t\turl: `${i18nBundleUrl}?v=${timeStamp}`,\n\t\t\tasync: true\n\t\t});\n\t}\n\n\treturn {\n\t\todataModel,\n\t\tappModel: model,\n\t\tentitySet,\n\t\tentitySetWithObjectContext: path,\n\t\tcontext,\n\t\tcomponentName,\n\t\tresourceBundle,\n\t\tsemanticObject,\n\t\taction\n\t} as ApplicationInfo;\n};\n"],"mappings":"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","ignoreList":[]}